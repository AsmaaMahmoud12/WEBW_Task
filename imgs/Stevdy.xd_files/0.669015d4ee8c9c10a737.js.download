(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var r=n(17);function i(t,e){const n=a(e);return n&&n.valid?t.clampedRelativeRect(n):t}function o(t){const e=a(t);if(e){const n=document.createElement("canvas");return n.width=e.width,n.height=e.height,n.getContext("2d").drawImage(t,e.left,e.top,e.width,e.height,0,0,e.width,e.height),n}return t}function a(t){const e=t.getContext("2d"),n=t.width,i=t.height;if(0===n||0===i)return;const o=e.getImageData(0,0,n,i).data;let a=0,s=0,l=i-1,c=n-1;for(a=0;a<i;a++){let t=!1;for(let e=0;e<n;e++){if(t=o[4*(a*n+e)+3]>0,t)break}if(t){a--;break}}for(s=0;s<n;s++){let t=!1;for(let e=0;e<i;e++){if(t=o[4*(e*n+s)+3]>0,t)break}if(t){s--;break}}for(l=i-1;l>=0;l--){let t=!1;for(let e=0;e<n;e++){if(t=o[4*(l*n+e)+3]>0,t)break}if(t)break}for(c=n-1;c>=0;c--){let t=!1;for(let e=0;e<i;e++){if(t=o[4*(e*n+c)+3]>0,t)break}if(t)break}return s>0||a>0||l<i-1||c<n-1?new r.a(s,a,c+1,l+1):void 0}},101:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(20);function i(t){throw Object(r.b)(t),alert(t),new Error(t)}},102:function(t,e,n){"use strict";function r(t){const e=t.toString(16);return 1===e.length?"0"+e:e}function i(t,e,n){return"#"+r(t)+r(e)+r(n)}n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return a}));const o=/\d+/g;function a(t){if(!t)return i(0,0,0);const e=t.match(o);return e?i(parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)):""}},11:function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n(53),i=n(54),o=n(39);function a(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(a()<e)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=l.prototype:(null===t&&(t=new l(e)),t.length=e),t}function l(t,e,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return u(this,t)}return c(this,t,e,n)}function c(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);l.TYPED_ARRAY_SUPPORT?(t=e).__proto__=l.prototype:t=f(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|d(e,n),i=(t=s(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(l.isBuffer(e)){var n=0|p(e.length);return 0===(t=s(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?s(t,0):f(t,e);if("Buffer"===e.type&&o(e.data))return f(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function u(t,e){if(h(e),t=s(t,e<0?0:0|p(e)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function f(t,e){var n=e.length<0?0:0|p(e.length);t=s(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function p(t){if(t>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function d(t,e){if(l.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return z(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return G(t).length;default:if(r)return z(t).length;e=(""+e).toLowerCase(),r=!0}}function g(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return E(this,e,n);case"utf8":case"utf-8":return O(this,e,n);case"ascii":return k(this,e,n);case"latin1":case"binary":return P(this,e,n);case"base64":return _(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function v(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function m(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=l.from(e,r)),l.isBuffer(e))return 0===e.length?-1:y(t,e,n,r,i);if("number"==typeof e)return e&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):y(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function y(t,e,n,r,i){var o,a=1,s=t.length,l=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;a=2,s/=2,l/=2,n/=2}function c(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(i){var h=-1;for(o=n;o<s;o++)if(c(t,o)===c(e,-1===h?0:o-h)){if(-1===h&&(h=o),o-h+1===l)return h*a}else-1!==h&&(o-=o-h),h=-1}else for(n+l>s&&(n=s-l),o=n;o>=0;o--){for(var u=!0,f=0;f<l;f++)if(c(t,o+f)!==c(e,f)){u=!1;break}if(u)return o}return-1}function b(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[n+a]=s}return a}function x(t,e,n,r){return N(z(e,t.length-n),t,n,r)}function w(t,e,n,r){return N(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function S(t,e,n,r){return w(t,e,n,r)}function C(t,e,n,r){return N(G(e),t,n,r)}function T(t,e,n,r){return N(function(t,e){for(var n,r,i,o=[],a=0;a<t.length&&!((e-=2)<0);++a)n=t.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function _(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function O(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,a,s,l,c=t[i],h=null,u=c>239?4:c>223?3:c>191?2:1;if(i+u<=n)switch(u){case 1:c<128&&(h=c);break;case 2:128==(192&(o=t[i+1]))&&(l=(31&c)<<6|63&o)>127&&(h=l);break;case 3:o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&(l=(15&c)<<12|(63&o)<<6|63&a)>2047&&(l<55296||l>57343)&&(h=l);break;case 4:o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(l=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(h=l)}null===h?(h=65533,u=1):h>65535&&(h-=65536,r.push(h>>>10&1023|55296),h=56320|1023&h),r.push(h),i+=u}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=4096));return n}(r)}e.Buffer=l,e.SlowBuffer=function(t){+t!=t&&(t=0);return l.alloc(+t)},e.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=a(),l.poolSize=8192,l._augment=function(t){return t.__proto__=l.prototype,t},l.from=function(t,e,n){return c(null,t,e,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(t,e,n){return function(t,e,n,r){return h(e),e<=0?s(t,e):void 0!==n?"string"==typeof r?s(t,e).fill(n,r):s(t,e).fill(n):s(t,e)}(null,t,e,n)},l.allocUnsafe=function(t){return u(null,t)},l.allocUnsafeSlow=function(t){return u(null,t)},l.isBuffer=function(t){return!(null==t||!t._isBuffer)},l.compare=function(t,e){if(!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=l.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var a=t[n];if(!l.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},l.byteLength=d,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)v(this,e,e+1);return this},l.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)v(this,e,e+3),v(this,e+1,e+2);return this},l.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)v(this,e,e+7),v(this,e+1,e+6),v(this,e+2,e+5),v(this,e+3,e+4);return this},l.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?O(this,0,t):g.apply(this,arguments)},l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},l.prototype.compare=function(t,e,n,r,i){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(e>>>=0),s=Math.min(o,a),c=this.slice(r,i),h=t.slice(e,n),u=0;u<s;++u)if(c[u]!==h[u]){o=c[u],a=h[u];break}return o<a?-1:a<o?1:0},l.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},l.prototype.indexOf=function(t,e,n){return m(this,t,e,n,!0)},l.prototype.lastIndexOf=function(t,e,n){return m(this,t,e,n,!1)},l.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return b(this,t,e,n);case"utf8":case"utf-8":return x(this,t,e,n);case"ascii":return w(this,t,e,n);case"latin1":case"binary":return S(this,t,e,n);case"base64":return C(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function k(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function P(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function E(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=U(t[o]);return i}function M(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function A(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function L(t,e,n,r,i,o){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function D(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function I(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function R(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function j(t,e,n,r,o){return o||R(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function B(t,e,n,r,o){return o||R(t,0,n,8),i.write(t,e,n,r,52,8),n+8}l.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=l.prototype;else{var i=e-t;n=new l(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},l.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||A(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},l.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||A(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},l.prototype.readUInt8=function(t,e){return e||A(t,1,this.length),this[t]},l.prototype.readUInt16LE=function(t,e){return e||A(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUInt16BE=function(t,e){return e||A(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUInt32LE=function(t,e){return e||A(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUInt32BE=function(t,e){return e||A(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||A(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},l.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||A(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},l.prototype.readInt8=function(t,e){return e||A(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},l.prototype.readInt16LE=function(t,e){e||A(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(t,e){e||A(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(t,e){return e||A(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return e||A(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readFloatLE=function(t,e){return e||A(t,4,this.length),i.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return e||A(t,4,this.length),i.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return e||A(t,8,this.length),i.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return e||A(t,8,this.length),i.read(this,t,!1,52,8)},l.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||L(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},l.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||L(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},l.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,1,255,0),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},l.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):D(this,t,e,!0),e+2},l.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):D(this,t,e,!1),e+2},l.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):I(this,t,e,!0),e+4},l.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):I(this,t,e,!1),e+4},l.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);L(this,t,e,n,i-1,-i)}var o=0,a=1,s=0;for(this[e]=255&t;++o<n&&(a*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},l.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);L(this,t,e,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[e+o]=255&t;--o>=0&&(a*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},l.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,1,127,-128),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):D(this,t,e,!0),e+2},l.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):D(this,t,e,!1),e+2},l.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):I(this,t,e,!0),e+4},l.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):I(this,t,e,!1),e+4},l.prototype.writeFloatLE=function(t,e,n){return j(this,t,e,!0,n)},l.prototype.writeFloatBE=function(t,e,n){return j(this,t,e,!1,n)},l.prototype.writeDoubleLE=function(t,e,n){return B(this,t,e,!0,n)},l.prototype.writeDoubleBE=function(t,e,n){return B(this,t,e,!1,n)},l.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},l.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var a=l.isBuffer(t)?t:z(new l(t,r).toString()),s=a.length;for(o=0;o<n-e;++o)this[o+e]=a[o%s]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function U(t){return t<16?"0"+t.toString(16):t.toString(16)}function z(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],a=0;a<r;++a){if((n=t.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function G(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(F,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function N(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(6))},119:function(t,e,n){"use strict";function r(t,e,n,o,a,s){if(!(a-o<=n)){var l=Math.floor((o+a)/2);!function t(e,n,r,o,a,s){for(;a>o;){if(a-o>600){var l=a-o+1,c=r-o+1,h=Math.log(l),u=.5*Math.exp(2*h/3),f=.5*Math.sqrt(h*u*(l-u)/l)*(c-l/2<0?-1:1),p=Math.max(o,Math.floor(r-c*u/l+f)),d=Math.min(a,Math.floor(r+(l-c)*u/l+f));t(e,n,r,p,d,s)}var g=n[2*r+s],v=o,m=a;for(i(e,n,o,r),n[2*a+s]>g&&i(e,n,o,a);v<m;){for(i(e,n,v,m),v++,m--;n[2*v+s]<g;)v++;for(;n[2*m+s]>g;)m--}n[2*o+s]===g?i(e,n,o,m):(m++,i(e,n,m,a)),m<=r&&(o=m+1),r<=m&&(a=m-1)}}(t,e,l,o,a,s%2),r(t,e,n,o,l-1,s+1),r(t,e,n,l+1,a,s+1)}}function i(t,e,n,r){o(t,n,r),o(e,2*n,2*r),o(e,2*n+1,2*r+1)}function o(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function a(t,e,n,r){var i=t-n,o=e-r;return i*i+o*o}function s(t,e,n,r,i){return new l(t,e,n,r,i)}function l(t,e,n,i,o){e=e||c,n=n||h,o=o||Array,this.nodeSize=i||64,this.points=t,this.ids=new o(t.length),this.coords=new o(2*t.length);for(var a=0;a<t.length;a++)this.ids[a]=a,this.coords[2*a]=e(t[a]),this.coords[2*a+1]=n(t[a]);r(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function c(t){return t[0]}function h(t){return t[1]}n.r(e),n.d(e,"default",(function(){return s})),l.prototype={range:function(t,e,n,r){return function(t,e,n,r,i,o,a){for(var s,l,c=[0,t.length-1,0],h=[];c.length;){var u=c.pop(),f=c.pop(),p=c.pop();if(f-p<=a)for(var d=p;d<=f;d++)s=e[2*d],l=e[2*d+1],s>=n&&s<=i&&l>=r&&l<=o&&h.push(t[d]);else{var g=Math.floor((p+f)/2);s=e[2*g],l=e[2*g+1],s>=n&&s<=i&&l>=r&&l<=o&&h.push(t[g]);var v=(u+1)%2;(0===u?n<=s:r<=l)&&(c.push(p),c.push(g-1),c.push(v)),(0===u?i>=s:o>=l)&&(c.push(g+1),c.push(f),c.push(v))}}return h}(this.ids,this.coords,t,e,n,r,this.nodeSize)},within:function(t,e,n){return function(t,e,n,r,i,o){for(var s=[0,t.length-1,0],l=[],c=i*i;s.length;){var h=s.pop(),u=s.pop(),f=s.pop();if(u-f<=o)for(var p=f;p<=u;p++)a(e[2*p],e[2*p+1],n,r)<=c&&l.push(t[p]);else{var d=Math.floor((f+u)/2),g=e[2*d],v=e[2*d+1];a(g,v,n,r)<=c&&l.push(t[d]);var m=(h+1)%2;(0===h?n-i<=g:r-i<=v)&&(s.push(f),s.push(d-1),s.push(m)),(0===h?n+i>=g:r+i>=v)&&(s.push(d+1),s.push(u),s.push(m))}}return l}(this.ids,this.coords,t,e,n,this.nodeSize)}}},120:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r={};n.r(r),n.d(r,"combinePathItems",(function(){return o})),n.d(r,"measure",(function(){return i.measure}));var i=n(24);function o(t){let e=void 0;for(const n of t){const t=n.model;if(void 0===e)e=t;else if("intersect"===n.combineMode)e=i.model.combineIntersection(e,t);else if("subtract"===n.combineMode)e=i.model.combine(e,t,!1,!0,!0,!1);else if("unite"===n.combineMode)e=i.model.combineUnion(e,t);else if("exclude"===n.combineMode){const n=i.model.combineUnion(e,t),r=i.model.combineIntersection(e,t);e=i.model.combineSubtraction(n,r)}else{if("continue"!==n.combineMode)throw new Error(`unknown combine model :${n.combineMode}`);e={models:{a:e,b:t}}}}return e}const a=r},121:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(146),i=n.n(r);function o(t){const e=document.createElement("button"),n=new i.a(e,{text:function(){return t}});e.click(),n.destroy()}},129:function(t,e,n){"use strict";n.r(e),n.d(e,"getExportTypes",(function(){return r.e})),n.d(e,"exportImageUrl",(function(){return r.a})),n.d(e,"getExportFileName",(function(){return r.d})),n.d(e,"layerToZip",(function(){return r.g})),n.d(e,"layerToBlob",(function(){return r.f})),n.d(e,"exportLayerWithExporter",(function(){return r.b})),n.d(e,"exportSvgWithExporter",(function(){return r.c})),n.d(e,"optimizeSvg",(function(){return i.optimizeSvg})),n.d(e,"optimizeJpg",(function(){return i.optimizeJpg})),n.d(e,"optimizePng",(function(){return i.optimizePng})),n.d(e,"layerToCanvas",(function(){return o.a})),n.d(e,"bestLayerByCoords",(function(){return a.a})),n.d(e,"doesFolderContainLayer",(function(){return a.b})),n.d(e,"compositeLayerFromLayers",(function(){return s.a})),n.d(e,"getOrCompositeLayers",(function(){return s.b})),n.d(e,"getLayerIcon",(function(){return c}));var r=n(64),i=n(28),o=n(57),a=n(47),s=n(48),l=n(21);function c(t){switch(t.layerType){case l.a.text:return"fa-font";case l.a.folder:case l.a.folderVector:return"fa-folder";case l.a.pixel:return"fa-file-image";case l.a.path:return"fa-vector-square"}}},138:function(t,e){},139:function(t,e){},140:function(t,e){},141:function(t,e,n){var r=n(142),i=n(143),o=n(144);function a(t){var e=(t.xMax||0)-(t.xMin||0);return t.advanceWidth-t.leftSideBearing-e}function s(t,e){var n="\t"===e;return t.charToGlyph(n?" ":e)}function l(t,e){return t.advanceWidth}function c(t){return t.path}t.exports=function(t,e,n){if(!t)throw new TypeError("Must specify a font from Opentype.js");e=e||"";for(var h=r((n=n||{}).align,"left"),u=r(n.letterSpacing,0),f=r(n.width,1/0),p=(r(n.breakWord,!1),o({},n,{measure:function(e,n,i,o){return function(t,e,n,i,o,h){n=Math.max(0,r(n,0)),i=Math.min(r(i,e.length),e.length),o=r(o,1/0),h=r(h,0);for(var u=0,f=0,p=0,d=n;d<i;d++){var g=e.charAt(d),v=s(t,g);c(v);var m=0;if(d<i-1){var y=s(t,e.charAt(d+1));m+=t.getKerningValue(v,y)}var b=v.xMax||0,x=v.xMin||0,w=b-x,S=a(v),C=u+v.leftSideBearing+w+S;if(C>o)break;u+=h+l(v,g)+m,p=C,f++}return{start:n,end:n+f,width:p}}(t,e,n,i,o,u)}})),d=i.lines(e,p),g=d.reduce((function(t,e){return Math.max(t,e.width)}),0),v=Math.abs(t.ascender-t.descender),m=r(n.lineHeight,1.175*t.unitsPerEm),y=m-v,b=0,x=-t.ascender-y/2,w=(v+y)*d.length,S=isFinite(f)?f:g,C=[],T=null,_=0;_<d.length;_++){for(var O=d[_],k=O.start,P=_===d.length-1?O.end-1:O.end,E=O.width,M=k,A=0;M<=P;M++,A++){var L=e.charAt(M),D=s(t,L);M===k&&"right"===h&&(b-=D.leftSideBearing),T&&(b+=t.getKerningValue(D,T)||0);var I=0;"center"===h?I=(S-E)/2:"right"===h&&(I=S-E),C.push({char:L,position:[b+I,x],data:D,index:M,column:A,row:_}),b+=u+l(D,L),T=D}x-=m,b=0}var R=0;"center"===h?R=(S-g)/2:"right"===h&&(R=S-g);var j=Math.max(0,S-g-R);return{glyphs:C,baseline:y/2+Math.abs(t.descender),leading:y,lines:d,lineHeight:m,left:R,right:j,maxLineWidth:g,width:S,height:w}}},142:function(t,e){t.exports=function(){for(var t=0;t<arguments.length;t++)if(void 0!==arguments[t])return arguments[t]}},143:function(t,e){var n=/\n/,r=/\s/,i=!1;function o(t,e,n,r){var i=t.indexOf(e,n);return-1===i||i>r?r:i}function a(t){return r.test(t)}function s(t,e,n,r){return{start:e,end:e+Math.min(r,n-e)}}t.exports=function(e,n){return t.exports.lines(e,n).map((function(t){return e.substring(t.start,t.end)})).join("\n")},t.exports.lines=function(t,e){if(0===(e=e||{}).width&&"nowrap"!==e.mode)return[];t=t||"";var r="number"==typeof e.width?e.width:Number.MAX_VALUE,l=Math.max(0,e.start||0),c="number"==typeof e.end?e.end:t.length,h=e.mode;i=e.breakWords||!1;var u=e.measure||s;return"pre"===h?function(t,e,r,i,o){for(var a=[],s=r,l=r;l<i&&l<e.length;l++){var c=e.charAt(l),h=n.test(c);if(h||l===i-1){var u=t(e,s,h?l:l+1,o);a.push(u),s=l+1}}return a}(u,t,l,c,r):function(t,e,n,r,s,l){var c=[],h=s;"nowrap"===l&&(h=Number.MAX_VALUE);for(;n<r&&n<e.length;){for(var u=o(e,"\n",n,r);n<u&&a(e.charAt(n));)n++;var f=t(e,n,u,h),p=n+(f.end-f.start),d=p+"\n".length;if(p<u&&!i){for(;p>n&&!a(e.charAt(p));)p--;if(p===n)d>n+"\n".length&&d--,p=d-"\n".length;else for(d=p;p>n&&a(e.charAt(p-"\n".length));)p--}if(p>=n){var g=t(e,n,p,h);c.push(g)}n=d}return c}(u,t,l,c,r,h)}},144:function(t,e,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function a(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,s,l=a(t),c=1;c<arguments.length;c++){for(var h in n=Object(arguments[c]))i.call(n,h)&&(l[h]=n[h]);if(r){s=r(n);for(var u=0;u<s.length;u++)o.call(n,s[u])&&(l[s[u]]=n[s[u]])}}return l}},145:function(t,e,n){(function(n){var r,i,o;i=[],void 0===(o="function"==typeof(r=function(){"use strict";function e(t,e,n){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="blob",r.onload=function(){a(r.response,e,n)},r.onerror=function(){console.error("could not download file")},r.send()}function r(t){var e=new XMLHttpRequest;return e.open("HEAD",t,!1),e.send(),200<=e.status&&299>=e.status}function i(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var o="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n&&n.global===n?n:void 0,a=o.saveAs||("object"!=typeof window||window!==o?function(){}:"download"in HTMLAnchorElement.prototype?function(t,n,a){var s=o.URL||o.webkitURL,l=document.createElement("a");n=n||t.name||"download",l.download=n,l.rel="noopener","string"==typeof t?(l.href=t,l.origin===location.origin?i(l):r(l.href)?e(t,n,a):i(l,l.target="_blank")):(l.href=s.createObjectURL(t),setTimeout((function(){s.revokeObjectURL(l.href)}),4e4),setTimeout((function(){i(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,n,o){if(n=n||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,o),n);else if(r(t))e(t,n,o);else{var a=document.createElement("a");a.href=t,a.target="_blank",setTimeout((function(){i(a)}))}}:function(t,n,r,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof t)return e(t,n,r);var a="application/octet-stream"===t.type,s=/constructor/i.test(o.HTMLElement)||o.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||a&&s)&&"object"==typeof FileReader){var c=new FileReader;c.onloadend=function(){var t=c.result;t=l?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=t:location=t,i=null},c.readAsDataURL(t)}else{var h=o.URL||o.webkitURL,u=h.createObjectURL(t);i?i.location=u:location.href=u,i=null,setTimeout((function(){h.revokeObjectURL(u)}),4e4)}});o.saveAs=a.saveAs=a,t.exports=a})?r.apply(e,i):r)||(t.exports=o)}).call(this,n(6))},146:function(t,e,n){
/*!
 * clipboard.js v2.0.4
 * https://zenorocha.github.io/clipboard.js
 * 
 * Licensed MIT © Zeno Rocha
 */
var r;r=function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=l(n(1)),a=l(n(3)),s=l(n(4));function l(t){return t&&t.__esModule?t:{default:t}}var c=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.resolveOptions(n),r.listenClick(t),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),i(e,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof t.action?t.action:this.defaultAction,this.target="function"==typeof t.target?t.target:this.defaultTarget,this.text="function"==typeof t.text?t.text:this.defaultText,this.container="object"===r(t.container)?t.container:document.body}},{key:"listenClick",value:function(t){var e=this;this.listener=(0,s.default)(t,"click",(function(t){return e.onClick(t)}))}},{key:"onClick",value:function(t){var e=t.delegateTarget||t.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new o.default({action:this.action(e),target:this.target(e),text:this.text(e),container:this.container,trigger:e,emitter:this})}},{key:"defaultAction",value:function(t){return h("action",t)}},{key:"defaultTarget",value:function(t){var e=h("target",t);if(e)return document.querySelector(e)}},{key:"defaultText",value:function(t){return h("text",t)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],e="string"==typeof t?[t]:t,n=!!document.queryCommandSupported;return e.forEach((function(t){n=n&&!!document.queryCommandSupported(t)})),n}}]),e}(a.default);function h(t,e){var n="data-clipboard-"+t;if(e.hasAttribute(n))return e.getAttribute(n)}t.exports=c},function(t,e,n){"use strict";var r,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(2),s=(r=a)&&r.__esModule?r:{default:r},l=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.resolveOptions(e),this.initSelection()}return o(t,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=t.action,this.container=t.container,this.emitter=t.emitter,this.target=t.target,this.text=t.text,this.trigger=t.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var t=this,e="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return t.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[e?"right":"left"]="-9999px";var n=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=n+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,s.default)(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,s.default)(this.target),this.copyText()}},{key:"copyText",value:function(){var t=void 0;try{t=document.execCommand(this.action)}catch(e){t=!1}this.handleResult(t)}},{key:"handleResult",value:function(t){this.emitter.emit(t?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=t,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(t){if(void 0!==t){if(!t||"object"!==(void 0===t?"undefined":i(t))||1!==t.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(t.hasAttribute("readonly")||t.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=t}},get:function(){return this._target}}]),t}();t.exports=l},function(t,e){t.exports=function(t){var e;if("SELECT"===t.nodeName)t.focus(),e=t.value;else if("INPUT"===t.nodeName||"TEXTAREA"===t.nodeName){var n=t.hasAttribute("readonly");n||t.setAttribute("readonly",""),t.select(),t.setSelectionRange(0,t.value.length),n||t.removeAttribute("readonly"),e=t.value}else{t.hasAttribute("contenteditable")&&t.focus();var r=window.getSelection(),i=document.createRange();i.selectNodeContents(t),r.removeAllRanges(),r.addRange(i),e=r.toString()}return e}},function(t,e){function n(){}n.prototype={on:function(t,e,n){var r=this.e||(this.e={});return(r[t]||(r[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){var r=this;function i(){r.off(t,i),e.apply(n,arguments)}return i._=e,this.on(t,i,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),r=0,i=n.length;r<i;r++)n[r].fn.apply(n[r].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),r=n[t],i=[];if(r&&e)for(var o=0,a=r.length;o<a;o++)r[o].fn!==e&&r[o].fn._!==e&&i.push(r[o]);return i.length?n[t]=i:delete n[t],this}},t.exports=n},function(t,e,n){var r=n(5),i=n(6);t.exports=function(t,e,n){if(!t&&!e&&!n)throw new Error("Missing required arguments");if(!r.string(e))throw new TypeError("Second argument must be a String");if(!r.fn(n))throw new TypeError("Third argument must be a Function");if(r.node(t))return function(t,e,n){return t.addEventListener(e,n),{destroy:function(){t.removeEventListener(e,n)}}}(t,e,n);if(r.nodeList(t))return function(t,e,n){return Array.prototype.forEach.call(t,(function(t){t.addEventListener(e,n)})),{destroy:function(){Array.prototype.forEach.call(t,(function(t){t.removeEventListener(e,n)}))}}}(t,e,n);if(r.string(t))return function(t,e,n){return i(document.body,t,e,n)}(t,e,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}},function(t,e){e.node=function(t){return void 0!==t&&t instanceof HTMLElement&&1===t.nodeType},e.nodeList=function(t){var n=Object.prototype.toString.call(t);return void 0!==t&&("[object NodeList]"===n||"[object HTMLCollection]"===n)&&"length"in t&&(0===t.length||e.node(t[0]))},e.string=function(t){return"string"==typeof t||t instanceof String},e.fn=function(t){return"[object Function]"===Object.prototype.toString.call(t)}},function(t,e,n){var r=n(7);function i(t,e,n,r,i){var a=o.apply(this,arguments);return t.addEventListener(n,a,i),{destroy:function(){t.removeEventListener(n,a,i)}}}function o(t,e,n,i){return function(n){n.delegateTarget=r(n.target,e),n.delegateTarget&&i.call(t,n)}}t.exports=function(t,e,n,r,o){return"function"==typeof t.addEventListener?i.apply(null,arguments):"function"==typeof n?i.bind(null,document).apply(null,arguments):("string"==typeof t&&(t=document.querySelectorAll(t)),Array.prototype.map.call(t,(function(t){return i(t,e,n,r,o)})))}},function(t,e){if("undefined"!=typeof Element&&!Element.prototype.matches){var n=Element.prototype;n.matches=n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector}t.exports=function(t,e){for(;t&&9!==t.nodeType;){if("function"==typeof t.matches&&t.matches(e))return t;t=t.parentNode}}}])},t.exports=r()},147:function(t,e,n){"use strict";var r=r||{};r.toast=function(){const t={SHOW:{"-webkit-transition":"opacity 400ms, -webkit-transform 400ms",transition:"opacity 400ms, transform 400ms",opacity:"1","-webkit-transform":"translateY(-100%) translateZ(0)",transform:"translateY(-100%) translateZ(0)"},HIDE:{opacity:"0","-webkit-transform":"translateY(150%) translateZ(0)",transform:"translateY(150%) translateZ(0)"}};function e(n,i,o){if(null!==r())e.prototype.toastQueue.push({text:n,options:i,transitions:o});else{e.prototype.Transitions=o||t;var a=i||{};a=e.prototype.mergeOptions(e.prototype.DEFAULT_SETTINGS,a),e.prototype.show(n,a),a=null}}var n=null;function r(){return n}function i(t){n=t}return e.prototype.DEFAULT_SETTINGS={style:{main:{background:"rgba(0, 0, 0, .85)","box-shadow":"0 0 10px rgba(0, 0, 0, .8)","border-radius":"3px","z-index":"99999",color:"rgba(255, 255, 255, .9)",padding:"10px 15px","max-width":"60%",width:"100%","word-break":"keep-all",margin:"0 auto","text-align":"center",position:"fixed",left:"0",right:"0",bottom:"0","-webkit-transform":"translateY(150%) translateZ(0)",transform:"translateY(150%) translateZ(0)","-webkit-filter":"blur(0)",opacity:"0"}},settings:{duration:1500}},e.prototype.Transitions={},e.prototype.toastQueue=[],e.prototype.timeout=null,e.prototype.mergeOptions=function(t,n){var r=n;for(var i in t)r.hasOwnProperty(i)?null!==t[i]&&t[i].constructor===Object&&(r[i]=e.prototype.mergeOptions(t[i],r[i])):r[i]=t[i];return r},e.prototype.generate=function(t,n){var o=document.createElement("div");"string"==typeof t&&(t=document.createTextNode(t)),o.appendChild(t),i(o),o=null,e.prototype.stylize(r(),n)},e.prototype.stylize=function(t,e){Object.keys(e).forEach((function(n){t.style[n]=e[n]}))},e.prototype.show=function(t,n){this.generate(t,n.style.main);var i=r();document.body.insertBefore(i,document.body.firstChild),i.offsetHeight,e.prototype.stylize(i,e.prototype.Transitions.SHOW),i=null,clearTimeout(e.prototype.timeout),e.prototype.timeout=setTimeout(e.prototype.hide,n.settings.duration)},e.prototype.hide=function(){var t=r();e.prototype.stylize(t,e.prototype.Transitions.HIDE),clearTimeout(e.prototype.timeout),t.addEventListener("transitionend",e.prototype.animationListener),t=null},e.prototype.animationListener=function(){r().removeEventListener("transitionend",e.prototype.animationListener),e.prototype.destroy.call(this)},e.prototype.destroy=function(){var t=r();if(document.body.removeChild(t),t=null,i(null),e.prototype.toastQueue.length>0){var n=e.prototype.toastQueue.shift();e(n.text,n.options,n.transitions),n=null}},{Toast:e}}(),t.exports=r.toast},16:function(t,e,n){(function(t){var r,i,o,a,s,l,c,h,u,f,p,d=d||{version:"4.3.0"};if(e.fabric=d,"undefined"!=typeof document&&"undefined"!=typeof window)document instanceof("undefined"!=typeof HTMLDocument?HTMLDocument:Document)?d.document=document:d.document=document.implementation.createHTMLDocument(""),d.window=window;else{var g=new(n(138).JSDOM)(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;d.document=g.document,d.jsdomImplForWrapper=n(139).implForWrapper,d.nodeCanvas=n(140).Canvas,d.window=g,DOMParser=d.window.DOMParser}if(d.isTouchSupported="ontouchstart"in d.window||"ontouchstart"in d.document||d.window&&d.window.navigator&&0<d.window.navigator.maxTouchPoints,d.isLikelyNode=void 0!==t&&"undefined"==typeof window,d.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],d.DPI=96,d.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",d.commaWsp="(?:\\s+,?\\s*|,\\s*)",d.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,d.reNonWord=/[ \n\.,;!\?\-]/,d.fontPaths={},d.iMatrix=[1,0,0,1,0,0],d.svgNS="http://www.w3.org/2000/svg",d.perfLimitSizeTotal=2097152,d.maxCacheSideLimit=4096,d.minCacheSideLimit=256,d.charWidthsCache={},d.textureSize=2048,d.disableStyleCopyPaste=!1,d.enableGLFiltering=!0,d.devicePixelRatio=d.window.devicePixelRatio||d.window.webkitDevicePixelRatio||d.window.mozDevicePixelRatio||1,d.browserShadowBlurConstant=1,d.arcToSegmentsCache={},d.boundsOfCurveCache={},d.cachesBoundsOfCurve=!0,d.forceGLPutImageData=!1,d.initFilterBackend=function(){return d.enableGLFiltering&&d.isWebglSupported&&d.isWebglSupported(d.textureSize)?(console.log("max texture size: "+d.maxTextureSize),new d.WebglFilterBackend({tileSize:d.textureSize})):d.Canvas2dFilterBackend?new d.Canvas2dFilterBackend:void 0},"undefined"!=typeof document&&"undefined"!=typeof window&&(window.fabric=d),void 0===v)var v={};if(function(t){"use strict";t.modifyEventListener=!1,t.modifySelectors=!1,t.configure=function(e){isFinite(e.modifyEventListener)&&(t.modifyEventListener=e.modifyEventListener),isFinite(e.modifySelectors)&&(t.modifySelectors=e.modifySelectors),!1===p&&t.modifyEventListener&&d(),!1===g&&t.modifySelectors&&m()},t.add=function(t,e,r,i){return n(t,e,r,i,"add")},t.remove=function(t,e,r,i){return n(t,e,r,i,"remove")},t.returnFalse=function(t){return!1},t.stop=function(t){t&&(t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,t.cancelBubbleCount=0)},t.prevent=function(t){t&&(t.preventDefault?t.preventDefault():t.preventManipulation?t.preventManipulation():t.returnValue=!1)},t.cancel=function(e){t.stop(e),t.prevent(e)},t.blur=function(){var t=document.activeElement;if(t){var e=document.activeElement.nodeName;"INPUT"!==e&&"TEXTAREA"!==e&&"true"!==t.contentEditable||t.blur&&t.blur()}},t.getEventSupport=function(t,e){if("string"==typeof t&&(e=t,t=window),(e="on"+e)in t)return!0;if(t.setAttribute||(t=document.createElement("div")),t.setAttribute&&t.removeAttribute){t.setAttribute(e,"");var n="function"==typeof t[e];return void 0!==t[e]&&(t[e]=null),t.removeAttribute(e),n}};var e=function(t){if(!t||"object"!=typeof t)return t;var n=new t.constructor;for(var r in t)t[r]&&"object"==typeof t[r]?n[r]=e(t[r]):n[r]=t[r];return n},n=function(o,a,c,p,d,g){if(p=p||{},"[object Object]"===String(o)){var m=o;if(o=m.target,delete m.target,!m.type||!m.listener){for(var y in m){var b=m[y];"function"!=typeof b&&(p[y]=b)}var x={};for(var w in m){y=w.split(",");var S=m[w],C={};for(var T in p)C[T]=p[T];if("function"==typeof S)c=S;else{if("function"!=typeof S.listener)continue;for(var T in c=S.listener,S)"function"!=typeof S[T]&&(C[T]=S[T])}for(var _=0;_<y.length;_++)x[w]=v.add(o,y[_],c,C,d)}return x}for(var w in a=m.type,delete m.type,c=m.listener,delete m.listener,m)p[w]=m[w]}if(o&&a&&c){if("string"==typeof o&&"ready"===a){if(!window.eventjs_stallOnReady){var O=(new Date).getTime(),k=p.timeout,P=p.interval||1e3/60,E=window.setInterval((function(){(new Date).getTime()-O>k&&window.clearInterval(E),document.querySelector(o)&&(window.clearInterval(E),setTimeout(c,1))}),P);return}a="load",o=window}if("string"==typeof o){if(0===(o=document.querySelectorAll(o)).length)return i("Missing target on listener!",arguments);1===o.length&&(o=o[0])}var M,A={};if(0<o.length&&o!==window){for(var L=0,D=o.length;L<D;L++)(M=n(o[L],a,c,e(p),d))&&(A[L]=M);return r(A)}if("string"==typeof a&&(-1!==(a=a.toLowerCase()).indexOf(" ")?a=a.split(" "):-1!==a.indexOf(",")&&(a=a.split(","))),"string"!=typeof a){if("number"==typeof a.length)for(var I=0,R=a.length;I<R;I++)(M=n(o,a[I],c,e(p),d))&&(A[a[I]]=M);else for(var w in a)(M="function"==typeof a[w]?n(o,w,a[w],e(p),d):n(o,w,a[w].listener,e(a[w]),d))&&(A[w]=M);return r(A)}if(0===a.indexOf("on")&&(a=a.substr(2)),"object"!=typeof o)return i("Target is not defined!",arguments);if("function"!=typeof c)return i("Listener is not a function!",arguments);var j=p.useCapture||!1,B=h(o)+"."+h(c)+"."+(j?1:0);if(t.Gesture&&t.Gesture._gestureHandlers[a]){if(B=a+B,"remove"===d){if(!l[B])return;l[B].remove(),delete l[B]}else if("add"===d){if(l[B])return l[B].add(),l[B];if(p.useCall&&!t.modifyEventListener){var F=c;c=function(t,e){for(var n in e)t[n]=e[n];return F.call(o,t)}}p.gesture=a,p.target=o,p.listener=c,p.fromOverwrite=g,l[B]=t.proxy[a](p)}return l[B]}var U,z=s(a);for(_=0;_<z.length;_++)if(U=(a=z[_])+"."+B,"remove"===d){if(!l[U])continue;o[f](a,c,j),delete l[U]}else if("add"===d){if(l[U])return l[U];o[u](a,c,j),l[U]={id:U,type:a,target:o,listener:c,remove:function(){for(var e=0;e<z.length;e++)t.remove(o,z[e],c,p)}}}return l[U]}},r=function(t){return{remove:function(){for(var e in t)t[e].remove()},add:function(){for(var e in t)t[e].add()}}},i=function(t,e){"undefined"!=typeof console&&void 0!==console.error&&console.error(t,e)},o={msPointer:["MSPointerDown","MSPointerMove","MSPointerUp"],touch:["touchstart","touchmove","touchend"],mouse:["mousedown","mousemove","mouseup"]},a={MSPointerDown:0,MSPointerMove:1,MSPointerUp:2,touchstart:0,touchmove:1,touchend:2,mousedown:0,mousemove:1,mouseup:2},s=(t.supports={},window.navigator.msPointerEnabled&&(t.supports.msPointer=!0),t.getEventSupport("touchstart")&&(t.supports.touch=!0),t.getEventSupport("mousedown")&&(t.supports.mouse=!0),function(e){var n=document.addEventListener?"":"on",r=a[e];if(isFinite(r)){var i=[];for(var s in t.supports)i.push(n+o[s][r]);return i}return[n+e]}),l={},c=0,h=function(t){return t===window?"#window":t===document?"#document":(t.uniqueID||(t.uniqueID="e"+c++),t.uniqueID)},u=document.addEventListener?"addEventListener":"attachEvent",f=document.removeEventListener?"removeEventListener":"detachEvent",p=!(t.createPointerEvent=function(e,n,r){var i=n.gesture,o=n.target,a=e.changedTouches||t.proxy.getCoords(e);if(a.length){var s=a[0];n.pointers=r?[]:a,n.pageX=s.pageX,n.pageY=s.pageY,n.x=n.pageX,n.y=n.pageY}var l=document.createEvent("Event");for(var c in l.initEvent(i,!0,!0),l.originalEvent=e,n)"target"!==c&&(l[c]=n[c]);var h=l.type;t.Gesture&&t.Gesture._gestureHandlers[h]&&n.oldListener.call(o,l,n,!1)}),d=function(){if(window.HTMLElement){var e=function(e){var r=function(r){var i=r+"EventListener",o=e[i];e[i]=function(e,i,a){if(t.Gesture&&t.Gesture._gestureHandlers[e]){var l=a;"object"==typeof a?l.useCall=!0:l={useCall:!0,useCapture:a},n(this,e,i,l,r,!0)}else for(var c=s(e),h=0;h<c.length;h++)o.call(this,c[h],i,a)}};r("add"),r("remove")};navigator.userAgent.match(/Firefox/)?(e(HTMLDivElement.prototype),e(HTMLCanvasElement.prototype)):e(HTMLElement.prototype),e(document),e(window)}},g=!1,m=function(){var t=NodeList.prototype;t.removeEventListener=function(t,e,n){for(var r=0,i=this.length;r<i;r++)this[r].removeEventListener(t,e,n)},t.addEventListener=function(t,e,n){for(var r=0,i=this.length;r<i;r++)this[r].addEventListener(t,e,n)}}}(v),void 0===v&&(v={}),void 0===v.proxy&&(v.proxy={}),v.proxy=function(t){"use strict";t.pointerSetup=function(t,e){t.target=t.target||window,t.doc=t.target.ownerDocument||t.target,t.minFingers=t.minFingers||t.fingers||1,t.maxFingers=t.maxFingers||t.fingers||1/0,t.position=t.position||"relative",delete t.fingers,(e=e||{}).enabled=!0,e.gesture=t.gesture,e.target=t.target,e.env=t.env,v.modifyEventListener&&t.fromOverwrite&&(t.oldListener=t.listener,t.listener=v.createPointerEvent);var n=0,r=0===e.gesture.indexOf("pointer")&&v.modifyEventListener?"pointer":"mouse";return t.oldListener&&(e.oldListener=t.oldListener),e.listener=t.listener,e.proxy=function(n){e.defaultListener=t.listener,(t.listener=n)(t.event,e)},e.add=function(){!0!==e.enabled&&(t.onPointerDown&&v.add(t.target,r+"down",t.onPointerDown),t.onPointerMove&&v.add(t.doc,r+"move",t.onPointerMove),t.onPointerUp&&v.add(t.doc,r+"up",t.onPointerUp),e.enabled=!0)},e.remove=function(){!1!==e.enabled&&(t.onPointerDown&&v.remove(t.target,r+"down",t.onPointerDown),t.onPointerMove&&v.remove(t.doc,r+"move",t.onPointerMove),t.onPointerUp&&v.remove(t.doc,r+"up",t.onPointerUp),e.reset(),e.enabled=!1)},e.pause=function(e){!t.onPointerMove||e&&!e.move||v.remove(t.doc,r+"move",t.onPointerMove),!t.onPointerUp||e&&!e.up||v.remove(t.doc,r+"up",t.onPointerUp),n=t.fingers,t.fingers=0},e.resume=function(e){!t.onPointerMove||e&&!e.move||v.add(t.doc,r+"move",t.onPointerMove),!t.onPointerUp||e&&!e.up||v.add(t.doc,r+"up",t.onPointerUp),t.fingers=n},e.reset=function(){t.tracker={},t.fingers=0},e};var e=v.supports;v.isMouse=!!e.mouse,v.isMSPointer=!!e.touch,v.isTouch=!!e.msPointer,t.pointerStart=function(e,n,r){var i=(e.type||"mousedown").toUpperCase();0===i.indexOf("MOUSE")?(v.isMouse=!0,v.isTouch=!1,v.isMSPointer=!1):0===i.indexOf("TOUCH")?(v.isMouse=!1,v.isTouch=!0,v.isMSPointer=!1):0===i.indexOf("MSPOINTER")&&(v.isMouse=!1,v.isTouch=!1,v.isMSPointer=!0);var o=function(t,e){var n=r.bbox,i=s[e]={};switch(r.position){case"absolute":i.offsetX=0,i.offsetY=0;break;case"differenceFromLast":case"difference":i.offsetX=t.pageX,i.offsetY=t.pageY;break;case"move":i.offsetX=t.pageX-n.x1,i.offsetY=t.pageY-n.y1;break;default:i.offsetX=n.x1-n.scrollLeft,i.offsetY=n.y1-n.scrollTop}var o=t.pageX-i.offsetX,a=t.pageY-i.offsetY;i.rotation=0,i.scale=1,i.startTime=i.moveTime=(new Date).getTime(),i.move={x:o,y:a},i.start={x:o,y:a},r.fingers++};r.event=e,n.defaultListener&&(r.listener=n.defaultListener,delete n.defaultListener);for(var a=!r.fingers,s=r.tracker,l=e.changedTouches||t.getCoords(e),c=l.length,h=0;h<c;h++){var u=l[h],f=u.identifier||1/0;if(r.fingers){if(r.fingers>=r.maxFingers){var p=[];for(var f in r.tracker)p.push(f);return n.identifier=p.join(","),a}for(var d in s)if(s[d].up){delete s[d],o(u,f),r.cancel=!0;break}if(s[f])continue;o(u,f)}else s=r.tracker={},n.bbox=r.bbox=t.getBoundingBox(r.target),r.fingers=0,r.cancel=!1,o(u,f)}for(var f in p=[],r.tracker)p.push(f);return n.identifier=p.join(","),a},t.pointerEnd=function(t,e,n,r){for(var i=t.touches||[],o=i.length,a={},s=0;s<o;s++)a[(l=i[s].identifier)||1/0]=!0;for(var l in n.tracker){var c=n.tracker[l];a[l]||c.up||(r&&r({pageX:c.pageX,pageY:c.pageY,changedTouches:[{pageX:c.pageX,pageY:c.pageY,identifier:"Infinity"===l?1/0:l}]},"up"),c.up=!0,n.fingers--)}if(0!==n.fingers)return!1;var h=[];for(var l in n.gestureFingers=0,n.tracker)n.gestureFingers++,h.push(l);return e.identifier=h.join(","),!0},t.getCoords=function(e){return void 0!==e.pageX?t.getCoords=function(t){return Array({type:"mouse",x:t.pageX,y:t.pageY,pageX:t.pageX,pageY:t.pageY,identifier:t.pointerId||1/0})}:t.getCoords=function(t){var e=document.documentElement;return t=t||window.event,Array({type:"mouse",x:t.clientX+e.scrollLeft,y:t.clientY+e.scrollTop,pageX:t.clientX+e.scrollLeft,pageY:t.clientY+e.scrollTop,identifier:1/0})},t.getCoords(e)},t.getCoord=function(e){if("ontouchstart"in window){var n=0,r=0;t.getCoord=function(t){var e=t.changedTouches;return e&&e.length?{x:n=e[0].pageX,y:r=e[0].pageY}:{x:n,y:r}}}else void 0!==e.pageX&&void 0!==e.pageY?t.getCoord=function(t){return{x:t.pageX,y:t.pageY}}:t.getCoord=function(t){var e=document.documentElement;return{x:(t=t||window.event).clientX+e.scrollLeft,y:t.clientY+e.scrollTop}};return t.getCoord(e)};var n,r,i,o=function(t,e){var n=parseFloat(t.getPropertyValue(e),10);return isFinite(n)?n:0};return t.getBoundingBox=function(t){t!==window&&t!==document||(t=document.body);var e={},n=t.getBoundingClientRect();if(e.width=n.width,e.height=n.height,e.x1=n.left,e.y1=n.top,e.scaleX=n.width/t.offsetWidth||1,e.scaleY=n.height/t.offsetHeight||1,e.scrollLeft=0,e.scrollTop=0,!1==("border-box"===(c=window.getComputedStyle(t)).getPropertyValue("box-sizing"))){var r=o(c,"border-left-width"),i=o(c,"border-right-width"),a=o(c,"border-bottom-width"),s=o(c,"border-top-width");e.border=[r,i,s,a],e.x1+=r,e.y1+=s,e.width-=i+r,e.height-=a+s}e.x2=e.x1+e.width,e.y2=e.y1+e.height;for(var l="fixed"===(h=c.getPropertyValue("position"))?t:t.parentNode;null!==l&&l!==document.body&&void 0!==l.scrollTop;){var c,h;if("absolute"===(h=(c=window.getComputedStyle(l)).getPropertyValue("position")));else{if("fixed"===h){e.scrollTop-=l.parentNode.scrollTop,e.scrollLeft-=l.parentNode.scrollLeft;break}e.scrollLeft+=l.scrollLeft,e.scrollTop+=l.scrollTop}l=l.parentNode}return e.scrollBodyLeft=void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,e.scrollBodyTop=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop,e.scrollLeft-=e.scrollBodyLeft,e.scrollTop-=e.scrollBodyTop,e},i=-1!==(r=navigator.userAgent.toLowerCase()).indexOf("macintosh"),n=i&&-1!==r.indexOf("khtml")?{91:!0,93:!0}:i&&-1!==r.indexOf("firefox")?{224:!0}:{17:!0},(t.metaTrackerReset=function(){v.fnKey=t.fnKey=!1,v.metaKey=t.metaKey=!1,v.escKey=t.escKey=!1,v.ctrlKey=t.ctrlKey=!1,v.shiftKey=t.shiftKey=!1,v.altKey=t.altKey=!1})(),t.metaTracker=function(e){var r="keydown"===e.type;27===e.keyCode&&(v.escKey=t.escKey=r),n[e.keyCode]&&(v.metaKey=t.metaKey=r),v.ctrlKey=t.ctrlKey=e.ctrlKey,v.shiftKey=t.shiftKey=e.shiftKey,v.altKey=t.altKey=e.altKey},t}(v.proxy),void 0===v&&(v={}),v.MutationObserver=(r=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,i=!r&&function(){var t=document.createElement("p"),e=!1,n=function(){e=!0};if(t.addEventListener)t.addEventListener("DOMAttrModified",n,!1);else{if(!t.attachEvent)return!1;t.attachEvent("onDOMAttrModified",n)}return t.setAttribute("id","target"),e}(),function(t,e){r?new r((function(t){t.forEach((function(t){e.call(t.target,t.attributeName)}))})).observe(t,{subtree:!1,attributes:!0}):i?v.add(t,"DOMAttrModified",(function(n){e.call(t,n.attrName)})):"onpropertychange"in document.body&&v.add(t,"propertychange",(function(n){e.call(t,window.event.propertyName)}))}),void 0===v&&(v={}),void 0===v.proxy&&(v.proxy={}),v.proxy=function(t){"use strict";return t.click=function(e){e.gesture=e.gesture||"click",e.maxFingers=e.maxFingers||e.fingers||1,e.onPointerDown=function(r){t.pointerStart(r,n,e)&&v.add(e.target,"mouseup",e.onPointerUp)},e.onPointerUp=function(r){if(t.pointerEnd(r,n,e)){v.remove(e.target,"mouseup",e.onPointerUp);var i=(r.changedTouches||t.getCoords(r))[0],o=e.bbox,a=t.getBoundingBox(e.target),s=i.pageY-a.scrollBodyTop,l=i.pageX-a.scrollBodyLeft;if(l>o.x1&&s>o.y1&&l<o.x2&&s<o.y2&&o.scrollTop===a.scrollTop){for(var c in e.tracker)break;var h=e.tracker[c];n.x=h.start.x,n.y=h.start.y,e.listener(r,n)}}};var n=t.pointerSetup(e);return n.state="click",v.add(e.target,"mousedown",e.onPointerDown),n},v.Gesture=v.Gesture||{},v.Gesture._gestureHandlers=v.Gesture._gestureHandlers||{},v.Gesture._gestureHandlers.click=t.click,t}(v.proxy),void 0===v&&(v={}),void 0===v.proxy&&(v.proxy={}),v.proxy=function(t){"use strict";return t.dbltap=t.dblclick=function(e){var n,r,i,o,a;e.gesture=e.gesture||"dbltap",e.maxFingers=e.maxFingers||e.fingers||1,e.onPointerDown=function(l){var c=l.changedTouches||t.getCoords(l);n&&!r?(a=c[0],r=(new Date).getTime()-n):(o=c[0],n=(new Date).getTime(),r=0,clearTimeout(i),i=setTimeout((function(){n=0}),700)),t.pointerStart(l,s,e)&&(v.add(e.target,"mousemove",e.onPointerMove).listener(l),v.add(e.target,"mouseup",e.onPointerUp))},e.onPointerMove=function(s){if(n&&!r){var l=s.changedTouches||t.getCoords(s);a=l[0]}var c=e.bbox,h=a.pageX-c.x1,u=a.pageY-c.y1;0<h&&h<c.width&&0<u&&u<c.height&&Math.abs(a.pageX-o.pageX)<=25&&Math.abs(a.pageY-o.pageY)<=25||(v.remove(e.target,"mousemove",e.onPointerMove),clearTimeout(i),n=r=0)},e.onPointerUp=function(o){if(t.pointerEnd(o,s,e)&&(v.remove(e.target,"mousemove",e.onPointerMove),v.remove(e.target,"mouseup",e.onPointerUp)),n&&r){if(r<=700){for(var a in s.state=e.gesture,e.tracker)break;var l=e.tracker[a];s.x=l.start.x,s.y=l.start.y,e.listener(o,s)}clearTimeout(i),n=r=0}};var s=t.pointerSetup(e);return s.state="dblclick",v.add(e.target,"mousedown",e.onPointerDown),s},v.Gesture=v.Gesture||{},v.Gesture._gestureHandlers=v.Gesture._gestureHandlers||{},v.Gesture._gestureHandlers.dbltap=t.dbltap,v.Gesture._gestureHandlers.dblclick=t.dblclick,t}(v.proxy),void 0===v&&(v={}),void 0===v.proxy&&(v.proxy={}),v.proxy=function(t){"use strict";return t.dragElement=function(e,n){t.drag({event:n,target:e,position:"move",listener:function(t,n){e.style.left=n.x+"px",e.style.top=n.y+"px",v.prevent(t)}})},t.drag=function(e){e.gesture="drag",e.onPointerDown=function(r){t.pointerStart(r,n,e)&&(e.monitor||(v.add(e.doc,"mousemove",e.onPointerMove),v.add(e.doc,"mouseup",e.onPointerUp))),e.onPointerMove(r,"down")},e.onPointerMove=function(r,i){if(!e.tracker)return e.onPointerDown(r);e.bbox;for(var o=r.changedTouches||t.getCoords(r),a=o.length,s=0;s<a;s++){var l=o[s],c=l.identifier||1/0,h=e.tracker[c];h&&(h.pageX=l.pageX,h.pageY=l.pageY,n.state=i||"move",n.identifier=c,n.start=h.start,n.fingers=e.fingers,"differenceFromLast"===e.position?(n.x=h.pageX-h.offsetX,n.y=h.pageY-h.offsetY,h.offsetX=h.pageX,h.offsetY=h.pageY):(n.x=h.pageX-h.offsetX,n.y=h.pageY-h.offsetY),e.listener(r,n))}},e.onPointerUp=function(r){t.pointerEnd(r,n,e,e.onPointerMove)&&(e.monitor||(v.remove(e.doc,"mousemove",e.onPointerMove),v.remove(e.doc,"mouseup",e.onPointerUp)))};var n=t.pointerSetup(e);return e.event?e.onPointerDown(e.event):(v.add(e.target,"mousedown",e.onPointerDown),e.monitor&&(v.add(e.doc,"mousemove",e.onPointerMove),v.add(e.doc,"mouseup",e.onPointerUp))),n},v.Gesture=v.Gesture||{},v.Gesture._gestureHandlers=v.Gesture._gestureHandlers||{},v.Gesture._gestureHandlers.drag=t.drag,t}(v.proxy),void 0===v&&(v={}),void 0===v.proxy&&(v.proxy={}),v.proxy=function(t){"use strict";var e=Math.PI/180,n=function(t,e){var n=0,r=0,i=0;for(var o in e){var a=e[o];a.up||(n+=a.move.x,r+=a.move.y,i++)}return t.x=n/=i,t.y=r/=i,t};return t.gesture=function(r){r.gesture=r.gesture||"gesture",r.minFingers=r.minFingers||r.fingers||2,r.onPointerDown=function(e){var o=r.fingers;if(t.pointerStart(e,i,r)&&(v.add(r.doc,"mousemove",r.onPointerMove),v.add(r.doc,"mouseup",r.onPointerUp)),r.fingers===r.minFingers&&o!==r.fingers){i.fingers=r.minFingers,i.scale=1,i.rotation=0,i.state="start";var a="";for(var s in r.tracker)a+=s;i.identifier=parseInt(a),n(i,r.tracker),r.listener(e,i)}},r.onPointerMove=function(o,a){for(var s=r.bbox,l=r.tracker,c=(f=o.changedTouches||t.getCoords(o)).length,h=0;h<c;h++){var u=l[g=(v=f[h]).identifier||1/0];u&&(u.move.x=v.pageX-s.x1,u.move.y=v.pageY-s.y1)}if(!(r.fingers<r.minFingers)){var f=[],p=0,d=0;for(var g in n(i,l),l){var v;if(!(v=l[g]).up){var m=v.start;if(!m.distance){var y=m.x-i.x,b=m.y-i.y;m.distance=Math.sqrt(y*y+b*b),m.angle=Math.atan2(y,b)/e}y=v.move.x-i.x,b=v.move.y-i.y,p+=Math.sqrt(y*y+b*b)/m.distance;var x=Math.atan2(y,b)/e,w=(m.angle-x+360)%360-180;v.DEG2=v.DEG1,v.DEG1=0<w?w:-w,void 0!==v.DEG2&&(0<w?v.rotation+=v.DEG1-v.DEG2:v.rotation-=v.DEG1-v.DEG2,d+=v.rotation),f.push(v.move)}}i.touches=f,i.fingers=r.fingers,i.scale=p/r.fingers,i.rotation=d/r.fingers,i.state="change",r.listener(o,i)}},r.onPointerUp=function(e){var n=r.fingers;t.pointerEnd(e,i,r)&&(v.remove(r.doc,"mousemove",r.onPointerMove),v.remove(r.doc,"mouseup",r.onPointerUp)),n===r.minFingers&&r.fingers<r.minFingers&&(i.fingers=r.fingers,i.state="end",r.listener(e,i))};var i=t.pointerSetup(r);return v.add(r.target,"mousedown",r.onPointerDown),i},v.Gesture=v.Gesture||{},v.Gesture._gestureHandlers=v.Gesture._gestureHandlers||{},v.Gesture._gestureHandlers.gesture=t.gesture,t}(v.proxy),void 0===v&&(v={}),void 0===v.proxy&&(v.proxy={}),v.proxy=function(t){"use strict";return t.pointerdown=t.pointermove=t.pointerup=function(e){if(e.gesture=e.gesture||"pointer",!e.target.isPointerEmitter){var n=!0;e.onPointerDown=function(t){n=!1,r.gesture="pointerdown",e.listener(t,r)},e.onPointerMove=function(t){r.gesture="pointermove",e.listener(t,r,n)},e.onPointerUp=function(t){n=!0,r.gesture="pointerup",e.listener(t,r,!0)};var r=t.pointerSetup(e);return v.add(e.target,"mousedown",e.onPointerDown),v.add(e.target,"mousemove",e.onPointerMove),v.add(e.doc,"mouseup",e.onPointerUp),e.target.isPointerEmitter=!0,r}},v.Gesture=v.Gesture||{},v.Gesture._gestureHandlers=v.Gesture._gestureHandlers||{},v.Gesture._gestureHandlers.pointerdown=t.pointerdown,v.Gesture._gestureHandlers.pointermove=t.pointermove,v.Gesture._gestureHandlers.pointerup=t.pointerup,t}(v.proxy),void 0===v&&(v={}),void 0===v.proxy&&(v.proxy={}),v.proxy=function(t){"use strict";return t.shake=function(t){var e={gesture:"devicemotion",acceleration:{},accelerationIncludingGravity:{},target:t.target,listener:t.listener,remove:function(){window.removeEventListener("devicemotion",o,!1)}},n=(new Date).getTime(),r={x:0,y:0,z:0},i={x:{count:0,value:0},y:{count:0,value:0},z:{count:0,value:0}},o=function(o){var a=o.accelerationIncludingGravity;if(r.x=.8*r.x+(1-.8)*a.x,r.y=.8*r.y+(1-.8)*a.y,r.z=.8*r.z+(1-.8)*a.z,e.accelerationIncludingGravity=r,e.acceleration.x=a.x-r.x,e.acceleration.y=a.y-r.y,e.acceleration.z=a.z-r.z,"devicemotion"!==t.gesture)for(var s=(new Date).getTime(),l=0,c="xyz".length;l<c;l++){var h="xyz"[l],u=e.acceleration[h],f=i[h],p=Math.abs(u);if(!(s-n<1e3)&&4<p){var d=s*u/p,g=Math.abs(d+f.value);f.value&&g<200?(f.value=d,f.count++,3===f.count&&(t.listener(o,e),n=s,f.value=0,f.count=0)):(f.value=d,f.count=1)}}else t.listener(o,e)};if(window.addEventListener)return window.addEventListener("devicemotion",o,!1),e},v.Gesture=v.Gesture||{},v.Gesture._gestureHandlers=v.Gesture._gestureHandlers||{},v.Gesture._gestureHandlers.shake=t.shake,t}(v.proxy),void 0===v&&(v={}),void 0===v.proxy&&(v.proxy={}),v.proxy=function(t){"use strict";var e=Math.PI/180;return t.swipe=function(n){n.snap=n.snap||90,n.threshold=n.threshold||1,n.gesture=n.gesture||"swipe",n.onPointerDown=function(e){t.pointerStart(e,r,n)&&(v.add(n.doc,"mousemove",n.onPointerMove).listener(e),v.add(n.doc,"mouseup",n.onPointerUp))},n.onPointerMove=function(e){for(var r=e.changedTouches||t.getCoords(e),i=r.length,o=0;o<i;o++){var a=r[o],s=a.identifier||1/0,l=n.tracker[s];l&&(l.move.x=a.pageX,l.move.y=a.pageY,l.moveTime=(new Date).getTime())}},n.onPointerUp=function(i){if(t.pointerEnd(i,r,n)){var o,a;v.remove(n.doc,"mousemove",n.onPointerMove),v.remove(n.doc,"mouseup",n.onPointerUp);var s={x:0,y:0},l=0,c=0,h=0;for(var u in n.tracker){var f=n.tracker[u],p=f.move.x-f.start.x,d=f.move.y-f.start.y;l+=f.move.x,c+=f.move.y,s.x+=f.start.x,s.y+=f.start.y,h++;var g=Math.sqrt(p*p+d*d),m=f.moveTime-f.startTime,y=Math.atan2(p,d)/e+180,b=m?g/m:0;if(void 0===a)a=y,o=b;else{if(!(Math.abs(y-a)<=20))return;a=(a+y)/2,o=(o+b)/2}}var x=n.gestureFingers;n.minFingers<=x&&n.maxFingers>=x&&o>n.threshold&&(s.x/=h,s.y/=h,r.start=s,r.x=l/h,r.y=c/h,r.angle=-(((a/n.snap+.5>>0)*n.snap||360)-360),r.velocity=o,r.fingers=x,r.state="swipe",n.listener(i,r))}};var r=t.pointerSetup(n);return v.add(n.target,"mousedown",n.onPointerDown),r},v.Gesture=v.Gesture||{},v.Gesture._gestureHandlers=v.Gesture._gestureHandlers||{},v.Gesture._gestureHandlers.swipe=t.swipe,t}(v.proxy),void 0===v&&(v={}),void 0===v.proxy&&(v.proxy={}),v.proxy=function(t){"use strict";return t.longpress=function(e){return e.gesture="longpress",t.tap(e)},t.tap=function(e){var n,r;e.delay=e.delay||500,e.timeout=e.timeout||250,e.driftDeviance=e.driftDeviance||10,e.gesture=e.gesture||"tap",e.onPointerDown=function(o){if(t.pointerStart(o,i,e)){if(n=(new Date).getTime(),v.add(e.doc,"mousemove",e.onPointerMove).listener(o),v.add(e.doc,"mouseup",e.onPointerUp),"longpress"!==e.gesture)return;r=setTimeout((function(){if(!(o.cancelBubble&&1<++o.cancelBubbleCount)){var t=0;for(var n in e.tracker){var r=e.tracker[n];if(!0===r.end)return;if(e.cancel)return;t++}e.minFingers<=t&&e.maxFingers>=t&&(i.state="start",i.fingers=t,i.x=r.start.x,i.y=r.start.y,e.listener(o,i))}}),e.delay)}},e.onPointerMove=function(n){for(var r=e.bbox,i=n.changedTouches||t.getCoords(n),o=i.length,a=0;a<o;a++){var s=i[a],l=s.identifier||1/0,c=e.tracker[l];if(c){var h=s.pageX-r.x1,u=s.pageY-r.y1,f=h-c.start.x,p=u-c.start.y,d=Math.sqrt(f*f+p*p);if(!(0<h&&h<r.width&&0<u&&u<r.height&&d<=e.driftDeviance))return v.remove(e.doc,"mousemove",e.onPointerMove),void(e.cancel=!0)}}},e.onPointerUp=function(o){if(t.pointerEnd(o,i,e)){if(clearTimeout(r),v.remove(e.doc,"mousemove",e.onPointerMove),v.remove(e.doc,"mouseup",e.onPointerUp),o.cancelBubble&&1<++o.cancelBubbleCount)return;if("longpress"===e.gesture)return void("start"===i.state&&(i.state="end",e.listener(o,i)));if(e.cancel)return;if((new Date).getTime()-n>e.timeout)return;var a=e.gestureFingers;e.minFingers<=a&&e.maxFingers>=a&&(i.state="tap",i.fingers=e.gestureFingers,e.listener(o,i))}};var i=t.pointerSetup(e);return v.add(e.target,"mousedown",e.onPointerDown),i},v.Gesture=v.Gesture||{},v.Gesture._gestureHandlers=v.Gesture._gestureHandlers||{},v.Gesture._gestureHandlers.tap=t.tap,v.Gesture._gestureHandlers.longpress=t.longpress,t}(v.proxy),void 0===v&&(v={}),void 0===v.proxy&&(v.proxy={}),v.proxy=function(t){"use strict";return t.wheelPreventElasticBounce=function(t){t&&("string"==typeof t&&(t=document.querySelector(t)),v.add(t,"wheel",(function(t,e){e.preventElasticBounce(),v.stop(t)})))},t.wheel=function(t){var e,n=t.timeout||150,r=0,i={gesture:"wheel",state:"start",wheelDelta:0,target:t.target,listener:t.listener,preventElasticBounce:function(t){var e=this.target,n=e.scrollTop;(n+e.offsetHeight===e.scrollHeight&&this.wheelDelta<=0||0===n&&0<=this.wheelDelta)&&v.cancel(t),v.stop(t)},add:function(){t.target[a](l,o,!1)},remove:function(){t.target[s](l,o,!1)}},o=function(o){o=o||window.event,i.state=r++?"change":"start",i.wheelDelta=o.detail?-20*o.detail:o.wheelDelta,t.listener(o,i),clearTimeout(e),e=setTimeout((function(){r=0,i.state="end",i.wheelDelta=0,t.listener(o,i)}),n)},a=document.addEventListener?"addEventListener":"attachEvent",s=document.removeEventListener?"removeEventListener":"detachEvent",l=v.getEventSupport("mousewheel")?"mousewheel":"DOMMouseScroll";return t.target[a](l,o,!1),i},v.Gesture=v.Gesture||{},v.Gesture._gestureHandlers=v.Gesture._gestureHandlers||{},v.Gesture._gestureHandlers.wheel=t.wheel,t}(v.proxy),void 0===m)var m={};function y(t,e){var n=t.canvas,r=e.targetCanvas,i=r.getContext("2d");i.translate(0,r.height),i.scale(1,-1);var o=n.height-r.height;i.drawImage(n,0,o,r.width,r.height,0,0,r.width,r.height)}function b(t,e){var n=e.targetCanvas.getContext("2d"),r=e.destinationWidth,i=e.destinationHeight,o=r*i*4,a=new Uint8Array(this.imageBuffer,0,o),s=new Uint8ClampedArray(this.imageBuffer,0,o);t.readPixels(0,0,r,i,t.RGBA,t.UNSIGNED_BYTE,a);var l=new ImageData(s,r,i);n.putImageData(l,0,0)}void 0===m.proxy&&(m.proxy={}),m.proxy=function(t){"use strict";return t.orientation=function(t){var e={gesture:"orientationchange",previous:null,current:window.orientation,target:t.target,listener:t.listener,remove:function(){window.removeEventListener("orientationchange",n,!1)}},n=function(n){e.previous=e.current,e.current=window.orientation,null===e.previous||e.previous==e.current||t.listener(n,e)};return window.DeviceOrientationEvent&&window.addEventListener("orientationchange",n,!1),e},m.Gesture=m.Gesture||{},m.Gesture._gestureHandlers=m.Gesture._gestureHandlers||{},m.Gesture._gestureHandlers.orientation=t.orientation,t}(m.proxy),function(){function t(t,e){if(this.__eventListeners[t]){var n=this.__eventListeners[t];e?n[n.indexOf(e)]=!1:d.util.array.fill(n,!1)}}d.Observable={fire:function(t,e){if(!this.__eventListeners)return this;var n=this.__eventListeners[t];if(!n)return this;for(var r=0,i=n.length;r<i;r++)n[r]&&n[r].call(this,e||{});return this.__eventListeners[t]=n.filter((function(t){return!1!==t})),this},on:function(t,e){if(this.__eventListeners||(this.__eventListeners={}),1===arguments.length)for(var n in t)this.on(n,t[n]);else this.__eventListeners[t]||(this.__eventListeners[t]=[]),this.__eventListeners[t].push(e);return this},off:function(e,n){if(!this.__eventListeners)return this;if(0===arguments.length)for(e in this.__eventListeners)t.call(this,e);else if(1===arguments.length&&"object"==typeof e)for(var r in e)t.call(this,r,e[r]);else t.call(this,e,n);return this}}}(),d.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var t=0,e=arguments.length;t<e;t++)this._onObjectAdded(arguments[t]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(t,e,n){var r=this._objects;return n?r[e]=t:r.splice(e,0,t),this._onObjectAdded&&this._onObjectAdded(t),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var t,e=this._objects,n=!1,r=0,i=arguments.length;r<i;r++)-1!==(t=e.indexOf(arguments[r]))&&(n=!0,e.splice(t,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[r]));return this.renderOnAddRemove&&n&&this.requestRenderAll(),this},forEachObject:function(t,e){for(var n=this.getObjects(),r=0,i=n.length;r<i;r++)t.call(e,n[r],r,n);return this},getObjects:function(t){return void 0===t?this._objects.concat():this._objects.filter((function(e){return e.type===t}))},item:function(t){return this._objects[t]},isEmpty:function(){return 0===this._objects.length},size:function(){return this._objects.length},contains:function(t){return-1<this._objects.indexOf(t)},complexity:function(){return this._objects.reduce((function(t,e){return t+(e.complexity?e.complexity():0)}),0)}},d.CommonMethods={_setOptions:function(t){for(var e in t)this.set(e,t[e])},_initGradient:function(t,e){!t||!t.colorStops||t instanceof d.Gradient||this.set(e,new d.Gradient(t))},_initPattern:function(t,e,n){!t||!t.source||t instanceof d.Pattern?n&&n():this.set(e,new d.Pattern(t,n))},_setObject:function(t){for(var e in t)this._set(e,t[e])},set:function(t,e){return"object"==typeof t?this._setObject(t):this._set(t,e),this},_set:function(t,e){this[t]=e},toggle:function(t){var e=this.get(t);return"boolean"==typeof e&&this.set(t,!e),this},get:function(t){return this[t]}},l=e,c=Math.sqrt,h=Math.atan2,u=Math.pow,f=Math.PI/180,p=Math.PI/2,d.util={cos:function(t){if(0===t)return 1;switch(t<0&&(t=-t),t/p){case 1:case 3:return 0;case 2:return-1}return Math.cos(t)},sin:function(t){if(0===t)return 0;var e=1;switch(t<0&&(e=-1),t/p){case 1:return e;case 2:return 0;case 3:return-e}return Math.sin(t)},removeFromArray:function(t,e){var n=t.indexOf(e);return-1!==n&&t.splice(n,1),t},getRandomInt:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},degreesToRadians:function(t){return t*f},radiansToDegrees:function(t){return t/f},rotatePoint:function(t,e,n){t.subtractEquals(e);var r=d.util.rotateVector(t,n);return new d.Point(r.x,r.y).addEquals(e)},rotateVector:function(t,e){var n=d.util.sin(e),r=d.util.cos(e);return{x:t.x*r-t.y*n,y:t.x*n+t.y*r}},transformPoint:function(t,e,n){return n?new d.Point(e[0]*t.x+e[2]*t.y,e[1]*t.x+e[3]*t.y):new d.Point(e[0]*t.x+e[2]*t.y+e[4],e[1]*t.x+e[3]*t.y+e[5])},makeBoundingBoxFromPoints:function(t,e){if(e)for(var n=0;n<t.length;n++)t[n]=d.util.transformPoint(t[n],e);var r=[t[0].x,t[1].x,t[2].x,t[3].x],i=d.util.array.min(r),o=d.util.array.max(r)-i,a=[t[0].y,t[1].y,t[2].y,t[3].y],s=d.util.array.min(a);return{left:i,top:s,width:o,height:d.util.array.max(a)-s}},invertTransform:function(t){var e=1/(t[0]*t[3]-t[1]*t[2]),n=[e*t[3],-e*t[1],-e*t[2],e*t[0]],r=d.util.transformPoint({x:t[4],y:t[5]},n,!0);return n[4]=-r.x,n[5]=-r.y,n},toFixed:function(t,e){return parseFloat(Number(t).toFixed(e))},parseUnit:function(t,e){var n=/\D{0,2}$/.exec(t),r=parseFloat(t);switch(e||(e=d.Text.DEFAULT_SVG_FONT_SIZE),n[0]){case"mm":return r*d.DPI/25.4;case"cm":return r*d.DPI/2.54;case"in":return r*d.DPI;case"pt":return r*d.DPI/72;case"pc":return r*d.DPI/72*12;case"em":return r*e;default:return r}},falseFunction:function(){return!1},getKlass:function(t,e){return t=d.util.string.camelize(t.charAt(0).toUpperCase()+t.slice(1)),d.util.resolveNamespace(e)[t]},getSvgAttributes:function(t){var e=["instantiated_by_use","style","id","class"];switch(t){case"linearGradient":e=e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":e=e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":e=e.concat(["offset","stop-color","stop-opacity"])}return e},resolveNamespace:function(t){if(!t)return d;var e,n=t.split("."),r=n.length,i=l||d.window;for(e=0;e<r;++e)i=i[n[e]];return i},loadImage:function(t,e,n,r){if(t){var i=d.util.createImage(),o=function(){e&&e.call(n,i,!1),i=i.onload=i.onerror=null};i.onload=o,i.onerror=function(){d.log("Error loading "+i.src),e&&e.call(n,null,!0),i=i.onload=i.onerror=null},0!==t.indexOf("data")&&null!=r&&(i.crossOrigin=r),"data:image/svg"===t.substring(0,14)&&(i.onload=null,d.util.loadImageInDom(i,o)),i.src=t}else e&&e.call(n,t)},loadImageInDom:function(t,e){var n=d.document.createElement("div");n.style.width=n.style.height="1px",n.style.left=n.style.top="-100%",n.style.position="absolute",n.appendChild(t),d.document.querySelector("body").appendChild(n),t.onload=function(){e(),n.parentNode.removeChild(n),n=null}},enlivenObjects:function(t,e,n,r){var i=[],o=0,a=(t=t||[]).length;function s(){++o===a&&e&&e(i.filter((function(t){return t})))}a?t.forEach((function(t,e){t&&t.type?d.util.getKlass(t.type,n).fromObject(t,(function(n,o){o||(i[e]=n),r&&r(t,n,o),s()})):s()})):e&&e(i)},enlivenPatterns:function(t,e){function n(){++i===o&&e&&e(r)}var r=[],i=0,o=(t=t||[]).length;o?t.forEach((function(t,e){t&&t.source?new d.Pattern(t,(function(t){r[e]=t,n()})):(r[e]=t,n())})):e&&e(r)},groupSVGElements:function(t,e,n){var r;return t&&1===t.length?t[0]:(e&&(e.width&&e.height?e.centerPoint={x:e.width/2,y:e.height/2}:(delete e.width,delete e.height)),r=new d.Group(t,e),void 0!==n&&(r.sourcePath=n),r)},populateWithProperties:function(t,e,n){if(n&&"[object Array]"===Object.prototype.toString.call(n))for(var r=0,i=n.length;r<i;r++)n[r]in t&&(e[n[r]]=t[n[r]])},drawDashedLine:function(t,e,n,r,i,o){var a=r-e,s=i-n,l=c(a*a+s*s),u=h(s,a),f=o.length,p=0,d=!0;for(t.save(),t.translate(e,n),t.moveTo(0,0),t.rotate(u),e=0;e<l;)l<(e+=o[p++%f])&&(e=l),t[d?"lineTo":"moveTo"](e,0),d=!d;t.restore()},createCanvasElement:function(){return d.document.createElement("canvas")},copyCanvasElement:function(t){var e=d.util.createCanvasElement();return e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),e},toDataURL:function(t,e,n){return t.toDataURL("image/"+e,n)},createImage:function(){return d.document.createElement("img")},multiplyTransformMatrices:function(t,e,n){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],n?0:t[0]*e[4]+t[2]*e[5]+t[4],n?0:t[1]*e[4]+t[3]*e[5]+t[5]]},qrDecompose:function(t){var e=h(t[1],t[0]),n=u(t[0],2)+u(t[1],2),r=c(n),i=(t[0]*t[3]-t[2]*t[1])/r,o=h(t[0]*t[2]+t[1]*t[3],n);return{angle:e/f,scaleX:r,scaleY:i,skewX:o/f,skewY:0,translateX:t[4],translateY:t[5]}},calcRotateMatrix:function(t){if(!t.angle)return d.iMatrix.concat();var e=d.util.degreesToRadians(t.angle),n=d.util.cos(e),r=d.util.sin(e);return[n,r,-r,n,0,0]},calcDimensionsMatrix:function(t){var e=void 0===t.scaleX?1:t.scaleX,n=void 0===t.scaleY?1:t.scaleY,r=[t.flipX?-e:e,0,0,t.flipY?-n:n,0,0],i=d.util.multiplyTransformMatrices,o=d.util.degreesToRadians;return t.skewX&&(r=i(r,[1,0,Math.tan(o(t.skewX)),1],!0)),t.skewY&&(r=i(r,[1,Math.tan(o(t.skewY)),0,1],!0)),r},composeMatrix:function(t){var e=[1,0,0,1,t.translateX||0,t.translateY||0],n=d.util.multiplyTransformMatrices;return t.angle&&(e=n(e,d.util.calcRotateMatrix(t))),(1!==t.scaleX||1!==t.scaleY||t.skewX||t.skewY||t.flipX||t.flipY)&&(e=n(e,d.util.calcDimensionsMatrix(t))),e},resetObjectTransform:function(t){t.scaleX=1,t.scaleY=1,t.skewX=0,t.skewY=0,t.flipX=!1,t.flipY=!1,t.rotate(0)},saveObjectTransform:function(t){return{scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,angle:t.angle,left:t.left,flipX:t.flipX,flipY:t.flipY,top:t.top}},isTransparent:function(t,e,n,r){0<r&&(r<e?e-=r:e=0,r<n?n-=r:n=0);var i,o=!0,a=t.getImageData(e,n,2*r||1,2*r||1),s=a.data.length;for(i=3;i<s&&0!=(o=a.data[i]<=0);i+=4);return a=null,o},parsePreserveAspectRatioAttribute:function(t){var e,n="meet",r=t.split(" ");return r&&r.length&&("meet"!==(n=r.pop())&&"slice"!==n?(e=n,n="meet"):r.length&&(e=r.pop())),{meetOrSlice:n,alignX:"none"!==e?e.slice(1,4):"none",alignY:"none"!==e?e.slice(5,8):"none"}},clearFabricFontCache:function(t){(t=(t||"").toLowerCase())?d.charWidthsCache[t]&&delete d.charWidthsCache[t]:d.charWidthsCache={}},limitDimsByArea:function(t,e){var n=Math.sqrt(e*t),r=Math.floor(e/n);return{x:Math.floor(n),y:r}},capValue:function(t,e,n){return Math.max(t,Math.min(e,n))},findScaleToFit:function(t,e){return Math.min(e.width/t.width,e.height/t.height)},findScaleToCover:function(t,e){return Math.max(e.width/t.width,e.height/t.height)},matrixToSVG:function(t){return"matrix("+t.map((function(t){return d.util.toFixed(t,d.Object.NUM_FRACTION_DIGITS)})).join(" ")+")"},sizeAfterTransform:function(t,e,n){var r=t/2,i=e/2,o=[{x:-r,y:-i},{x:r,y:-i},{x:-r,y:i},{x:r,y:i}],a=d.util.calcDimensionsMatrix(n),s=d.util.makeBoundingBoxFromPoints(o,a);return{x:s.width,y:s.height}}},d.util.createAccessors=function(t){var e,n,r,i,o,a=t.prototype;for(e=a.stateProperties.length;e--;)i="set"+(r=(n=a.stateProperties[e]).charAt(0).toUpperCase()+n.slice(1)),a[o="get"+r]||(a[o]=new Function('return this.get("'+n+'")')),a[i]||(a[i]=new Function("value",'return this.set("'+n+'", value)'))},function(){var t=Array.prototype.join,e={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},n={m:"l",M:"L"};function r(t,e,n,r,o,a,s){var l=Math.PI,c=s*l/180,h=d.util.sin(c),u=d.util.cos(c),f=0,p=0,g=-u*t*.5-h*e*.5,v=-u*e*.5+h*t*.5,m=(n=Math.abs(n))*n,y=(r=Math.abs(r))*r,b=v*v,x=g*g,w=m*y-m*b-y*x,S=0;if(w<0){var C=Math.sqrt(1-w/(m*y));n*=C,r*=C}else S=(o===a?-1:1)*Math.sqrt(w/(m*b+y*x));var T=S*n*v/r,_=-S*r*g/n,O=u*T-h*_+.5*t,k=h*T+u*_+.5*e,P=i(1,0,(g-T)/n,(v-_)/r),E=i((g-T)/n,(v-_)/r,(-g-T)/n,(-v-_)/r);0===a&&0<E?E-=2*l:1===a&&E<0&&(E+=2*l);for(var M,A,L,D,I,R,j,B,F,U,z,G,N,H,X,W,Y,V=Math.ceil(Math.abs(E/l*2)),q=[],J=E/V,K=8/3*Math.sin(J/4)*Math.sin(J/4)/Math.sin(J/2),Z=P+J,$=0;$<V;$++)q[$]=(M=P,A=Z,L=u,D=h,I=n,R=r,j=O,B=k,F=K,U=f,z=p,G=d.util.cos(M),["C",U+F*(-L*I*(N=d.util.sin(M))-D*R*G),z+F*(-D*I*N+L*R*G),(W=L*I*(H=d.util.cos(A))-D*R*(X=d.util.sin(A))+j)+F*(L*I*X+D*R*H),(Y=D*I*H+L*R*X+B)+F*(D*I*X-L*R*H),W,Y]),f=q[$][5],p=q[$][6],P=Z,Z+=J;return q}function i(t,e,n,r){var i=Math.atan2(e,t),o=Math.atan2(r,n);return i<=o?o-i:2*Math.PI-(i-o)}function o(e,n,r,i,o,a,s,l){var c;if(d.cachesBoundsOfCurve&&(c=t.call(arguments),d.boundsOfCurveCache[c]))return d.boundsOfCurveCache[c];var h,u,f,p,g,v,m,y,b=Math.sqrt,x=Math.min,w=Math.max,S=Math.abs,C=[],T=[[],[]];u=6*e-12*r+6*o,h=-3*e+9*r-9*o+3*s,f=3*r-3*e;for(var _=0;_<2;++_)if(0<_&&(u=6*n-12*i+6*a,h=-3*n+9*i-9*a+3*l,f=3*i-3*n),S(h)<1e-12){if(S(u)<1e-12)continue;0<(p=-f/u)&&p<1&&C.push(p)}else(m=u*u-4*f*h)<0||(0<(g=(-u+(y=b(m)))/(2*h))&&g<1&&C.push(g),0<(v=(-u-y)/(2*h))&&v<1&&C.push(v));for(var O,k,P,E=C.length,M=E;E--;)O=(P=1-(p=C[E]))*P*P*e+3*P*P*p*r+3*P*p*p*o+p*p*p*s,T[0][E]=O,k=P*P*P*n+3*P*P*p*i+3*P*p*p*a+p*p*p*l,T[1][E]=k;T[0][M]=e,T[1][M]=n,T[0][M+1]=s,T[1][M+1]=l;var A=[{x:x.apply(null,T[0]),y:x.apply(null,T[1])},{x:w.apply(null,T[0]),y:w.apply(null,T[1])}];return d.cachesBoundsOfCurve&&(d.boundsOfCurveCache[c]=A),A}function a(t,e,n){for(var i=n[1],o=n[2],a=n[3],s=n[4],l=n[5],c=r(n[6]-t,n[7]-e,i,o,s,l,a),h=0,u=c.length;h<u;h++)c[h][1]+=t,c[h][2]+=e,c[h][3]+=t,c[h][4]+=e,c[h][5]+=t,c[h][6]+=e;return c}function s(t,e,n,r){return Math.sqrt((n-t)*(n-t)+(r-e)*(r-e))}function l(t,e,n,r,i,o,a,s){return function(l){var c,h,u,f,p=(f=l)*f*f,d=3*(u=l)*u*(1-u),g=3*(h=l)*(1-h)*(1-h),v=(1-(c=l))*(1-c)*(1-c);return{x:a*p+i*d+n*g+t*v,y:s*p+o*d+r*g+e*v}}}function c(t,e,n,r,i,o,a,s){return function(l){var c=1-l,h=3*c*c*(n-t)+6*c*l*(i-n)+3*l*l*(a-i),u=3*c*c*(r-e)+6*c*l*(o-r)+3*l*l*(s-o);return Math.atan2(u,h)}}function h(t,e,n,r,i,o){return function(a){var s,l,c,h=(c=a)*c,u=2*(l=a)*(1-l),f=(1-(s=a))*(1-s);return{x:i*h+n*u+t*f,y:o*h+r*u+e*f}}}function u(t,e,n,r,i,o){return function(a){var s=1-a,l=2*s*(n-t)+2*a*(i-n),c=2*s*(r-e)+2*a*(o-r);return Math.atan2(c,l)}}function f(t,e,n){var r,i,o={x:e,y:n},a=0;for(i=.01;i<=1;i+=.01)r=t(i),a+=s(o.x,o.y,r.x,r.y),o=r;return a}function p(t){for(var e,n,r,i,o=0,a=t.length,p=0,d=0,g=0,v=0,m=[],y=0;y<a;y++){switch(r={x:p,y:d,command:(e=t[y])[0]},e[0]){case"M":r.length=0,g=p=e[1],v=d=e[2];break;case"L":r.length=s(p,d,e[1],e[2]),p=e[1],d=e[2];break;case"C":n=l(p,d,e[1],e[2],e[3],e[4],e[5],e[6]),i=c(p,d,e[1],e[2],e[3],e[4],e[5],e[6]),r.iterator=n,r.angleFinder=i,r.length=f(n,p,d),p=e[5],d=e[6];break;case"Q":n=h(p,d,e[1],e[2],e[3],e[4]),i=u(p,d,e[1],e[2],e[3],e[4]),r.iterator=n,r.angleFinder=i,r.length=f(n,p,d),p=e[3],d=e[4];break;case"Z":case"z":r.destX=g,r.destY=v,r.length=s(p,d,g,v),p=g,d=v}o+=r.length,m.push(r)}return m.push({length:o,x:p,y:d}),m}d.util.parsePath=function(t){var r,i,o,a,s,l=[],c=[],h=d.rePathCommand,u="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",f="("+u+")"+d.commaWsp,p="([01])"+d.commaWsp+"?",g=new RegExp(f+"?"+f+"?"+f+p+p+f+"?("+u+")","g");if(!t||!t.match)return l;for(var v,m=0,y=(s=t.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi)).length;m<y;m++){a=(r=s[m]).slice(1).trim(),c.length=0;var b=r.charAt(0);if(v=[b],"a"===b.toLowerCase())for(var x;x=g.exec(a);)for(var w=1;w<x.length;w++)c.push(x[w]);else for(;o=h.exec(a);)c.push(o[0]);w=0;for(var S=c.length;w<S;w++)i=parseFloat(c[w]),isNaN(i)||v.push(i);var C=e[b.toLowerCase()],T=n[b]||b;if(v.length-1>C)for(var _=1,O=v.length;_<O;_+=C)l.push([b].concat(v.slice(_,_+C))),b=T;else l.push(v)}return l},d.util.makePathSimpler=function(t){var e,n,r,i,o,s,l=0,c=0,h=t.length,u=0,f=0,p=[];for(n=0;n<h;++n){switch(r=!1,(e=t[n].slice(0))[0]){case"l":e[0]="L",e[1]+=l,e[2]+=c;case"L":l=e[1],c=e[2];break;case"h":e[1]+=l;case"H":e[0]="L",e[2]=c,l=e[1];break;case"v":e[1]+=c;case"V":e[0]="L",c=e[1],e[1]=l,e[2]=c;break;case"m":e[0]="M",e[1]+=l,e[2]+=c;case"M":l=e[1],c=e[2],u=e[1],f=e[2];break;case"c":e[0]="C",e[1]+=l,e[2]+=c,e[3]+=l,e[4]+=c,e[5]+=l,e[6]+=c;case"C":o=e[3],s=e[4],l=e[5],c=e[6];break;case"s":e[0]="S",e[1]+=l,e[2]+=c,e[3]+=l,e[4]+=c;case"S":"C"===i?(o=2*l-o,s=2*c-s):(o=l,s=c),l=e[3],c=e[4],e[0]="C",e[5]=e[3],e[6]=e[4],e[3]=e[1],e[4]=e[2],e[1]=o,e[2]=s,o=e[3],s=e[4];break;case"q":e[0]="Q",e[1]+=l,e[2]+=c,e[3]+=l,e[4]+=c;case"Q":o=e[1],s=e[2],l=e[3],c=e[4];break;case"t":e[0]="T",e[1]+=l,e[2]+=c;case"T":"Q"===i?(o=2*l-o,s=2*c-s):(o=l,s=c),e[0]="Q",l=e[1],c=e[2],e[1]=o,e[2]=s,e[3]=l,e[4]=c;break;case"a":e[0]="A",e[6]+=l,e[7]+=c;case"A":r=!0,p=p.concat(a(l,c,e)),l=e[6],c=e[7];break;case"z":case"Z":l=u,c=f}r||p.push(e),i=e[0]}return p},d.util.getPathSegmentsInfo=p,d.util.fromArcToBeziers=a,d.util.fromArcToBeizers=a,d.util.getBoundsOfCurve=o,d.util.getPointOnPath=function(t,e,n){n||(n=p(t));for(var r=0;0<e-n[r].length&&r<n.length-2;)e-=n[r].length,r++;var i,o=n[r],a=e/o.length,l=o.command,c=t[r];switch(l){case"M":return{x:o.x,y:o.y,angle:0};case"Z":case"z":return(i=new d.Point(o.x,o.y).lerp(new d.Point(o.destX,o.destY),a)).angle=Math.atan2(o.destY-o.y,o.destX-o.x),i;case"L":return(i=new d.Point(o.x,o.y).lerp(new d.Point(c[1],c[2]),a)).angle=Math.atan2(c[2]-o.y,c[1]-o.x),i;case"C":case"Q":return function(t,e){for(var n,r,i,o=0,a=0,l=t.iterator,c={x:t.x,y:t.y},h=.01,u=t.angleFinder;a<e&&o<=1&&1e-4<h;)n=l(o),i=o,e<(r=s(c.x,c.y,n.x,n.y))+a?o-=h/=2:(c=n,o+=h,a+=r);return n.angle=u(i),n}(o,e)}},d.util.getBoundsOfArc=function(t,e,n,i,a,s,l,c,h){for(var u,f=0,p=0,d=[],g=r(c-t,h-e,n,i,s,l,a),v=0,m=g.length;v<m;v++)u=o(f,p,g[v][1],g[v][2],g[v][3],g[v][4],g[v][5],g[v][6]),d.push({x:u[0].x+t,y:u[0].y+e}),d.push({x:u[1].x+t,y:u[1].y+e}),f=g[v][5],p=g[v][6];return d},d.util.drawArc=function(t,e,n,r){a(e,n,r=r.slice(0).unshift("X")).forEach((function(e){t.bezierCurveTo.apply(t,e.slice(1))}))}}(),function(){var t=Array.prototype.slice;function e(t,e,n){if(t&&0!==t.length){var r=t.length-1,i=e?t[r][e]:t[r];if(e)for(;r--;)n(t[r][e],i)&&(i=t[r][e]);else for(;r--;)n(t[r],i)&&(i=t[r]);return i}}d.util.array={fill:function(t,e){for(var n=t.length;n--;)t[n]=e;return t},invoke:function(e,n){for(var r=t.call(arguments,2),i=[],o=0,a=e.length;o<a;o++)i[o]=r.length?e[o][n].apply(e[o],r):e[o][n].call(e[o]);return i},min:function(t,n){return e(t,n,(function(t,e){return t<e}))},max:function(t,n){return e(t,n,(function(t,e){return e<=t}))}}}(),function(){function t(e,n,r){if(r)if(!d.isLikelyNode&&n instanceof Element)e=n;else if(n instanceof Array){e=[];for(var i=0,o=n.length;i<o;i++)e[i]=t({},n[i],r)}else if(n&&"object"==typeof n)for(var a in n)"canvas"===a||"group"===a?e[a]=null:n.hasOwnProperty(a)&&(e[a]=t({},n[a],r));else e=n;else for(var a in n)e[a]=n[a];return e}d.util.object={extend:t,clone:function(e,n){return t({},e,n)}},d.util.object.extend(d.util,d.Observable)}(),function(){function t(t,e){var n=t.charCodeAt(e);if(isNaN(n))return"";if(n<55296||57343<n)return t.charAt(e);if(55296<=n&&n<=56319){if(t.length<=e+1)throw"High surrogate without following low surrogate";var r=t.charCodeAt(e+1);if(r<56320||57343<r)throw"High surrogate without following low surrogate";return t.charAt(e)+t.charAt(e+1)}if(0===e)throw"Low surrogate without preceding high surrogate";var i=t.charCodeAt(e-1);if(i<55296||56319<i)throw"Low surrogate without preceding high surrogate";return!1}d.util.string={camelize:function(t){return t.replace(/-+(.)?/g,(function(t,e){return e?e.toUpperCase():""}))},capitalize:function(t,e){return t.charAt(0).toUpperCase()+(e?t.slice(1):t.slice(1).toLowerCase())},escapeXml:function(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},graphemeSplit:function(e){var n,r=0,i=[];for(r=0;r<e.length;r++)!1!==(n=t(e,r))&&i.push(n);return i}}}(),function(){var t=Array.prototype.slice,e=function(){},n=function(){for(var t in{toString:1})if("toString"===t)return!1;return!0}(),r=function(t,e,r){for(var i in e)i in t.prototype&&"function"==typeof t.prototype[i]&&-1<(e[i]+"").indexOf("callSuper")?t.prototype[i]=function(t){return function(){var n=this.constructor.superclass;this.constructor.superclass=r;var i=e[t].apply(this,arguments);if(this.constructor.superclass=n,"initialize"!==t)return i}}(i):t.prototype[i]=e[i],n&&(e.toString!==Object.prototype.toString&&(t.prototype.toString=e.toString),e.valueOf!==Object.prototype.valueOf&&(t.prototype.valueOf=e.valueOf))};function i(){}function o(e){for(var n=null,r=this;r.constructor.superclass;){var i=r.constructor.superclass.prototype[e];if(r[e]!==i){n=i;break}r=r.constructor.superclass.prototype}return n?1<arguments.length?n.apply(this,t.call(arguments,1)):n.call(this):console.log("tried to callSuper "+e+", method not found in prototype chain",this)}d.util.createClass=function(){var n=null,a=t.call(arguments,0);function s(){this.initialize.apply(this,arguments)}"function"==typeof a[0]&&(n=a.shift()),s.superclass=n,s.subclasses=[],n&&(i.prototype=n.prototype,s.prototype=new i,n.subclasses.push(s));for(var l=0,c=a.length;l<c;l++)r(s,a[l],n);return s.prototype.initialize||(s.prototype.initialize=e),(s.prototype.constructor=s).prototype.callSuper=o,s}}(),a=!!d.document.createElement("div").attachEvent,s=["touchstart","touchmove","touchend"],d.util.addListener=function(t,e,n,r){t&&t.addEventListener(e,n,!a&&r)},d.util.removeListener=function(t,e,n,r){t&&t.removeEventListener(e,n,!a&&r)},d.util.getPointer=function(t){var e,n,r=t.target,i=d.util.getScrollLeftTop(r),o=(n=(e=t).changedTouches)&&n[0]?n[0]:e;return{x:o.clientX+i.left,y:o.clientY+i.top}},d.util.isTouchEvent=function(t){return-1<s.indexOf(t.type)||"touch"===t.pointerType},function(){var t=d.document.createElement("div"),e="string"==typeof t.style.opacity,n="string"==typeof t.style.filter,r=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,i=function(t){return t};e?i=function(t,e){return t.style.opacity=e,t}:n&&(i=function(t,e){var n=t.style;return t.currentStyle&&!t.currentStyle.hasLayout&&(n.zoom=1),r.test(n.filter)?(e=.9999<=e?"":"alpha(opacity="+100*e+")",n.filter=n.filter.replace(r,e)):n.filter+=" alpha(opacity="+100*e+")",t}),d.util.setStyle=function(t,e){var n=t.style;if(!n)return t;if("string"==typeof e)return t.style.cssText+=";"+e,-1<e.indexOf("opacity")?i(t,e.match(/opacity:\s*(\d?\.?\d*)/)[1]):t;for(var r in e)"opacity"===r?i(t,e[r]):n["float"===r||"cssFloat"===r?void 0===n.styleFloat?"cssFloat":"styleFloat":r]=e[r];return t}}(),function(){var t,e,n,r,i=Array.prototype.slice,o=function(t){return i.call(t,0)};try{t=o(d.document.childNodes)instanceof Array}catch(t){}function a(t,e){var n=d.document.createElement(t);for(var r in e)"class"===r?n.className=e[r]:"for"===r?n.htmlFor=e[r]:n.setAttribute(r,e[r]);return n}function s(t){for(var e=0,n=0,r=d.document.documentElement,i=d.document.body||{scrollLeft:0,scrollTop:0};t&&(t.parentNode||t.host)&&((t=t.parentNode||t.host)===d.document?(e=i.scrollLeft||r.scrollLeft||0,n=i.scrollTop||r.scrollTop||0):(e+=t.scrollLeft||0,n+=t.scrollTop||0),1!==t.nodeType||"fixed"!==t.style.position););return{left:e,top:n}}t||(o=function(t){for(var e=new Array(t.length),n=t.length;n--;)e[n]=t[n];return e}),e=d.document.defaultView&&d.document.defaultView.getComputedStyle?function(t,e){var n=d.document.defaultView.getComputedStyle(t,null);return n?n[e]:void 0}:function(t,e){var n=t.style[e];return!n&&t.currentStyle&&(n=t.currentStyle[e]),n},n=d.document.documentElement.style,r="userSelect"in n?"userSelect":"MozUserSelect"in n?"MozUserSelect":"WebkitUserSelect"in n?"WebkitUserSelect":"KhtmlUserSelect"in n?"KhtmlUserSelect":"",d.util.makeElementUnselectable=function(t){return void 0!==t.onselectstart&&(t.onselectstart=d.util.falseFunction),r?t.style[r]="none":"string"==typeof t.unselectable&&(t.unselectable="on"),t},d.util.makeElementSelectable=function(t){return void 0!==t.onselectstart&&(t.onselectstart=null),r?t.style[r]="":"string"==typeof t.unselectable&&(t.unselectable=""),t},d.util.setImageSmoothing=function(t,e){t.imageSmoothingEnabled=t.imageSmoothingEnabled||t.webkitImageSmoothingEnabled||t.mozImageSmoothingEnabled||t.msImageSmoothingEnabled||t.oImageSmoothingEnabled,t.imageSmoothingEnabled=e},d.util.getById=function(t){return"string"==typeof t?d.document.getElementById(t):t},d.util.toArray=o,d.util.addClass=function(t,e){t&&-1===(" "+t.className+" ").indexOf(" "+e+" ")&&(t.className+=(t.className?" ":"")+e)},d.util.makeElement=a,d.util.wrapElement=function(t,e,n){return"string"==typeof e&&(e=a(e,n)),t.parentNode&&t.parentNode.replaceChild(e,t),e.appendChild(t),e},d.util.getScrollLeftTop=s,d.util.getElementOffset=function(t){var n,r,i=t&&t.ownerDocument,o={left:0,top:0},a={left:0,top:0},l={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!i)return a;for(var c in l)a[l[c]]+=parseInt(e(t,c),10)||0;return n=i.documentElement,void 0!==t.getBoundingClientRect&&(o=t.getBoundingClientRect()),r=s(t),{left:o.left+r.left-(n.clientLeft||0)+a.left,top:o.top+r.top-(n.clientTop||0)+a.top}},d.util.getNodeCanvas=function(t){var e=d.jsdomImplForWrapper(t);return e._canvas||e._image},d.util.cleanUpJsdomNode=function(t){if(d.isLikelyNode){var e=d.jsdomImplForWrapper(t);e&&(e._image=null,e._canvas=null,e._currentSrc=null,e._attributes=null,e._classList=null)}}}(),function(){function t(){}d.util.request=function(e,n){n||(n={});var r,i,o=n.method?n.method.toUpperCase():"GET",a=n.onComplete||function(){},s=new d.window.XMLHttpRequest,l=n.body||n.parameters;return s.onreadystatechange=function(){4===s.readyState&&(a(s),s.onreadystatechange=t)},"GET"===o&&(l=null,"string"==typeof n.parameters&&(r=e,i=n.parameters,e=r+(/\?/.test(r)?"&":"?")+i)),s.open(o,e,!0),"POST"!==o&&"PUT"!==o||s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(l),s}}(),d.log=console.log,d.warn=console.warn,function(){function t(){return!1}function e(t,e,n,r){return-n*Math.cos(t/r*(Math.PI/2))+n+e}var n=d.window.requestAnimationFrame||d.window.webkitRequestAnimationFrame||d.window.mozRequestAnimationFrame||d.window.oRequestAnimationFrame||d.window.msRequestAnimationFrame||function(t){return d.window.setTimeout(t,1e3/60)},r=d.window.cancelAnimationFrame||d.window.clearTimeout;function i(){return n.apply(d.window,arguments)}d.util.animate=function(n){i((function(r){n||(n={});var o,a=r||+new Date,s=n.duration||500,l=a+s,c=n.onChange||t,h=n.abort||t,u=n.onComplete||t,f=n.easing||e,p="startValue"in n?n.startValue:0,d="endValue"in n?n.endValue:100,g=n.byValue||d-p;n.onStart&&n.onStart(),function t(e){o=e||+new Date;var n=l<o?s:o-a,r=n/s,v=f(n,p,g,s),m=Math.abs((v-p)/g);if(!h())return l<o?(c(d,1,1),void u(d,1,1)):(c(v,m,r),void i(t));u(d,1,1)}(a)}))},d.util.requestAnimFrame=i,d.util.cancelAnimFrame=function(){return r.apply(d.window,arguments)}}(),function(){function t(t,e,n){var r="rgba("+parseInt(t[0]+n*(e[0]-t[0]),10)+","+parseInt(t[1]+n*(e[1]-t[1]),10)+","+parseInt(t[2]+n*(e[2]-t[2]),10);return(r+=","+(t&&e?parseFloat(t[3]+n*(e[3]-t[3])):1))+")"}d.util.animateColor=function(e,n,r,i){var o=new d.Color(e).getSource(),a=new d.Color(n).getSource(),s=i.onComplete,l=i.onChange;i=i||{},d.util.animate(d.util.object.extend(i,{duration:r||500,startValue:o,endValue:a,byValue:a,easing:function(e,n,r,o){return t(n,r,i.colorEasing?i.colorEasing(e,o):1-Math.cos(e/o*(Math.PI/2)))},onComplete:function(e,n,r){if(s)return s(t(a,a,0),n,r)},onChange:function(e,n,r){if(l){if(Array.isArray(e))return l(t(e,e,0),n,r);l(e,n,r)}}}))}}(),function(){function t(t,e,n,r){return t<Math.abs(e)?(t=e,r=n/4):r=0===e&&0===t?n/(2*Math.PI)*Math.asin(1):n/(2*Math.PI)*Math.asin(e/t),{a:t,c:e,p:n,s:r}}function e(t,e,n){return t.a*Math.pow(2,10*(e-=1))*Math.sin((e*n-t.s)*(2*Math.PI)/t.p)}function n(t,e,n,i){return n-r(i-t,0,n,i)+e}function r(t,e,n,r){return(t/=r)<1/2.75?n*(7.5625*t*t)+e:t<2/2.75?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e}d.util.ease={easeInQuad:function(t,e,n,r){return n*(t/=r)*t+e},easeOutQuad:function(t,e,n,r){return-n*(t/=r)*(t-2)+e},easeInOutQuad:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,n,r){return n*(t/=r)*t*t+e},easeOutCubic:function(t,e,n,r){return n*((t=t/r-1)*t*t+1)+e},easeInOutCubic:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,n,r){return n*(t/=r)*t*t*t+e},easeOutQuart:function(t,e,n,r){return-n*((t=t/r-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t*t+e:-n/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,n,r){return n*(t/=r)*t*t*t*t+e},easeOutQuint:function(t,e,n,r){return n*((t=t/r-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,n,r){return-n*Math.cos(t/r*(Math.PI/2))+n+e},easeOutSine:function(t,e,n,r){return n*Math.sin(t/r*(Math.PI/2))+e},easeInOutSine:function(t,e,n,r){return-n/2*(Math.cos(Math.PI*t/r)-1)+e},easeInExpo:function(t,e,n,r){return 0===t?e:n*Math.pow(2,10*(t/r-1))+e},easeOutExpo:function(t,e,n,r){return t===r?e+n:n*(1-Math.pow(2,-10*t/r))+e},easeInOutExpo:function(t,e,n,r){return 0===t?e:t===r?e+n:(t/=r/2)<1?n/2*Math.pow(2,10*(t-1))+e:n/2*(2-Math.pow(2,-10*--t))+e},easeInCirc:function(t,e,n,r){return-n*(Math.sqrt(1-(t/=r)*t)-1)+e},easeOutCirc:function(t,e,n,r){return n*Math.sqrt(1-(t=t/r-1)*t)+e},easeInOutCirc:function(t,e,n,r){return(t/=r/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+e:n/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(n,r,i,o){var a=0;return 0===n?r:1==(n/=o)?r+i:(a||(a=.3*o),-e(t(i,i,a,1.70158),n,o)+r)},easeOutElastic:function(e,n,r,i){var o=0;if(0===e)return n;if(1==(e/=i))return n+r;o||(o=.3*i);var a=t(r,r,o,1.70158);return a.a*Math.pow(2,-10*e)*Math.sin((e*i-a.s)*(2*Math.PI)/a.p)+a.c+n},easeInOutElastic:function(n,r,i,o){var a=0;if(0===n)return r;if(2==(n/=o/2))return r+i;a||(a=o*(.3*1.5));var s=t(i,i,a,1.70158);return n<1?-.5*e(s,n,o)+r:s.a*Math.pow(2,-10*(n-=1))*Math.sin((n*o-s.s)*(2*Math.PI)/s.p)*.5+s.c+r},easeInBack:function(t,e,n,r,i){return void 0===i&&(i=1.70158),n*(t/=r)*t*((i+1)*t-i)+e},easeOutBack:function(t,e,n,r,i){return void 0===i&&(i=1.70158),n*((t=t/r-1)*t*((i+1)*t+i)+1)+e},easeInOutBack:function(t,e,n,r,i){return void 0===i&&(i=1.70158),(t/=r/2)<1?n/2*(t*t*((1+(i*=1.525))*t-i))+e:n/2*((t-=2)*t*((1+(i*=1.525))*t+i)+2)+e},easeInBounce:n,easeOutBounce:r,easeInOutBounce:function(t,e,i,o){return t<o/2?.5*n(2*t,0,i,o)+e:.5*r(2*t-o,0,i,o)+.5*i+e}}}(),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,r=e.util.object.clone,i=e.util.toFixed,o=e.util.parseUnit,a=e.util.multiplyTransformMatrices,s={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},l={stroke:"strokeOpacity",fill:"fillOpacity"},c="font-size",h="clip-path";function u(t,n,r,i){var s,l="[object Array]"===Object.prototype.toString.call(n);if("fill"!==t&&"stroke"!==t||"none"!==n){if("strokeUniform"===t)return"non-scaling-stroke"===n;if("strokeDashArray"===t)n="none"===n?null:n.replace(/,/g," ").split(/\s+/).map(parseFloat);else if("transformMatrix"===t)n=r&&r.transformMatrix?a(r.transformMatrix,e.parseTransformAttribute(n)):e.parseTransformAttribute(n);else if("visible"===t)n="none"!==n&&"hidden"!==n,r&&!1===r.visible&&(n=!1);else if("opacity"===t)n=parseFloat(n),r&&void 0!==r.opacity&&(n*=r.opacity);else if("textAnchor"===t)n="start"===n?"left":"end"===n?"right":"center";else if("charSpacing"===t)s=o(n,i)/i*1e3;else if("paintFirst"===t){var c=n.indexOf("fill"),h=n.indexOf("stroke");n="fill",(-1<c&&-1<h&&h<c||-1===c&&-1<h)&&(n="stroke")}else{if("href"===t||"xlink:href"===t||"font"===t)return n;if("imageSmoothing"===t)return"optimizeQuality"===n;s=l?n.map(o):o(n,i)}}else n="";return!l&&isNaN(s)?n:s}function f(t){return new RegExp("^("+t.join("|")+")\\b","i")}function p(t,e){var n,r,i,o,a=[];for(i=0,o=e.length;i<o;i++)n=e[i],r=t.getElementsByTagName(n),a=a.concat(Array.prototype.slice.call(r));return a}function d(t,e){var n,r=!0;return(n=g(t,e.pop()))&&e.length&&(r=function(t,e){for(var n,r=!0;t.parentNode&&1===t.parentNode.nodeType&&e.length;)r&&(n=e.pop()),r=g(t=t.parentNode,n);return 0===e.length}(t,e)),n&&r&&0===e.length}function g(t,e){var n,r,i=t.nodeName,o=t.getAttribute("class"),a=t.getAttribute("id");if(n=new RegExp("^"+i,"i"),e=e.replace(n,""),a&&e.length&&(n=new RegExp("#"+a+"(?![a-zA-Z\\-]+)","i"),e=e.replace(n,"")),o&&e.length)for(r=(o=o.split(" ")).length;r--;)n=new RegExp("\\."+o[r]+"(?![a-zA-Z\\-]+)","i"),e=e.replace(n,"");return 0===e.length}function v(t,e){var n;if(t.getElementById&&(n=t.getElementById(e)),n)return n;var r,i,o,a=t.getElementsByTagName("*");for(i=0,o=a.length;i<o;i++)if(e===(r=a[i]).getAttribute("id"))return r}e.svgValidTagNamesRegEx=f(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),e.svgViewBoxElementsRegEx=f(["symbol","image","marker","pattern","view","svg"]),e.svgInvalidAncestorsRegEx=f(["pattern","defs","symbol","metadata","clipPath","mask","desc"]),e.svgValidParentsRegEx=f(["symbol","g","a","svg","clipPath","defs"]),e.cssRules={},e.gradientDefs={},e.clipPaths={},e.parseTransformAttribute=function(){function t(t,n,r){t[r]=Math.tan(e.util.degreesToRadians(n[0]))}var n=e.iMatrix,r=e.reNum,i=e.commaWsp,o="(?:(?:(matrix)\\s*\\(\\s*("+r+")"+i+"("+r+")"+i+"("+r+")"+i+"("+r+")"+i+"("+r+")"+i+"("+r+")\\s*\\))|(?:(translate)\\s*\\(\\s*("+r+")(?:"+i+"("+r+"))?\\s*\\))|(?:(scale)\\s*\\(\\s*("+r+")(?:"+i+"("+r+"))?\\s*\\))|(?:(rotate)\\s*\\(\\s*("+r+")(?:"+i+"("+r+")"+i+"("+r+"))?\\s*\\))|(?:(skewX)\\s*\\(\\s*("+r+")\\s*\\))|(?:(skewY)\\s*\\(\\s*("+r+")\\s*\\)))",a=new RegExp("^\\s*(?:(?:"+o+"(?:"+i+"*"+o+")*)?)\\s*$"),s=new RegExp(o,"g");return function(r){var i=n.concat(),l=[];if(!r||r&&!a.test(r))return i;r.replace(s,(function(r){var a,s,c,h,u,f,p,d,g,v,m,y,b=new RegExp(o).exec(r).filter((function(t){return!!t})),x=b[1],w=b.slice(2).map(parseFloat);switch(x){case"translate":y=w,(m=i)[4]=y[0],2===y.length&&(m[5]=y[1]);break;case"rotate":w[0]=e.util.degreesToRadians(w[0]),u=i,f=w,p=e.util.cos(f[0]),d=e.util.sin(f[0]),v=g=0,3===f.length&&(g=f[1],v=f[2]),u[0]=p,u[1]=d,u[2]=-d,u[3]=p,u[4]=g-(p*g-d*v),u[5]=v-(d*g+p*v);break;case"scale":a=i,c=(s=w)[0],h=2===s.length?s[1]:s[0],a[0]=c,a[3]=h;break;case"skewX":t(i,w,2);break;case"skewY":t(i,w,1);break;case"matrix":i=w}l.push(i.concat()),i=n.concat()}));for(var c=l[0];1<l.length;)l.shift(),c=e.util.multiplyTransformMatrices(c,l[0]);return c}}();var m=new RegExp("^\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*$");function y(t){if(e.svgViewBoxElementsRegEx.test(t.nodeName)){var n,r,i,a,s,l,c=t.getAttribute("viewBox"),h=1,u=1,f=t.getAttribute("width"),p=t.getAttribute("height"),d=t.getAttribute("x")||0,g=t.getAttribute("y")||0,v=t.getAttribute("preserveAspectRatio")||"",y=!c||!(c=c.match(m)),b=!f||!p||"100%"===f||"100%"===p,x=y&&b,w={},S="",C=0,T=0;if(w.width=0,w.height=0,w.toBeParsed=x,y&&(d||g)&&"#document"!==t.parentNode.nodeName&&(S=" translate("+o(d)+" "+o(g)+") ",s=(t.getAttribute("transform")||"")+S,t.setAttribute("transform",s),t.removeAttribute("x"),t.removeAttribute("y")),x)return w;if(y)return w.width=o(f),w.height=o(p),w;if(n=-parseFloat(c[1]),r=-parseFloat(c[2]),i=parseFloat(c[3]),a=parseFloat(c[4]),w.minX=n,w.minY=r,w.viewBoxWidth=i,w.viewBoxHeight=a,b?(w.width=i,w.height=a):(w.width=o(f),w.height=o(p),h=w.width/i,u=w.height/a),"none"!==(v=e.util.parsePreserveAspectRatioAttribute(v)).alignX&&("meet"===v.meetOrSlice&&(u=h=u<h?u:h),"slice"===v.meetOrSlice&&(u=h=u<h?h:u),C=w.width-i*h,T=w.height-a*h,"Mid"===v.alignX&&(C/=2),"Mid"===v.alignY&&(T/=2),"Min"===v.alignX&&(C=0),"Min"===v.alignY&&(T=0)),1===h&&1===u&&0===n&&0===r&&0===d&&0===g)return w;if((d||g)&&"#document"!==t.parentNode.nodeName&&(S=" translate("+o(d)+" "+o(g)+") "),s=S+" matrix("+h+" 0 0 "+u+" "+(n*h+C)+" "+(r*u+T)+") ","svg"===t.nodeName){for(l=t.ownerDocument.createElementNS(e.svgNS,"g");t.firstChild;)l.appendChild(t.firstChild);t.appendChild(l)}else(l=t).removeAttribute("x"),l.removeAttribute("y"),s=l.getAttribute("transform")+s;return l.setAttribute("transform",s),w}}function b(t,e){var n="xlink:href",r=v(t,e.getAttribute(n).substr(1));if(r&&r.getAttribute(n)&&b(t,r),["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"].forEach((function(t){r&&!e.hasAttribute(t)&&r.hasAttribute(t)&&e.setAttribute(t,r.getAttribute(t))})),!e.children.length)for(var i=r.cloneNode(!0);i.firstChild;)e.appendChild(i.firstChild);e.removeAttribute(n)}e.parseSVGDocument=function(t,n,i,o){if(t){!function(t){for(var n=p(t,["use","svg:use"]),r=0;n.length&&r<n.length;){var i,o,a,s,l=n[r],c=(l.getAttribute("xlink:href")||l.getAttribute("href")).substr(1),h=l.getAttribute("x")||0,u=l.getAttribute("y")||0,f=v(t,c).cloneNode(!0),d=(f.getAttribute("transform")||"")+" translate("+h+", "+u+")",g=n.length,m=e.svgNS;if(y(f),/^svg$/i.test(f.nodeName)){var b=f.ownerDocument.createElementNS(m,"g");for(o=0,s=(a=f.attributes).length;o<s;o++)i=a.item(o),b.setAttributeNS(m,i.nodeName,i.nodeValue);for(;f.firstChild;)b.appendChild(f.firstChild);f=b}for(o=0,s=(a=l.attributes).length;o<s;o++)"x"!==(i=a.item(o)).nodeName&&"y"!==i.nodeName&&"xlink:href"!==i.nodeName&&"href"!==i.nodeName&&("transform"===i.nodeName?d=i.nodeValue+" "+d:f.setAttribute(i.nodeName,i.nodeValue));f.setAttribute("transform",d),f.setAttribute("instantiated_by_use","1"),f.removeAttribute("id"),l.parentNode.replaceChild(f,l),n.length===g&&r++}}(t);var a,s,l=e.Object.__uid++,c=y(t),h=e.util.toArray(t.getElementsByTagName("*"));if(c.crossOrigin=o&&o.crossOrigin,c.svgUid=l,0===h.length&&e.isLikelyNode){var u=[];for(a=0,s=(h=t.selectNodes('//*[name(.)!="svg"]')).length;a<s;a++)u[a]=h[a];h=u}var f=h.filter((function(t){return y(t),e.svgValidTagNamesRegEx.test(t.nodeName.replace("svg:",""))&&!function(t,e){for(;t&&(t=t.parentNode);)if(t.nodeName&&e.test(t.nodeName.replace("svg:",""))&&!t.getAttribute("instantiated_by_use"))return!0;return!1}(t,e.svgInvalidAncestorsRegEx)}));if(!f||f&&!f.length)n&&n([],{});else{var d={};h.filter((function(t){return"clipPath"===t.nodeName.replace("svg:","")})).forEach((function(t){var n=t.getAttribute("id");d[n]=e.util.toArray(t.getElementsByTagName("*")).filter((function(t){return e.svgValidTagNamesRegEx.test(t.nodeName.replace("svg:",""))}))})),e.gradientDefs[l]=e.getGradientDefs(t),e.cssRules[l]=e.getCSSRules(t),e.clipPaths[l]=d,e.parseElements(f,(function(t,r){n&&(n(t,c,r,h),delete e.gradientDefs[l],delete e.cssRules[l],delete e.clipPaths[l])}),r(c),i,o)}}};var x=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+e.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+e.reNum+"))?\\s+(.*)");n(e,{parseFontDeclaration:function(t,e){var n=t.match(x);if(n){var r=n[1],i=n[3],a=n[4],s=n[5],l=n[6];r&&(e.fontStyle=r),i&&(e.fontWeight=isNaN(parseFloat(i))?i:parseFloat(i)),a&&(e.fontSize=o(a)),l&&(e.fontFamily=l),s&&(e.lineHeight="normal"===s?1:s)}},getGradientDefs:function(t){var e,n=p(t,["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"]),r=0,i={};for(r=n.length;r--;)(e=n[r]).getAttribute("xlink:href")&&b(t,e),i[e.getAttribute("id")]=e;return i},parseAttributes:function(t,r,a){if(t){var f,p,g,v={};void 0===a&&(a=t.getAttribute("svgUid")),t.parentNode&&e.svgValidParentsRegEx.test(t.parentNode.nodeName)&&(v=e.parseAttributes(t.parentNode,r,a));var m=r.reduce((function(e,n){return(f=t.getAttribute(n))&&(e[n]=f),e}),{}),y=n(function(t,n){var r={};for(var i in e.cssRules[n])if(d(t,i.split(" ")))for(var o in e.cssRules[n][i])r[o]=e.cssRules[n][i][o];return r}(t,a),e.parseStyleAttribute(t));m=n(m,y),y[h]&&t.setAttribute(h,y[h]),p=g=v.fontSize||e.Text.DEFAULT_SVG_FONT_SIZE,m[c]&&(m[c]=p=o(m[c],g));var b,x,w,S={};for(var C in m)x=u(b=(w=C)in s?s[w]:w,m[C],v,p),S[b]=x;S&&S.font&&e.parseFontDeclaration(S.font,S);var T=n(v,S);return e.svgValidParentsRegEx.test(t.nodeName)?T:function(t){for(var n in l)if(void 0!==t[l[n]]&&""!==t[n]){if(void 0===t[n]){if(!e.Object.prototype[n])continue;t[n]=e.Object.prototype[n]}if(0!==t[n].indexOf("url(")){var r=new e.Color(t[n]);t[n]=r.setAlpha(i(r.getAlpha()*t[l[n]],2)).toRgba()}}return t}(T)}},parseElements:function(t,n,r,i,o){new e.ElementsParser(t,n,r,i,o).parse()},parseStyleAttribute:function(t){var e,n,r,i={},o=t.getAttribute("style");return o&&("string"==typeof o?(e=i,o.replace(/;\s*$/,"").split(";").forEach((function(t){var i=t.split(":");n=i[0].trim().toLowerCase(),r=i[1].trim(),e[n]=r}))):function(t,e){var n,r;for(var i in t)void 0!==t[i]&&(n=i.toLowerCase(),r=t[i],e[n]=r)}(o,i)),i},parsePointsAttribute:function(t){if(!t)return null;var e,n,r=[];for(e=0,n=(t=(t=t.replace(/,/g," ").trim()).split(/\s+/)).length;e<n;e+=2)r.push({x:parseFloat(t[e]),y:parseFloat(t[e+1])});return r},getCSSRules:function(t){var n,r,i=t.getElementsByTagName("style"),o={};for(n=0,r=i.length;n<r;n++){var a=i[n].textContent;""!==(a=a.replace(/\/\*[\s\S]*?\*\//g,"")).trim()&&a.match(/[^{]*\{[\s\S]*?\}/g).map((function(t){return t.trim()})).forEach((function(t){var i=t.match(/([\s\S]*?)\s*\{([^}]*)\}/),a={},s=i[2].trim().replace(/;$/,"").split(/\s*;\s*/);for(n=0,r=s.length;n<r;n++){var l=s[n].split(/\s*:\s*/),c=l[0],h=l[1];a[c]=h}(t=i[1]).split(",").forEach((function(t){""!==(t=t.replace(/^svg/i,"").trim())&&(o[t]?e.util.object.extend(o[t],a):o[t]=e.util.object.clone(a))}))}))}return o},loadSVGFromURL:function(t,n,r,i){t=t.replace(/^\n\s*/,"").trim(),new e.util.request(t,{method:"get",onComplete:function(t){var o=t.responseXML;if(!o||!o.documentElement)return n&&n(null),!1;e.parseSVGDocument(o.documentElement,(function(t,e,r,i){n&&n(t,e,r,i)}),r,i)}})},loadSVGFromString:function(t,n,r,i){var o=(new e.window.DOMParser).parseFromString(t.trim(),"text/xml");e.parseSVGDocument(o.documentElement,(function(t,e,r,i){n(t,e,r,i)}),r,i)}})}(e),d.ElementsParser=function(t,e,n,r,i,o){this.elements=t,this.callback=e,this.options=n,this.reviver=r,this.svgUid=n&&n.svgUid||0,this.parsingOptions=i,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=o},function(t){t.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},t.createObjects=function(){var t=this;this.elements.forEach((function(e,n){e.setAttribute("svgUid",t.svgUid),t.createObject(e,n)}))},t.findTag=function(t){return d[d.util.string.capitalize(t.tagName.replace("svg:",""))]},t.createObject=function(t,e){var n=this.findTag(t);if(n&&n.fromElement)try{n.fromElement(t,this.createCallback(e,t),this.options)}catch(t){d.log(t)}else this.checkIfDone()},t.createCallback=function(t,e){var n=this;return function(r){var i;n.resolveGradient(r,e,"fill"),n.resolveGradient(r,e,"stroke"),r instanceof d.Image&&r._originalElement&&(i=r.parsePreserveAspectRatioAttribute(e)),r._removeTransformMatrix(i),n.resolveClipPath(r,e),n.reviver&&n.reviver(e,r),n.instances[t]=r,n.checkIfDone()}},t.extractPropertyDefinition=function(t,e,n){var r=t[e],i=this.regexUrl;if(i.test(r)){i.lastIndex=0;var o=i.exec(r)[1];return i.lastIndex=0,d[n][this.svgUid][o]}},t.resolveGradient=function(t,e,n){var r=this.extractPropertyDefinition(t,n,"gradientDefs");if(r){var i=e.getAttribute(n+"-opacity"),o=d.Gradient.fromElement(r,t,i,this.options);t.set(n,o)}},t.createClipPathCallback=function(t,e){return function(t){t._removeTransformMatrix(),t.fillRule=t.clipRule,e.push(t)}},t.resolveClipPath=function(t,e){var n,r,i,o,a=this.extractPropertyDefinition(t,"clipPath","clipPaths");if(a){i=[],r=d.util.invertTransform(t.calcTransformMatrix());for(var s=a[0].parentNode,l=e;l.parentNode&&l.getAttribute("clip-path")!==t.clipPath;)l=l.parentNode;l.parentNode.appendChild(s);for(var c=0;c<a.length;c++)n=a[c],this.findTag(n).fromElement(n,this.createClipPathCallback(t,i),this.options);a=1===i.length?i[0]:new d.Group(i),o=d.util.multiplyTransformMatrices(r,a.calcTransformMatrix()),a.clipPath&&this.resolveClipPath(a,l);var h=d.util.qrDecompose(o);a.flipX=!1,a.flipY=!1,a.set("scaleX",h.scaleX),a.set("scaleY",h.scaleY),a.angle=h.angle,a.skewX=h.skewX,a.skewY=0,a.setPositionByOrigin({x:h.translateX,y:h.translateY},"center","center"),t.clipPath=a}else delete t.clipPath},t.checkIfDone=function(){0==--this.numElements&&(this.instances=this.instances.filter((function(t){return null!=t})),this.callback(this.instances,this.elements))}}(d.ElementsParser.prototype),function(t){"use strict";var e=t.fabric||(t.fabric={});function n(t,e){this.x=t,this.y=e}e.Point?e.warn("fabric.Point is already defined"):(e.Point=n).prototype={type:"point",constructor:n,add:function(t){return new n(this.x+t.x,this.y+t.y)},addEquals:function(t){return this.x+=t.x,this.y+=t.y,this},scalarAdd:function(t){return new n(this.x+t,this.y+t)},scalarAddEquals:function(t){return this.x+=t,this.y+=t,this},subtract:function(t){return new n(this.x-t.x,this.y-t.y)},subtractEquals:function(t){return this.x-=t.x,this.y-=t.y,this},scalarSubtract:function(t){return new n(this.x-t,this.y-t)},scalarSubtractEquals:function(t){return this.x-=t,this.y-=t,this},multiply:function(t){return new n(this.x*t,this.y*t)},multiplyEquals:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return new n(this.x/t,this.y/t)},divideEquals:function(t){return this.x/=t,this.y/=t,this},eq:function(t){return this.x===t.x&&this.y===t.y},lt:function(t){return this.x<t.x&&this.y<t.y},lte:function(t){return this.x<=t.x&&this.y<=t.y},gt:function(t){return this.x>t.x&&this.y>t.y},gte:function(t){return this.x>=t.x&&this.y>=t.y},lerp:function(t,e){return void 0===e&&(e=.5),e=Math.max(Math.min(1,e),0),new n(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e)},distanceFrom:function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},midPointFrom:function(t){return this.lerp(t)},min:function(t){return new n(Math.min(this.x,t.x),Math.min(this.y,t.y))},max:function(t){return new n(Math.max(this.x,t.x),Math.max(this.y,t.y))},toString:function(){return this.x+","+this.y},setXY:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setFromPoint:function(t){return this.x=t.x,this.y=t.y,this},swap:function(t){var e=this.x,n=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=n},clone:function(){return new n(this.x,this.y)}}}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});function n(t){this.status=t,this.points=[]}e.Intersection?e.warn("fabric.Intersection is already defined"):(e.Intersection=n,e.Intersection.prototype={constructor:n,appendPoint:function(t){return this.points.push(t),this},appendPoints:function(t){return this.points=this.points.concat(t),this}},e.Intersection.intersectLineLine=function(t,r,i,o){var a,s=(o.x-i.x)*(t.y-i.y)-(o.y-i.y)*(t.x-i.x),l=(r.x-t.x)*(t.y-i.y)-(r.y-t.y)*(t.x-i.x),c=(o.y-i.y)*(r.x-t.x)-(o.x-i.x)*(r.y-t.y);if(0!==c){var h=s/c,u=l/c;0<=h&&h<=1&&0<=u&&u<=1?(a=new n("Intersection")).appendPoint(new e.Point(t.x+h*(r.x-t.x),t.y+h*(r.y-t.y))):a=new n}else a=new n(0===s||0===l?"Coincident":"Parallel");return a},e.Intersection.intersectLinePolygon=function(t,e,r){var i,o,a,s,l=new n,c=r.length;for(s=0;s<c;s++)i=r[s],o=r[(s+1)%c],a=n.intersectLineLine(t,e,i,o),l.appendPoints(a.points);return 0<l.points.length&&(l.status="Intersection"),l},e.Intersection.intersectPolygonPolygon=function(t,e){var r,i=new n,o=t.length;for(r=0;r<o;r++){var a=t[r],s=t[(r+1)%o],l=n.intersectLinePolygon(a,s,e);i.appendPoints(l.points)}return 0<i.points.length&&(i.status="Intersection"),i},e.Intersection.intersectPolygonRectangle=function(t,r,i){var o=r.min(i),a=r.max(i),s=new e.Point(a.x,o.y),l=new e.Point(o.x,a.y),c=n.intersectLinePolygon(o,s,t),h=n.intersectLinePolygon(s,a,t),u=n.intersectLinePolygon(a,l,t),f=n.intersectLinePolygon(l,o,t),p=new n;return p.appendPoints(c.points),p.appendPoints(h.points),p.appendPoints(u.points),p.appendPoints(f.points),0<p.points.length&&(p.status="Intersection"),p})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});function n(t){t?this._tryParsingColor(t):this.setSource([0,0,0,1])}function r(t,e,n){return n<0&&(n+=1),1<n&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}e.Color?e.warn("fabric.Color is already defined."):(e.Color=n,e.Color.prototype={_tryParsingColor:function(t){var e;t in n.colorNameMap&&(t=n.colorNameMap[t]),"transparent"===t&&(e=[255,255,255,0]),e||(e=n.sourceFromHex(t)),e||(e=n.sourceFromRgb(t)),e||(e=n.sourceFromHsl(t)),e||(e=[0,0,0,1]),e&&this.setSource(e)},_rgbToHsl:function(t,n,r){t/=255,n/=255,r/=255;var i,o,a,s=e.util.array.max([t,n,r]),l=e.util.array.min([t,n,r]);if(a=(s+l)/2,s===l)i=o=0;else{var c=s-l;switch(o=.5<a?c/(2-s-l):c/(s+l),s){case t:i=(n-r)/c+(n<r?6:0);break;case n:i=(r-t)/c+2;break;case r:i=(t-n)/c+4}i/=6}return[Math.round(360*i),Math.round(100*o),Math.round(100*a)]},getSource:function(){return this._source},setSource:function(t){this._source=t},toRgb:function(){var t=this.getSource();return"rgb("+t[0]+","+t[1]+","+t[2]+")"},toRgba:function(){var t=this.getSource();return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"},toHsl:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsl("+e[0]+","+e[1]+"%,"+e[2]+"%)"},toHsla:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsla("+e[0]+","+e[1]+"%,"+e[2]+"%,"+t[3]+")"},toHex:function(){var t,e,n,r=this.getSource();return t=1===(t=r[0].toString(16)).length?"0"+t:t,e=1===(e=r[1].toString(16)).length?"0"+e:e,n=1===(n=r[2].toString(16)).length?"0"+n:n,t.toUpperCase()+e.toUpperCase()+n.toUpperCase()},toHexa:function(){var t,e=this.getSource();return t=1===(t=(t=Math.round(255*e[3])).toString(16)).length?"0"+t:t,this.toHex()+t.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(t){var e=this.getSource();return e[3]=t,this.setSource(e),this},toGrayscale:function(){var t=this.getSource(),e=parseInt((.3*t[0]+.59*t[1]+.11*t[2]).toFixed(0),10),n=t[3];return this.setSource([e,e,e,n]),this},toBlackWhite:function(t){var e=this.getSource(),n=(.3*e[0]+.59*e[1]+.11*e[2]).toFixed(0),r=e[3];return t=t||127,n=Number(n)<Number(t)?0:255,this.setSource([n,n,n,r]),this},overlayWith:function(t){t instanceof n||(t=new n(t));var e,r=[],i=this.getAlpha(),o=this.getSource(),a=t.getSource();for(e=0;e<3;e++)r.push(Math.round(.5*o[e]+.5*a[e]));return r[3]=i,this.setSource(r),this}},e.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,e.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,e.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,e.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},e.Color.fromRgb=function(t){return n.fromSource(n.sourceFromRgb(t))},e.Color.sourceFromRgb=function(t){var e=t.match(n.reRGBa);if(e){var r=parseInt(e[1],10)/(/%$/.test(e[1])?100:1)*(/%$/.test(e[1])?255:1),i=parseInt(e[2],10)/(/%$/.test(e[2])?100:1)*(/%$/.test(e[2])?255:1),o=parseInt(e[3],10)/(/%$/.test(e[3])?100:1)*(/%$/.test(e[3])?255:1);return[parseInt(r,10),parseInt(i,10),parseInt(o,10),e[4]?parseFloat(e[4]):1]}},e.Color.fromRgba=n.fromRgb,e.Color.fromHsl=function(t){return n.fromSource(n.sourceFromHsl(t))},e.Color.sourceFromHsl=function(t){var e=t.match(n.reHSLa);if(e){var i,o,a,s=(parseFloat(e[1])%360+360)%360/360,l=parseFloat(e[2])/(/%$/.test(e[2])?100:1),c=parseFloat(e[3])/(/%$/.test(e[3])?100:1);if(0===l)i=o=a=c;else{var h=c<=.5?c*(l+1):c+l-c*l,u=2*c-h;i=r(u,h,s+1/3),o=r(u,h,s),a=r(u,h,s-1/3)}return[Math.round(255*i),Math.round(255*o),Math.round(255*a),e[4]?parseFloat(e[4]):1]}},e.Color.fromHsla=n.fromHsl,e.Color.fromHex=function(t){return n.fromSource(n.sourceFromHex(t))},e.Color.sourceFromHex=function(t){if(t.match(n.reHex)){var e=t.slice(t.indexOf("#")+1),r=3===e.length||4===e.length,i=8===e.length||4===e.length,o=r?e.charAt(0)+e.charAt(0):e.substring(0,2),a=r?e.charAt(1)+e.charAt(1):e.substring(2,4),s=r?e.charAt(2)+e.charAt(2):e.substring(4,6),l=i?r?e.charAt(3)+e.charAt(3):e.substring(6,8):"FF";return[parseInt(o,16),parseInt(a,16),parseInt(s,16),parseFloat((parseInt(l,16)/255).toFixed(2))]}},e.Color.fromSource=function(t){var e=new n;return e.setSource(t),e})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=["e","se","s","sw","w","nw","n","ne","e"],r=["ns","nesw","ew","nwse"],i={},o="left",a="top",s="right",l="bottom",c="center",h={top:l,bottom:a,left:s,right:o,center:c},u=e.util.radiansToDegrees,f=Math.sign||function(t){return(0<t)-(t<0)||+t};function p(t,e){var n=t.angle+u(Math.atan2(e.y,e.x))+360;return Math.round(n%360/45)}function d(t,n){var r=n.transform.target,i=r.canvas,o=e.util.object.clone(n);o.target=r,i&&i.fire("object:"+t,o),r.fire(t,n)}function g(t,e){var n=e.canvas,r=t[n.uniScaleKey];return n.uniformScaling&&!r||!n.uniformScaling&&r}function v(t){return t.originX===c&&t.originY===c}function m(t,e,n){var r=t.lockScalingX,i=t.lockScalingY;return!((!r||!i)&&(e||!r&&!i||!n)&&(!r||"x"!==e)&&(!i||"y"!==e))}function y(t,e,n,r){return{e:t,transform:e,pointer:{x:n,y:r}}}function b(t){return function(e,n,r,i){var o=n.target,a=o.getCenterPoint(),s=o.translateToOriginPoint(a,n.originX,n.originY),l=t(e,n,r,i);return o.setPositionByOrigin(s,n.originX,n.originY),l}}function x(t,n,r,i,o){var a=t.target,s=a.controls[t.corner],l=a.canvas.getZoom(),c=a.padding/l,h=a.toLocalPoint(new e.Point(i,o),n,r);return h.x>=c&&(h.x-=c),h.x<=-c&&(h.x+=c),h.y>=c&&(h.y-=c),h.y<=c&&(h.y+=c),h.x-=s.offsetX,h.y-=s.offsetY,h}function w(t){return t.flipX&&!t.flipY||!t.flipX&&t.flipY}function S(t,e,n,r,i){if(0!==t[e]){var o=i/t._getTransformedDimensions()[r]*t[n];t.set(n,o)}}function C(t,e,n,r){var i,c=e.target,h=c._getTransformedDimensions(0,c.skewY),f=x(e,e.originX,e.originY,n,r),p=Math.abs(2*f.x)-h.x,g=c.skewX;p<2?i=0:(i=u(Math.atan2(p/c.scaleX,h.y/c.scaleY)),e.originX===o&&e.originY===l&&(i=-i),e.originX===s&&e.originY===a&&(i=-i),w(c)&&(i=-i));var v=g!==i;if(v){var m=c._getTransformedDimensions().y;c.set("skewX",i),S(c,"skewY","scaleY","y",m),d("skewing",y(t,e,n,r))}return v}function T(t,e,n,r){var i,c=e.target,h=c._getTransformedDimensions(c.skewX,0),f=x(e,e.originX,e.originY,n,r),p=Math.abs(2*f.y)-h.y,g=c.skewY;p<2?i=0:(i=u(Math.atan2(p/c.scaleY,h.x/c.scaleX)),e.originX===o&&e.originY===l&&(i=-i),e.originX===s&&e.originY===a&&(i=-i),w(c)&&(i=-i));var v=g!==i;if(v){var m=c._getTransformedDimensions().x;c.set("skewY",i),S(c,"skewX","scaleX","x",m),d("skewing",y(t,e,n,r))}return v}function _(t,e,n,r,i){i=i||{};var o,a,s,l,c,u,p=e.target,b=p.lockScalingX,w=p.lockScalingY,S=i.by,C=g(t,p),T=m(p,S,C),_=e.gestureScale;if(T)return!1;if(_)a=e.scaleX*_,s=e.scaleY*_;else{if(o=x(e,e.originX,e.originY,n,r),c="y"!==S?f(o.x):1,u="x"!==S?f(o.y):1,e.signX||(e.signX=c),e.signY||(e.signY=u),p.lockScalingFlip&&(e.signX!==c||e.signY!==u))return!1;if(l=p._getTransformedDimensions(),C&&!S){var O,k=Math.abs(o.x)+Math.abs(o.y),P=e.original,E=k/(Math.abs(l.x*P.scaleX/p.scaleX)+Math.abs(l.y*P.scaleY/p.scaleY));a=P.scaleX*E,s=P.scaleY*E}else a=Math.abs(o.x*p.scaleX/l.x),s=Math.abs(o.y*p.scaleY/l.y);v(e)&&(a*=2,s*=2),e.signX!==c&&"y"!==S&&(e.originX=h[e.originX],a*=-1,e.signX=c),e.signY!==u&&"x"!==S&&(e.originY=h[e.originY],s*=-1,e.signY=u)}var M=p.scaleX,A=p.scaleY;return S?("x"===S&&p.set("scaleX",a),"y"===S&&p.set("scaleY",s)):(!b&&p.set("scaleX",a),!w&&p.set("scaleY",s)),(O=M!==p.scaleX||A!==p.scaleY)&&d("scaling",y(t,e,n,r)),O}i.scaleCursorStyleHandler=function(t,e,r){var i=g(t,r),o="";if(0!==e.x&&0===e.y?o="x":0===e.x&&0!==e.y&&(o="y"),m(r,o,i))return"not-allowed";var a=p(r,e);return n[a]+"-resize"},i.skewCursorStyleHandler=function(t,e,n){var i="not-allowed";if(0!==e.x&&n.lockSkewingY)return i;if(0!==e.y&&n.lockSkewingX)return i;var o=p(n,e)%4;return r[o]+"-resize"},i.scaleSkewCursorStyleHandler=function(t,e,n){return t[n.canvas.altActionKey]?i.skewCursorStyleHandler(t,e,n):i.scaleCursorStyleHandler(t,e,n)},i.rotationWithSnapping=b((function(t,e,n,r){var i=e,o=i.target,a=o.translateToOriginPoint(o.getCenterPoint(),i.originX,i.originY);if(o.lockRotation)return!1;var s,l=Math.atan2(i.ey-a.y,i.ex-a.x),c=Math.atan2(r-a.y,n-a.x),h=u(c-l+i.theta);if(0<o.snapAngle){var f=o.snapAngle,p=o.snapThreshold||f,g=Math.ceil(h/f)*f,v=Math.floor(h/f)*f;Math.abs(h-v)<p?h=v:Math.abs(h-g)<p&&(h=g)}return h<0&&(h=360+h),h%=360,s=o.angle!==h,o.angle=h,s&&d("rotating",y(t,e,n,r)),s})),i.scalingEqually=b((function(t,e,n,r){return _(t,e,n,r)})),i.scalingX=b((function(t,e,n,r){return _(t,e,n,r,{by:"x"})})),i.scalingY=b((function(t,e,n,r){return _(t,e,n,r,{by:"y"})})),i.scalingYOrSkewingX=function(t,e,n,r){return t[e.target.canvas.altActionKey]?i.skewHandlerX(t,e,n,r):i.scalingY(t,e,n,r)},i.scalingXOrSkewingY=function(t,e,n,r){return t[e.target.canvas.altActionKey]?i.skewHandlerY(t,e,n,r):i.scalingX(t,e,n,r)},i.changeWidth=b((function(t,e,n,r){var i,o=e.target,a=x(e,e.originX,e.originY,n,r),s=o.strokeWidth/(o.strokeUniform?o.scaleX:1),l=v(e)?2:1,c=o.width,h=Math.abs(a.x*l/o.scaleX)-s;return o.set("width",Math.max(h,0)),(i=c!==h)&&d("resizing",y(t,e,n,r)),i})),i.skewHandlerX=function(t,e,n,r){var i,l=e.target,h=l.skewX,u=e.originY;return!l.lockSkewingX&&(0===h?i=0<x(e,c,c,n,r).x?o:s:(0<h&&(i=u===a?o:s),h<0&&(i=u===a?s:o),w(l)&&(i=i===o?s:o)),e.originX=i,b(C)(t,e,n,r))},i.skewHandlerY=function(t,e,n,r){var i,s=e.target,h=s.skewY,u=e.originX;return!s.lockSkewingY&&(0===h?i=0<x(e,c,c,n,r).y?a:l:(0<h&&(i=u===o?a:l),h<0&&(i=u===o?l:a),w(s)&&(i=i===a?l:a)),e.originY=i,b(T)(t,e,n,r))},i.dragHandler=function(t,e,n,r){var i=e.target,o=n-e.offsetX,a=r-e.offsetY,s=!i.get("lockMovementX")&&i.left!==o,l=!i.get("lockMovementY")&&i.top!==a;return s&&i.set("left",o),l&&i.set("top",a),(s||l)&&d("moving",y(t,e,n,r)),s||l},i.scaleOrSkewActionName=function(t,e,n){var r=t[n.canvas.altActionKey];return 0===e.x?r?"skewX":"scaleY":0===e.y?r?"skewY":"scaleX":void 0},i.rotationStyleHandler=function(t,e,n){return n.lockRotation?"not-allowed":e.cursorStyle},i.fireEvent=d,i.wrapWithFixedAnchor=b,i.getLocalPoint=x,e.controlsUtils=i}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.degreesToRadians,r=e.controlsUtils;r.renderCircleControl=function(t,e,n,r,i){r=r||{};var o,a=this.sizeX||r.cornerSize||i.cornerSize,s=this.sizeY||r.cornerSize||i.cornerSize,l=void 0!==r.transparentCorners?r.transparentCorners:this.transparentCorners,c=l?"stroke":"fill",h=!l&&(r.cornerStrokeColor||i.cornerStrokeColor),u=e,f=n;t.save(),t.fillStyle=r.cornerColor||i.cornerColor,t.strokeStyle=r.cornerStrokeColor||i.cornerStrokeColor,s<a?(o=a,t.scale(1,s/a),f=n*a/s):a<s?(o=s,t.scale(a/s,1),u=e*s/a):o=a,t.lineWidth=1,t.beginPath(),t.arc(u,f,o/2,0,2*Math.PI,!1),t[c](),h&&t.stroke(),t.restore()},r.renderSquareControl=function(t,e,r,i,o){i=i||{};var a=this.sizeX||i.cornerSize||o.cornerSize,s=this.sizeY||i.cornerSize||o.cornerSize,l=void 0!==i.transparentCorners?i.transparentCorners:o.transparentCorners,c=l?"stroke":"fill",h=!l&&(i.cornerStrokeColor||o.cornerStrokeColor),u=a/2,f=s/2;t.save(),t.fillStyle=i.cornerColor||o.cornerColor,t.strokeStyle=i.strokeCornerColor||o.strokeCornerColor,t.lineWidth=1,t.translate(e,r),t.rotate(n(o.angle)),t[c+"Rect"](-u,-f,a,s),h&&t.strokeRect(-u,-f,a,s),t.restore()}}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Control=function(t){for(var e in t)this[e]=t[e]},e.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(t,e){return e.cursorStyle},getActionName:function(t,e){return e.actionName},getVisibility:function(t,e){var n=t._controlsVisibility;return n&&void 0!==n[e]?n[e]:this.visible},setVisibility:function(t){this.visible=t},positionHandler:function(t,n){return e.util.transformPoint({x:this.x*t.x+this.offsetX,y:this.y*t.y+this.offsetY},n)},calcCornerCoords:function(t,n,r,i,o){var a,s,l,c,h=o?this.touchSizeX:this.sizeX,u=o?this.touchSizeY:this.sizeY;if(h&&u&&h!==u){var f=Math.atan2(u,h),p=Math.sqrt(h*h+u*u)/2,d=f-e.util.degreesToRadians(t),g=Math.PI/2-f-e.util.degreesToRadians(t);a=p*e.util.cos(d),s=p*e.util.sin(d),l=p*e.util.cos(g),c=p*e.util.sin(g)}else p=.7071067812*(h&&u?h:n),d=e.util.degreesToRadians(45-t),a=l=p*e.util.cos(d),s=c=p*e.util.sin(d);return{tl:{x:r-c,y:i-l},tr:{x:r+a,y:i-s},bl:{x:r-a,y:i+s},br:{x:r+c,y:i+l}}},render:function(t,n,r,i,o){switch((i=i||{}).cornerStyle||o.cornerStyle){case"circle":e.controlsUtils.renderCircleControl.call(this,t,n,r,i,o);break;default:e.controlsUtils.renderSquareControl.call(this,t,n,r,i,o)}}}}(e),function(){function t(t,e){var n,r,i,o,a=t.getAttribute("style"),s=t.getAttribute("offset")||0;if(s=(s=parseFloat(s)/(/%$/.test(s)?100:1))<0?0:1<s?1:s,a){var l=a.split(/\s*;\s*/);for(""===l[l.length-1]&&l.pop(),o=l.length;o--;){var c=l[o].split(/\s*:\s*/),h=c[0].trim(),u=c[1].trim();"stop-color"===h?n=u:"stop-opacity"===h&&(i=u)}}return n||(n=t.getAttribute("stop-color")||"rgb(0,0,0)"),i||(i=t.getAttribute("stop-opacity")),r=(n=new d.Color(n)).getAlpha(),i=isNaN(parseFloat(i))?1:parseFloat(i),i*=r*e,{offset:s,color:n.toRgb(),opacity:i}}var e=d.util.object.clone;d.Gradient=d.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(t){t||(t={}),t.coords||(t.coords={});var e,n=this;Object.keys(t).forEach((function(e){n[e]=t[e]})),this.id?this.id+="_"+d.Object.__uid++:this.id=d.Object.__uid++,e={x1:t.coords.x1||0,y1:t.coords.y1||0,x2:t.coords.x2||0,y2:t.coords.y2||0},"radial"===this.type&&(e.r1=t.coords.r1||0,e.r2=t.coords.r2||0),this.coords=e,this.colorStops=t.colorStops.slice()},addColorStop:function(t){for(var e in t){var n=new d.Color(t[e]);this.colorStops.push({offset:parseFloat(e),color:n.toRgb(),opacity:n.getAlpha()})}return this},toObject:function(t){var e={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return d.util.populateWithProperties(this,e,t),e},toSVG:function(t,n){var r,i,o,a,s=e(this.coords,!0),l=(n=n||{},e(this.colorStops,!0)),c=s.r1>s.r2,h=this.gradientTransform?this.gradientTransform.concat():d.iMatrix.concat(),u=-this.offsetX,f=-this.offsetY,p=!!n.additionalTransform,g="pixels"===this.gradientUnits?"userSpaceOnUse":"objectBoundingBox";if(l.sort((function(t,e){return t.offset-e.offset})),"objectBoundingBox"===g?(u/=t.width,f/=t.height):(u+=t.width/2,f+=t.height/2),"path"===t.type&&"percentage"!==this.gradientUnits&&(u-=t.pathOffset.x,f-=t.pathOffset.y),h[4]-=u,h[5]-=f,a='id="SVGID_'+this.id+'" gradientUnits="'+g+'"',a+=' gradientTransform="'+(p?n.additionalTransform+" ":"")+d.util.matrixToSVG(h)+'" ',"linear"===this.type?o=["<linearGradient ",a,' x1="',s.x1,'" y1="',s.y1,'" x2="',s.x2,'" y2="',s.y2,'">\n']:"radial"===this.type&&(o=["<radialGradient ",a,' cx="',c?s.x1:s.x2,'" cy="',c?s.y1:s.y2,'" r="',c?s.r1:s.r2,'" fx="',c?s.x2:s.x1,'" fy="',c?s.y2:s.y1,'">\n']),"radial"===this.type){if(c)for((l=l.concat()).reverse(),r=0,i=l.length;r<i;r++)l[r].offset=1-l[r].offset;var v=Math.min(s.r1,s.r2);if(0<v){var m=v/Math.max(s.r1,s.r2);for(r=0,i=l.length;r<i;r++)l[r].offset+=m*(1-l[r].offset)}}for(r=0,i=l.length;r<i;r++){var y=l[r];o.push("<stop ",'offset="',100*y.offset+"%",'" style="stop-color:',y.color,void 0!==y.opacity?";stop-opacity: "+y.opacity:";",'"/>\n')}return o.push("linear"===this.type?"</linearGradient>\n":"</radialGradient>\n"),o.join("")},toLive:function(t){var e,n,r,i=d.util.object.clone(this.coords);if(this.type){for("linear"===this.type?e=t.createLinearGradient(i.x1,i.y1,i.x2,i.y2):"radial"===this.type&&(e=t.createRadialGradient(i.x1,i.y1,i.r1,i.x2,i.y2,i.r2)),n=0,r=this.colorStops.length;n<r;n++){var o=this.colorStops[n].color,a=this.colorStops[n].opacity,s=this.colorStops[n].offset;void 0!==a&&(o=new d.Color(o).setAlpha(a).toRgba()),e.addColorStop(s,o)}return e}}}),d.util.object.extend(d.Gradient,{fromElement:function(e,n,r,i){var o=parseFloat(r)/(/%$/.test(r)?100:1);o=o<0?0:1<o?1:o,isNaN(o)&&(o=1);var a,s,l,c,h,u,f,p,g,v,m,y=e.getElementsByTagName("stop"),b="userSpaceOnUse"===e.getAttribute("gradientUnits")?"pixels":"percentage",x=e.getAttribute("gradientTransform")||"",w=[],S=0,C=0;for("linearGradient"===e.nodeName||"LINEARGRADIENT"===e.nodeName?(a="linear",s={x1:(u=e).getAttribute("x1")||0,y1:u.getAttribute("y1")||0,x2:u.getAttribute("x2")||"100%",y2:u.getAttribute("y2")||0}):(a="radial",s={x1:(h=e).getAttribute("fx")||h.getAttribute("cx")||"50%",y1:h.getAttribute("fy")||h.getAttribute("cy")||"50%",r1:0,x2:h.getAttribute("cx")||"50%",y2:h.getAttribute("cy")||"50%",r2:h.getAttribute("r")||"50%"}),l=y.length;l--;)w.push(t(y[l],o));return c=d.parseTransformAttribute(x),f=s,p=i,g=b,Object.keys(f).forEach((function(t){"Infinity"===(v=f[t])?m=1:"-Infinity"===v?m=0:(m=parseFloat(f[t],10),"string"==typeof v&&/^(\d+\.\d+)%|(\d+)%$/.test(v)&&(m*=.01,"pixels"===g&&("x1"!==t&&"x2"!==t&&"r2"!==t||(m*=p.viewBoxWidth||p.width),"y1"!==t&&"y2"!==t||(m*=p.viewBoxHeight||p.height)))),f[t]=m})),"pixels"===b&&(S=-n.left,C=-n.top),new d.Gradient({id:e.getAttribute("id"),type:a,coords:s,colorStops:w,gradientUnits:b,gradientTransform:c,offsetX:S,offsetY:C})}})}(),function(){"use strict";var t=d.util.toFixed;d.Pattern=d.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(t,e){if(t||(t={}),this.id=d.Object.__uid++,this.setOptions(t),!t.source||t.source&&"string"!=typeof t.source)e&&e(this);else{var n=this;this.source=d.util.createImage(),d.util.loadImage(t.source,(function(t,r){n.source=t,e&&e(n,r)}),null,this.crossOrigin)}},toObject:function(e){var n,r,i=d.Object.NUM_FRACTION_DIGITS;return"string"==typeof this.source.src?n=this.source.src:"object"==typeof this.source&&this.source.toDataURL&&(n=this.source.toDataURL()),r={type:"pattern",source:n,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:t(this.offsetX,i),offsetY:t(this.offsetY,i),patternTransform:this.patternTransform?this.patternTransform.concat():null},d.util.populateWithProperties(this,r,e),r},toSVG:function(t){var e="function"==typeof this.source?this.source():this.source,n=e.width/t.width,r=e.height/t.height,i=this.offsetX/t.width,o=this.offsetY/t.height,a="";return"repeat-x"!==this.repeat&&"no-repeat"!==this.repeat||(r=1,o&&(r+=Math.abs(o))),"repeat-y"!==this.repeat&&"no-repeat"!==this.repeat||(n=1,i&&(n+=Math.abs(i))),e.src?a=e.src:e.toDataURL&&(a=e.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+i+'" y="'+o+'" width="'+n+'" height="'+r+'">\n<image x="0" y="0" width="'+e.width+'" height="'+e.height+'" xlink:href="'+a+'"></image>\n</pattern>\n'},setOptions:function(t){for(var e in t)this[e]=t[e]},toLive:function(t){var e=this.source;if(!e)return"";if(void 0!==e.src){if(!e.complete)return"";if(0===e.naturalWidth||0===e.naturalHeight)return""}return t.createPattern(e,this.repeat)}})}(),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.toFixed;e.Shadow?e.warn("fabric.Shadow is already defined."):(e.Shadow=e.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(t){for(var n in"string"==typeof t&&(t=this._parseShadow(t)),t)this[n]=t[n];this.id=e.Object.__uid++},_parseShadow:function(t){var n=t.trim(),r=e.Shadow.reOffsetsAndBlur.exec(n)||[];return{color:(n.replace(e.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)").trim(),offsetX:parseInt(r[1],10)||0,offsetY:parseInt(r[2],10)||0,blur:parseInt(r[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(t){var r=40,i=40,o=e.Object.NUM_FRACTION_DIGITS,a=e.util.rotateVector({x:this.offsetX,y:this.offsetY},e.util.degreesToRadians(-t.angle)),s=new e.Color(this.color);return t.width&&t.height&&(r=100*n((Math.abs(a.x)+this.blur)/t.width,o)+20,i=100*n((Math.abs(a.y)+this.blur)/t.height,o)+20),t.flipX&&(a.x*=-1),t.flipY&&(a.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+i+'%" height="'+(100+2*i)+'%" x="-'+r+'%" width="'+(100+2*r)+'%" >\n\t<feGaussianBlur in="SourceAlpha" stdDeviation="'+n(this.blur?this.blur/2:0,o)+'"></feGaussianBlur>\n\t<feOffset dx="'+n(a.x,o)+'" dy="'+n(a.y,o)+'" result="oBlur" ></feOffset>\n\t<feFlood flood-color="'+s.toRgb()+'" flood-opacity="'+s.getAlpha()+'"/>\n\t<feComposite in2="oBlur" operator="in" />\n\t<feMerge>\n\t\t<feMergeNode></feMergeNode>\n\t\t<feMergeNode in="SourceGraphic"></feMergeNode>\n\t</feMerge>\n</filter>\n'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var t={},n=e.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach((function(e){this[e]!==n[e]&&(t[e]=this[e])}),this),t}}),e.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:px)?(?:\s?|$))?(-?\d+(?:px)?(?:\s?|$))?(\d+(?:px)?)?(?:\s?|$)(?:$|\s)/)}(e),function(){"use strict";if(d.StaticCanvas)d.warn("fabric.StaticCanvas is already defined.");else{var t=d.util.object.extend,e=d.util.getElementOffset,n=d.util.removeFromArray,r=d.util.toFixed,i=d.util.transformPoint,o=d.util.invertTransform,a=d.util.getNodeCanvas,s=d.util.createCanvasElement,l=new Error("Could not initialize `canvas` element");d.StaticCanvas=d.util.createClass(d.CommonMethods,{initialize:function(t,e){e||(e={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(t,e)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:d.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(t,e){var n=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(t),this._initOptions(e),this.interactive||this._initRetinaScaling(),e.overlayImage&&this.setOverlayImage(e.overlayImage,n),e.backgroundImage&&this.setBackgroundImage(e.backgroundImage,n),e.backgroundColor&&this.setBackgroundColor(e.backgroundColor,n),e.overlayColor&&this.setOverlayColor(e.overlayColor,n),this.calcOffset()},_isRetinaScaling:function(){return 1!==d.devicePixelRatio&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?d.devicePixelRatio:1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var t=d.devicePixelRatio;this.__initRetinaScaling(t,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(t,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(t,e,n){e.setAttribute("width",this.width*t),e.setAttribute("height",this.height*t),n.scale(t,t)},calcOffset:function(){return this._offset=e(this.lowerCanvasEl),this},setOverlayImage:function(t,e,n){return this.__setBgOverlayImage("overlayImage",t,e,n)},setBackgroundImage:function(t,e,n){return this.__setBgOverlayImage("backgroundImage",t,e,n)},setOverlayColor:function(t,e){return this.__setBgOverlayColor("overlayColor",t,e)},setBackgroundColor:function(t,e){return this.__setBgOverlayColor("backgroundColor",t,e)},__setBgOverlayImage:function(t,e,n,r){return"string"==typeof e?d.util.loadImage(e,(function(e,i){if(e){var o=new d.Image(e,r);(this[t]=o).canvas=this}n&&n(e,i)}),this,r&&r.crossOrigin):(r&&e.setOptions(r),(this[t]=e)&&(e.canvas=this),n&&n(e,!1)),this},__setBgOverlayColor:function(t,e,n){return this[t]=e,this._initGradient(e,t),this._initPattern(e,t,n),this},_createCanvasElement:function(){var t=s();if(!t)throw l;if(t.style||(t.style={}),void 0===t.getContext)throw l;return t},_initOptions:function(t){var e=this.lowerCanvasEl;this._setOptions(t),this.width=this.width||parseInt(e.width,10)||0,this.height=this.height||parseInt(e.height,10)||0,this.lowerCanvasEl.style&&(e.width=this.width,e.height=this.height,e.style.width=this.width+"px",e.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(t){t&&t.getContext?this.lowerCanvasEl=t:this.lowerCanvasEl=d.util.getById(t)||this._createCanvasElement(),d.util.addClass(this.lowerCanvasEl,"lower-canvas"),this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(t,e){return this.setDimensions({width:t},e)},setHeight:function(t,e){return this.setDimensions({height:t},e)},setDimensions:function(t,e){var n;for(var r in e=e||{},t)n=t[r],e.cssOnly||(this._setBackstoreDimension(r,t[r]),n+="px",this.hasLostContext=!0),e.backstoreOnly||this._setCssDimension(r,n);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(),this._initRetinaScaling(),this.calcOffset(),e.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(t,e){return this.lowerCanvasEl[t]=e,this.upperCanvasEl&&(this.upperCanvasEl[t]=e),this.cacheCanvasEl&&(this.cacheCanvasEl[t]=e),this[t]=e,this},_setCssDimension:function(t,e){return this.lowerCanvasEl.style[t]=e,this.upperCanvasEl&&(this.upperCanvasEl.style[t]=e),this.wrapperEl&&(this.wrapperEl.style[t]=e),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(t){var e,n,r,i=this._activeObject;for(this.viewportTransform=t,n=0,r=this._objects.length;n<r;n++)(e=this._objects[n]).group||e.setCoords(!0);return i&&i.setCoords(),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(t,e){var n=t,r=this.viewportTransform.slice(0);t=i(t,o(this.viewportTransform)),r[0]=e,r[3]=e;var a=i(t,r);return r[4]+=n.x-a.x,r[5]+=n.y-a.y,this.setViewportTransform(r)},setZoom:function(t){return this.zoomToPoint(new d.Point(0,0),t),this},absolutePan:function(t){var e=this.viewportTransform.slice(0);return e[4]=-t.x,e[5]=-t.y,this.setViewportTransform(e)},relativePan:function(t){return this.absolutePan(new d.Point(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(t){this.stateful&&t.setupState(),t._set("canvas",this),t.setCoords(),this.fire("object:added",{target:t}),t.fire("added")},_onObjectRemoved:function(t){this.fire("object:removed",{target:t}),t.fire("removed"),delete t.canvas},clearContext:function(t){return t.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this._objects.length=0,this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var t=this.contextContainer;return this.renderCanvas(t,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=d.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var t={},e=this.width,n=this.height,r=o(this.viewportTransform);return t.tl=i({x:0,y:0},r),t.br=i({x:e,y:n},r),t.tr=new d.Point(t.br.x,t.tl.y),t.bl=new d.Point(t.tl.x,t.br.y),this.vptCoords=t},cancelRequestedRender:function(){this.isRendering&&(d.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(t,e){var n=this.viewportTransform,r=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(t),d.util.setImageSmoothing(t,this.imageSmoothingEnabled),this.fire("before:render",{ctx:t}),this._renderBackground(t),t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._renderObjects(t,e),t.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),r&&(r.canvas=this,r.shouldCache(),r._transformDone=!0,r.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(t)),this._renderOverlay(t),this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),this.fire("after:render",{ctx:t})},drawClipPathOnCanvas:function(t){var e=this.viewportTransform,n=this.clipPath;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t.globalCompositeOperation="destination-in",n.transform(t),t.scale(1/n.zoomX,1/n.zoomY),t.drawImage(n._cacheCanvas,-n.cacheTranslationX,-n.cacheTranslationY),t.restore()},_renderObjects:function(t,e){var n,r;for(n=0,r=e.length;n<r;++n)e[n]&&e[n].render(t)},_renderBackgroundOrOverlay:function(t,e){var n=this[e+"Color"],r=this[e+"Image"],i=this.viewportTransform,o=this[e+"Vpt"];if(n||r){if(n){t.save(),t.beginPath(),t.moveTo(0,0),t.lineTo(this.width,0),t.lineTo(this.width,this.height),t.lineTo(0,this.height),t.closePath(),t.fillStyle=n.toLive?n.toLive(t,this):n,o&&t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),t.transform(1,0,0,1,n.offsetX||0,n.offsetY||0);var a=n.gradientTransform||n.patternTransform;a&&t.transform(a[0],a[1],a[2],a[3],a[4],a[5]),t.fill(),t.restore()}r&&(t.save(),o&&t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),r.render(t),t.restore())}},_renderBackground:function(t){this._renderBackgroundOrOverlay(t,"background")},_renderOverlay:function(t){this._renderBackgroundOrOverlay(t,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},centerObjectH:function(t){return this._centerObject(t,new d.Point(this.getCenter().left,t.getCenterPoint().y))},centerObjectV:function(t){return this._centerObject(t,new d.Point(t.getCenterPoint().x,this.getCenter().top))},centerObject:function(t){var e=this.getCenter();return this._centerObject(t,new d.Point(e.left,e.top))},viewportCenterObject:function(t){var e=this.getVpCenter();return this._centerObject(t,e)},viewportCenterObjectH:function(t){var e=this.getVpCenter();return this._centerObject(t,new d.Point(e.x,t.getCenterPoint().y)),this},viewportCenterObjectV:function(t){var e=this.getVpCenter();return this._centerObject(t,new d.Point(t.getCenterPoint().x,e.y))},getVpCenter:function(){var t=this.getCenter(),e=o(this.viewportTransform);return i({x:t.left,y:t.top},e)},_centerObject:function(t,e){return t.setPositionByOrigin(e,"center","center"),t.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(t){return this.toDatalessObject(t)},toObject:function(t){return this._toObjectMethod("toObject",t)},toDatalessObject:function(t){return this._toObjectMethod("toDatalessObject",t)},_toObjectMethod:function(e,n){var r=this.clipPath,i={version:d.version,objects:this._toObjects(e,n)};return r&&(i.clipPath=this._toObject(this.clipPath,e,n)),t(i,this.__serializeBgOverlay(e,n)),d.util.populateWithProperties(this,i,n),i},_toObjects:function(t,e){return this._objects.filter((function(t){return!t.excludeFromExport})).map((function(n){return this._toObject(n,t,e)}),this)},_toObject:function(t,e,n){var r;this.includeDefaultValues||(r=t.includeDefaultValues,t.includeDefaultValues=!1);var i=t[e](n);return this.includeDefaultValues||(t.includeDefaultValues=r),i},__serializeBgOverlay:function(t,e){var n={},r=this.backgroundImage,i=this.overlayImage;return this.backgroundColor&&(n.background=this.backgroundColor.toObject?this.backgroundColor.toObject(e):this.backgroundColor),this.overlayColor&&(n.overlay=this.overlayColor.toObject?this.overlayColor.toObject(e):this.overlayColor),r&&!r.excludeFromExport&&(n.backgroundImage=this._toObject(r,t,e)),i&&!i.excludeFromExport&&(n.overlayImage=this._toObject(i,t,e)),n},svgViewportTransformation:!0,toSVG:function(t,e){t||(t={}),t.reviver=e;var n=[];return this._setSVGPreamble(n,t),this._setSVGHeader(n,t),this.clipPath&&n.push('<g clip-path="url(#'+this.clipPath.clipPathId+')" >\n'),this._setSVGBgOverlayColor(n,"background"),this._setSVGBgOverlayImage(n,"backgroundImage",e),this._setSVGObjects(n,e),this.clipPath&&n.push("</g>\n"),this._setSVGBgOverlayColor(n,"overlay"),this._setSVGBgOverlayImage(n,"overlayImage",e),n.push("</svg>"),n.join("")},_setSVGPreamble:function(t,e){e.suppressPreamble||t.push('<?xml version="1.0" encoding="',e.encoding||"UTF-8",'" standalone="no" ?>\n','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(t,e){var n,i=e.width||this.width,o=e.height||this.height,a='viewBox="0 0 '+this.width+" "+this.height+'" ',s=d.Object.NUM_FRACTION_DIGITS;e.viewBox?a='viewBox="'+e.viewBox.x+" "+e.viewBox.y+" "+e.viewBox.width+" "+e.viewBox.height+'" ':this.svgViewportTransformation&&(n=this.viewportTransform,a='viewBox="'+r(-n[4]/n[0],s)+" "+r(-n[5]/n[3],s)+" "+r(this.width/n[0],s)+" "+r(this.height/n[3],s)+'" '),t.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',i,'" ','height="',o,'" ',a,'xml:space="preserve">\n',"<desc>Created with Fabric.js ",d.version,"</desc>\n","<defs>\n",this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(e),"</defs>\n")},createSVGClipPathMarkup:function(t){var e=this.clipPath;return e?(e.clipPathId="CLIPPATH_"+d.Object.__uid++,'<clipPath id="'+e.clipPathId+'" >\n'+this.clipPath.toClipPathSVG(t.reviver)+"</clipPath>\n"):""},createSVGRefElementsMarkup:function(){var t=this;return["background","overlay"].map((function(e){var n=t[e+"Color"];if(n&&n.toLive){var r=t[e+"Vpt"],i=t.viewportTransform,o={width:t.width/(r?i[0]:1),height:t.height/(r?i[3]:1)};return n.toSVG(o,{additionalTransform:r?d.util.matrixToSVG(i):""})}})).join("")},createSVGFontFacesMarkup:function(){var t,e,n,r,i,o,a,s,l="",c={},h=d.fontPaths,u=[];for(this._objects.forEach((function t(e){u.push(e),e._objects&&e._objects.forEach(t)})),a=0,s=u.length;a<s;a++)if(e=(t=u[a]).fontFamily,-1!==t.type.indexOf("text")&&!c[e]&&h[e]&&(c[e]=!0,t.styles))for(i in n=t.styles)for(o in r=n[i])!c[e=r[o].fontFamily]&&h[e]&&(c[e]=!0);for(var f in c)l+=["\t\t@font-face {\n","\t\t\tfont-family: '",f,"';\n","\t\t\tsrc: url('",h[f],"');\n","\t\t}\n"].join("");return l&&(l=['\t<style type="text/css">',"<![CDATA[\n",l,"]]>","</style>\n"].join("")),l},_setSVGObjects:function(t,e){var n,r,i,o=this._objects;for(r=0,i=o.length;r<i;r++)(n=o[r]).excludeFromExport||this._setSVGObject(t,n,e)},_setSVGObject:function(t,e,n){t.push(e.toSVG(n))},_setSVGBgOverlayImage:function(t,e,n){this[e]&&!this[e].excludeFromExport&&this[e].toSVG&&t.push(this[e].toSVG(n))},_setSVGBgOverlayColor:function(t,e){var n=this[e+"Color"],r=this.viewportTransform,i=this.width,o=this.height;if(n)if(n.toLive){var a=n.repeat,s=d.util.invertTransform(r),l=this[e+"Vpt"]?d.util.matrixToSVG(s):"";t.push('<rect transform="'+l+" translate(",i/2,",",o/2,')"',' x="',n.offsetX-i/2,'" y="',n.offsetY-o/2,'" ','width="',"repeat-y"===a||"no-repeat"===a?n.source.width:i,'" height="',"repeat-x"===a||"no-repeat"===a?n.source.height:o,'" fill="url(#SVGID_'+n.id+')"',"></rect>\n")}else t.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',n,'"',"></rect>\n")},sendToBack:function(t){if(!t)return this;var e,r,i,o=this._activeObject;if(t===o&&"activeSelection"===t.type)for(e=(i=o._objects).length;e--;)r=i[e],n(this._objects,r),this._objects.unshift(r);else n(this._objects,t),this._objects.unshift(t);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(t){if(!t)return this;var e,r,i,o=this._activeObject;if(t===o&&"activeSelection"===t.type)for(i=o._objects,e=0;e<i.length;e++)r=i[e],n(this._objects,r),this._objects.push(r);else n(this._objects,t),this._objects.push(t);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(t,e){if(!t)return this;var r,i,o,a,s,l=this._activeObject,c=0;if(t===l&&"activeSelection"===t.type)for(s=l._objects,r=0;r<s.length;r++)i=s[r],0+c<(o=this._objects.indexOf(i))&&(a=o-1,n(this._objects,i),this._objects.splice(a,0,i)),c++;else 0!==(o=this._objects.indexOf(t))&&(a=this._findNewLowerIndex(t,o,e),n(this._objects,t),this._objects.splice(a,0,t));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(t,e,n){var r,i;if(n){for(i=(r=e)-1;0<=i;--i)if(t.intersectsWithObject(this._objects[i])||t.isContainedWithinObject(this._objects[i])||this._objects[i].isContainedWithinObject(t)){r=i;break}}else r=e-1;return r},bringForward:function(t,e){if(!t)return this;var r,i,o,a,s,l=this._activeObject,c=0;if(t===l&&"activeSelection"===t.type)for(r=(s=l._objects).length;r--;)i=s[r],(o=this._objects.indexOf(i))<this._objects.length-1-c&&(a=o+1,n(this._objects,i),this._objects.splice(a,0,i)),c++;else(o=this._objects.indexOf(t))!==this._objects.length-1&&(a=this._findNewUpperIndex(t,o,e),n(this._objects,t),this._objects.splice(a,0,t));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(t,e,n){var r,i,o;if(n){for(i=(r=e)+1,o=this._objects.length;i<o;++i)if(t.intersectsWithObject(this._objects[i])||t.isContainedWithinObject(this._objects[i])||this._objects[i].isContainedWithinObject(t)){r=i;break}}else r=e+1;return r},moveTo:function(t,e){return n(this._objects,t),this._objects.splice(e,0,t),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(d.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject((function(t){t.dispose&&t.dispose()})),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,d.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),t(d.StaticCanvas.prototype,d.Observable),t(d.StaticCanvas.prototype,d.Collection),t(d.StaticCanvas.prototype,d.DataURLExporter),t(d.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(t){var e=s();if(!e||!e.getContext)return null;var n=e.getContext("2d");if(!n)return null;switch(t){case"setLineDash":return void 0!==n.setLineDash;default:return null}}}),d.StaticCanvas.prototype.toJSON=d.StaticCanvas.prototype.toObject,d.isLikelyNode&&(d.StaticCanvas.prototype.createPNGStream=function(){var t=a(this.lowerCanvasEl);return t&&t.createPNGStream()},d.StaticCanvas.prototype.createJPEGStream=function(t){var e=a(this.lowerCanvasEl);return e&&e.createJPEGStream(t)})}}(),d.BaseBrush=d.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,_setBrushStyles:function(){var t=this.canvas.contextTop;t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.miterLimit=this.strokeMiterLimit,t.lineJoin=this.strokeLineJoin,d.StaticCanvas.supports("setLineDash")&&t.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(t){var e=this.canvas.viewportTransform;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5])},_setShadow:function(){if(this.shadow){var t=this.canvas,e=this.shadow,n=t.contextTop,r=t.getZoom();t&&t._isRetinaScaling()&&(r*=d.devicePixelRatio),n.shadowColor=e.color,n.shadowBlur=e.blur*r,n.shadowOffsetX=e.offsetX*r,n.shadowOffsetY=e.offsetY*r}},needsFullRender:function(){return new d.Color(this.color).getAlpha()<1||!!this.shadow},_resetShadow:function(){var t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0}}),d.PencilBrush=d.util.createClass(d.BaseBrush,{decimate:.4,initialize:function(t){this.canvas=t,this._points=[]},_drawSegment:function(t,e,n){var r=e.midPointFrom(n);return t.quadraticCurveTo(e.x,e.y,r.x,r.y),r},onMouseDown:function(t,e){this.canvas._isMainEvent(e.e)&&(this._prepareForDrawing(t),this._captureDrawingPath(t),this._render())},onMouseMove:function(t,e){if(this.canvas._isMainEvent(e.e)&&this._captureDrawingPath(t)&&1<this._points.length)if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var n=this._points,r=n.length,i=this.canvas.contextTop;this._saveAndTransform(i),this.oldEnd&&(i.beginPath(),i.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(i,n[r-2],n[r-1],!0),i.stroke(),i.restore()}},onMouseUp:function(t){return!this.canvas._isMainEvent(t.e)||(this.oldEnd=void 0,this._finalizeAndAddPath(),!1)},_prepareForDrawing:function(t){var e=new d.Point(t.x,t.y);this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y)},_addPoint:function(t){return!(1<this._points.length&&t.eq(this._points[this._points.length-1])||(this._points.push(t),0))},_reset:function(){this._points=[],this._setBrushStyles(),this._setShadow()},_captureDrawingPath:function(t){var e=new d.Point(t.x,t.y);return this._addPoint(e)},_render:function(){var t,e,n=this.canvas.contextTop,r=this._points[0],i=this._points[1];if(this._saveAndTransform(n),n.beginPath(),2===this._points.length&&r.x===i.x&&r.y===i.y){var o=this.width/1e3;r=new d.Point(r.x,r.y),i=new d.Point(i.x,i.y),r.x-=o,i.x+=o}for(n.moveTo(r.x,r.y),t=1,e=this._points.length;t<e;t++)this._drawSegment(n,r,i),r=this._points[t],i=this._points[t+1];n.lineTo(r.x,r.y),n.stroke(),n.restore()},convertPointsToSVGPath:function(t){var e,n=[],r=this.width/1e3,i=new d.Point(t[0].x,t[0].y),o=new d.Point(t[1].x,t[1].y),a=t.length,s=1,l=0,c=2<a;for(c&&(s=t[2].x<o.x?-1:t[2].x===o.x?0:1,l=t[2].y<o.y?-1:t[2].y===o.y?0:1),n.push("M ",i.x-s*r," ",i.y-l*r," "),e=1;e<a;e++){if(!i.eq(o)){var h=i.midPointFrom(o);n.push("Q ",i.x," ",i.y," ",h.x," ",h.y," ")}i=t[e],e+1<t.length&&(o=t[e+1])}return c&&(s=i.x>t[e-2].x?1:i.x===t[e-2].x?0:-1,l=i.y>t[e-2].y?1:i.y===t[e-2].y?0:-1),n.push("L ",i.x+s*r," ",i.y+l*r),n},createPath:function(t){var e=new d.Path(t,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,e.shadow=new d.Shadow(this.shadow)),e},decimatePoints:function(t,e){if(t.length<=2)return t;var n,r=this.canvas.getZoom(),i=Math.pow(e/r,2),o=t.length-1,a=t[0],s=[a];for(n=1;n<o;n++)i<=Math.pow(a.x-t[n].x,2)+Math.pow(a.y-t[n].y,2)&&(a=t[n],s.push(a));return 1===s.length&&s.push(new d.Point(s[0].x,s[0].y)),s},_finalizeAndAddPath:function(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var t=this.convertPointsToSVGPath(this._points).join("");if("M 0 0 Q 0 0 0 0 L 0 0"!==t){var e=this.createPath(t);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:e}),this.canvas.add(e),this.canvas.requestRenderAll(),e.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:e})}else this.canvas.requestRenderAll()}}),d.CircleBrush=d.util.createClass(d.BaseBrush,{width:10,initialize:function(t){this.canvas=t,this.points=[]},drawDot:function(t){var e=this.addPoint(t),n=this.canvas.contextTop;this._saveAndTransform(n),this.dot(n,e),n.restore()},dot:function(t,e){t.fillStyle=e.fill,t.beginPath(),t.arc(e.x,e.y,e.radius,0,2*Math.PI,!1),t.closePath(),t.fill()},onMouseDown:function(t){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(t)},_render:function(){var t,e,n=this.canvas.contextTop,r=this.points;for(this._saveAndTransform(n),t=0,e=r.length;t<e;t++)this.dot(n,r[t]);n.restore()},onMouseMove:function(t){this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(t),this._render()):this.drawDot(t)},onMouseUp:function(){var t,e,n=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;var r=[];for(t=0,e=this.points.length;t<e;t++){var i=this.points[t],o=new d.Circle({radius:i.radius,left:i.x,top:i.y,originX:"center",originY:"center",fill:i.fill});this.shadow&&(o.shadow=new d.Shadow(this.shadow)),r.push(o)}var a=new d.Group(r);a.canvas=this.canvas,this.canvas.fire("before:path:created",{path:a}),this.canvas.add(a),this.canvas.fire("path:created",{path:a}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=n,this.canvas.requestRenderAll()},addPoint:function(t){var e=new d.Point(t.x,t.y),n=d.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,r=new d.Color(this.color).setAlpha(d.util.getRandomInt(0,100)/100).toRgba();return e.radius=n,e.fill=r,this.points.push(e),e}}),d.SprayBrush=d.util.createClass(d.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(t){this.canvas=t,this.sprayChunks=[]},onMouseDown:function(t){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(t),this.render(this.sprayChunkPoints)},onMouseMove:function(t){this.addSprayChunk(t),this.render(this.sprayChunkPoints)},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],n=0,r=this.sprayChunks.length;n<r;n++)for(var i=this.sprayChunks[n],o=0,a=i.length;o<a;o++){var s=new d.Rect({width:i[o].width,height:i[o].width,left:i[o].x+1,top:i[o].y+1,originX:"center",originY:"center",fill:this.color});e.push(s)}this.optimizeOverlapping&&(e=this._getOptimizedRects(e));var l=new d.Group(e);this.shadow&&l.set("shadow",new d.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:l}),this.canvas.add(l),this.canvas.fire("path:created",{path:l}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.requestRenderAll()},_getOptimizedRects:function(t){var e,n,r,i={};for(n=0,r=t.length;n<r;n++)i[e=t[n].left+""+t[n].top]||(i[e]=t[n]);var o=[];for(e in i)o.push(i[e]);return o},render:function(t){var e,n,r=this.canvas.contextTop;for(r.fillStyle=this.color,this._saveAndTransform(r),e=0,n=t.length;e<n;e++){var i=t[e];void 0!==i.opacity&&(r.globalAlpha=i.opacity),r.fillRect(i.x,i.y,i.width,i.width)}r.restore()},_render:function(){var t,e,n=this.canvas.contextTop;for(n.fillStyle=this.color,this._saveAndTransform(n),t=0,e=this.sprayChunks.length;t<e;t++)this.render(this.sprayChunks[t]);n.restore()},addSprayChunk:function(t){this.sprayChunkPoints=[];var e,n,r,i,o=this.width/2;for(i=0;i<this.density;i++){e=d.util.getRandomInt(t.x-o,t.x+o),n=d.util.getRandomInt(t.y-o,t.y+o),r=this.dotWidthVariance?d.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var a=new d.Point(e,n);a.width=r,this.randomOpacity&&(a.opacity=d.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(a)}this.sprayChunks.push(this.sprayChunkPoints)}}),d.PatternBrush=d.util.createClass(d.PencilBrush,{getPatternSrc:function(){var t=d.util.createCanvasElement(),e=t.getContext("2d");return t.width=t.height=25,e.fillStyle=this.color,e.beginPath(),e.arc(10,10,10,0,2*Math.PI,!1),e.closePath(),e.fill(),t},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(){return this.canvas.contextTop.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(){this.callSuper("_setBrushStyles"),this.canvas.contextTop.strokeStyle=this.getPattern()},createPath:function(t){var e=this.callSuper("createPath",t),n=e._getLeftTopCoords().scalarAdd(e.strokeWidth/2);return e.stroke=new d.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-n.x,offsetY:-n.y}),e}}),function(){var t=d.util.getPointer,e=d.util.degreesToRadians,n=Math.abs,r=d.StaticCanvas.supports("setLineDash"),i=d.util.isTouchEvent;for(var o in d.Canvas=d.util.createClass(d.StaticCanvas,{initialize:function(t,e){e||(e={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(t,e),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",rotationCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=d.PencilBrush&&new d.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var t,e,n,r=this.getActiveObjects();if(0<r.length&&!this.preserveObjectStacking){e=[],n=[];for(var i=0,o=this._objects.length;i<o;i++)t=this._objects[i],-1===r.indexOf(t)?e.push(t):n.push(t);1<r.length&&(this._activeObject._objects=n),e.push.apply(e,n)}else e=this._objects;return e},renderAll:function(){!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&this.renderTopLayer(this.contextTop);var t=this.contextContainer;return this.renderCanvas(t,this._chooseObjectsToRender()),this},renderTopLayer:function(t){t.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(t),this.contextTopDirty=!0),t.restore()},renderTop:function(){var t=this.contextTop;return this.clearContext(t),this.renderTopLayer(t),this.fire("after:render"),this},_normalizePointer:function(t,e){var n=t.calcTransformMatrix(),r=d.util.invertTransform(n),i=this.restorePointerVpt(e);return d.util.transformPoint(i,r)},isTargetTransparent:function(t,e,n){if(t.shouldCache()&&t._cacheCanvas&&t!==this._activeObject){var r=this._normalizePointer(t,{x:e,y:n}),i=Math.max(t.cacheTranslationX+r.x*t.zoomX,0),o=Math.max(t.cacheTranslationY+r.y*t.zoomY,0);return d.util.isTransparent(t._cacheContext,Math.round(i),Math.round(o),this.targetFindTolerance)}var a=this.contextCache,s=t.selectionBackgroundColor,l=this.viewportTransform;return t.selectionBackgroundColor="",this.clearContext(a),a.save(),a.transform(l[0],l[1],l[2],l[3],l[4],l[5]),t.render(a),a.restore(),t===this._activeObject&&t._renderControls(a,{hasBorders:!1,transparentCorners:!1},{hasBorders:!1}),t.selectionBackgroundColor=s,d.util.isTransparent(a,e,n,this.targetFindTolerance)},_isSelectionKeyPressed:function(t){return"[object Array]"===Object.prototype.toString.call(this.selectionKey)?!!this.selectionKey.find((function(e){return!0===t[e]})):t[this.selectionKey]},_shouldClearSelection:function(t,e){var n=this.getActiveObjects(),r=this._activeObject;return!e||e&&r&&1<n.length&&-1===n.indexOf(e)&&r!==e&&!this._isSelectionKeyPressed(t)||e&&!e.evented||e&&!e.selectable&&r&&r!==e},_shouldCenterTransform:function(t,e,n){var r;if(t)return"scale"===e||"scaleX"===e||"scaleY"===e||"resizing"===e?r=this.centeredScaling||t.centeredScaling:"rotate"===e&&(r=this.centeredRotation||t.centeredRotation),r?!n:n},_getOriginFromCorner:function(t,e){var n={x:t.originX,y:t.originY};return"ml"===e||"tl"===e||"bl"===e?n.x="right":"mr"!==e&&"tr"!==e&&"br"!==e||(n.x="left"),"tl"===e||"mt"===e||"tr"===e?n.y="bottom":"bl"!==e&&"mb"!==e&&"br"!==e||(n.y="top"),n},_getActionFromCorner:function(t,e,n,r){if(!e||!t)return"drag";var i=r.controls[e];return i.getActionName(n,i,r)},_setupCurrentTransform:function(t,n,r){if(n){var i=this.getPointer(t),o=n.__corner,a=n.controls[o],s=r&&o?a.getActionHandler(t,n,a):d.controlsUtils.dragHandler,l=this._getActionFromCorner(r,o,t,n),c=this._getOriginFromCorner(n,o),h=t[this.centeredKey],u={target:n,action:l,actionHandler:s,corner:o,scaleX:n.scaleX,scaleY:n.scaleY,skewX:n.skewX,skewY:n.skewY,offsetX:i.x-n.left,offsetY:i.y-n.top,originX:c.x,originY:c.y,ex:i.x,ey:i.y,lastX:i.x,lastY:i.y,theta:e(n.angle),width:n.width*n.scaleX,shiftKey:t.shiftKey,altKey:h,original:d.util.saveObjectTransform(n)};this._shouldCenterTransform(n,l,h)&&(u.originX="center",u.originY="center"),u.original.originX=c.x,u.original.originY=c.y,this._currentTransform=u,this._beforeTransform(t)}},setCursor:function(t){this.upperCanvasEl.style.cursor=t},_drawSelection:function(t){var e=this._groupSelector,i=e.left,o=e.top,a=n(i),s=n(o);if(this.selectionColor&&(t.fillStyle=this.selectionColor,t.fillRect(e.ex-(0<i?0:-i),e.ey-(0<o?0:-o),a,s)),this.selectionLineWidth&&this.selectionBorderColor)if(t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,1<this.selectionDashArray.length&&!r){var l=e.ex+.5-(0<i?0:a),c=e.ey+.5-(0<o?0:s);t.beginPath(),d.util.drawDashedLine(t,l,c,l+a,c,this.selectionDashArray),d.util.drawDashedLine(t,l,c+s-1,l+a,c+s-1,this.selectionDashArray),d.util.drawDashedLine(t,l,c,l,c+s,this.selectionDashArray),d.util.drawDashedLine(t,l+a-1,c,l+a-1,c+s,this.selectionDashArray),t.closePath(),t.stroke()}else d.Object.prototype._setLineDash.call(this,t,this.selectionDashArray),t.strokeRect(e.ex+.5-(0<i?0:a),e.ey+.5-(0<o?0:s),a,s)},findTarget:function(t,e){if(!this.skipTargetFind){var n,r,o=this.getPointer(t,!0),a=this._activeObject,s=this.getActiveObjects(),l=i(t);if(this.targets=[],1<s.length&&!e&&a===this._searchPossibleTargets([a],o))return a;if(1===s.length&&a._findTargetCorner(o,l))return a;if(1===s.length&&a===this._searchPossibleTargets([a],o)){if(!this.preserveObjectStacking)return a;n=a,r=this.targets,this.targets=[]}var c=this._searchPossibleTargets(this._objects,o);return t[this.altSelectionKey]&&c&&n&&c!==n&&(c=n,this.targets=r),c}},_checkTarget:function(t,e,n){if(e&&e.visible&&e.evented&&(e.containsPoint(t)||e._findTargetCorner(t))){if(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing)return!0;if(!this.isTargetTransparent(e,n.x,n.y))return!0}},_searchPossibleTargets:function(t,e){for(var n,r,i=t.length;i--;){var o=t[i],a=o.group?this._normalizePointer(o.group,e):e;if(this._checkTarget(a,o,e)){(n=t[i]).subTargetCheck&&n instanceof d.Group&&(r=this._searchPossibleTargets(n._objects,e))&&this.targets.push(r);break}}return n},restorePointerVpt:function(t){return d.util.transformPoint(t,d.util.invertTransform(this.viewportTransform))},getPointer:function(e,n){if(this._absolutePointer&&!n)return this._absolutePointer;if(this._pointer&&n)return this._pointer;var r,i=t(e),o=this.upperCanvasEl,a=o.getBoundingClientRect(),s=a.width||0,l=a.height||0;s&&l||("top"in a&&"bottom"in a&&(l=Math.abs(a.top-a.bottom)),"right"in a&&"left"in a&&(s=Math.abs(a.right-a.left))),this.calcOffset(),i.x=i.x-this._offset.left,i.y=i.y-this._offset.top,n||(i=this.restorePointerVpt(i));var c=this.getRetinaScaling();return 1!==c&&(i.x/=c,i.y/=c),r=0===s||0===l?{width:1,height:1}:{width:o.width/s,height:o.height/l},{x:i.x*r.width,y:i.y*r.height}},_createUpperCanvas:function(){var t=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),e=this.lowerCanvasEl,n=this.upperCanvasEl;n?n.className="":(n=this._createCanvasElement(),this.upperCanvasEl=n),d.util.addClass(n,"upper-canvas "+t),this.wrapperEl.appendChild(n),this._copyCanvasStyle(e,n),this._applyCanvasStyle(n),this.contextTop=n.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=d.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),d.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),d.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(t){var e=this.width||t.width,n=this.height||t.height;d.util.setStyle(t,{position:"absolute",width:e+"px",height:n+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),t.width=e,t.height=n,d.util.makeElementUnselectable(t)},_copyCanvasStyle:function(t,e){e.style.cssText=t.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var t=this._activeObject;return t?"activeSelection"===t.type&&t._objects?t._objects.slice(0):[t]:[]},_onObjectRemoved:function(t){t===this._activeObject&&(this.fire("before:selection:cleared",{target:t}),this._discardActiveObject(),this.fire("selection:cleared",{target:t}),t.fire("deselected")),t===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",t)},_fireSelectionEvents:function(t,e){var n=!1,r=this.getActiveObjects(),i=[],o=[],a={e:e};t.forEach((function(t){-1===r.indexOf(t)&&(n=!0,t.fire("deselected",a),o.push(t))})),r.forEach((function(e){-1===t.indexOf(e)&&(n=!0,e.fire("selected",a),i.push(e))})),0<t.length&&0<r.length?(a.selected=i,a.deselected=o,a.updated=i[0]||o[0],a.target=this._activeObject,n&&this.fire("selection:updated",a)):0<r.length?(a.selected=i,a.target=this._activeObject,this.fire("selection:created",a)):0<t.length&&(a.deselected=o,this.fire("selection:cleared",a))},setActiveObject:function(t,e){var n=this.getActiveObjects();return this._setActiveObject(t,e),this._fireSelectionEvents(n,e),this},_setActiveObject:function(t,e){return this._activeObject!==t&&!!this._discardActiveObject(e,t)&&!t.onSelect({e:e})&&(this._activeObject=t,!0)},_discardActiveObject:function(t,e){var n=this._activeObject;if(n){if(n.onDeselect({e:t,object:e}))return!1;this._activeObject=null}return!0},discardActiveObject:function(t){var e=this.getActiveObjects(),n=this.getActiveObject();return e.length&&this.fire("before:selection:cleared",{target:n,e:t}),this._discardActiveObject(t),this._fireSelectionEvents(e,t),this},dispose:function(){var t=this.wrapperEl;return this.removeListeners(),t.removeChild(this.upperCanvasEl),t.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(t){d.util.cleanUpJsdomNode(this[t]),this[t]=void 0}.bind(this)),t.parentNode&&t.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,d.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(t){var e=this._activeObject;e&&e._renderControls(t)},_toObject:function(t,e,n){var r=this._realizeGroupTransformOnObject(t),i=this.callSuper("_toObject",t,e,n);return this._unwindGroupTransformOnObject(t,r),i},_realizeGroupTransformOnObject:function(t){if(t.group&&"activeSelection"===t.group.type&&this._activeObject===t.group){var e={};return["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"].forEach((function(n){e[n]=t[n]})),this._activeObject.realizeTransform(t),e}return null},_unwindGroupTransformOnObject:function(t,e){e&&t.set(e)},_setSVGObject:function(t,e,n){var r=this._realizeGroupTransformOnObject(e);this.callSuper("_setSVGObject",t,e,n),this._unwindGroupTransformOnObject(e,r)},setViewportTransform:function(t){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),d.StaticCanvas.prototype.setViewportTransform.call(this,t)}}),d.StaticCanvas)"prototype"!==o&&(d.Canvas[o]=d.StaticCanvas[o])}(),function(){var t=d.util.addListener,e=d.util.removeListener,n={passive:!1};function r(t,e){return t.button&&t.button===e-1}d.util.object.extend(d.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(t,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(t,e){var r=this.upperCanvasEl,i=this._getEventPrefix();t(d.window,"resize",this._onResize),t(r,i+"down",this._onMouseDown),t(r,i+"move",this._onMouseMove,n),t(r,i+"out",this._onMouseOut),t(r,i+"enter",this._onMouseEnter),t(r,"wheel",this._onMouseWheel),t(r,"contextmenu",this._onContextMenu),t(r,"dblclick",this._onDoubleClick),t(r,"dragover",this._onDragOver),t(r,"dragenter",this._onDragEnter),t(r,"dragleave",this._onDragLeave),t(r,"drop",this._onDrop),this.enablePointerEvents||t(r,"touchstart",this._onTouchStart,n),void 0!==v&&e in v&&(v[e](r,"gesture",this._onGesture),v[e](r,"drag",this._onDrag),v[e](r,"orientation",this._onOrientationChange),v[e](r,"shake",this._onShake),v[e](r,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(e,"remove");var t=this._getEventPrefix();e(d.document,t+"up",this._onMouseUp),e(d.document,"touchend",this._onTouchEnd,n),e(d.document,t+"move",this._onMouseMove,n),e(d.document,"touchmove",this._onMouseMove,n)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._simpleEventHandler.bind(this,"drop"),this.eventsBound=!0)},_onGesture:function(t,e){this.__onTransformGesture&&this.__onTransformGesture(t,e)},_onDrag:function(t,e){this.__onDrag&&this.__onDrag(t,e)},_onMouseWheel:function(t){this.__onMouseWheel(t)},_onMouseOut:function(t){var e=this._hoveredTarget;this.fire("mouse:out",{target:e,e:t}),this._hoveredTarget=null,e&&e.fire("mouseout",{e:t});var n=this;this._hoveredTargets.forEach((function(r){n.fire("mouse:out",{target:e,e:t}),r&&e.fire("mouseout",{e:t})})),this._hoveredTargets=[],this._iTextInstances&&this._iTextInstances.forEach((function(t){t.isEditing&&t.hiddenTextarea.focus()}))},_onMouseEnter:function(t){this._currentTransform||this.findTarget(t)||(this.fire("mouse:over",{target:null,e:t}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(t,e){this.__onOrientationChange&&this.__onOrientationChange(t,e)},_onShake:function(t,e){this.__onShake&&this.__onShake(t,e)},_onLongPress:function(t,e){this.__onLongPress&&this.__onLongPress(t,e)},_onDragOver:function(t){t.preventDefault();var e=this._simpleEventHandler("dragover",t);this._fireEnterLeaveEvents(e,t)},_onContextMenu:function(t){return this.stopContextMenu&&(t.stopPropagation(),t.preventDefault()),!1},_onDoubleClick:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"dblclick"),this._resetTransformEventData(t)},getPointerId:function(t){var e=t.changedTouches;return e?e[0]&&e[0].identifier:this.enablePointerEvents?t.pointerId:-1},_isMainEvent:function(t){return!0===t.isPrimary||!1!==t.isPrimary&&("touchend"===t.type&&0===t.touches.length||!t.changedTouches||t.changedTouches[0].identifier===this.mainTouchId)},_onTouchStart:function(r){r.preventDefault(),null===this.mainTouchId&&(this.mainTouchId=this.getPointerId(r)),this.__onMouseDown(r),this._resetTransformEventData();var i=this.upperCanvasEl,o=this._getEventPrefix();t(d.document,"touchend",this._onTouchEnd,n),t(d.document,"touchmove",this._onMouseMove,n),e(i,o+"down",this._onMouseDown)},_onMouseDown:function(r){this.__onMouseDown(r),this._resetTransformEventData();var i=this.upperCanvasEl,o=this._getEventPrefix();e(i,o+"move",this._onMouseMove,n),t(d.document,o+"up",this._onMouseUp),t(d.document,o+"move",this._onMouseMove,n)},_onTouchEnd:function(r){if(!(0<r.touches.length)){this.__onMouseUp(r),this._resetTransformEventData(),this.mainTouchId=null;var i=this._getEventPrefix();e(d.document,"touchend",this._onTouchEnd,n),e(d.document,"touchmove",this._onMouseMove,n);var o=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout((function(){t(o.upperCanvasEl,i+"down",o._onMouseDown),o._willAddMouseDown=0}),400)}},_onMouseUp:function(r){this.__onMouseUp(r),this._resetTransformEventData();var i=this.upperCanvasEl,o=this._getEventPrefix();this._isMainEvent(r)&&(e(d.document,o+"up",this._onMouseUp),e(d.document,o+"move",this._onMouseMove,n),t(i,o+"move",this._onMouseMove,n))},_onMouseMove:function(t){!this.allowTouchScrolling&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t)},_onResize:function(){this.calcOffset()},_shouldRender:function(t){var e=this._activeObject;return!!(!!e!=!!t||e&&t&&e!==t)||(e&&e.isEditing,!1)},__onMouseUp:function(t){var e,n=this._currentTransform,i=this._groupSelector,o=!1,a=!i||0===i.left&&0===i.top;if(this._cacheTransformEventData(t),e=this._target,this._handleEvent(t,"up:before"),r(t,3))this.fireRightClick&&this._handleEvent(t,"up",3,a);else{if(r(t,2))return this.fireMiddleClick&&this._handleEvent(t,"up",2,a),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)this._onMouseUpInDrawingMode(t);else if(this._isMainEvent(t)){if(n&&(this._finalizeCurrentTransform(t),o=n.actionPerformed),!a){var s=e===this._activeObject;this._maybeGroupObjects(t),o||(o=this._shouldRender(e)||!s&&e===this._activeObject)}if(e){var l=e._findTargetCorner(this.getPointer(t,!0),d.util.isTouchEvent(t)),c=e.controls[l],h=c&&c.getMouseUpHandler(t,e,c);if(h){var u=this.getPointer(t);h(t,n,u.x,u.y)}e.isMoving=!1}this._setCursorFromEvent(t,e),this._handleEvent(t,"up",1,a),this._groupSelector=null,this._currentTransform=null,e&&(e.__corner=0),o?this.requestRenderAll():a||this.renderTop()}}},_simpleEventHandler:function(t,e){var n=this.findTarget(e),r=this.targets,i={e:e,target:n,subTargets:r};if(this.fire(t,i),n&&n.fire(t,i),!r)return n;for(var o=0;o<r.length;o++)r[o].fire(t,i);return n},_handleEvent:function(t,e,n,r){var i=this._target,o=this.targets||[],a={e:t,target:i,subTargets:o,button:n||1,isClick:r||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};"up"===e&&(a.currentTarget=this.findTarget(t),a.currentSubTargets=this.targets),this.fire("mouse:"+e,a),i&&i.fire("mouse"+e,a);for(var s=0;s<o.length;s++)o[s].fire("mouse"+e,a)},_finalizeCurrentTransform:function(t){var e,n=this._currentTransform,r=n.target,i={e:t,target:r,transform:n,action:n.action};r._scaling&&(r._scaling=!1),r.setCoords(),(n.actionPerformed||this.stateful&&r.hasStateChanged())&&(n.actionPerformed&&(e=this._addEventOptions(i,n),this._fire(e,i)),this._fire("modified",i))},_addEventOptions:function(t,e){var n,r;switch(e.action){case"scaleX":n="scaled",r="x";break;case"scaleY":n="scaled",r="y";break;case"skewX":n="skewed",r="x";break;case"skewY":n="skewed",r="y";break;case"scale":n="scaled",r="equally";break;case"rotate":n="rotated";break;case"drag":n="moved"}return t.by=r,n},_onMouseDownInDrawingMode:function(t){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(t).requestRenderAll();var e=this.getPointer(t);this.freeDrawingBrush.onMouseDown(e,{e:t,pointer:e}),this._handleEvent(t,"down")},_onMouseMoveInDrawingMode:function(t){if(this._isCurrentlyDrawing){var e=this.getPointer(t);this.freeDrawingBrush.onMouseMove(e,{e:t,pointer:e})}this.setCursor(this.freeDrawingCursor),this._handleEvent(t,"move")},_onMouseUpInDrawingMode:function(t){var e=this.getPointer(t);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:t,pointer:e}),this._handleEvent(t,"up")},__onMouseDown:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"down:before");var e=this._target;if(r(t,3))this.fireRightClick&&this._handleEvent(t,"down",3);else if(r(t,2))this.fireMiddleClick&&this._handleEvent(t,"down",2);else if(this.isDrawingMode)this._onMouseDownInDrawingMode(t);else if(this._isMainEvent(t)&&!this._currentTransform){var n=this._pointer;this._previousPointer=n;var i=this._shouldRender(e),o=this._shouldGroup(t,e);if(this._shouldClearSelection(t,e)?this.discardActiveObject(t):o&&(this._handleGrouping(t,e),e=this._activeObject),!this.selection||e&&(e.selectable||e.isEditing||e===this._activeObject)||(this._groupSelector={ex:n.x,ey:n.y,top:0,left:0}),e){var a=e===this._activeObject;e.selectable&&this.setActiveObject(e,t);var s=e._findTargetCorner(this.getPointer(t,!0),d.util.isTouchEvent(t));if(e.__corner=s,e===this._activeObject&&(s||!o)){this._setupCurrentTransform(t,e,a);var l=e.controls[s],c=(n=this.getPointer(t),l&&l.getMouseDownHandler(t,e,l));c&&c(t,this._currentTransform,n.x,n.y)}}this._handleEvent(t,"down"),(i||o)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(t){this._resetTransformEventData(),this._pointer=this.getPointer(t,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(t)||null},_beforeTransform:function(t){var e=this._currentTransform;this.stateful&&e.target.saveState(),this.fire("before:transform",{e:t,transform:e})},__onMouseMove:function(t){var e,n;if(this._handleEvent(t,"move:before"),this._cacheTransformEventData(t),this.isDrawingMode)this._onMouseMoveInDrawingMode(t);else if(this._isMainEvent(t)){var r=this._groupSelector;r?(n=this._pointer,r.left=n.x-r.ex,r.top=n.y-r.ey,this.renderTop()):this._currentTransform?this._transformObject(t):(e=this.findTarget(t)||null,this._setCursorFromEvent(t,e),this._fireOverOutEvents(e,t)),this._handleEvent(t,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(t,e){var n=this._hoveredTarget,r=this._hoveredTargets,i=this.targets,o=Math.max(r.length,i.length);this.fireSyntheticInOutEvents(t,e,{oldTarget:n,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var a=0;a<o;a++)this.fireSyntheticInOutEvents(i[a],e,{oldTarget:r[a],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(t,e){var n=this._draggedoverTarget,r=this._hoveredTargets,i=this.targets,o=Math.max(r.length,i.length);this.fireSyntheticInOutEvents(t,e,{oldTarget:n,evtOut:"dragleave",evtIn:"dragenter"});for(var a=0;a<o;a++)this.fireSyntheticInOutEvents(i[a],e,{oldTarget:r[a],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=t},fireSyntheticInOutEvents:function(t,e,n){var r,i,o,a=n.oldTarget,s=a!==t,l=n.canvasEvtIn,c=n.canvasEvtOut;s&&(r={e:e,target:t,previousTarget:a},i={e:e,target:a,nextTarget:t}),o=t&&s,a&&s&&(c&&this.fire(c,i),a.fire(n.evtOut,i)),o&&(l&&this.fire(l,r),t.fire(n.evtIn,r))},__onMouseWheel:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"wheel"),this._resetTransformEventData()},_transformObject:function(t){var e=this.getPointer(t),n=this._currentTransform;n.reset=!1,n.target.isMoving=!0,n.shiftKey=t.shiftKey,n.altKey=t[this.centeredKey],this._performTransformAction(t,n,e),n.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(t,e,n){var r=n.x,i=n.y,o=e.action,a=!1,s=e.actionHandler;s&&(a=s(t,e,r,i)),"drag"===o&&a&&this.setCursor(e.target.moveCursor||this.moveCursor),e.actionPerformed=e.actionPerformed||a},_fire:d.controlsUtils.fireEvent,_setCursorFromEvent:function(t,e){if(!e)return this.setCursor(this.defaultCursor),!1;var n=e.hoverCursor||this.hoverCursor,r=this._activeObject&&"activeSelection"===this._activeObject.type?this._activeObject:null,i=(!r||!r.contains(e))&&e._findTargetCorner(this.getPointer(t,!0));i?this.setCursor(this.getCornerCursor(i,e,t)):(e.subTargetCheck&&this.targets.concat().reverse().map((function(t){n=t.hoverCursor||n})),this.setCursor(n))},getCornerCursor:function(t,e,n){var r=e.controls[t];return r.cursorStyleHandler(n,r,e)}})}(),function(){var t=Math.min,e=Math.max;d.util.object.extend(d.Canvas.prototype,{_shouldGroup:function(t,e){var n=this._activeObject;return n&&this._isSelectionKeyPressed(t)&&e&&e.selectable&&this.selection&&(n!==e||"activeSelection"===n.type)&&!e.onSelect({e:t})},_handleGrouping:function(t,e){var n=this._activeObject;n.__corner||(e!==n||(e=this.findTarget(t,!0))&&e.selectable)&&(n&&"activeSelection"===n.type?this._updateActiveSelection(e,t):this._createActiveSelection(e,t))},_updateActiveSelection:function(t,e){var n=this._activeObject,r=n._objects.slice(0);n.contains(t)?(n.removeWithUpdate(t),this._hoveredTarget=t,this._hoveredTargets=this.targets.concat(),1===n.size()&&this._setActiveObject(n.item(0),e)):(n.addWithUpdate(t),this._hoveredTarget=n,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(r,e)},_createActiveSelection:function(t,e){var n=this.getActiveObjects(),r=this._createGroup(t);this._hoveredTarget=r,this._setActiveObject(r,e),this._fireSelectionEvents(n,e)},_createGroup:function(t){var e=this._objects,n=e.indexOf(this._activeObject)<e.indexOf(t)?[this._activeObject,t]:[t,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new d.ActiveSelection(n,{canvas:this})},_groupSelectedObjects:function(t){var e,n=this._collectObjects(t);1===n.length?this.setActiveObject(n[0],t):1<n.length&&(e=new d.ActiveSelection(n.reverse(),{canvas:this}),this.setActiveObject(e,t))},_collectObjects:function(n){for(var r,i=[],o=this._groupSelector.ex,a=this._groupSelector.ey,s=o+this._groupSelector.left,l=a+this._groupSelector.top,c=new d.Point(t(o,s),t(a,l)),h=new d.Point(e(o,s),e(a,l)),u=!this.selectionFullyContained,f=o===s&&a===l,p=this._objects.length;p--&&!((r=this._objects[p])&&r.selectable&&r.visible&&(u&&r.intersectsWithRect(c,h)||r.isContainedWithinRect(c,h)||u&&r.containsPoint(c)||u&&r.containsPoint(h))&&(i.push(r),f)););return 1<i.length&&(i=i.filter((function(t){return!t.onSelect({e:n})}))),i},_maybeGroupObjects:function(t){this.selection&&this._groupSelector&&this._groupSelectedObjects(t),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),d.util.object.extend(d.StaticCanvas.prototype,{toDataURL:function(t){t||(t={});var e=t.format||"png",n=t.quality||1,r=(t.multiplier||1)*(t.enableRetinaScaling?this.getRetinaScaling():1),i=this.toCanvasElement(r,t);return d.util.toDataURL(i,e,n)},toCanvasElement:function(t,e){t=t||1;var n=((e=e||{}).width||this.width)*t,r=(e.height||this.height)*t,i=this.getZoom(),o=this.width,a=this.height,s=i*t,l=this.viewportTransform,c=(l[4]-(e.left||0))*t,h=(l[5]-(e.top||0))*t,u=this.interactive,f=[s,0,0,s,c,h],p=this.enableRetinaScaling,g=d.util.createCanvasElement(),v=this.contextTop;return g.width=n,g.height=r,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=f,this.width=n,this.height=r,this.calcViewportBoundaries(),this.renderCanvas(g.getContext("2d"),this._objects),this.viewportTransform=l,this.width=o,this.height=a,this.calcViewportBoundaries(),this.interactive=u,this.enableRetinaScaling=p,this.contextTop=v,g}}),d.util.object.extend(d.StaticCanvas.prototype,{loadFromJSON:function(t,e,n){if(t){var r="string"==typeof t?JSON.parse(t):d.util.object.clone(t),i=this,o=r.clipPath,a=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete r.clipPath,this._enlivenObjects(r.objects,(function(t){i.clear(),i._setBgOverlay(r,(function(){o?i._enlivenObjects([o],(function(n){i.clipPath=n[0],i.__setupCanvas.call(i,r,t,a,e)})):i.__setupCanvas.call(i,r,t,a,e)}))}),n),this}},__setupCanvas:function(t,e,n,r){var i=this;e.forEach((function(t,e){i.insertAt(t,e)})),this.renderOnAddRemove=n,delete t.objects,delete t.backgroundImage,delete t.overlayImage,delete t.background,delete t.overlay,this._setOptions(t),this.renderAll(),r&&r()},_setBgOverlay:function(t,e){var n={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(t.backgroundImage||t.overlayImage||t.background||t.overlay){var r=function(){n.backgroundImage&&n.overlayImage&&n.backgroundColor&&n.overlayColor&&e&&e()};this.__setBgOverlay("backgroundImage",t.backgroundImage,n,r),this.__setBgOverlay("overlayImage",t.overlayImage,n,r),this.__setBgOverlay("backgroundColor",t.background,n,r),this.__setBgOverlay("overlayColor",t.overlay,n,r)}else e&&e()},__setBgOverlay:function(t,e,n,r){var i=this;if(!e)return n[t]=!0,void(r&&r());"backgroundImage"===t||"overlayImage"===t?d.util.enlivenObjects([e],(function(e){i[t]=e[0],n[t]=!0,r&&r()})):this["set"+d.util.string.capitalize(t,!0)](e,(function(){n[t]=!0,r&&r()}))},_enlivenObjects:function(t,e,n){t&&0!==t.length?d.util.enlivenObjects(t,(function(t){e&&e(t)}),null,n):e&&e([])},_toDataURL:function(t,e){this.clone((function(n){e(n.toDataURL(t))}))},_toDataURLWithMultiplier:function(t,e,n){this.clone((function(r){n(r.toDataURLWithMultiplier(t,e))}))},clone:function(t,e){var n=JSON.stringify(this.toJSON(e));this.cloneWithoutData((function(e){e.loadFromJSON(n,(function(){t&&t(e)}))}))},cloneWithoutData:function(t){var e=d.util.createCanvasElement();e.width=this.width,e.height=this.height;var n=new d.Canvas(e);this.backgroundImage?(n.setBackgroundImage(this.backgroundImage.src,(function(){n.renderAll(),t&&t(n)})),n.backgroundImageOpacity=this.backgroundImageOpacity,n.backgroundImageStretch=this.backgroundImageStretch):t&&t(n)}}),function(){var t=d.util.degreesToRadians,e=d.util.radiansToDegrees;d.util.object.extend(d.Canvas.prototype,{__onTransformGesture:function(t,e){if(!this.isDrawingMode&&t.touches&&2===t.touches.length&&"gesture"===e.gesture){var n=this.findTarget(t);void 0!==n&&(this.__gesturesParams={e:t,self:e,target:n},this.__gesturesRenderer()),this.fire("touch:gesture",{target:n,e:t,self:e})}},__gesturesParams:null,__gesturesRenderer:function(){if(null!==this.__gesturesParams&&null!==this._currentTransform){var t=this.__gesturesParams.self,e=this._currentTransform,n=this.__gesturesParams.e;e.action="scale",e.originX=e.originY="center",this._scaleObjectBy(t.scale,n),0!==t.rotation&&(e.action="rotate",this._rotateObjectByAngle(t.rotation,n)),this.requestRenderAll(),e.action="drag"}},__onDrag:function(t,e){this.fire("touch:drag",{e:t,self:e})},__onOrientationChange:function(t,e){this.fire("touch:orientation",{e:t,self:e})},__onShake:function(t,e){this.fire("touch:shake",{e:t,self:e})},__onLongPress:function(t,e){this.fire("touch:longpress",{e:t,self:e})},_scaleObjectBy:function(t,e){var n=this._currentTransform,r=n.target;return n.gestureScale=t,r._scaling=!0,d.controlsUtils.scalingEqually(e,n,0,0)},_rotateObjectByAngle:function(n,r){var i=this._currentTransform;i.target.get("lockRotation")||(i.target.rotate(e(t(n)+i.theta)),this._fire("rotating",{target:i.target,e:r,transform:i}))}})}(),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,r=e.util.object.clone,i=e.util.toFixed,o=e.util.string.capitalize,a=e.util.degreesToRadians,s=e.StaticCanvas.supports("setLineDash"),l=!e.isLikelyNode;e.Object||(e.Object=e.util.createClass(e.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:l,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(t){t&&this.setOptions(t)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=e.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(t){var n=e.perfLimitSizeTotal,r=t.width,i=t.height,o=e.maxCacheSideLimit,a=e.minCacheSideLimit;if(r<=o&&i<=o&&r*i<=n)return r<a&&(t.width=a),i<a&&(t.height=a),t;var s=r/i,l=e.util.limitDimsByArea(s,n),c=e.util.capValue,h=c(a,l.x,o),u=c(a,l.y,o);return h<r&&(t.zoomX/=r/h,t.width=h,t.capped=!0),u<i&&(t.zoomY/=i/u,t.height=u,t.capped=!0),t},_getCacheCanvasDimensions:function(){var t=this.getTotalObjectScaling(),e=this._getTransformedDimensions(0,0),n=e.x*t.scaleX/this.scaleX,r=e.y*t.scaleY/this.scaleY;return{width:n+2,height:r+2,zoomX:t.scaleX,zoomY:t.scaleY,x:n,y:r}},_updateCacheCanvas:function(){var t=this.canvas;if(this.noScaleCache&&t&&t._currentTransform){var n=t._currentTransform.target,r=t._currentTransform.action;if(this===n&&r.slice&&"scale"===r.slice(0,5))return!1}var i,o,a=this._cacheCanvas,s=this._limitCacheSize(this._getCacheCanvasDimensions()),l=e.minCacheSideLimit,c=s.width,h=s.height,u=s.zoomX,f=s.zoomY,p=c!==this.cacheWidth||h!==this.cacheHeight,d=this.zoomX!==u||this.zoomY!==f,g=p||d,v=0,m=0,y=!1;if(p){var b=this._cacheCanvas.width,x=this._cacheCanvas.height,w=b<c||x<h;y=w||(c<.9*b||h<.9*x)&&l<b&&l<x,w&&!s.capped&&(l<c||l<h)&&(v=.1*c,m=.1*h)}return!!g&&(y?(a.width=Math.ceil(c+v),a.height=Math.ceil(h+m)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,a.width,a.height)),i=s.x/2,o=s.y/2,this.cacheTranslationX=Math.round(a.width/2-i)+i,this.cacheTranslationY=Math.round(a.height/2-o)+o,this.cacheWidth=c,this.cacheHeight=h,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(u,f),this.zoomX=u,this.zoomY=f,!0)},setOptions:function(t){this._setOptions(t),this._initGradient(t.fill,"fill"),this._initGradient(t.stroke,"stroke"),this._initPattern(t.fill,"fill"),this._initPattern(t.stroke,"stroke")},transform:function(t){var e=this.group&&!this.group._transformDone||this.group&&this.canvas&&t===this.canvas.contextTop,n=this.calcTransformMatrix(!e);t.transform(n[0],n[1],n[2],n[3],n[4],n[5])},toObject:function(t){var n=e.Object.NUM_FRACTION_DIGITS,r={type:this.type,version:e.version,originX:this.originX,originY:this.originY,left:i(this.left,n),top:i(this.top,n),width:i(this.width,n),height:i(this.height,n),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:i(this.strokeWidth,n),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:i(this.strokeMiterLimit,n),scaleX:i(this.scaleX,n),scaleY:i(this.scaleY,n),angle:i(this.angle,n),flipX:this.flipX,flipY:this.flipY,opacity:i(this.opacity,n),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:i(this.skewX,n),skewY:i(this.skewY,n)};return this.clipPath&&(r.clipPath=this.clipPath.toObject(t),r.clipPath.inverted=this.clipPath.inverted,r.clipPath.absolutePositioned=this.clipPath.absolutePositioned),e.util.populateWithProperties(this,r,t),this.includeDefaultValues||(r=this._removeDefaultValues(r)),r},toDatalessObject:function(t){return this.toObject(t)},_removeDefaultValues:function(t){var n=e.util.getKlass(t.type).prototype;return n.stateProperties.forEach((function(e){"left"!==e&&"top"!==e&&(t[e]===n[e]&&delete t[e],"[object Array]"===Object.prototype.toString.call(t[e])&&"[object Array]"===Object.prototype.toString.call(n[e])&&0===t[e].length&&0===n[e].length&&delete t[e])})),t},toString:function(){return"#<fabric."+o(this.type)+">"},getObjectScaling:function(){var t=e.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(t.scaleX),scaleY:Math.abs(t.scaleY)}},getTotalObjectScaling:function(){var t=this.getObjectScaling(),e=t.scaleX,n=t.scaleY;if(this.canvas){var r=this.canvas.getZoom(),i=this.canvas.getRetinaScaling();e*=r*i,n*=r*i}return{scaleX:e,scaleY:n}},getObjectOpacity:function(){var t=this.opacity;return this.group&&(t*=this.group.getObjectOpacity()),t},_set:function(t,n){var r="scaleX"===t||"scaleY"===t,i=this[t]!==n,o=!1;return r&&(n=this._constrainScale(n)),"scaleX"===t&&n<0?(this.flipX=!this.flipX,n*=-1):"scaleY"===t&&n<0?(this.flipY=!this.flipY,n*=-1):"shadow"!==t||!n||n instanceof e.Shadow?"dirty"===t&&this.group&&this.group.set("dirty",n):n=new e.Shadow(n),this[t]=n,i&&(o=this.group&&this.group.isOnACache(),-1<this.cacheProperties.indexOf(t)?(this.dirty=!0,o&&this.group.set("dirty",!0)):o&&-1<this.stateProperties.indexOf(t)&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:e.iMatrix.concat()},isNotVisible:function(){return 0===this.opacity||!this.width&&!this.height&&0===this.strokeWidth||!this.visible},render:function(t){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(t.save(),this._setupCompositeOperation(t),this.drawSelectionBackground(t),this.transform(t),this._setOpacity(t),this._setShadow(t,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(t)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(t),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),t.restore())},renderCache:function(t){t=t||{},this._cacheCanvas||this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,t.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&"transparent"!==this.stroke&&0!==this.strokeWidth},hasFill:function(){return this.fill&&"transparent"!==this.fill},needsItsOwnCache:function(){return!("stroke"!==this.paintFirst||!this.hasFill()||!this.hasStroke()||"object"!=typeof this.shadow)||!!this.clipPath},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(0!==this.shadow.offsetX||0!==this.shadow.offsetY)},drawClipPathOnCache:function(t){var n=this.clipPath;if(t.save(),n.inverted?t.globalCompositeOperation="destination-out":t.globalCompositeOperation="destination-in",n.absolutePositioned){var r=e.util.invertTransform(this.calcTransformMatrix());t.transform(r[0],r[1],r[2],r[3],r[4],r[5])}n.transform(t),t.scale(1/n.zoomX,1/n.zoomY),t.drawImage(n._cacheCanvas,-n.cacheTranslationX,-n.cacheTranslationY),t.restore()},drawObject:function(t,e){var n=this.fill,r=this.stroke;e?(this.fill="black",this.stroke="",this._setClippingProperties(t)):this._renderBackground(t),this._render(t),this._drawClipPath(t),this.fill=n,this.stroke=r},_drawClipPath:function(t){var e=this.clipPath;e&&(e.canvas=this.canvas,e.shouldCache(),e._transformDone=!0,e.renderCache({forClipping:!0}),this.drawClipPathOnCache(t))},drawCacheOnCanvas:function(t){t.scale(1/this.zoomX,1/this.zoomY),t.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(t){if(this.isNotVisible())return!1;if(this._cacheCanvas&&!t&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&!t){var e=this.cacheWidth/this.zoomX,n=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-e/2,-n/2,e,n)}return!0}return!1},_renderBackground:function(t){if(this.backgroundColor){var e=this._getNonTransformedDimensions();t.fillStyle=this.backgroundColor,t.fillRect(-e.x/2,-e.y/2,e.x,e.y),this._removeShadow(t)}},_setOpacity:function(t){this.group&&!this.group._transformDone?t.globalAlpha=this.getObjectOpacity():t.globalAlpha*=this.opacity},_setStrokeStyles:function(t,e){var n=e.stroke;n&&(t.lineWidth=e.strokeWidth,t.lineCap=e.strokeLineCap,t.lineDashOffset=e.strokeDashOffset,t.lineJoin=e.strokeLineJoin,t.miterLimit=e.strokeMiterLimit,n.toLive?"percentage"===n.gradientUnits||n.gradientTrasnform||n.patternTransform?this._applyPatternForTransformedGradient(t,n):(t.strokeStyle=n.toLive(t,this),this._applyPatternGradientTransform(t,n)):t.strokeStyle=e.stroke)},_setFillStyles:function(t,e){var n=e.fill;n&&(n.toLive?(t.fillStyle=n.toLive(t,this),this._applyPatternGradientTransform(t,e.fill)):t.fillStyle=n)},_setClippingProperties:function(t){t.globalAlpha=1,t.strokeStyle="transparent",t.fillStyle="#000000"},_setLineDash:function(t,e,n){e&&0!==e.length&&(1&e.length&&e.push.apply(e,e),s?t.setLineDash(e):n&&n(t))},_renderControls:function(t,n){var r,i,o,s=this.getViewportTransform(),l=this.calcTransformMatrix();i=void 0!==(n=n||{}).hasBorders?n.hasBorders:this.hasBorders,o=void 0!==n.hasControls?n.hasControls:this.hasControls,l=e.util.multiplyTransformMatrices(s,l),r=e.util.qrDecompose(l),t.save(),t.translate(r.translateX,r.translateY),t.lineWidth=1*this.borderScaleFactor,this.group||(t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),n.forActiveSelection?(t.rotate(a(r.angle)),i&&this.drawBordersInGroup(t,r,n)):(t.rotate(a(this.angle)),i&&this.drawBorders(t,n)),o&&this.drawControls(t,n),t.restore()},_setShadow:function(t){if(this.shadow){var n,r=this.shadow,i=this.canvas,o=i&&i.viewportTransform[0]||1,a=i&&i.viewportTransform[3]||1;n=r.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),i&&i._isRetinaScaling()&&(o*=e.devicePixelRatio,a*=e.devicePixelRatio),t.shadowColor=r.color,t.shadowBlur=r.blur*e.browserShadowBlurConstant*(o+a)*(n.scaleX+n.scaleY)/4,t.shadowOffsetX=r.offsetX*o*n.scaleX,t.shadowOffsetY=r.offsetY*a*n.scaleY}},_removeShadow:function(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)},_applyPatternGradientTransform:function(t,e){if(!e||!e.toLive)return{offsetX:0,offsetY:0};var n=e.gradientTransform||e.patternTransform,r=-this.width/2+e.offsetX||0,i=-this.height/2+e.offsetY||0;return"percentage"===e.gradientUnits?t.transform(this.width,0,0,this.height,r,i):t.transform(1,0,0,1,r,i),n&&t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),{offsetX:r,offsetY:i}},_renderPaintInOrder:function(t){"stroke"===this.paintFirst?(this._renderStroke(t),this._renderFill(t)):(this._renderFill(t),this._renderStroke(t))},_render:function(){},_renderFill:function(t){this.fill&&(t.save(),this._setFillStyles(t,this),"evenodd"===this.fillRule?t.fill("evenodd"):t.fill(),t.restore())},_renderStroke:function(t){if(this.stroke&&0!==this.strokeWidth){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this.strokeUniform&&this.group){var e=this.getObjectScaling();t.scale(1/e.scaleX,1/e.scaleY)}else this.strokeUniform&&t.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(t,this.strokeDashArray,this._renderDashedStroke),this._setStrokeStyles(t,this),t.stroke(),t.restore()}},_applyPatternForTransformedGradient:function(t,n){var r,i=this._limitCacheSize(this._getCacheCanvasDimensions()),o=e.util.createCanvasElement(),a=this.canvas.getRetinaScaling(),s=i.x/this.scaleX/a,l=i.y/this.scaleY/a;o.width=s,o.height=l,(r=o.getContext("2d")).beginPath(),r.moveTo(0,0),r.lineTo(s,0),r.lineTo(s,l),r.lineTo(0,l),r.closePath(),r.translate(s/2,l/2),r.scale(i.zoomX/this.scaleX/a,i.zoomY/this.scaleY/a),this._applyPatternGradientTransform(r,n),r.fillStyle=n.toLive(t),r.fill(),t.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),t.scale(a*this.scaleX/i.zoomX,a*this.scaleY/i.zoomY),t.strokeStyle=r.createPattern(o,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var t=e.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",t.scaleX),this.set("scaleY",t.scaleY),this.angle=t.angle,this.skewX=t.skewX,this.skewY=0}},_removeTransformMatrix:function(t){var n=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),n=e.util.transformPoint(n,this.transformMatrix)),this.transformMatrix=null,t&&(this.scaleX*=t.scaleX,this.scaleY*=t.scaleY,this.cropX=t.cropX,this.cropY=t.cropY,n.x+=t.offsetLeft,n.y+=t.offsetTop,this.width=t.width,this.height=t.height),this.setPositionByOrigin(n,"center","center")},clone:function(t,n){var r=this.toObject(n);this.constructor.fromObject?this.constructor.fromObject(r,t):e.Object._fromObject("Object",r,t)},cloneAsImage:function(t,n){var r=this.toCanvasElement(n);return t&&t(new e.Image(r)),this},toCanvasElement:function(t){t||(t={});var n=e.util,r=n.saveObjectTransform(this),i=this.group,o=this.shadow,a=Math.abs,s=(t.multiplier||1)*(t.enableRetinaScaling?e.devicePixelRatio:1);delete this.group,t.withoutTransform&&n.resetObjectTransform(this),t.withoutShadow&&(this.shadow=null);var l,c,h,u,f=e.util.createCanvasElement(),p=this.getBoundingRect(!0,!0),d=this.shadow,g={x:0,y:0};d&&(c=d.blur,l=d.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),g.x=2*Math.round(a(d.offsetX)+c)*a(l.scaleX),g.y=2*Math.round(a(d.offsetY)+c)*a(l.scaleY)),h=p.width+g.x,u=p.height+g.y,f.width=Math.ceil(h),f.height=Math.ceil(u);var v=new e.StaticCanvas(f,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});"jpeg"===t.format&&(v.backgroundColor="#fff"),this.setPositionByOrigin(new e.Point(v.width/2,v.height/2),"center","center");var m=this.canvas;v.add(this);var y=v.toCanvasElement(s||1,t);return this.shadow=o,this.set("canvas",m),i&&(this.group=i),this.set(r).setCoords(),v._objects=[],v.dispose(),v=null,y},toDataURL:function(t){return t||(t={}),e.util.toDataURL(this.toCanvasElement(t),t.format||"png",t.quality||1)},isType:function(t){return this.type===t},complexity:function(){return 1},toJSON:function(t){return this.toObject(t)},rotate:function(t){var e=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;return e&&this._setOriginToCenter(),this.set("angle",t),e&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(t,n){n=n||this.canvas.getPointer(t);var r=new e.Point(n.x,n.y),i=this._getLeftTopCoords();return this.angle&&(r=e.util.rotatePoint(r,i,a(-this.angle))),{x:r.x-i.x,y:r.y-i.y}},_setupCompositeOperation:function(t){this.globalCompositeOperation&&(t.globalCompositeOperation=this.globalCompositeOperation)}}),e.util.createAccessors&&e.util.createAccessors(e.Object),n(e.Object.prototype,e.Observable),e.Object.NUM_FRACTION_DIGITS=2,e.Object._fromObject=function(t,n,i,o){var a=e[t];n=r(n,!0),e.util.enlivenPatterns([n.fill,n.stroke],(function(t){void 0!==t[0]&&(n.fill=t[0]),void 0!==t[1]&&(n.stroke=t[1]),e.util.enlivenObjects([n.clipPath],(function(t){n.clipPath=t[0];var e=o?new a(n[o],n):new a(n);i&&i(e)}))}))},e.Object.__uid=0)}(e),function(){var t=d.util.degreesToRadians,e={left:-.5,center:0,right:.5},n={top:-.5,center:0,bottom:.5};d.util.object.extend(d.Object.prototype,{translateToGivenOrigin:function(t,r,i,o,a){var s,l,c,h=t.x,u=t.y;return"string"==typeof r?r=e[r]:r-=.5,"string"==typeof o?o=e[o]:o-=.5,"string"==typeof i?i=n[i]:i-=.5,"string"==typeof a?a=n[a]:a-=.5,l=a-i,((s=o-r)||l)&&(c=this._getTransformedDimensions(),h=t.x+s*c.x,u=t.y+l*c.y),new d.Point(h,u)},translateToCenterPoint:function(e,n,r){var i=this.translateToGivenOrigin(e,n,r,"center","center");return this.angle?d.util.rotatePoint(i,e,t(this.angle)):i},translateToOriginPoint:function(e,n,r){var i=this.translateToGivenOrigin(e,"center","center",n,r);return this.angle?d.util.rotatePoint(i,e,t(this.angle)):i},getCenterPoint:function(){var t=new d.Point(this.left,this.top);return this.translateToCenterPoint(t,this.originX,this.originY)},getPointByOrigin:function(t,e){var n=this.getCenterPoint();return this.translateToOriginPoint(n,t,e)},toLocalPoint:function(e,n,r){var i,o,a=this.getCenterPoint();return i=void 0!==n&&void 0!==r?this.translateToGivenOrigin(a,"center","center",n,r):new d.Point(this.left,this.top),o=new d.Point(e.x,e.y),this.angle&&(o=d.util.rotatePoint(o,a,-t(this.angle))),o.subtractEquals(i)},setPositionByOrigin:function(t,e,n){var r=this.translateToCenterPoint(t,e,n),i=this.translateToOriginPoint(r,this.originX,this.originY);this.set("left",i.x),this.set("top",i.y)},adjustPosition:function(n){var r,i,o=t(this.angle),a=this.getScaledWidth(),s=d.util.cos(o)*a,l=d.util.sin(o)*a;r="string"==typeof this.originX?e[this.originX]:this.originX-.5,i="string"==typeof n?e[n]:n-.5,this.left+=s*(i-r),this.top+=l*(i-r),this.setCoords(),this.originX=n},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var t=this.getCenterPoint();this.originX="center",this.originY="center",this.left=t.x,this.top=t.y},_resetOrigin:function(){var t=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=t.x,this.top=t.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){var t=d.util,e=t.degreesToRadians,n=t.multiplyTransformMatrices,r=t.transformPoint;t.object.extend(d.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(t,e){return e?t?this.calcACoords():this.calcLineCoords():(this.aCoords&&this.lineCoords||this.setCoords(!0),t?this.aCoords:this.lineCoords)},getCoords:function(t,e){return n=this._getCoords(t,e),[new d.Point(n.tl.x,n.tl.y),new d.Point(n.tr.x,n.tr.y),new d.Point(n.br.x,n.br.y),new d.Point(n.bl.x,n.bl.y)];var n},intersectsWithRect:function(t,e,n,r){var i=this.getCoords(n,r);return"Intersection"===d.Intersection.intersectPolygonRectangle(i,t,e).status},intersectsWithObject:function(t,e,n){return"Intersection"===d.Intersection.intersectPolygonPolygon(this.getCoords(e,n),t.getCoords(e,n)).status||t.isContainedWithinObject(this,e,n)||this.isContainedWithinObject(t,e,n)},isContainedWithinObject:function(t,e,n){for(var r=this.getCoords(e,n),i=e?t.aCoords:t.lineCoords,o=0,a=t._getImageLines(i);o<4;o++)if(!t.containsPoint(r[o],a))return!1;return!0},isContainedWithinRect:function(t,e,n,r){var i=this.getBoundingRect(n,r);return i.left>=t.x&&i.left+i.width<=e.x&&i.top>=t.y&&i.top+i.height<=e.y},containsPoint:function(t,e,n,r){var i=this._getCoords(n,r),o=(e=e||this._getImageLines(i),this._findCrossPoints(t,e));return 0!==o&&o%2==1},isOnScreen:function(t){if(!this.canvas)return!1;var e=this.canvas.vptCoords.tl,n=this.canvas.vptCoords.br;return!!this.getCoords(!0,t).some((function(t){return t.x<=n.x&&t.x>=e.x&&t.y<=n.y&&t.y>=e.y}))||!!this.intersectsWithRect(e,n,!0,t)||this._containsCenterOfCanvas(e,n,t)},_containsCenterOfCanvas:function(t,e,n){var r={x:(t.x+e.x)/2,y:(t.y+e.y)/2};return!!this.containsPoint(r,null,!0,n)},isPartiallyOnScreen:function(t){if(!this.canvas)return!1;var e=this.canvas.vptCoords.tl,n=this.canvas.vptCoords.br;return!!this.intersectsWithRect(e,n,!0,t)||this.getCoords(!0,t).every((function(t){return(t.x>=n.x||t.x<=e.x)&&(t.y>=n.y||t.y<=e.y)}))&&this._containsCenterOfCanvas(e,n,t)},_getImageLines:function(t){return{topline:{o:t.tl,d:t.tr},rightline:{o:t.tr,d:t.br},bottomline:{o:t.br,d:t.bl},leftline:{o:t.bl,d:t.tl}}},_findCrossPoints:function(t,e){var n,r,i,o=0;for(var a in e)if(!((i=e[a]).o.y<t.y&&i.d.y<t.y||i.o.y>=t.y&&i.d.y>=t.y||(i.o.x===i.d.x&&i.o.x>=t.x?r=i.o.x:(n=(i.d.y-i.o.y)/(i.d.x-i.o.x),r=-(t.y-0*t.x-(i.o.y-n*i.o.x))/(0-n)),r>=t.x&&(o+=1),2!==o)))break;return o},getBoundingRect:function(e,n){var r=this.getCoords(e,n);return t.makeBoundingBoxFromPoints(r)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(t){return Math.abs(t)<this.minScaleLimit?t<0?-this.minScaleLimit:this.minScaleLimit:0===t?1e-4:t},scale:function(t){return this._set("scaleX",t),this._set("scaleY",t),this.setCoords()},scaleToWidth:function(t,e){var n=this.getBoundingRect(e).width/this.getScaledWidth();return this.scale(t/this.width/n)},scaleToHeight:function(t,e){var n=this.getBoundingRect(e).height/this.getScaledHeight();return this.scale(t/this.height/n)},calcCoords:function(t){return t?this.calcACoords():this.calcOCoords()},calcLineCoords:function(){var n=this.getViewportTransform(),i=this.padding,o=e(this.angle),a=t.cos(o)*i,s=t.sin(o)*i,l=a+s,c=a-s,h=this.calcACoords(),u={tl:r(h.tl,n),tr:r(h.tr,n),bl:r(h.bl,n),br:r(h.br,n)};return i&&(u.tl.x-=c,u.tl.y-=l,u.tr.x+=l,u.tr.y-=c,u.bl.x-=l,u.bl.y+=c,u.br.x+=c,u.br.y+=l),u},calcOCoords:function(){var t=this._calcRotateMatrix(),e=this._calcTranslateMatrix(),r=this.getViewportTransform(),i=n(r,e),o=n(i,t),a=(o=n(o,[1/r[0],0,0,1/r[3],0,0]),this._calculateCurrentDimensions()),s={};return this.forEachControl((function(t,e,n){s[e]=t.positionHandler(a,o,n)})),s},calcACoords:function(){var t=this._calcRotateMatrix(),e=this._calcTranslateMatrix(),i=n(e,t),o=this._getTransformedDimensions(),a=o.x/2,s=o.y/2;return{tl:r({x:-a,y:-s},i),tr:r({x:a,y:-s},i),bl:r({x:-a,y:s},i),br:r({x:a,y:s},i)}},setCoords:function(t){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),t||(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords()),this},_calcRotateMatrix:function(){return t.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var t=this.getCenterPoint();return[1,0,0,1,t.x,t.y]},transformMatrixKey:function(t){var e="_",n="";return!t&&this.group&&(n=this.group.transformMatrixKey(t)+e),n+this.top+e+this.left+e+this.scaleX+e+this.scaleY+e+this.skewX+e+this.skewY+e+this.angle+e+this.originX+e+this.originY+e+this.width+e+this.height+e+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(t){var e=this.calcOwnMatrix();if(t||!this.group)return e;var r=this.transformMatrixKey(t),i=this.matrixCache||(this.matrixCache={});return i.key===r?i.value:(this.group&&(e=n(this.group.calcTransformMatrix(!1),e)),i.key=r,i.value=e)},calcOwnMatrix:function(){var e=this.transformMatrixKey(!0),n=this.ownMatrixCache||(this.ownMatrixCache={});if(n.key===e)return n.value;var r=this._calcTranslateMatrix(),i={angle:this.angle,translateX:r[4],translateY:r[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return n.key=e,n.value=t.composeMatrix(i),n.value},_calcDimensionsTransformMatrix:function(e,n,r){return t.calcDimensionsMatrix({skewX:e,skewY:n,scaleX:this.scaleX*(r&&this.flipX?-1:1),scaleY:this.scaleY*(r&&this.flipY?-1:1)})},_getNonTransformedDimensions:function(){var t=this.strokeWidth;return{x:this.width+t,y:this.height+t}},_getTransformedDimensions:function(e,n){void 0===e&&(e=this.skewX),void 0===n&&(n=this.skewY);var r,i,o=this._getNonTransformedDimensions(),a=0===e&&0===n;if(this.strokeUniform?(r=this.width,i=this.height):(r=o.x,i=o.y),a)return this._finalizeDimensions(r*this.scaleX,i*this.scaleY);var s=t.sizeAfterTransform(r,i,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:e,skewY:n});return this._finalizeDimensions(s.x,s.y)},_finalizeDimensions:function(t,e){return this.strokeUniform?{x:t+this.strokeWidth,y:e+this.strokeWidth}:{x:t,y:e}},_calculateCurrentDimensions:function(){var t=this.getViewportTransform(),e=this._getTransformedDimensions();return r(e,t,!0).scalarAdd(2*this.padding)}})}(),d.util.object.extend(d.Object.prototype,{sendToBack:function(){return this.group?d.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?d.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(t){return this.group?d.StaticCanvas.prototype.sendBackwards.call(this.group,this,t):this.canvas&&this.canvas.sendBackwards(this,t),this},bringForward:function(t){return this.group?d.StaticCanvas.prototype.bringForward.call(this.group,this,t):this.canvas&&this.canvas.bringForward(this,t),this},moveTo:function(t){return this.group&&"activeSelection"!==this.group.type?d.StaticCanvas.prototype.moveTo.call(this.group,this,t):this.canvas&&this.canvas.moveTo(this,t),this}}),function(){function t(t,e){if(e){if(e.toLive)return t+": url(#SVGID_"+e.id+"); ";var n=new d.Color(e),r=t+": "+n.toRgb()+"; ",i=n.getAlpha();return 1!==i&&(r+=t+"-opacity: "+i.toString()+"; "),r}return t+": none; "}var e=d.util.toFixed;d.util.object.extend(d.Object.prototype,{getSvgStyles:function(e){var n=this.fillRule?this.fillRule:"nonzero",r=this.strokeWidth?this.strokeWidth:"0",i=this.strokeDashArray?this.strokeDashArray.join(" "):"none",o=this.strokeDashOffset?this.strokeDashOffset:"0",a=this.strokeLineCap?this.strokeLineCap:"butt",s=this.strokeLineJoin?this.strokeLineJoin:"miter",l=this.strokeMiterLimit?this.strokeMiterLimit:"4",c=void 0!==this.opacity?this.opacity:"1",h=this.visible?"":" visibility: hidden;",u=e?"":this.getSvgFilter(),f=t("fill",this.fill);return[t("stroke",this.stroke),"stroke-width: ",r,"; ","stroke-dasharray: ",i,"; ","stroke-linecap: ",a,"; ","stroke-dashoffset: ",o,"; ","stroke-linejoin: ",s,"; ","stroke-miterlimit: ",l,"; ",f,"fill-rule: ",n,"; ","opacity: ",c,";",u,h].join("")},getSvgSpanStyles:function(e,n){var r="; ",i=e.fontFamily?"font-family: "+(-1===e.fontFamily.indexOf("'")&&-1===e.fontFamily.indexOf('"')?"'"+e.fontFamily+"'":e.fontFamily)+r:"",o=e.strokeWidth?"stroke-width: "+e.strokeWidth+r:"",a=(i=i,e.fontSize?"font-size: "+e.fontSize+"px"+r:""),s=e.fontStyle?"font-style: "+e.fontStyle+r:"",l=e.fontWeight?"font-weight: "+e.fontWeight+r:"",c=e.fill?t("fill",e.fill):"",h=e.stroke?t("stroke",e.stroke):"",u=this.getSvgTextDecoration(e);return u&&(u="text-decoration: "+u+r),[h,o,i,a,s,l,u,c,e.deltaY?"baseline-shift: "+-e.deltaY+"; ":"",n?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(t){return["overline","underline","line-through"].filter((function(e){return t[e.replace("-","")]})).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(t,e){var n=t?this.calcTransformMatrix():this.calcOwnMatrix();return'transform="'+d.util.matrixToSVG(n)+(e||"")+'" '},_setSVGBg:function(t){if(this.backgroundColor){var n=d.Object.NUM_FRACTION_DIGITS;t.push("\t\t<rect ",this._getFillAttributes(this.backgroundColor),' x="',e(-this.width/2,n),'" y="',e(-this.height/2,n),'" width="',e(this.width,n),'" height="',e(this.height,n),'"></rect>\n')}},toSVG:function(t){return this._createBaseSVGMarkup(this._toSVG(t),{reviver:t})},toClipPathSVG:function(t){return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(t),{reviver:t})},_createBaseClipPathSVGMarkup:function(t,e){var n=(e=e||{}).reviver,r=e.additionalTransform||"",i=[this.getSvgTransform(!0,r),this.getSvgCommons()].join(""),o=t.indexOf("COMMON_PARTS");return t[o]=i,n?n(t.join("")):t.join("")},_createBaseSVGMarkup:function(t,e){var n,r,i=(e=e||{}).noStyle,o=e.reviver,a=i?"":'style="'+this.getSvgStyles()+'" ',s=e.withShadow?'style="'+this.getSvgFilter()+'" ':"",l=this.clipPath,c=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",h=l&&l.absolutePositioned,u=this.stroke,f=this.fill,p=this.shadow,g=[],v=t.indexOf("COMMON_PARTS"),m=e.additionalTransform;return l&&(l.clipPathId="CLIPPATH_"+d.Object.__uid++,r='<clipPath id="'+l.clipPathId+'" >\n'+l.toClipPathSVG(o)+"</clipPath>\n"),h&&g.push("<g ",s,this.getSvgCommons()," >\n"),g.push("<g ",this.getSvgTransform(!1),h?"":s+this.getSvgCommons()," >\n"),n=[a,c,i?"":this.addPaintOrder()," ",m?'transform="'+m+'" ':""].join(""),t[v]=n,f&&f.toLive&&g.push(f.toSVG(this)),u&&u.toLive&&g.push(u.toSVG(this)),p&&g.push(p.toSVG(this)),l&&g.push(r),g.push(t.join("")),g.push("</g>\n"),h&&g.push("</g>\n"),o?o(g.join("")):g.join("")},addPaintOrder:function(){return"fill"!==this.paintFirst?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var t=d.util.object.extend,e="stateProperties";function n(e,n,r){var i={};r.forEach((function(t){i[t]=e[t]})),t(e[n],i,!0)}d.util.object.extend(d.Object.prototype,{hasStateChanged:function(t){var n="_"+(t=t||e);return Object.keys(this[n]).length<this[t].length||!function t(e,n,r){if(e===n)return!0;if(Array.isArray(e)){if(!Array.isArray(n)||e.length!==n.length)return!1;for(var i=0,o=e.length;i<o;i++)if(!t(e[i],n[i]))return!1;return!0}if(e&&"object"==typeof e){var a,s=Object.keys(e);if(!n||"object"!=typeof n||!r&&s.length!==Object.keys(n).length)return!1;for(i=0,o=s.length;i<o;i++)if("canvas"!==(a=s[i])&&"group"!==a&&!t(e[a],n[a]))return!1;return!0}}(this[n],this,!0)},saveState:function(t){var r=t&&t.propertySet||e,i="_"+r;return this[i]?(n(this,i,this[r]),t&&t.stateProperties&&n(this,i,t.stateProperties),this):this.setupState(t)},setupState:function(t){var n=(t=t||{}).propertySet||e;return this["_"+(t.propertySet=n)]={},this.saveState(t),this}})}(),function(){var t=d.util.degreesToRadians;d.util.object.extend(d.Object.prototype,{_findTargetCorner:function(t,e){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var n,r,i,o=t.x,a=t.y,s=Object.keys(this.oCoords),l=s.length-1;for(this.__corner=0;0<=l;l--)if(i=s[l],this.isControlVisible(i)&&(r=this._getImageLines(e?this.oCoords[i].touchCorner:this.oCoords[i].corner),0!==(n=this._findCrossPoints({x:o,y:a},r))&&n%2==1))return this.__corner=i;return!1},forEachControl:function(t){for(var e in this.controls)t(this.controls[e],e,this)},_setCornerCoords:function(){var t=this.oCoords;for(var e in t){var n=this.controls[e];t[e].corner=n.calcCornerCoords(this.angle,this.cornerSize,t[e].x,t[e].y,!1),t[e].touchCorner=n.calcCornerCoords(this.angle,this.touchCornerSize,t[e].x,t[e].y,!0)}},drawSelectionBackground:function(e){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;e.save();var n=this.getCenterPoint(),r=this._calculateCurrentDimensions(),i=this.canvas.viewportTransform;return e.translate(n.x,n.y),e.scale(1/i[0],1/i[3]),e.rotate(t(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-r.x/2,-r.y/2,r.x,r.y),e.restore(),this},drawBorders:function(t,e){e=e||{};var n=this._calculateCurrentDimensions(),r=this.borderScaleFactor,i=n.x+r,o=n.y+r,a=void 0!==e.hasControls?e.hasControls:this.hasControls,s=!1;return t.save(),t.strokeStyle=e.borderColor||this.borderColor,this._setLineDash(t,e.borderDashArray||this.borderDashArray,null),t.strokeRect(-i/2,-o/2,i,o),a&&(t.beginPath(),this.forEachControl((function(e,n,r){e.withConnection&&e.getVisibility(r,n)&&(s=!0,t.moveTo(e.x*i,e.y*o),t.lineTo(e.x*i+e.offsetX,e.y*o+e.offsetY))})),s&&t.stroke()),t.restore(),this},drawBordersInGroup:function(t,e,n){n=n||{};var r=d.util.sizeAfterTransform(this.width,this.height,e),i=this.strokeWidth,o=this.strokeUniform,a=this.borderScaleFactor,s=r.x+i*(o?this.canvas.getZoom():e.scaleX)+a,l=r.y+i*(o?this.canvas.getZoom():e.scaleY)+a;return t.save(),this._setLineDash(t,n.borderDashArray||this.borderDashArray,null),t.strokeStyle=n.borderColor||this.borderColor,t.strokeRect(-s/2,-l/2,s,l),t.restore(),this},drawControls:function(t,e){return e=e||{},t.save(),t.setTransform(this.canvas.getRetinaScaling(),0,0,this.canvas.getRetinaScaling(),0,0),t.strokeStyle=t.fillStyle=e.cornerColor||this.cornerColor,this.transparentCorners||(t.strokeStyle=e.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(t,e.cornerDashArray||this.cornerDashArray,null),this.setCoords(),this.forEachControl((function(n,r,i){n.getVisibility(i,r)&&n.render(t,i.oCoords[r].x,i.oCoords[r].y,e,i)})),t.restore(),this},isControlVisible:function(t){return this.controls[t]&&this.controls[t].getVisibility(this,t)},setControlVisible:function(t,e){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[t]=e,this},setControlsVisibility:function(t){for(var e in t||(t={}),t)this.setControlVisible(e,t[e]);return this},onDeselect:function(){},onSelect:function(){}})}(),d.util.object.extend(d.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(t,e){var n=function(){},r=(e=e||{}).onComplete||n,i=e.onChange||n,o=this;return d.util.animate({startValue:t.left,endValue:this.getCenter().left,duration:this.FX_DURATION,onChange:function(e){t.set("left",e),o.requestRenderAll(),i()},onComplete:function(){t.setCoords(),r()}}),this},fxCenterObjectV:function(t,e){var n=function(){},r=(e=e||{}).onComplete||n,i=e.onChange||n,o=this;return d.util.animate({startValue:t.top,endValue:this.getCenter().top,duration:this.FX_DURATION,onChange:function(e){t.set("top",e),o.requestRenderAll(),i()},onComplete:function(){t.setCoords(),r()}}),this},fxRemove:function(t,e){var n=function(){},r=(e=e||{}).onComplete||n,i=e.onChange||n,o=this;return d.util.animate({startValue:t.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(e){t.set("opacity",e),o.requestRenderAll(),i()},onComplete:function(){o.remove(t),r()}}),this}}),d.util.object.extend(d.Object.prototype,{animate:function(){if(arguments[0]&&"object"==typeof arguments[0]){var t,e,n=[];for(t in arguments[0])n.push(t);for(var r=0,i=n.length;r<i;r++)t=n[r],e=r!==i-1,this._animate(t,arguments[0][t],arguments[1],e)}else this._animate.apply(this,arguments);return this},_animate:function(t,e,n,r){var i,o=this;e=e.toString(),n=n?d.util.object.clone(n):{},~t.indexOf(".")&&(i=t.split("."));var a=-1<o.colorProperties.indexOf(t)||i&&-1<o.colorProperties.indexOf(i[1]),s=i?this.get(i[0])[i[1]]:this.get(t);"from"in n||(n.from=s),a||(e=~e.indexOf("=")?s+parseFloat(e.replace("=","")):parseFloat(e));var l={startValue:n.from,endValue:e,byValue:n.by,easing:n.easing,duration:n.duration,abort:n.abort&&function(){return n.abort.call(o)},onChange:function(e,a,s){i?o[i[0]][i[1]]=e:o.set(t,e),r||n.onChange&&n.onChange(e,a,s)},onComplete:function(t,e,i){r||(o.setCoords(),n.onComplete&&n.onComplete(t,e,i))}};a?d.util.animateColor(l.startValue,l.endValue,l.duration,l):d.util.animate(l)}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,r=e.util.object.clone,i={x1:1,x2:1,y1:1,y2:1},o=e.StaticCanvas.supports("setLineDash");function a(t,e){var n=t.origin,r=t.axis1,i=t.axis2,o=t.dimension,a=e.nearest,s=e.center,l=e.farthest;return function(){switch(this.get(n)){case a:return Math.min(this.get(r),this.get(i));case s:return Math.min(this.get(r),this.get(i))+.5*this.get(o);case l:return Math.max(this.get(r),this.get(i))}}}e.Line?e.warn("fabric.Line is already defined"):(e.Line=e.util.createClass(e.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:e.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(t,e){t||(t=[0,0,0,0]),this.callSuper("initialize",e),this.set("x1",t[0]),this.set("y1",t[1]),this.set("x2",t[2]),this.set("y2",t[3]),this._setWidthHeight(e)},_setWidthHeight:function(t){t||(t={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in t?t.left:this._getLeftToOriginX(),this.top="top"in t?t.top:this._getTopToOriginY()},_set:function(t,e){return this.callSuper("_set",t,e),void 0!==i[t]&&this._setWidthHeight(),this},_getLeftToOriginX:a({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:a({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(t){if(t.beginPath(),!this.strokeDashArray||this.strokeDashArray&&o){var e=this.calcLinePoints();t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2)}t.lineWidth=this.strokeWidth;var n=t.strokeStyle;t.strokeStyle=this.stroke||t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=n},_renderDashedStroke:function(t){var n=this.calcLinePoints();t.beginPath(),e.util.drawDashedLine(t,n.x1,n.y1,n.x2,n.y2,this.strokeDashArray),t.closePath()},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(t){return n(this.callSuper("toObject",t),this.calcLinePoints())},_getNonTransformedDimensions:function(){var t=this.callSuper("_getNonTransformedDimensions");return"butt"===this.strokeLineCap&&(0===this.width&&(t.y-=this.strokeWidth),0===this.height&&(t.x-=this.strokeWidth)),t},calcLinePoints:function(){var t=this.x1<=this.x2?-1:1,e=this.y1<=this.y2?-1:1,n=t*this.width*.5,r=e*this.height*.5;return{x1:n,x2:t*this.width*-.5,y1:r,y2:e*this.height*-.5}},_toSVG:function(){var t=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',t.x1,'" y1="',t.y1,'" x2="',t.x2,'" y2="',t.y2,'" />\n']}}),e.Line.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),e.Line.fromElement=function(t,r,i){i=i||{};var o=e.parseAttributes(t,e.Line.ATTRIBUTE_NAMES),a=[o.x1||0,o.y1||0,o.x2||0,o.y2||0];r(new e.Line(a,n(o,i)))},e.Line.fromObject=function(t,n){var i=r(t,!0);i.points=[t.x1,t.y1,t.x2,t.y2],e.Object._fromObject("Line",i,(function(t){delete t.points,n&&n(t)}),"points")})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=Math.PI;e.Circle?e.warn("fabric.Circle is already defined."):(e.Circle=e.util.createClass(e.Object,{type:"circle",radius:0,startAngle:0,endAngle:2*n,cacheProperties:e.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(t,e){return this.callSuper("_set",t,e),"radius"===t&&this.setRadius(e),this},toObject:function(t){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(t))},_toSVG:function(){var t,r=(this.endAngle-this.startAngle)%(2*n);if(0===r)t=["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',this.radius,'" />\n'];else{var i=e.util.cos(this.startAngle)*this.radius,o=e.util.sin(this.startAngle)*this.radius,a=e.util.cos(this.endAngle)*this.radius,s=e.util.sin(this.endAngle)*this.radius,l=n<r?"1":"0";t=['<path d="M '+i+" "+o," A "+this.radius+" "+this.radius," 0 ",+l+" 1"," "+a+" "+s,'" ',"COMMON_PARTS"," />\n"]}return t},_render:function(t){t.beginPath(),t.arc(0,0,this.radius,this.startAngle,this.endAngle,!1),this._renderPaintInOrder(t)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(t){return this.radius=t,this.set("width",2*t).set("height",2*t)}}),e.Circle.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),e.Circle.fromElement=function(t,n){var r,i=e.parseAttributes(t,e.Circle.ATTRIBUTE_NAMES);if(!("radius"in(r=i)&&0<=r.radius))throw new Error("value of `r` attribute is required and can not be negative");i.left=(i.left||0)-i.radius,i.top=(i.top||0)-i.radius,n(new e.Circle(i))},e.Circle.fromObject=function(t,n){return e.Object._fromObject("Circle",t,n)})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Triangle?e.warn("fabric.Triangle is already defined"):(e.Triangle=e.util.createClass(e.Object,{type:"triangle",width:100,height:100,_render:function(t){var e=this.width/2,n=this.height/2;t.beginPath(),t.moveTo(-e,n),t.lineTo(0,-n),t.lineTo(e,n),t.closePath(),this._renderPaintInOrder(t)},_renderDashedStroke:function(t){var n=this.width/2,r=this.height/2;t.beginPath(),e.util.drawDashedLine(t,-n,r,0,-r,this.strokeDashArray),e.util.drawDashedLine(t,0,-r,n,r,this.strokeDashArray),e.util.drawDashedLine(t,n,r,-n,r,this.strokeDashArray),t.closePath()},_toSVG:function(){var t=this.width/2,e=this.height/2;return["<polygon ","COMMON_PARTS",'points="',[-t+" "+e,"0 "+-e,t+" "+e].join(","),'" />']}}),e.Triangle.fromObject=function(t,n){return e.Object._fromObject("Triangle",t,n)})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=2*Math.PI;e.Ellipse?e.warn("fabric.Ellipse is already defined."):(e.Ellipse=e.util.createClass(e.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(t){this.callSuper("initialize",t),this.set("rx",t&&t.rx||0),this.set("ry",t&&t.ry||0)},_set:function(t,e){switch(this.callSuper("_set",t,e),t){case"rx":this.rx=e,this.set("width",2*e);break;case"ry":this.ry=e,this.set("height",2*e)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(t){return this.callSuper("toObject",["rx","ry"].concat(t))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,'" />\n']},_render:function(t){t.beginPath(),t.save(),t.transform(1,0,0,this.ry/this.rx,0,0),t.arc(0,0,this.rx,0,n,!1),t.restore(),this._renderPaintInOrder(t)}}),e.Ellipse.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),e.Ellipse.fromElement=function(t,n){var r=e.parseAttributes(t,e.Ellipse.ATTRIBUTE_NAMES);r.left=(r.left||0)-r.rx,r.top=(r.top||0)-r.ry,n(new e.Ellipse(r))},e.Ellipse.fromObject=function(t,n){return e.Object._fromObject("Ellipse",t,n)})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend;e.Rect?e.warn("fabric.Rect is already defined"):(e.Rect=e.util.createClass(e.Object,{stateProperties:e.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(t){this.callSuper("initialize",t),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(t){var e=this.rx?Math.min(this.rx,this.width/2):0,n=this.ry?Math.min(this.ry,this.height/2):0,r=this.width,i=this.height,o=-this.width/2,a=-this.height/2,s=0!==e||0!==n,l=.4477152502;t.beginPath(),t.moveTo(o+e,a),t.lineTo(o+r-e,a),s&&t.bezierCurveTo(o+r-l*e,a,o+r,a+l*n,o+r,a+n),t.lineTo(o+r,a+i-n),s&&t.bezierCurveTo(o+r,a+i-l*n,o+r-l*e,a+i,o+r-e,a+i),t.lineTo(o+e,a+i),s&&t.bezierCurveTo(o+l*e,a+i,o,a+i-l*n,o,a+i-n),t.lineTo(o,a+n),s&&t.bezierCurveTo(o,a+l*n,o+l*e,a,o+e,a),t.closePath(),this._renderPaintInOrder(t)},_renderDashedStroke:function(t){var n=-this.width/2,r=-this.height/2,i=this.width,o=this.height;t.beginPath(),e.util.drawDashedLine(t,n,r,n+i,r,this.strokeDashArray),e.util.drawDashedLine(t,n+i,r,n+i,r+o,this.strokeDashArray),e.util.drawDashedLine(t,n+i,r+o,n,r+o,this.strokeDashArray),e.util.drawDashedLine(t,n,r+o,n,r,this.strokeDashArray),t.closePath()},toObject:function(t){return this.callSuper("toObject",["rx","ry"].concat(t))},_toSVG:function(){return["<rect ","COMMON_PARTS",'x="',-this.width/2,'" y="',-this.height/2,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,'" />\n']}}),e.Rect.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),e.Rect.fromElement=function(t,r,i){if(!t)return r(null);i=i||{};var o=e.parseAttributes(t,e.Rect.ATTRIBUTE_NAMES);o.left=o.left||0,o.top=o.top||0,o.height=o.height||0,o.width=o.width||0;var a=new e.Rect(n(i?e.util.object.clone(i):{},o));a.visible=a.visible&&0<a.width&&0<a.height,r(a)},e.Rect.fromObject=function(t,n){return e.Object._fromObject("Rect",t,n)})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,r=e.util.array.min,i=e.util.array.max,o=e.util.toFixed;e.Polyline?e.warn("fabric.Polyline is already defined"):(e.Polyline=e.util.createClass(e.Object,{type:"polyline",points:null,cacheProperties:e.Object.prototype.cacheProperties.concat("points"),initialize:function(t,e){e=e||{},this.points=t||[],this.callSuper("initialize",e),this._setPositionDimensions(e)},_setPositionDimensions:function(t){var e,n=this._calcDimensions(t);this.width=n.width,this.height=n.height,t.fromSVG||(e=this.translateToGivenOrigin({x:n.left-this.strokeWidth/2,y:n.top-this.strokeWidth/2},"left","top",this.originX,this.originY)),void 0===t.left&&(this.left=t.fromSVG?n.left:e.x),void 0===t.top&&(this.top=t.fromSVG?n.top:e.y),this.pathOffset={x:n.left+this.width/2,y:n.top+this.height/2}},_calcDimensions:function(){var t=this.points,e=r(t,"x")||0,n=r(t,"y")||0;return{left:e,top:n,width:(i(t,"x")||0)-e,height:(i(t,"y")||0)-n}},toObject:function(t){return n(this.callSuper("toObject",t),{points:this.points.concat()})},_toSVG:function(){for(var t=[],n=this.pathOffset.x,r=this.pathOffset.y,i=e.Object.NUM_FRACTION_DIGITS,a=0,s=this.points.length;a<s;a++)t.push(o(this.points[a].x-n,i),",",o(this.points[a].y-r,i)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',t.join(""),'" />\n']},commonRender:function(t){var e,n=this.points.length,r=this.pathOffset.x,i=this.pathOffset.y;if(!n||isNaN(this.points[n-1].y))return!1;t.beginPath(),t.moveTo(this.points[0].x-r,this.points[0].y-i);for(var o=0;o<n;o++)e=this.points[o],t.lineTo(e.x-r,e.y-i);return!0},_render:function(t){this.commonRender(t)&&this._renderPaintInOrder(t)},_renderDashedStroke:function(t){var n,r;t.beginPath();for(var i=0,o=this.points.length;i<o;i++)n=this.points[i],r=this.points[i+1]||n,e.util.drawDashedLine(t,n.x,n.y,r.x,r.y,this.strokeDashArray)},complexity:function(){return this.get("points").length}}),e.Polyline.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polyline.fromElementGenerator=function(t){return function(r,i,o){if(!r)return i(null);o||(o={});var a=e.parsePointsAttribute(r.getAttribute("points")),s=e.parseAttributes(r,e[t].ATTRIBUTE_NAMES);s.fromSVG=!0,i(new e[t](a,n(s,o)))}},e.Polyline.fromElement=e.Polyline.fromElementGenerator("Polyline"),e.Polyline.fromObject=function(t,n){return e.Object._fromObject("Polyline",t,n,"points")})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Polygon?e.warn("fabric.Polygon is already defined"):(e.Polygon=e.util.createClass(e.Polyline,{type:"polygon",_render:function(t){this.commonRender(t)&&(t.closePath(),this._renderPaintInOrder(t))},_renderDashedStroke:function(t){this.callSuper("_renderDashedStroke",t),t.closePath()}}),e.Polygon.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polygon.fromElement=e.Polyline.fromElementGenerator("Polygon"),e.Polygon.fromObject=function(t,n){return e.Object._fromObject("Polygon",t,n,"points")})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.array.min,r=e.util.array.max,i=e.util.object.extend,o=Object.prototype.toString,a=e.util.toFixed;e.Path?e.warn("fabric.Path is already defined"):(e.Path=e.util.createClass(e.Object,{type:"path",path:null,cacheProperties:e.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:e.Object.prototype.stateProperties.concat("path"),initialize:function(t,n){n=n||{},this.callSuper("initialize",n),t||(t=[]);var r="[object Array]"===o.call(t);this.path=r?e.util.makePathSimpler(t):e.util.makePathSimpler(e.util.parsePath(t)),this.path&&e.Polyline.prototype._setPositionDimensions.call(this,n)},_renderPathCommands:function(t){var e,n=0,r=0,i=0,o=0,a=0,s=0,l=-this.pathOffset.x,c=-this.pathOffset.y;t.beginPath();for(var h=0,u=this.path.length;h<u;++h)switch((e=this.path[h])[0]){case"L":i=e[1],o=e[2],t.lineTo(i+l,o+c);break;case"M":n=i=e[1],r=o=e[2],t.moveTo(i+l,o+c);break;case"C":i=e[5],o=e[6],a=e[3],s=e[4],t.bezierCurveTo(e[1]+l,e[2]+c,a+l,s+c,i+l,o+c);break;case"Q":t.quadraticCurveTo(e[1]+l,e[2]+c,e[3]+l,e[4]+c),i=e[3],o=e[4],a=e[1],s=e[2];break;case"z":case"Z":i=n,o=r,t.closePath()}},_render:function(t){this._renderPathCommands(t),this._renderPaintInOrder(t)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(t){return i(this.callSuper("toObject",t),{path:this.path.map((function(t){return t.slice()}))})},toDatalessObject:function(t){var e=this.toObject(["sourcePath"].concat(t));return e.sourcePath&&delete e.path,e},_toSVG:function(){return["<path ","COMMON_PARTS",'d="',this.path.map((function(t){return t.join(" ")})).join(" "),'" stroke-linecap="round" ',"/>\n"]},_getOffsetTransform:function(){var t=e.Object.NUM_FRACTION_DIGITS;return" translate("+a(-this.pathOffset.x,t)+", "+a(-this.pathOffset.y,t)+")"},toClipPathSVG:function(t){var e=this._getOffsetTransform();return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})},toSVG:function(t){var e=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var t,i,o=[],a=[],s=0,l=0,c=0,h=0,u=0,f=this.path.length;u<f;++u){switch((t=this.path[u])[0]){case"L":c=t[1],h=t[2],i=[];break;case"M":s=c=t[1],l=h=t[2],i=[];break;case"C":i=e.util.getBoundsOfCurve(c,h,t[1],t[2],t[3],t[4],t[5],t[6]),c=t[5],h=t[6];break;case"Q":i=e.util.getBoundsOfCurve(c,h,t[1],t[2],t[1],t[2],t[3],t[4]),c=t[3],h=t[4];break;case"z":case"Z":c=s,h=l}i.forEach((function(t){o.push(t.x),a.push(t.y)})),o.push(c),a.push(h)}var p=n(o)||0,d=n(a)||0;return{left:p,top:d,width:(r(o)||0)-p,height:(r(a)||0)-d}}}),e.Path.fromObject=function(t,n){if("string"==typeof t.sourcePath){var r=t.sourcePath;e.loadSVGFromURL(r,(function(e){var r=e[0];r.setOptions(t),n&&n(r)}))}else e.Object._fromObject("Path",t,n,"path")},e.Path.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(["d"]),e.Path.fromElement=function(t,n,r){var o=e.parseAttributes(t,e.Path.ATTRIBUTE_NAMES);o.fromSVG=!0,n(new e.Path(o.d,i(o,r)))})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.array.min,r=e.util.array.max;e.Group||(e.Group=e.util.createClass(e.Object,e.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(t,e,n){e=e||{},this._objects=[],n&&this.callSuper("initialize",e),this._objects=t||[];for(var r=this._objects.length;r--;)this._objects[r].group=this;if(n)this._updateObjectsACoords();else{var i=e&&e.centerPoint;void 0!==e.originX&&(this.originX=e.originX),void 0!==e.originY&&(this.originY=e.originY),i||this._calcBounds(),this._updateObjectsCoords(i),delete e.centerPoint,this.callSuper("initialize",e)}this.setCoords()},_updateObjectsACoords:function(){for(var t=this._objects.length;t--;)this._objects[t].setCoords(!0)},_updateObjectsCoords:function(t){t=t||this.getCenterPoint();for(var e=this._objects.length;e--;)this._updateObjectCoords(this._objects[e],t)},_updateObjectCoords:function(t,e){var n=t.left,r=t.top;t.set({left:n-e.x,top:r-e.y}),t.group=this,t.setCoords(!0)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(t){return this._restoreObjectsState(),e.util.resetObjectTransform(this),t&&(this._objects.push(t),t.group=this,t._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},removeWithUpdate:function(t){return this._restoreObjectsState(),e.util.resetObjectTransform(this),this.remove(t),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(t){this.dirty=!0,t.group=this,t._set("canvas",this.canvas)},_onObjectRemoved:function(t){this.dirty=!0,delete t.group},_set:function(t,n){var r=this._objects.length;if(this.useSetOnGroup)for(;r--;)this._objects[r].setOnGroup(t,n);if("canvas"===t)for(;r--;)this._objects[r]._set(t,n);e.Object.prototype._set.call(this,t,n)},toObject:function(t){var n=this.includeDefaultValues,r=this._objects.map((function(e){var r=e.includeDefaultValues;e.includeDefaultValues=n;var i=e.toObject(t);return e.includeDefaultValues=r,i})),i=e.Object.prototype.toObject.call(this,t);return i.objects=r,i},toDatalessObject:function(t){var n,r=this.sourcePath;if(r)n=r;else{var i=this.includeDefaultValues;n=this._objects.map((function(e){var n=e.includeDefaultValues;e.includeDefaultValues=i;var r=e.toDatalessObject(t);return e.includeDefaultValues=n,r}))}var o=e.Object.prototype.toDatalessObject.call(this,t);return o.objects=n,o},render:function(t){this._transformDone=!0,this.callSuper("render",t),this._transformDone=!1},shouldCache:function(){var t=e.Object.prototype.shouldCache.call(this);if(t)for(var n=0,r=this._objects.length;n<r;n++)if(this._objects[n].willDrawShadow())return this.ownCaching=!1;return t},willDrawShadow:function(){if(e.Object.prototype.willDrawShadow.call(this))return!0;for(var t=0,n=this._objects.length;t<n;t++)if(this._objects[t].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(t){for(var e=0,n=this._objects.length;e<n;e++)this._objects[e].render(t);this._drawClipPath(t)},isCacheDirty:function(t){if(this.callSuper("isCacheDirty",t))return!0;if(!this.statefullCache)return!1;for(var e=0,n=this._objects.length;e<n;e++)if(this._objects[e].isCacheDirty(!0)){if(this._cacheCanvas){var r=this.cacheWidth/this.zoomX,i=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-r/2,-i/2,r,i)}return!0}return!1},_restoreObjectsState:function(){return this._objects.forEach(this._restoreObjectState,this),this},realizeTransform:function(t){var n=t.calcTransformMatrix(),r=e.util.qrDecompose(n),i=new e.Point(r.translateX,r.translateY);return t.flipX=!1,t.flipY=!1,t.set("scaleX",r.scaleX),t.set("scaleY",r.scaleY),t.skewX=r.skewX,t.skewY=r.skewY,t.angle=r.angle,t.setPositionByOrigin(i,"center","center"),t},_restoreObjectState:function(t){return this.realizeTransform(t),delete t.group,t.setCoords(),this},destroy:function(){return this._objects.forEach((function(t){t.set("dirty",!0)})),this._restoreObjectsState()},toActiveSelection:function(){if(this.canvas){var t=this._objects,n=this.canvas;this._objects=[];var r=this.toObject();delete r.objects;var i=new e.ActiveSelection([]);return i.set(r),i.type="activeSelection",n.remove(this),t.forEach((function(t){t.group=i,t.dirty=!0,n.add(t)})),i.canvas=n,i._objects=t,(n._activeObject=i).setCoords(),i}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){return this.forEachObject((function(t){t.setCoords(!0)})),this},_calcBounds:function(t){for(var e,n,r,i=[],o=[],a=["tr","br","bl","tl"],s=0,l=this._objects.length,c=a.length;s<l;++s)for((e=this._objects[s]).aCoords=e.calcACoords(),r=0;r<c;r++)n=a[r],i.push(e.aCoords[n].x),o.push(e.aCoords[n].y);this._getBounds(i,o,t)},_getBounds:function(t,i,o){var a=new e.Point(n(t),n(i)),s=new e.Point(r(t),r(i)),l=a.y||0,c=a.x||0,h=s.x-a.x||0,u=s.y-a.y||0;this.width=h,this.height=u,o||this.setPositionByOrigin({x:c,y:l},"left","top")},_toSVG:function(t){for(var e=["<g ","COMMON_PARTS"," >\n"],n=0,r=this._objects.length;n<r;n++)e.push("\t\t",this._objects[n].toSVG(t));return e.push("</g>\n"),e},getSvgStyles:function(){var t=void 0!==this.opacity&&1!==this.opacity?"opacity: "+this.opacity+";":"",e=this.visible?"":" visibility: hidden;";return[t,this.getSvgFilter(),e].join("")},toClipPathSVG:function(t){for(var e=[],n=0,r=this._objects.length;n<r;n++)e.push("\t",this._objects[n].toClipPathSVG(t));return this._createBaseClipPathSVGMarkup(e,{reviver:t})}}),e.Group.fromObject=function(t,n){var r=t.objects,i=e.util.object.clone(t,!0);delete i.objects,"string"!=typeof r?e.util.enlivenObjects(r,(function(r){e.util.enlivenObjects([t.clipPath],(function(i){var o=e.util.object.clone(t,!0);o.clipPath=i[0],delete o.objects,n&&n(new e.Group(r,o,!0))}))})):e.loadSVGFromURL(r,(function(o){var a=e.util.groupSVGElements(o,t,r);a.set(i),n&&n(a)}))})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});e.ActiveSelection||(e.ActiveSelection=e.util.createClass(e.Group,{type:"activeSelection",initialize:function(t,n){n=n||{},this._objects=t||[];for(var r=this._objects.length;r--;)this._objects[r].group=this;n.originX&&(this.originX=n.originX),n.originY&&(this.originY=n.originY),this._calcBounds(),this._updateObjectsCoords(),e.Object.prototype.initialize.call(this,n),this.setCoords()},toGroup:function(){var t=this._objects.concat();this._objects=[];var n=e.Object.prototype.toObject.call(this),r=new e.Group([]);if(delete n.type,r.set(n),t.forEach((function(t){t.canvas.remove(t),t.group=r})),r._objects=t,!this.canvas)return r;var i=this.canvas;return i.add(r),(i._activeObject=r).setCoords(),r},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(t,e,n){t.save(),t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",t,e),void 0===(n=n||{}).hasControls&&(n.hasControls=!1),n.forActiveSelection=!0;for(var r=0,i=this._objects.length;r<i;r++)this._objects[r]._renderControls(t,n);t.restore()}}),e.ActiveSelection.fromObject=function(t,n){e.util.enlivenObjects(t.objects,(function(r){delete t.objects,n&&n(new e.ActiveSelection(r,t,!0))}))})}(e),function(t){"use strict";var e=d.util.object.extend;t.fabric||(t.fabric={}),t.fabric.Image?d.warn("fabric.Image is already defined."):(d.Image=d.util.createClass(d.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:d.Object.prototype.stateProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(t,e){e||(e={}),this.filters=[],this.cacheKey="texture"+d.Object.__uid++,this.callSuper("initialize",e),this._initElement(t,e)},getElement:function(){return this._element||{}},setElement:function(t,e){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=t,this._originalElement=t,this._initConfig(e),0!==this.filters.length&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(t){var e=d.filterBackend;e&&e.evictCachesForKey&&e.evictCachesForKey(t)},dispose:function(){this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(t){d.util.cleanUpJsdomNode(this[t]),this[t]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var t=this.getElement();return{width:t.naturalWidth||t.width,height:t.naturalHeight||t.height}},_stroke:function(t){if(this.stroke&&0!==this.strokeWidth){var e=this.width/2,n=this.height/2;t.beginPath(),t.moveTo(-e,-n),t.lineTo(e,-n),t.lineTo(e,n),t.lineTo(-e,n),t.lineTo(-e,-n),t.closePath()}},_renderDashedStroke:function(t){var e=-this.width/2,n=-this.height/2,r=this.width,i=this.height;t.save(),this._setStrokeStyles(t,this),t.beginPath(),d.util.drawDashedLine(t,e,n,e+r,n,this.strokeDashArray),d.util.drawDashedLine(t,e+r,n,e+r,n+i,this.strokeDashArray),d.util.drawDashedLine(t,e+r,n+i,e,n+i,this.strokeDashArray),d.util.drawDashedLine(t,e,n+i,e,n,this.strokeDashArray),t.closePath(),t.restore()},toObject:function(t){var n=[];this.filters.forEach((function(t){t&&n.push(t.toObject())}));var r=e(this.callSuper("toObject",["cropX","cropY"].concat(t)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:n});return this.resizeFilter&&(r.resizeFilter=this.resizeFilter.toObject()),r},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var t,e=[],n=[],r=this._element,i=-this.width/2,o=-this.height/2,a="",s="";if(!r)return[];if(this.hasCrop()){var l=d.Object.__uid++;e.push('<clipPath id="imageCrop_'+l+'">\n','\t<rect x="'+i+'" y="'+o+'" width="'+this.width+'" height="'+this.height+'" />\n',"</clipPath>\n"),a=' clip-path="url(#imageCrop_'+l+')" '}if(this.imageSmoothing||(s='" image-rendering="optimizeSpeed'),n.push("\t<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',i-this.cropX,'" y="',o-this.cropY,'" width="',r.width||r.naturalWidth,'" height="',r.height||r.height,s,'"',a,"></image>\n"),this.stroke||this.strokeDashArray){var c=this.fill;this.fill=null,t=["\t<rect ",'x="',i,'" y="',o,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'],this.fill=c}return"fill"!==this.paintFirst?e.concat(t,n):e.concat(n,t)},getSrc:function(t){var e=t?this._element:this._originalElement;return e?e.toDataURL?e.toDataURL():this.srcFromAttribute?e.getAttribute("src"):e.src:this.src||""},setSrc:function(t,e,n){return d.util.loadImage(t,(function(t,r){this.setElement(t,n),this._setWidthHeight(),e&&e(this,r)}),this,n&&n.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var t=this.resizeFilter,e=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),r=n.scaleX,i=n.scaleY,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!t||e<r&&e<i)return this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=r,void(this._lastScaleY=i);d.filterBackend||(d.filterBackend=d.initFilterBackend());var a=d.util.createCanvasElement(),s=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,l=o.width,c=o.height;a.width=l,a.height=c,this._element=a,this._lastScaleX=t.scaleX=r,this._lastScaleY=t.scaleY=i,d.filterBackend.applyFilters([t],o,l,c,this._element,s),this._filterScalingX=a.width/this._originalElement.width,this._filterScalingY=a.height/this._originalElement.height},applyFilters:function(t){if(t=(t=t||this.filters||[]).filter((function(t){return t&&!t.isNeutralState()})),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),0===t.length)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var e=this._originalElement,n=e.naturalWidth||e.width,r=e.naturalHeight||e.height;if(this._element===this._originalElement){var i=d.util.createCanvasElement();i.width=n,i.height=r,this._element=i,this._filteredEl=i}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,r),this._lastScaleX=1,this._lastScaleY=1;return d.filterBackend||(d.filterBackend=d.initFilterBackend()),d.filterBackend.applyFilters(t,this._originalElement,n,r,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(t){d.util.setImageSmoothing(t,this.imageSmoothing),!0!==this.isMoving&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(t),this._renderPaintInOrder(t)},drawCacheOnCanvas:function(t){d.util.setImageSmoothing(t,this.imageSmoothing),d.Object.prototype.drawCacheOnCanvas.call(this,t)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(t){var e=this._element;if(e){var n=this._filterScalingX,r=this._filterScalingY,i=this.width,o=this.height,a=Math.min,s=Math.max,l=s(this.cropX,0),c=s(this.cropY,0),h=e.naturalWidth||e.width,u=e.naturalHeight||e.height,f=l*n,p=c*r,d=a(i*n,h-f),g=a(o*r,u-p),v=-i/2,m=-o/2,y=a(i,h/n-l),b=a(o,u/n-c);e&&t.drawImage(e,f,p,d,g,v,m,y,b)}},_needsResize:function(){var t=this.getTotalObjectScaling();return t.scaleX!==this._lastScaleX||t.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(t,e){this.setElement(d.util.getById(t),e),d.util.addClass(this.getElement(),d.Image.CSS_CANVAS)},_initConfig:function(t){t||(t={}),this.setOptions(t),this._setWidthHeight(t)},_initFilters:function(t,e){t&&t.length?d.util.enlivenObjects(t,(function(t){e&&e(t)}),"fabric.Image.filters"):e&&e()},_setWidthHeight:function(t){t||(t={});var e=this.getElement();this.width=t.width||e.naturalWidth||e.width||0,this.height=t.height||e.naturalHeight||e.height||0},parsePreserveAspectRatioAttribute:function(){var t,e=d.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),n=this._element.width,r=this._element.height,i=1,o=1,a=0,s=0,l=0,c=0,h=this.width,u=this.height,f={width:h,height:u};return!e||"none"===e.alignX&&"none"===e.alignY?(i=h/n,o=u/r):("meet"===e.meetOrSlice&&(t=(h-n*(i=o=d.util.findScaleToFit(this._element,f)))/2,"Min"===e.alignX&&(a=-t),"Max"===e.alignX&&(a=t),t=(u-r*o)/2,"Min"===e.alignY&&(s=-t),"Max"===e.alignY&&(s=t)),"slice"===e.meetOrSlice&&(t=n-h/(i=o=d.util.findScaleToCover(this._element,f)),"Mid"===e.alignX&&(l=t/2),"Max"===e.alignX&&(l=t),t=r-u/o,"Mid"===e.alignY&&(c=t/2),"Max"===e.alignY&&(c=t),n=h/i,r=u/o)),{width:n,height:r,scaleX:i,scaleY:o,offsetLeft:a,offsetTop:s,cropX:l,cropY:c}}}),d.Image.CSS_CANVAS="canvas-img",d.Image.prototype.getSvgSrc=d.Image.prototype.getSrc,d.Image.fromObject=function(t,e){var n=d.util.object.clone(t);d.util.loadImage(n.src,(function(t,r){r?e&&e(null,!0):d.Image.prototype._initFilters.call(n,n.filters,(function(r){n.filters=r||[],d.Image.prototype._initFilters.call(n,[n.resizeFilter],(function(r){n.resizeFilter=r[0],d.util.enlivenObjects([n.clipPath],(function(r){n.clipPath=r[0];var i=new d.Image(t,n);e(i,!1)}))}))}))}),null,n.crossOrigin)},d.Image.fromURL=function(t,e,n){d.util.loadImage(t,(function(t,r){e&&e(new d.Image(t,n),r)}),null,n&&n.crossOrigin)},d.Image.ATTRIBUTE_NAMES=d.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),d.Image.fromElement=function(t,n,r){var i=d.parseAttributes(t,d.Image.ATTRIBUTE_NAMES);d.Image.fromURL(i["xlink:href"],n,e(r?d.util.object.clone(r):{},i))})}(e),d.util.object.extend(d.Object.prototype,{_getAngleValueForStraighten:function(){var t=this.angle%360;return 0<t?90*Math.round((t-1)/90):90*Math.round(t/90)},straighten:function(){return this.rotate(this._getAngleValueForStraighten()),this},fxStraighten:function(t){var e=function(){},n=(t=t||{}).onComplete||e,r=t.onChange||e,i=this;return d.util.animate({startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(t){i.rotate(t),r()},onComplete:function(){i.setCoords(),n()}}),this}}),d.util.object.extend(d.StaticCanvas.prototype,{straightenObject:function(t){return t.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(t){return t.fxStraighten({onChange:this.requestRenderAllBound}),this}}),function(){"use strict";d.isWebglSupported=function(t){if(d.isLikelyNode)return!1;t=t||d.WebglFilterBackend.prototype.tileSize;var e,n,r,i=document.createElement("canvas"),o=i.getContext("webgl")||i.getContext("experimental-webgl"),a=!1;if(o){d.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),a=d.maxTextureSize>=t;for(var s=["highp","mediump","lowp"],l=0;l<3;l++)if(n="precision "+s[l]+" float;\nvoid main(){}",r=(e=o).createShader(e.FRAGMENT_SHADER),e.shaderSource(r,n),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS)){d.webGlPrecision=s[l];break}}return this.isSupported=a},(d.WebglFilterBackend=function(t){t&&t.tileSize&&(this.tileSize=t.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}).prototype={tileSize:2048,resources:{},setupGLContext:function(t,e){this.dispose(),this.createWebGLCanvas(t,e),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(t,e)},chooseFastestCopyGLTo2DMethod:function(t,e){var n,r=void 0!==window.performance;try{new ImageData(1,1),n=!0}catch(t){n=!1}var i="undefined"!=typeof ArrayBuffer,o="undefined"!=typeof Uint8ClampedArray;if(r&&n&&i&&o){var a=d.util.createCanvasElement(),s=new ArrayBuffer(t*e*4);if(d.forceGLPutImageData)return this.imageBuffer=s,void(this.copyGLTo2D=b);var l,c,h={imageBuffer:s,destinationWidth:t,destinationHeight:e,targetCanvas:a};a.width=t,a.height=e,l=window.performance.now(),y.call(h,this.gl,h),c=window.performance.now()-l,l=window.performance.now(),b.call(h,this.gl,h),window.performance.now()-l<c?(this.imageBuffer=s,this.copyGLTo2D=b):this.copyGLTo2D=y}},createWebGLCanvas:function(t,e){var n=d.util.createCanvasElement();n.width=t,n.height=e;var r={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},i=n.getContext("webgl",r);i||(i=n.getContext("experimental-webgl",r)),i&&(i.clearColor(0,0,0,0),this.canvas=n,this.gl=i)},applyFilters:function(t,e,n,r,i,o){var a,s=this.gl;o&&(a=this.getCachedTexture(o,e));var l={originalWidth:e.width||e.originalWidth,originalHeight:e.height||e.originalHeight,sourceWidth:n,sourceHeight:r,destinationWidth:n,destinationHeight:r,context:s,sourceTexture:this.createTexture(s,n,r,!a&&e),targetTexture:this.createTexture(s,n,r),originalTexture:a||this.createTexture(s,n,r,!a&&e),passes:t.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:i},c=s.createFramebuffer();return s.bindFramebuffer(s.FRAMEBUFFER,c),t.forEach((function(t){t&&t.applyTo(l)})),function(t){var e=t.targetCanvas,n=e.width,r=e.height,i=t.destinationWidth,o=t.destinationHeight;n===i&&r===o||(e.width=i,e.height=o)}(l),this.copyGLTo2D(s,l),s.bindTexture(s.TEXTURE_2D,null),s.deleteTexture(l.sourceTexture),s.deleteTexture(l.targetTexture),s.deleteFramebuffer(c),i.getContext("2d").setTransform(1,0,0,1,0,0),l},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(t,e,n,r){var i=t.createTexture();return t.bindTexture(t.TEXTURE_2D,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),r?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,n,0,t.RGBA,t.UNSIGNED_BYTE,null),i},getCachedTexture:function(t,e){if(this.textureCache[t])return this.textureCache[t];var n=this.createTexture(this.gl,e.width,e.height,e);return this.textureCache[t]=n},evictCachesForKey:function(t){this.textureCache[t]&&(this.gl.deleteTexture(this.textureCache[t]),delete this.textureCache[t])},copyGLTo2D:y,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var t=this.gl,e={renderer:"",vendor:""};if(!t)return e;var n=t.getExtension("WEBGL_debug_renderer_info");if(n){var r=t.getParameter(n.UNMASKED_RENDERER_WEBGL),i=t.getParameter(n.UNMASKED_VENDOR_WEBGL);r&&(e.renderer=r.toLowerCase()),i&&(e.vendor=i.toLowerCase())}return this.gpuInfo=e}}}(),function(){"use strict";var t=function(){};(d.Canvas2dFilterBackend=function(){}).prototype={evictCachesForKey:t,dispose:t,clearWebGLCaches:t,resources:{},applyFilters:function(t,e,n,r,i){var o=i.getContext("2d");o.drawImage(e,0,0,n,r);var a={sourceWidth:n,sourceHeight:r,imageData:o.getImageData(0,0,n,r),originalEl:e,originalImageData:o.getImageData(0,0,n,r),canvasEl:i,ctx:o,filterBackend:this};return t.forEach((function(t){t.applyTo(a)})),a.imageData.width===n&&a.imageData.height===r||(i.width=a.imageData.width,i.height=a.imageData.height),o.putImageData(a.imageData,0,0),a}}}(),d.Image=d.Image||{},d.Image.filters=d.Image.filters||{},d.Image.filters.BaseFilter=d.util.createClass({type:"BaseFilter",vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvoid main() {\nvTexCoord = aPosition;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:"precision highp float;\nvarying vec2 vTexCoord;\nuniform sampler2D uTexture;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\n}",initialize:function(t){t&&this.setOptions(t)},setOptions:function(t){for(var e in t)this[e]=t[e]},createProgram:function(t,e,n){e=e||this.fragmentSource,n=n||this.vertexSource,"highp"!==d.webGlPrecision&&(e=e.replace(/precision highp float/g,"precision "+d.webGlPrecision+" float"));var r=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(r,n),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+t.getShaderInfoLog(r));var i=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(i,e),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+t.getShaderInfoLog(i));var o=t.createProgram();if(t.attachShader(o,r),t.attachShader(o,i),t.linkProgram(o),!t.getProgramParameter(o,t.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+t.getProgramInfoLog(o));var a=this.getAttributeLocations(t,o),s=this.getUniformLocations(t,o)||{};return s.uStepW=t.getUniformLocation(o,"uStepW"),s.uStepH=t.getUniformLocation(o,"uStepH"),{program:o,attributeLocations:a,uniformLocations:s}},getAttributeLocations:function(t,e){return{aPosition:t.getAttribLocation(e,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(t,e,n){var r=e.aPosition,i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i),t.enableVertexAttribArray(r),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)},_setupFrameBuffer:function(t){var e,n,r=t.context;1<t.passes?(e=t.destinationWidth,n=t.destinationHeight,t.sourceWidth===e&&t.sourceHeight===n||(r.deleteTexture(t.targetTexture),t.targetTexture=t.filterBackend.createTexture(r,e,n)),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t.targetTexture,0)):(r.bindFramebuffer(r.FRAMEBUFFER,null),r.finish())},_swapTextures:function(t){t.passes--,t.pass++;var e=t.targetTexture;t.targetTexture=t.sourceTexture,t.sourceTexture=e},isNeutralState:function(){var t=this.mainParameter,e=d.Image.filters[this.type].prototype;if(t){if(Array.isArray(e[t])){for(var n=e[t].length;n--;)if(this[t][n]!==e[t][n])return!1;return!0}return e[t]===this[t]}return!1},applyTo:function(t){t.webgl?(this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)},retrieveShader:function(t){return t.programCache.hasOwnProperty(this.type)||(t.programCache[this.type]=this.createProgram(t.context)),t.programCache[this.type]},applyToWebGL:function(t){var e=t.context,n=this.retrieveShader(t);0===t.pass&&t.originalTexture?e.bindTexture(e.TEXTURE_2D,t.originalTexture):e.bindTexture(e.TEXTURE_2D,t.sourceTexture),e.useProgram(n.program),this.sendAttributeData(e,n.attributeLocations,t.aPosition),e.uniform1f(n.uniformLocations.uStepW,1/t.sourceWidth),e.uniform1f(n.uniformLocations.uStepH,1/t.sourceHeight),this.sendUniformData(e,n.uniformLocations),e.viewport(0,0,t.destinationWidth,t.destinationHeight),e.drawArrays(e.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(t,e,n){t.activeTexture(n),t.bindTexture(t.TEXTURE_2D,e),t.activeTexture(t.TEXTURE0)},unbindAdditionalTexture:function(t,e){t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(t){this[this.mainParameter]=t},sendUniformData:function(){},createHelpLayer:function(t){if(!t.helpLayer){var e=document.createElement("canvas");e.width=t.sourceWidth,e.height=t.sourceHeight,t.helpLayer=e}},toObject:function(){var t={type:this.type},e=this.mainParameter;return e&&(t[e]=this[e]),t},toJSON:function(){return this.toObject()}}),d.Image.filters.BaseFilter.fromObject=function(t,e){var n=new d.Image.filters[t.type](t);return e&&e(n),n},function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass;n.ColorMatrix=r(n.BaseFilter,{type:"ColorMatrix",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nuniform mat4 uColorMatrix;\nuniform vec4 uConstants;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor *= uColorMatrix;\ncolor += uConstants;\ngl_FragColor = color;\n}",matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(t){this.callSuper("initialize",t),this.matrix=this.matrix.slice(0)},applyTo2d:function(t){var e,n,r,i,o,a=t.imageData.data,s=a.length,l=this.matrix,c=this.colorsOnly;for(o=0;o<s;o+=4)e=a[o],n=a[o+1],r=a[o+2],c?(a[o]=e*l[0]+n*l[1]+r*l[2]+255*l[4],a[o+1]=e*l[5]+n*l[6]+r*l[7]+255*l[9],a[o+2]=e*l[10]+n*l[11]+r*l[12]+255*l[14]):(i=a[o+3],a[o]=e*l[0]+n*l[1]+r*l[2]+i*l[3]+255*l[4],a[o+1]=e*l[5]+n*l[6]+r*l[7]+i*l[8]+255*l[9],a[o+2]=e*l[10]+n*l[11]+r*l[12]+i*l[13]+255*l[14],a[o+3]=e*l[15]+n*l[16]+r*l[17]+i*l[18]+255*l[19])},getUniformLocations:function(t,e){return{uColorMatrix:t.getUniformLocation(e,"uColorMatrix"),uConstants:t.getUniformLocation(e,"uConstants")}},sendUniformData:function(t,e){var n=this.matrix,r=[n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]],i=[n[4],n[9],n[14],n[19]];t.uniformMatrix4fv(e.uColorMatrix,!1,r),t.uniform4fv(e.uConstants,i)}}),e.Image.filters.ColorMatrix.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass;n.Brightness=r(n.BaseFilter,{type:"Brightness",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBrightness;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += uBrightness;\ngl_FragColor = color;\n}",brightness:0,mainParameter:"brightness",applyTo2d:function(t){if(0!==this.brightness){var e,n=t.imageData.data,r=n.length,i=Math.round(255*this.brightness);for(e=0;e<r;e+=4)n[e]=n[e]+i,n[e+1]=n[e+1]+i,n[e+2]=n[e+2]+i}},getUniformLocations:function(t,e){return{uBrightness:t.getUniformLocation(e,"uBrightness")}},sendUniformData:function(t,e){t.uniform1f(e.uBrightness,this.brightness)}}),e.Image.filters.Brightness.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,r=e.Image.filters,i=e.util.createClass;r.Convolute=i(r.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_3_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_5_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_5_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_7_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_7_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_9_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_9_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}"},retrieveShader:function(t){var e=Math.sqrt(this.matrix.length),n=this.type+"_"+e+"_"+(this.opaque?1:0),r=this.fragmentSource[n];return t.programCache.hasOwnProperty(n)||(t.programCache[n]=this.createProgram(t.context,r)),t.programCache[n]},applyTo2d:function(t){var e,n,r,i,o,a,s,l,c,h,u,f,p,d=t.imageData,g=d.data,v=this.matrix,m=Math.round(Math.sqrt(v.length)),y=Math.floor(m/2),b=d.width,x=d.height,w=t.ctx.createImageData(b,x),S=w.data,C=this.opaque?1:0;for(u=0;u<x;u++)for(h=0;h<b;h++){for(o=4*(u*b+h),p=i=r=n=e=0;p<m;p++)for(f=0;f<m;f++)a=h+f-y,(s=u+p-y)<0||x<=s||a<0||b<=a||(l=4*(s*b+a),c=v[p*m+f],e+=g[l]*c,n+=g[l+1]*c,r+=g[l+2]*c,C||(i+=g[l+3]*c));S[o]=e,S[o+1]=n,S[o+2]=r,S[o+3]=C?g[o+3]:i}t.imageData=w},getUniformLocations:function(t,e){return{uMatrix:t.getUniformLocation(e,"uMatrix"),uOpaque:t.getUniformLocation(e,"uOpaque"),uHalfSize:t.getUniformLocation(e,"uHalfSize"),uSize:t.getUniformLocation(e,"uSize")}},sendUniformData:function(t,e){t.uniform1fv(e.uMatrix,this.matrix)},toObject:function(){return n(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),e.Image.filters.Convolute.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass;n.Grayscale=r(n.BaseFilter,{type:"Grayscale",fragmentSource:{average:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat average = (color.r + color.b + color.g) / 3.0;\ngl_FragColor = vec4(average, average, average, color.a);\n}",lightness:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;\ngl_FragColor = vec4(average, average, average, col.a);\n}",luminosity:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;\ngl_FragColor = vec4(average, average, average, col.a);\n}"},mode:"average",mainParameter:"mode",applyTo2d:function(t){var e,n,r=t.imageData.data,i=r.length,o=this.mode;for(e=0;e<i;e+=4)"average"===o?n=(r[e]+r[e+1]+r[e+2])/3:"lightness"===o?n=(Math.min(r[e],r[e+1],r[e+2])+Math.max(r[e],r[e+1],r[e+2]))/2:"luminosity"===o&&(n=.21*r[e]+.72*r[e+1]+.07*r[e+2]),r[e]=n,r[e+1]=n,r[e+2]=n},retrieveShader:function(t){var e=this.type+"_"+this.mode;if(!t.programCache.hasOwnProperty(e)){var n=this.fragmentSource[this.mode];t.programCache[e]=this.createProgram(t.context,n)}return t.programCache[e]},getUniformLocations:function(t,e){return{uMode:t.getUniformLocation(e,"uMode")}},sendUniformData:function(t,e){t.uniform1i(e.uMode,1)},isNeutralState:function(){return!1}}),e.Image.filters.Grayscale.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass;n.Invert=r(n.BaseFilter,{type:"Invert",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uInvert;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nif (uInvert == 1) {\ngl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);\n} else {\ngl_FragColor = color;\n}\n}",invert:!0,mainParameter:"invert",applyTo2d:function(t){var e,n=t.imageData.data,r=n.length;for(e=0;e<r;e+=4)n[e]=255-n[e],n[e+1]=255-n[e+1],n[e+2]=255-n[e+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(t,e){return{uInvert:t.getUniformLocation(e,"uInvert")}},sendUniformData:function(t,e){t.uniform1i(e.uInvert,this.invert)}}),e.Image.filters.Invert.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,r=e.Image.filters,i=e.util.createClass;r.Noise=i(r.BaseFilter,{type:"Noise",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uStepH;\nuniform float uNoise;\nuniform float uSeed;\nvarying vec2 vTexCoord;\nfloat rand(vec2 co, float seed, float vScale) {\nreturn fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);\n}\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;\ngl_FragColor = color;\n}",mainParameter:"noise",noise:0,applyTo2d:function(t){if(0!==this.noise){var e,n,r=t.imageData.data,i=r.length,o=this.noise;for(e=0,i=r.length;e<i;e+=4)n=(.5-Math.random())*o,r[e]+=n,r[e+1]+=n,r[e+2]+=n}},getUniformLocations:function(t,e){return{uNoise:t.getUniformLocation(e,"uNoise"),uSeed:t.getUniformLocation(e,"uSeed")}},sendUniformData:function(t,e){t.uniform1f(e.uNoise,this.noise/255),t.uniform1f(e.uSeed,Math.random())},toObject:function(){return n(this.callSuper("toObject"),{noise:this.noise})}}),e.Image.filters.Noise.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass;n.Pixelate=r(n.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBlocksize;\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nfloat blockW = uBlocksize * uStepW;\nfloat blockH = uBlocksize * uStepW;\nint posX = int(vTexCoord.x / blockW);\nint posY = int(vTexCoord.y / blockH);\nfloat fposX = float(posX);\nfloat fposY = float(posY);\nvec2 squareCoords = vec2(fposX * blockW, fposY * blockH);\nvec4 color = texture2D(uTexture, squareCoords);\ngl_FragColor = color;\n}",applyTo2d:function(t){var e,n,r,i,o,a,s,l,c,h,u,f=t.imageData,p=f.data,d=f.height,g=f.width;for(n=0;n<d;n+=this.blocksize)for(r=0;r<g;r+=this.blocksize)for(i=p[e=4*n*g+4*r],o=p[e+1],a=p[e+2],s=p[e+3],h=Math.min(n+this.blocksize,d),u=Math.min(r+this.blocksize,g),l=n;l<h;l++)for(c=r;c<u;c++)p[e=4*l*g+4*c]=i,p[e+1]=o,p[e+2]=a,p[e+3]=s},isNeutralState:function(){return 1===this.blocksize},getUniformLocations:function(t,e){return{uBlocksize:t.getUniformLocation(e,"uBlocksize"),uStepW:t.getUniformLocation(e,"uStepW"),uStepH:t.getUniformLocation(e,"uStepH")}},sendUniformData:function(t,e){t.uniform1f(e.uBlocksize,this.blocksize)}}),e.Image.filters.Pixelate.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,r=e.Image.filters,i=e.util.createClass;r.RemoveColor=i(r.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uLow;\nuniform vec4 uHigh;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\nif(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {\ngl_FragColor.a = 0.0;\n}\n}",distance:.02,useAlpha:!1,applyTo2d:function(t){var n,r,i,o,a=t.imageData.data,s=255*this.distance,l=new e.Color(this.color).getSource(),c=[l[0]-s,l[1]-s,l[2]-s],h=[l[0]+s,l[1]+s,l[2]+s];for(n=0;n<a.length;n+=4)r=a[n],i=a[n+1],o=a[n+2],c[0]<r&&c[1]<i&&c[2]<o&&r<h[0]&&i<h[1]&&o<h[2]&&(a[n+3]=0)},getUniformLocations:function(t,e){return{uLow:t.getUniformLocation(e,"uLow"),uHigh:t.getUniformLocation(e,"uHigh")}},sendUniformData:function(t,n){var r=new e.Color(this.color).getSource(),i=parseFloat(this.distance),o=[0+r[0]/255-i,0+r[1]/255-i,0+r[2]/255-i,1],a=[r[0]/255+i,r[1]/255+i,r[2]/255+i,1];t.uniform4fv(n.uLow,o),t.uniform4fv(n.uHigh,a)},toObject:function(){return n(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),e.Image.filters.RemoveColor.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass,i={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var o in i)n[o]=r(n.ColorMatrix,{type:o,matrix:i[o],mainParameter:!1,colorsOnly:!0}),e.Image.filters[o].fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric,n=e.Image.filters,r=e.util.createClass;n.BlendColor=r(n.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:"gl_FragColor.rgb *= uColor.rgb;\n",screen:"gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);\n",add:"gl_FragColor.rgb += uColor.rgb;\n",diff:"gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);\n",subtract:"gl_FragColor.rgb -= uColor.rgb;\n",lighten:"gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);\n",darken:"gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);\n",exclusion:"gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);\n",overlay:"if (uColor.r < 0.5) {\ngl_FragColor.r *= 2.0 * uColor.r;\n} else {\ngl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);\n}\nif (uColor.g < 0.5) {\ngl_FragColor.g *= 2.0 * uColor.g;\n} else {\ngl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);\n}\nif (uColor.b < 0.5) {\ngl_FragColor.b *= 2.0 * uColor.b;\n} else {\ngl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);\n}\n",tint:"gl_FragColor.rgb *= (1.0 - uColor.a);\ngl_FragColor.rgb += uColor.rgb;\n"},buildSource:function(t){return"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ngl_FragColor = color;\nif (color.a > 0.0) {\n"+this.fragmentSource[t]+"}\n}"},retrieveShader:function(t){var e,n=this.type+"_"+this.mode;return t.programCache.hasOwnProperty(n)||(e=this.buildSource(this.mode),t.programCache[n]=this.createProgram(t.context,e)),t.programCache[n]},applyTo2d:function(t){var n,r,i,o,a,s,l,c=t.imageData.data,h=c.length,u=1-this.alpha;n=(l=new e.Color(this.color).getSource())[0]*this.alpha,r=l[1]*this.alpha,i=l[2]*this.alpha;for(var f=0;f<h;f+=4)switch(o=c[f],a=c[f+1],s=c[f+2],this.mode){case"multiply":c[f]=o*n/255,c[f+1]=a*r/255,c[f+2]=s*i/255;break;case"screen":c[f]=255-(255-o)*(255-n)/255,c[f+1]=255-(255-a)*(255-r)/255,c[f+2]=255-(255-s)*(255-i)/255;break;case"add":c[f]=o+n,c[f+1]=a+r,c[f+2]=s+i;break;case"diff":case"difference":c[f]=Math.abs(o-n),c[f+1]=Math.abs(a-r),c[f+2]=Math.abs(s-i);break;case"subtract":c[f]=o-n,c[f+1]=a-r,c[f+2]=s-i;break;case"darken":c[f]=Math.min(o,n),c[f+1]=Math.min(a,r),c[f+2]=Math.min(s,i);break;case"lighten":c[f]=Math.max(o,n),c[f+1]=Math.max(a,r),c[f+2]=Math.max(s,i);break;case"overlay":c[f]=n<128?2*o*n/255:255-2*(255-o)*(255-n)/255,c[f+1]=r<128?2*a*r/255:255-2*(255-a)*(255-r)/255,c[f+2]=i<128?2*s*i/255:255-2*(255-s)*(255-i)/255;break;case"exclusion":c[f]=n+o-2*n*o/255,c[f+1]=r+a-2*r*a/255,c[f+2]=i+s-2*i*s/255;break;case"tint":c[f]=n+o*u,c[f+1]=r+a*u,c[f+2]=i+s*u}},getUniformLocations:function(t,e){return{uColor:t.getUniformLocation(e,"uColor")}},sendUniformData:function(t,n){var r=new e.Color(this.color).getSource();r[0]=this.alpha*r[0]/255,r[1]=this.alpha*r[1]/255,r[2]=this.alpha*r[2]/255,r[3]=this.alpha,t.uniform4fv(n.uColor,r)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendColor.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric,n=e.Image.filters,r=e.util.createClass;n.BlendImage=r(n.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nuniform mat3 uTransformMatrix;\nvoid main() {\nvTexCoord = aPosition;\nvTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:{multiply:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.rgba *= color2.rgba;\ngl_FragColor = color;\n}",mask:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.a = color2.a;\ngl_FragColor = color;\n}"},retrieveShader:function(t){var e=this.type+"_"+this.mode,n=this.fragmentSource[this.mode];return t.programCache.hasOwnProperty(e)||(t.programCache[e]=this.createProgram(t.context,n)),t.programCache[e]},applyToWebGL:function(t){var e=t.context,n=this.createTexture(t.filterBackend,this.image);this.bindAdditionalTexture(e,n,e.TEXTURE1),this.callSuper("applyToWebGL",t),this.unbindAdditionalTexture(e,e.TEXTURE1)},createTexture:function(t,e){return t.getCachedTexture(e.cacheKey,e._element)},calculateMatrix:function(){var t=this.image,e=t._element.width,n=t._element.height;return[1/t.scaleX,0,0,0,1/t.scaleY,0,-t.left/e,-t.top/n,1]},applyTo2d:function(t){var n,r,i,o,a,s,l,c,h,u,f,p=t.imageData,d=t.filterBackend.resources,g=p.data,v=g.length,m=p.width,y=p.height,b=this.image;d.blendImage||(d.blendImage=e.util.createCanvasElement()),u=(h=d.blendImage).getContext("2d"),h.width!==m||h.height!==y?(h.width=m,h.height=y):u.clearRect(0,0,m,y),u.setTransform(b.scaleX,0,0,b.scaleY,b.left,b.top),u.drawImage(b._element,0,0,m,y),f=u.getImageData(0,0,m,y).data;for(var x=0;x<v;x+=4)switch(a=g[x],s=g[x+1],l=g[x+2],c=g[x+3],n=f[x],r=f[x+1],i=f[x+2],o=f[x+3],this.mode){case"multiply":g[x]=a*n/255,g[x+1]=s*r/255,g[x+2]=l*i/255,g[x+3]=c*o/255;break;case"mask":g[x+3]=o}},getUniformLocations:function(t,e){return{uTransformMatrix:t.getUniformLocation(e,"uTransformMatrix"),uImage:t.getUniformLocation(e,"uImage")}},sendUniformData:function(t,e){var n=this.calculateMatrix();t.uniform1i(e.uImage,1),t.uniformMatrix3fv(e.uTransformMatrix,!1,n)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendImage.fromObject=function(t,n){e.Image.fromObject(t.image,(function(r){var i=e.util.object.clone(t);i.image=r,n(new e.Image.filters.BlendImage(i))}))}}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=Math.pow,r=Math.floor,i=Math.sqrt,o=Math.abs,a=Math.round,s=Math.sin,l=Math.ceil,c=e.Image.filters,h=e.util.createClass;c.Resize=h(c.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(t,e){return{uDelta:t.getUniformLocation(e,"uDelta"),uTaps:t.getUniformLocation(e,"uTaps")}},sendUniformData:function(t,e){t.uniform2fv(e.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),t.uniform1fv(e.uTaps,this.taps)},retrieveShader:function(t){var e=this.getFilterWindow(),n=this.type+"_"+e;if(!t.programCache.hasOwnProperty(n)){var r=this.generateShader(e);t.programCache[n]=this.createProgram(t.context,r)}return t.programCache[n]},getFilterWindow:function(){var t=this.tempScale;return Math.ceil(this.lanczosLobes/t)},getTaps:function(){for(var t=this.lanczosCreate(this.lanczosLobes),e=this.tempScale,n=this.getFilterWindow(),r=new Array(n),i=1;i<=n;i++)r[i-1]=t(i*e);return r},generateShader:function(t){for(var e=new Array(t),n=this.fragmentSourceTOP,r=1;r<=t;r++)e[r-1]=r+".0 * uDelta";return n+="uniform float uTaps["+t+"];\n",n+="void main() {\n",n+="  vec4 color = texture2D(uTexture, vTexCoord);\n",n+="  float sum = 1.0;\n",e.forEach((function(t,e){n+="  color += texture2D(uTexture, vTexCoord + "+t+") * uTaps["+e+"];\n",n+="  color += texture2D(uTexture, vTexCoord - "+t+") * uTaps["+e+"];\n",n+="  sum += 2.0 * uTaps["+e+"];\n"})),n+="  gl_FragColor = color / sum;\n",n+="}"},fragmentSourceTOP:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\n",applyTo:function(t){t.webgl?(t.passes++,this.width=t.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=t.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),t.destinationWidth=this.dW,this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t),t.sourceWidth=t.destinationWidth,this.height=t.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),t.destinationHeight=this.dH,this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t),t.sourceHeight=t.destinationHeight):this.applyTo2d(t)},isNeutralState:function(){return 1===this.scaleX&&1===this.scaleY},lanczosCreate:function(t){return function(e){if(t<=e||e<=-t)return 0;if(e<1.1920929e-7&&-1.1920929e-7<e)return 1;var n=(e*=Math.PI)/t;return s(e)/e*s(n)/n}},applyTo2d:function(t){var e=t.imageData,n=this.scaleX,r=this.scaleY;this.rcpScaleX=1/n,this.rcpScaleY=1/r;var i,o=e.width,s=e.height,l=a(o*n),c=a(s*r);"sliceHack"===this.resizeType?i=this.sliceByTwo(t,o,s,l,c):"hermite"===this.resizeType?i=this.hermiteFastResize(t,o,s,l,c):"bilinear"===this.resizeType?i=this.bilinearFiltering(t,o,s,l,c):"lanczos"===this.resizeType&&(i=this.lanczosResize(t,o,s,l,c)),t.imageData=i},sliceByTwo:function(t,n,i,o,a){var s,l,c=t.imageData,h=!1,u=!1,f=.5*n,p=.5*i,d=e.filterBackend.resources,g=0,v=0,m=n,y=0;for(d.sliceByTwo||(d.sliceByTwo=document.createElement("canvas")),((s=d.sliceByTwo).width<1.5*n||s.height<i)&&(s.width=1.5*n,s.height=i),(l=s.getContext("2d")).clearRect(0,0,1.5*n,i),l.putImageData(c,0,0),o=r(o),a=r(a);!h||!u;)i=p,o<r(.5*(n=f))?f=r(.5*f):(f=o,h=!0),a<r(.5*p)?p=r(.5*p):(p=a,u=!0),l.drawImage(s,g,v,n,i,m,y,f,p),g=m,v=y,y+=p;return l.getImageData(g,v,o,a)},lanczosResize:function(t,e,a,s,c){var h=t.imageData.data,u=t.ctx.createImageData(s,c),f=u.data,p=this.lanczosCreate(this.lanczosLobes),d=this.rcpScaleX,g=this.rcpScaleY,v=2/this.rcpScaleX,m=2/this.rcpScaleY,y=l(d*this.lanczosLobes/2),b=l(g*this.lanczosLobes/2),x={},w={},S={};return function t(l){var C,T,_,O,k,P,E,M,A,L,D;for(w.x=(l+.5)*d,S.x=r(w.x),C=0;C<c;C++){for(w.y=(C+.5)*g,S.y=r(w.y),A=M=E=P=k=0,T=S.x-y;T<=S.x+y;T++)if(!(T<0||e<=T)){L=r(1e3*o(T-w.x)),x[L]||(x[L]={});for(var I=S.y-b;I<=S.y+b;I++)I<0||a<=I||(D=r(1e3*o(I-w.y)),x[L][D]||(x[L][D]=p(i(n(L*v,2)+n(D*m,2))/1e3)),0<(_=x[L][D])&&(k+=_,P+=_*h[O=4*(I*e+T)],E+=_*h[O+1],M+=_*h[O+2],A+=_*h[O+3]))}f[O=4*(C*s+l)]=P/k,f[O+1]=E/k,f[O+2]=M/k,f[O+3]=A/k}return++l<s?t(l):u}(0)},bilinearFiltering:function(t,e,n,i,o){var a,s,l,c,h,u,f,p,d,g=0,v=this.rcpScaleX,m=this.rcpScaleY,y=4*(e-1),b=t.imageData.data,x=t.ctx.createImageData(i,o),w=x.data;for(l=0;l<o;l++)for(c=0;c<i;c++)for(h=v*c-(a=r(v*c)),u=m*l-(s=r(m*l)),d=4*(s*e+a),f=0;f<4;f++)p=b[d+f]*(1-h)*(1-u)+b[d+4+f]*h*(1-u)+b[d+y+f]*u*(1-h)+b[d+y+4+f]*h*u,w[g++]=p;return x},hermiteFastResize:function(t,e,n,a,s){for(var c=this.rcpScaleX,h=this.rcpScaleY,u=l(c/2),f=l(h/2),p=t.imageData.data,d=t.ctx.createImageData(a,s),g=d.data,v=0;v<s;v++)for(var m=0;m<a;m++){for(var y=4*(m+v*a),b=0,x=0,w=0,S=0,C=0,T=0,_=0,O=(v+.5)*h,k=r(v*h);k<(v+1)*h;k++)for(var P=o(O-(k+.5))/f,E=(m+.5)*c,M=P*P,A=r(m*c);A<(m+1)*c;A++){var L=o(E-(A+.5))/u,D=i(M+L*L);1<D&&D<-1||0<(b=2*D*D*D-3*D*D+1)&&(_+=b*p[3+(L=4*(A+k*e))],w+=b,p[L+3]<255&&(b=b*p[L+3]/250),S+=b*p[L],C+=b*p[L+1],T+=b*p[L+2],x+=b)}g[y]=S/x,g[y+1]=C/x,g[y+2]=T/x,g[y+3]=_/w}return d},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),e.Image.filters.Resize.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass;n.Contrast=r(n.BaseFilter,{type:"Contrast",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uContrast;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));\ncolor.rgb = contrastF * (color.rgb - 0.5) + 0.5;\ngl_FragColor = color;\n}",contrast:0,mainParameter:"contrast",applyTo2d:function(t){if(0!==this.contrast){var e,n=t.imageData.data,r=n.length,i=Math.floor(255*this.contrast),o=259*(i+255)/(255*(259-i));for(e=0;e<r;e+=4)n[e]=o*(n[e]-128)+128,n[e+1]=o*(n[e+1]-128)+128,n[e+2]=o*(n[e+2]-128)+128}},getUniformLocations:function(t,e){return{uContrast:t.getUniformLocation(e,"uContrast")}},sendUniformData:function(t,e){t.uniform1f(e.uContrast,this.contrast)}}),e.Image.filters.Contrast.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass;n.Saturation=r(n.BaseFilter,{type:"Saturation",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uSaturation;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat rgMax = max(color.r, color.g);\nfloat rgbMax = max(rgMax, color.b);\ncolor.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;\ncolor.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;\ncolor.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;\ngl_FragColor = color;\n}",saturation:0,mainParameter:"saturation",applyTo2d:function(t){if(0!==this.saturation){var e,n,r=t.imageData.data,i=r.length,o=-this.saturation;for(e=0;e<i;e+=4)n=Math.max(r[e],r[e+1],r[e+2]),r[e]+=n!==r[e]?(n-r[e])*o:0,r[e+1]+=n!==r[e+1]?(n-r[e+1])*o:0,r[e+2]+=n!==r[e+2]?(n-r[e+2])*o:0}},getUniformLocations:function(t,e){return{uSaturation:t.getUniformLocation(e,"uSaturation")}},sendUniformData:function(t,e){t.uniform1f(e.uSaturation,-this.saturation)}}),e.Image.filters.Saturation.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass;n.Blur=r(n.BaseFilter,{type:"Blur",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\nconst float nSamples = 15.0;\nvec3 v3offset = vec3(12.9898, 78.233, 151.7182);\nfloat random(vec3 scale) {\nreturn fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);\n}\nvoid main() {\nvec4 color = vec4(0.0);\nfloat total = 0.0;\nfloat offset = random(v3offset);\nfor (float t = -nSamples; t <= nSamples; t++) {\nfloat percent = (t + offset - 0.5) / nSamples;\nfloat weight = 1.0 - abs(percent);\ncolor += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;\ntotal += weight;\n}\ngl_FragColor = color / total;\n}",blur:0,mainParameter:"blur",applyTo:function(t){t.webgl?(this.aspectRatio=t.sourceWidth/t.sourceHeight,t.passes++,this._setupFrameBuffer(t),this.horizontal=!0,this.applyToWebGL(t),this._swapTextures(t),this._setupFrameBuffer(t),this.horizontal=!1,this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)},applyTo2d:function(t){t.imageData=this.simpleBlur(t)},simpleBlur:function(t){var n,r,i=t.filterBackend.resources,o=t.imageData.width,a=t.imageData.height;i.blurLayer1||(i.blurLayer1=e.util.createCanvasElement(),i.blurLayer2=e.util.createCanvasElement()),n=i.blurLayer1,r=i.blurLayer2,n.width===o&&n.height===a||(r.width=n.width=o,r.height=n.height=a);var s,l,c,h,u=n.getContext("2d"),f=r.getContext("2d"),p=.06*this.blur*.5;for(u.putImageData(t.imageData,0,0),f.clearRect(0,0,o,a),h=-15;h<=15;h++)c=p*(l=h/15)*o+(s=(Math.random()-.5)/4),f.globalAlpha=1-Math.abs(l),f.drawImage(n,c,s),u.drawImage(r,0,0),f.globalAlpha=1,f.clearRect(0,0,r.width,r.height);for(h=-15;h<=15;h++)c=p*(l=h/15)*a+(s=(Math.random()-.5)/4),f.globalAlpha=1-Math.abs(l),f.drawImage(n,s,c),u.drawImage(r,0,0),f.globalAlpha=1,f.clearRect(0,0,r.width,r.height);t.ctx.drawImage(n,0,0);var d=t.ctx.getImageData(0,0,n.width,n.height);return u.globalAlpha=1,u.clearRect(0,0,n.width,n.height),d},getUniformLocations:function(t,e){return{delta:t.getUniformLocation(e,"uDelta")}},sendUniformData:function(t,e){var n=this.chooseRightDelta();t.uniform2fv(e.delta,n)},chooseRightDelta:function(){var t,e=1,n=[0,0];return this.horizontal?1<this.aspectRatio&&(e=1/this.aspectRatio):this.aspectRatio<1&&(e=this.aspectRatio),t=e*this.blur*.12,this.horizontal?n[0]=t:n[1]=t,n}}),n.Blur.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass;n.Gamma=r(n.BaseFilter,{type:"Gamma",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec3 uGamma;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec3 correction = (1.0 / uGamma);\ncolor.r = pow(color.r, correction.r);\ncolor.g = pow(color.g, correction.g);\ncolor.b = pow(color.b, correction.b);\ngl_FragColor = color;\ngl_FragColor.rgb *= color.a;\n}",gamma:[1,1,1],mainParameter:"gamma",initialize:function(t){this.gamma=[1,1,1],n.BaseFilter.prototype.initialize.call(this,t)},applyTo2d:function(t){var e,n=t.imageData.data,r=this.gamma,i=n.length,o=1/r[0],a=1/r[1],s=1/r[2];for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),e=0,i=256;e<i;e++)this.rVals[e]=255*Math.pow(e/255,o),this.gVals[e]=255*Math.pow(e/255,a),this.bVals[e]=255*Math.pow(e/255,s);for(e=0,i=n.length;e<i;e+=4)n[e]=this.rVals[n[e]],n[e+1]=this.gVals[n[e+1]],n[e+2]=this.bVals[n[e+2]]},getUniformLocations:function(t,e){return{uGamma:t.getUniformLocation(e,"uGamma")}},sendUniformData:function(t,e){t.uniform3fv(e.uGamma,this.gamma)}}),e.Image.filters.Gamma.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass;n.Composed=r(n.BaseFilter,{type:"Composed",subFilters:[],initialize:function(t){this.callSuper("initialize",t),this.subFilters=this.subFilters.slice(0)},applyTo:function(t){t.passes+=this.subFilters.length-1,this.subFilters.forEach((function(e){e.applyTo(t)}))},toObject:function(){return e.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map((function(t){return t.toObject()}))})},isNeutralState:function(){return!this.subFilters.some((function(t){return!t.isNeutralState()}))}}),e.Image.filters.Composed.fromObject=function(t,n){var r=(t.subFilters||[]).map((function(t){return new e.Image.filters[t.type](t)})),i=new e.Image.filters.Composed({subFilters:r});return n&&n(i),i}}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,r=e.util.createClass;n.HueRotation=r(n.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var t=this.rotation*Math.PI,n=e.util.cos(t),r=e.util.sin(t),i=Math.sqrt(1/3)*r,o=1-n;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=n+o/3,this.matrix[1]=1/3*o-i,this.matrix[2]=1/3*o+i,this.matrix[5]=1/3*o+i,this.matrix[6]=n+1/3*o,this.matrix[7]=1/3*o-i,this.matrix[10]=1/3*o-i,this.matrix[11]=1/3*o+i,this.matrix[12]=n+1/3*o},isNeutralState:function(t){return this.calculateMatrix(),n.BaseFilter.prototype.isNeutralState.call(this,t)},applyTo:function(t){this.calculateMatrix(),n.BaseFilter.prototype.applyTo.call(this,t)}}),e.Image.filters.HueRotation.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.clone;if(e.Text)e.warn("fabric.Text is already defined");else{var r="fontFamily fontWeight fontSize text underline overline linethrough"+" textAlign fontStyle lineHeight textBackgroundColor charSpacing styles path".split(" ");e.Text=e.util.createClass(e.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:e.Object.prototype.stateProperties.concat(r),cacheProperties:e.Object.prototype.cacheProperties.concat(r),stroke:null,shadow:null,_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(t,e){this.styles=e&&e.styles||{},this.text=t,this.__skipDimension=!0,this.callSuper("initialize",e),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var t=this.path;t&&(t.segmentsInfo=e.util.getPathSegmentsInfo(t.path))},getMeasuringContext:function(){return e._measuringContext||(e._measuringContext=this.canvas&&this.canvas.contextCache||e.util.createCanvasElement().getContext("2d")),e._measuringContext},_splitText:function(){var t=this._splitTextIntoLines(this.text);return this.textLines=t.lines,this._textLines=t.graphemeLines,this._unwrappedTextLines=t._unwrappedLines,this._text=t.graphemeText,t},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var t,e,n,r,i,o,a,s=0,l=this._textLines.length;s<l;s++)if(("justify"===this.textAlign||s!==l-1&&!this.isEndOfWrapping(s))&&(r=0,i=this._textLines[s],(e=this.getLineWidth(s))<this.width&&(a=this.textLines[s].match(this._reSpacesAndTabs)))){n=a.length,t=(this.width-e)/n;for(var c=0,h=i.length;c<=h;c++)o=this.__charBounds[s][c],this._reSpaceAndTab.test(i[c])?(o.width+=t,o.kernedWidth+=t,o.left+=r,r+=t):o.left+=r}},isEndOfWrapping:function(t){return t===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var t=this.callSuper("_getCacheCanvasDimensions"),e=this.fontSize;return t.width+=e*t.zoomX,t.height+=e*t.zoomY,t},_render:function(t){this._setTextStyles(t),this._renderTextLinesBackground(t),this._renderTextDecoration(t,"underline"),this._renderText(t),this._renderTextDecoration(t,"overline"),this._renderTextDecoration(t,"linethrough")},_renderText:function(t){"stroke"===this.paintFirst?(this._renderTextStroke(t),this._renderTextFill(t)):(this._renderTextFill(t),this._renderTextStroke(t))},_setTextStyles:function(t,e,n){t.textBaseline="alphabetic",t.font=this._getFontDeclaration(e,n)},calcTextWidth:function(){for(var t=this.getLineWidth(0),e=1,n=this._textLines.length;e<n;e++){var r=this.getLineWidth(e);t<r&&(t=r)}return t},_renderTextLine:function(t,e,n,r,i,o){this._renderChars(t,e,n,r,i,o)},_renderTextLinesBackground:function(t){if(this.textBackgroundColor||this.styleHas("textBackgroundColor")){for(var e,n,r,i,o,a,s=t.fillStyle,l=this._getLeftOffset(),c=this._getTopOffset(),h=0,u=0,f=this.path,p=0,d=this._textLines.length;p<d;p++)if(e=this.getHeightOfLine(p),this.textBackgroundColor||this.styleHas("textBackgroundColor",p)){r=this._textLines[p],n=this._getLineLeftOffset(p),h=u=0,i=this.getValueOfPropertyAt(p,0,"textBackgroundColor");for(var g=0,v=r.length;g<v;g++)o=this.__charBounds[p][g],a=this.getValueOfPropertyAt(p,g,"textBackgroundColor"),f?(t.save(),t.translate(o.renderLeft,o.renderTop),t.rotate(o.angle),(t.fillStyle=a)&&t.fillRect(-o.width/2,-e/this.lineHeight*(1-this._fontSizeFraction),o.width,e/this.lineHeight),t.restore()):a!==i?((t.fillStyle=i)&&t.fillRect(l+n+h,c,u,e/this.lineHeight),h=o.left,u=o.width,i=a):u+=o.kernedWidth;a&&!f&&(t.fillStyle=a,t.fillRect(l+n+h,c,u,e/this.lineHeight)),c+=e}else c+=e;t.fillStyle=s,this._removeShadow(t)}},getFontCache:function(t){var n=t.fontFamily.toLowerCase();e.charWidthsCache[n]||(e.charWidthsCache[n]={});var r=e.charWidthsCache[n],i=t.fontStyle.toLowerCase()+"_"+(t.fontWeight+"").toLowerCase();return r[i]||(r[i]={}),r[i]},_measureChar:function(t,e,n,r){var i,o,a,s,l=this.getFontCache(e),c=n+t,h=this._getFontDeclaration(e)===this._getFontDeclaration(r),u=e.fontSize/this.CACHE_FONT_SIZE;if(n&&void 0!==l[n]&&(a=l[n]),void 0!==l[t]&&(s=i=l[t]),h&&void 0!==l[c]&&(s=(o=l[c])-a),void 0===i||void 0===a||void 0===o){var f=this.getMeasuringContext();this._setTextStyles(f,e,!0)}return void 0===i&&(s=i=f.measureText(t).width,l[t]=i),void 0===a&&h&&n&&(a=f.measureText(n).width,l[n]=a),h&&void 0===o&&(o=f.measureText(c).width,s=(l[c]=o)-a),{width:i*u,kernedWidth:s*u}},getHeightOfChar:function(t,e){return this.getValueOfPropertyAt(t,e,"fontSize")},measureLine:function(t){var e=this._measureLine(t);return 0!==this.charSpacing&&(e.width-=this._getWidthOfCharSpacing()),e.width<0&&(e.width=0),e},_measureLine:function(t){var n,r,i,o,a,s,l=0,c=this._textLines[t],h=new Array(c.length),u=0,f=this.path;for(this.__charBounds[t]=h,f&&(a=e.util.getPointOnPath(f.path,0,f.segmentsInfo),s=f.segmentsInfo[f.segmentsInfo.length-1].length,a.x+=f.pathOffset.x,a.y+=f.pathOffset.y),n=0;n<c.length;n++)r=c[n],o=this._getGraphemeBox(r,t,n,i),f&&(s<u&&(u%=s),this._setGraphemeOnPath(u,o,a)),l+=(h[n]=o).kernedWidth,u+=o.kernedWidth,i=r;return h[n]={left:o?o.left+o.width:0,width:0,kernedWidth:0,height:this.fontSize},{width:l,numOfSpaces:0}},_setGraphemeOnPath:function(t,n,r){var i=t+n.kernedWidth/2,o=this.path,a=e.util.getPointOnPath(o.path,i,o.segmentsInfo);n.renderLeft=a.x-r.x,n.renderTop=a.y-r.y,n.angle=a.angle},_getGraphemeBox:function(t,e,n,r,i){var o,a=this.getCompleteStyleDeclaration(e,n),s=r?this.getCompleteStyleDeclaration(e,n-1):{},l=this._measureChar(t,a,r,s),c=l.kernedWidth,h=l.width;0!==this.charSpacing&&(h+=o=this._getWidthOfCharSpacing(),c+=o);var u={width:h,left:0,height:a.fontSize,kernedWidth:c,deltaY:a.deltaY};if(0<n&&!i){var f=this.__charBounds[e][n-1];u.left=f.left+f.width+l.kernedWidth-l.width}return u},getHeightOfLine:function(t){if(this.__lineHeights[t])return this.__lineHeights[t];for(var e=this._textLines[t],n=this.getHeightOfChar(t,0),r=1,i=e.length;r<i;r++)n=Math.max(this.getHeightOfChar(t,r),n);return this.__lineHeights[t]=n*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var t,e=0,n=0,r=this._textLines.length;n<r;n++)t=this.getHeightOfLine(n),e+=n===r-1?t/this.lineHeight:t;return e},_getLeftOffset:function(){return-this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(t,e){t.save();for(var n=0,r=this._getLeftOffset(),i=this._getTopOffset(),o=0,a=this._textLines.length;o<a;o++){var s=this.getHeightOfLine(o),l=s/this.lineHeight,c=this._getLineLeftOffset(o);this._renderTextLine(e,t,this._textLines[o],r+c,i+n+l,o),n+=s}t.restore()},_renderTextFill:function(t){(this.fill||this.styleHas("fill"))&&this._renderTextCommon(t,"fillText")},_renderTextStroke:function(t){(this.stroke&&0!==this.strokeWidth||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this._setLineDash(t,this.strokeDashArray),t.beginPath(),this._renderTextCommon(t,"strokeText"),t.closePath(),t.restore())},_renderChars:function(t,e,n,r,i,o){var a,s,l,c,h=this.getHeightOfLine(o),u=-1!==this.textAlign.indexOf("justify"),f="",p=0,d=this.path,g=!u&&0===this.charSpacing&&this.isEmptyStyles(o)&&!d;if(e.save(),i-=h*this._fontSizeFraction/this.lineHeight,g)return this._renderChar(t,e,o,0,n.join(""),r,i,h),void e.restore();for(var v=0,m=n.length-1;v<=m;v++)c=v===m||this.charSpacing||d,f+=n[v],l=this.__charBounds[o][v],0===p?(r+=l.kernedWidth-l.width,p+=l.width):p+=l.kernedWidth,u&&!c&&this._reSpaceAndTab.test(n[v])&&(c=!0),c||(a=a||this.getCompleteStyleDeclaration(o,v),s=this.getCompleteStyleDeclaration(o,v+1),c=this._hasStyleChanged(a,s)),c&&(d?(e.save(),e.translate(l.renderLeft,l.renderTop),e.rotate(l.angle),this._renderChar(t,e,o,v,f,-p/2,0,h),e.restore()):this._renderChar(t,e,o,v,f,r,i,h),f="",a=s,r+=p,p=0);e.restore()},_applyPatternGradientTransformText:function(t){var n,r=e.util.createCanvasElement(),i=this.width+this.strokeWidth,o=this.height+this.strokeWidth;return r.width=i,r.height=o,(n=r.getContext("2d")).beginPath(),n.moveTo(0,0),n.lineTo(i,0),n.lineTo(i,o),n.lineTo(0,o),n.closePath(),n.translate(i/2,o/2),n.fillStyle=t.toLive(n),this._applyPatternGradientTransform(n,t),n.fill(),n.createPattern(r,"no-repeat")},handleFiller:function(t,e,n){var r,i;return n.toLive?"percentage"===n.gradientUnits||n.gradientTrasnform||n.patternTransform?(r=-this.width/2,i=-this.height/2,t.translate(r,i),t[e]=this._applyPatternGradientTransformText(n),{offsetX:r,offsetY:i}):(t[e]=n.toLive(t,this),this._applyPatternGradientTransform(t,n)):(t[e]=n,{offsetX:0,offsetY:0})},_setStrokeStyles:function(t,e){return t.lineWidth=e.strokeWidth,t.lineCap=this.strokeLineCap,t.lineDashOffset=this.strokeDashOffset,t.lineJoin=this.strokeLineJoin,t.miterLimit=this.strokeMiterLimit,this.handleFiller(t,"strokeStyle",e.stroke)},_setFillStyles:function(t,e){return this.handleFiller(t,"fillStyle",e.fill)},_renderChar:function(t,e,n,r,i,o,a){var s,l,c=this._getStyleDeclaration(n,r),h=this.getCompleteStyleDeclaration(n,r),u="fillText"===t&&h.fill,f="strokeText"===t&&h.stroke&&h.strokeWidth;(f||u)&&(e.save(),u&&(s=this._setFillStyles(e,h)),f&&(l=this._setStrokeStyles(e,h)),e.font=this._getFontDeclaration(h),c&&c.textBackgroundColor&&this._removeShadow(e),c&&c.deltaY&&(a+=c.deltaY),u&&e.fillText(i,o-s.offsetX,a-s.offsetY),f&&e.strokeText(i,o-l.offsetX,a-l.offsetY),e.restore())},setSuperscript:function(t,e){return this._setScript(t,e,this.superscript)},setSubscript:function(t,e){return this._setScript(t,e,this.subscript)},_setScript:function(t,e,n){var r=this.get2DCursorLocation(t,!0),i=this.getValueOfPropertyAt(r.lineIndex,r.charIndex,"fontSize"),o=this.getValueOfPropertyAt(r.lineIndex,r.charIndex,"deltaY"),a={fontSize:i*n.size,deltaY:o+i*n.baseline};return this.setSelectionStyles(a,t,e),this},_hasStyleChanged:function(t,e){return t.fill!==e.fill||t.stroke!==e.stroke||t.strokeWidth!==e.strokeWidth||t.fontSize!==e.fontSize||t.fontFamily!==e.fontFamily||t.fontWeight!==e.fontWeight||t.fontStyle!==e.fontStyle||t.deltaY!==e.deltaY},_hasStyleChangedForSvg:function(t,e){return this._hasStyleChanged(t,e)||t.overline!==e.overline||t.underline!==e.underline||t.linethrough!==e.linethrough},_getLineLeftOffset:function(t){var e=this.getLineWidth(t);return"center"===this.textAlign?(this.width-e)/2:"right"===this.textAlign?this.width-e:"justify-center"===this.textAlign&&this.isEndOfWrapping(t)?(this.width-e)/2:"justify-right"===this.textAlign&&this.isEndOfWrapping(t)?this.width-e:0},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var t=this._forceClearCache;return t||(t=this.hasStateChanged("_dimensionAffectingProps")),t&&(this.dirty=!0,this._forceClearCache=!1),t},getLineWidth:function(t){return this.__lineWidths[t]?this.__lineWidths[t]:(e=""===this._textLines[t]?0:this.measureLine(t).width,this.__lineWidths[t]=e);var e},_getWidthOfCharSpacing:function(){return 0!==this.charSpacing?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(t,e,n){var r=this._getStyleDeclaration(t,e);return r&&void 0!==r[n]?r[n]:this[n]},_renderTextDecoration:function(t,e){if(this[e]||this.styleHas(e)){for(var n,r,i,o,a,s,l,c,h,u,f,p,d,g,v,m,y=this._getLeftOffset(),b=this._getTopOffset(),x=this.path,w=this._getWidthOfCharSpacing(),S=0,C=this._textLines.length;S<C;S++)if(n=this.getHeightOfLine(S),this[e]||this.styleHas(e,S)){l=this._textLines[S],g=n/this.lineHeight,o=this._getLineLeftOffset(S),f=u=0,c=this.getValueOfPropertyAt(S,0,e),m=this.getValueOfPropertyAt(S,0,"fill"),h=b+g*(1-this._fontSizeFraction),r=this.getHeightOfChar(S,0),a=this.getValueOfPropertyAt(S,0,"deltaY");for(var T=0,_=l.length;T<_;T++)p=this.__charBounds[S][T],d=this.getValueOfPropertyAt(S,T,e),v=this.getValueOfPropertyAt(S,T,"fill"),i=this.getHeightOfChar(S,T),s=this.getValueOfPropertyAt(S,T,"deltaY"),x&&d&&v?(t.save(),t.fillStyle=m,t.translate(p.renderLeft,p.renderTop),t.rotate(p.angle),t.fillRect(-p.kernedWidth/2,this.offsets[e]*i+s,p.kernedWidth,this.fontSize/15),t.restore()):(d!==c||v!==m||i!==r||s!==a)&&0<f?(c&&m&&t.fillRect(y+o+u,h+this.offsets[e]*r+a,f,this.fontSize/15),u=p.left,f=p.width,c=d,m=v,r=i,a=s):f+=p.kernedWidth;t.fillStyle=v,d&&v&&t.fillRect(y+o+u,h+this.offsets[e]*r+a,f-w,this.fontSize/15),b+=n}else b+=n;this._removeShadow(t)}},_getFontDeclaration:function(t,n){var r=t||this,i=this.fontFamily,o=-1<e.Text.genericFonts.indexOf(i.toLowerCase()),a=void 0===i||-1<i.indexOf("'")||-1<i.indexOf(",")||-1<i.indexOf('"')||o?r.fontFamily:'"'+r.fontFamily+'"';return[e.isLikelyNode?r.fontWeight:r.fontStyle,e.isLikelyNode?r.fontStyle:r.fontWeight,n?this.CACHE_FONT_SIZE+"px":r.fontSize+"px",a].join(" ")},render:function(t){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",t)))},_splitTextIntoLines:function(t){for(var n=t.split(this._reNewline),r=new Array(n.length),i=["\n"],o=[],a=0;a<n.length;a++)r[a]=e.util.string.graphemeSplit(n[a]),o=o.concat(r[a],i);return o.pop(),{_unwrappedLines:r,lines:n,graphemeText:o,graphemeLines:r}},toObject:function(t){var e=["text","fontSize","fontWeight","fontFamily","fontStyle","lineHeight","underline","overline","linethrough","textAlign","textBackgroundColor","charSpacing"].concat(t),r=this.callSuper("toObject",e);return r.styles=n(this.styles,!0),r},set:function(t,e){this.callSuper("set",t,e);var n=!1,r=!1;if("object"==typeof t)for(var i in t)"path"===i&&this.setPathInfo(),n=n||-1!==this._dimensionAffectingProps.indexOf(i),r=r||"path"===i;else n=-1!==this._dimensionAffectingProps.indexOf(t),r="path"===t;return r&&this.setPathInfo(),n&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),e.Text.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),e.Text.DEFAULT_SVG_FONT_SIZE=16,e.Text.fromElement=function(t,r,i){if(!t)return r(null);var o=e.parseAttributes(t,e.Text.ATTRIBUTE_NAMES),a=o.textAnchor||"left";if((i=e.util.object.extend(i?n(i):{},o)).top=i.top||0,i.left=i.left||0,o.textDecoration){var s=o.textDecoration;-1!==s.indexOf("underline")&&(i.underline=!0),-1!==s.indexOf("overline")&&(i.overline=!0),-1!==s.indexOf("line-through")&&(i.linethrough=!0),delete i.textDecoration}"dx"in o&&(i.left+=o.dx),"dy"in o&&(i.top+=o.dy),"fontSize"in i||(i.fontSize=e.Text.DEFAULT_SVG_FONT_SIZE);var l="";"textContent"in t?l=t.textContent:"firstChild"in t&&null!==t.firstChild&&"data"in t.firstChild&&null!==t.firstChild.data&&(l=t.firstChild.data),l=l.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var c=i.strokeWidth;i.strokeWidth=0;var h=new e.Text(l,i),u=h.getScaledHeight()/h.height,f=((h.height+h.strokeWidth)*h.lineHeight-h.height)*u,p=h.getScaledHeight()+f,d=0;"center"===a&&(d=h.getScaledWidth()/2),"right"===a&&(d=h.getScaledWidth()),h.set({left:h.left-d,top:h.top-(p-h.fontSize*(.07+h._fontSizeFraction))/h.lineHeight,strokeWidth:void 0!==c?c:1}),r(h)},e.Text.fromObject=function(t,n){return e.Object._fromObject("Text",t,n,"text")},e.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],e.util.createAccessors&&e.util.createAccessors(e.Text)}}(e),d.util.object.extend(d.Text.prototype,{isEmptyStyles:function(t){if(!this.styles)return!0;if(void 0!==t&&!this.styles[t])return!0;var e=void 0===t?this.styles:{line:this.styles[t]};for(var n in e)for(var r in e[n])for(var i in e[n][r])return!1;return!0},styleHas:function(t,e){if(!this.styles||!t||""===t)return!1;if(void 0!==e&&!this.styles[e])return!1;var n=void 0===e?this.styles:{0:this.styles[e]};for(var r in n)for(var i in n[r])if(void 0!==n[r][i][t])return!0;return!1},cleanStyle:function(t){if(!this.styles||!t||""===t)return!1;var e,n,r=this.styles,i=0,o=!0,a=0;for(var s in r){for(var l in e=0,r[s]){var c;i++,(c=r[s][l]).hasOwnProperty(t)?(n?c[t]!==n&&(o=!1):n=c[t],c[t]===this[t]&&delete c[t]):o=!1,0!==Object.keys(c).length?e++:delete r[s][l]}0===e&&delete r[s]}for(var h=0;h<this._textLines.length;h++)a+=this._textLines[h].length;o&&i===a&&(this[t]=n,this.removeStyle(t))},removeStyle:function(t){if(this.styles&&t&&""!==t){var e,n,r,i=this.styles;for(n in i){for(r in e=i[n])delete e[r][t],0===Object.keys(e[r]).length&&delete e[r];0===Object.keys(e).length&&delete i[n]}}},_extendStyles:function(t,e){var n=this.get2DCursorLocation(t);this._getLineStyle(n.lineIndex)||this._setLineStyle(n.lineIndex),this._getStyleDeclaration(n.lineIndex,n.charIndex)||this._setStyleDeclaration(n.lineIndex,n.charIndex,{}),d.util.object.extend(this._getStyleDeclaration(n.lineIndex,n.charIndex),e)},get2DCursorLocation:function(t,e){void 0===t&&(t=this.selectionStart);for(var n=e?this._unwrappedTextLines:this._textLines,r=n.length,i=0;i<r;i++){if(t<=n[i].length)return{lineIndex:i,charIndex:t};t-=n[i].length+this.missingNewlineOffset(i)}return{lineIndex:i-1,charIndex:n[i-1].length<t?n[i-1].length:t}},getSelectionStyles:function(t,e,n){void 0===t&&(t=this.selectionStart||0),void 0===e&&(e=this.selectionEnd||t);for(var r=[],i=t;i<e;i++)r.push(this.getStyleAtPosition(i,n));return r},getStyleAtPosition:function(t,e){var n=this.get2DCursorLocation(t);return(e?this.getCompleteStyleDeclaration(n.lineIndex,n.charIndex):this._getStyleDeclaration(n.lineIndex,n.charIndex))||{}},setSelectionStyles:function(t,e,n){void 0===e&&(e=this.selectionStart||0),void 0===n&&(n=this.selectionEnd||e);for(var r=e;r<n;r++)this._extendStyles(r,t);return this._forceClearCache=!0,this},_getStyleDeclaration:function(t,e){var n=this.styles&&this.styles[t];return n?n[e]:null},getCompleteStyleDeclaration:function(t,e){for(var n,r=this._getStyleDeclaration(t,e)||{},i={},o=0;o<this._styleProperties.length;o++)i[n=this._styleProperties[o]]=void 0===r[n]?this[n]:r[n];return i},_setStyleDeclaration:function(t,e,n){this.styles[t][e]=n},_deleteStyleDeclaration:function(t,e){delete this.styles[t][e]},_getLineStyle:function(t){return!!this.styles[t]},_setLineStyle:function(t){this.styles[t]={}},_deleteLineStyle:function(t){delete this.styles[t]}}),function(){function t(t){t.textDecoration&&(-1<t.textDecoration.indexOf("underline")&&(t.underline=!0),-1<t.textDecoration.indexOf("line-through")&&(t.linethrough=!0),-1<t.textDecoration.indexOf("overline")&&(t.overline=!0),delete t.textDecoration)}d.IText=d.util.createClass(d.Text,d.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(t,e){this.callSuper("initialize",t,e),this.initBehavior()},setSelectionStart:function(t){t=Math.max(t,0),this._updateAndFire("selectionStart",t)},setSelectionEnd:function(t){t=Math.min(t,this.text.length),this._updateAndFire("selectionEnd",t)},_updateAndFire:function(t,e){this[t]!==e&&(this._fireSelectionChanged(),this[t]=e),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(t){this.clearContextTop(),this.callSuper("render",t),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(t){this.callSuper("_render",t)},clearContextTop:function(t){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var e=this.canvas.contextTop,n=this.canvas.viewportTransform;e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this.transform(e),this._clearTextArea(e),t||e.restore()}},renderCursorOrSelection:function(){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var t=this._getCursorBoundaries(),e=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(t,e):this.renderSelection(t,e),e.restore()}},_clearTextArea:function(t){var e=this.width+4,n=this.height+4;t.clearRect(-e/2,-n/2,e,n)},_getCursorBoundaries:function(t){void 0===t&&(t=this.selectionStart);var e=this._getLeftOffset(),n=this._getTopOffset(),r=this._getCursorBoundariesOffsets(t);return{left:e,top:n,leftOffset:r.left,topOffset:r.top}},_getCursorBoundariesOffsets:function(t){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var e,n,r,i,o=0,a=0,s=this.get2DCursorLocation(t);r=s.charIndex,n=s.lineIndex;for(var l=0;l<n;l++)o+=this.getHeightOfLine(l);e=this._getLineLeftOffset(n);var c=this.__charBounds[n][r];return c&&(a=c.left),0!==this.charSpacing&&r===this._textLines[n].length&&(a-=this._getWidthOfCharSpacing()),i={top:o,left:e+(0<a?a:0)},this.cursorOffsetCache=i,this.cursorOffsetCache},renderCursor:function(t,e){var n=this.get2DCursorLocation(),r=n.lineIndex,i=0<n.charIndex?n.charIndex-1:0,o=this.getValueOfPropertyAt(r,i,"fontSize"),a=this.scaleX*this.canvas.getZoom(),s=this.cursorWidth/a,l=t.topOffset,c=this.getValueOfPropertyAt(r,i,"deltaY");l+=(1-this._fontSizeFraction)*this.getHeightOfLine(r)/this.lineHeight-o*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(t,e),e.fillStyle=this.cursorColor||this.getValueOfPropertyAt(r,i,"fill"),e.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,e.fillRect(t.left+t.leftOffset-s/2,l+t.top+c,s,o)},renderSelection:function(t,e){for(var n=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,r=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,i=-1!==this.textAlign.indexOf("justify"),o=this.get2DCursorLocation(n),a=this.get2DCursorLocation(r),s=o.lineIndex,l=a.lineIndex,c=o.charIndex<0?0:o.charIndex,h=a.charIndex<0?0:a.charIndex,u=s;u<=l;u++){var f,p=this._getLineLeftOffset(u)||0,d=this.getHeightOfLine(u),g=0,v=0;if(u===s&&(g=this.__charBounds[s][c].left),s<=u&&u<l)v=i&&!this.isEndOfWrapping(u)?this.width:this.getLineWidth(u)||5;else if(u===l)if(0===h)v=this.__charBounds[l][h].left;else{var m=this._getWidthOfCharSpacing();v=this.__charBounds[l][h-1].left+this.__charBounds[l][h-1].width-m}f=d,(this.lineHeight<1||u===l&&1<this.lineHeight)&&(d/=this.lineHeight),this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",e.fillRect(t.left+p+g,t.top+t.topOffset+d,v-g,1)):(e.fillStyle=this.selectionColor,e.fillRect(t.left+p+g,t.top+t.topOffset,v-g,d)),t.topOffset+=f}},getCurrentCharFontSize:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fontSize")},getCurrentCharColor:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fill")},_getCurrentCharIndex:function(){var t=this.get2DCursorLocation(this.selectionStart,!0),e=0<t.charIndex?t.charIndex-1:0;return{l:t.lineIndex,c:e}}}),d.IText.fromObject=function(e,n){if(t(e),e.styles)for(var r in e.styles)for(var i in e.styles[r])t(e.styles[r][i]);d.Object._fromObject("IText",e,n,"text")}}(),o=d.util.object.clone,d.util.object.extend(d.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var t=this;this.on("added",(function(){var e=t.canvas;e&&(e._hasITextHandlers||(e._hasITextHandlers=!0,t._initCanvasHandlers(e)),e._iTextInstances=e._iTextInstances||[],e._iTextInstances.push(t))}))},initRemovedHandler:function(){var t=this;this.on("removed",(function(){var e=t.canvas;e&&(e._iTextInstances=e._iTextInstances||[],d.util.removeFromArray(e._iTextInstances,t),0===e._iTextInstances.length&&(e._hasITextHandlers=!1,t._removeCanvasHandlers(e)))}))},_initCanvasHandlers:function(t){t._mouseUpITextHandler=function(){t._iTextInstances&&t._iTextInstances.forEach((function(t){t.__isMousedown=!1}))},t.on("mouse:up",t._mouseUpITextHandler)},_removeCanvasHandlers:function(t){t.off("mouse:up",t._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(t,e,n,r){var i;return i={isAborted:!1,abort:function(){this.isAborted=!0}},t.animate("_currentCursorOpacity",e,{duration:n,onComplete:function(){i.isAborted||t[r]()},onChange:function(){t.canvas&&t.selectionStart===t.selectionEnd&&t.renderCursorOrSelection()},abort:function(){return i.isAborted}}),i},_onTickComplete:function(){var t=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout((function(){t._currentTickCompleteState=t._animateCursor(t,0,this.cursorDuration/2,"_tick")}),100)},initDelayedCursor:function(t){var e=this,n=t?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout((function(){e._tick()}),n)},abortCursorAnimation:function(){var t=this._currentTickState||this._currentTickCompleteState,e=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,t&&e&&e.clearContext(e.contextTop||e.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(t){var e=0,n=t-1;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)e++,n--;for(;/\S/.test(this._text[n])&&-1<n;)e++,n--;return t-e},findWordBoundaryRight:function(t){var e=0,n=t;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)e++,n++;for(;/\S/.test(this._text[n])&&n<this._text.length;)e++,n++;return t+e},findLineBoundaryLeft:function(t){for(var e=0,n=t-1;!/\n/.test(this._text[n])&&-1<n;)e++,n--;return t-e},findLineBoundaryRight:function(t){for(var e=0,n=t;!/\n/.test(this._text[n])&&n<this._text.length;)e++,n++;return t+e},searchWordBoundary:function(t,e){for(var n=this._text,r=this._reSpace.test(n[t])?t-1:t,i=n[r],o=d.reNonWord;!o.test(i)&&0<r&&r<n.length;)i=n[r+=e];return o.test(i)&&(r+=1===e?0:1),r},selectWord:function(t){t=t||this.selectionStart;var e=this.searchWordBoundary(t,-1),n=this.searchWordBoundary(t,1);this.selectionStart=e,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(t){t=t||this.selectionStart;var e=this.findLineBoundaryLeft(t),n=this.findLineBoundaryRight(t);return this.selectionStart=e,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(t){if(!this.isEditing&&this.editable)return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(t),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll()),this},exitEditingOnOthers:function(t){t._iTextInstances&&t._iTextInstances.forEach((function(t){t.selected=!1,t.isEditing&&t.exitEditing()}))},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(t){if(this.__isMousedown&&this.isEditing){var e=this.getSelectionStartFromPointer(t.e),n=this.selectionStart,r=this.selectionEnd;(e===this.__selectionStartOnMouseDown&&n!==r||n!==e&&r!==e)&&(e>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=e):(this.selectionStart=e,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===n&&this.selectionEnd===r||(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(t,e,n){var r=n.slice(0,t),i=d.util.string.graphemeSplit(r).length;if(t===e)return{selectionStart:i,selectionEnd:i};var o=n.slice(t,e);return{selectionStart:i,selectionEnd:i+d.util.string.graphemeSplit(o).length}},fromGraphemeToStringSelection:function(t,e,n){var r=n.slice(0,t).join("").length;return t===e?{selectionStart:r,selectionEnd:r}:{selectionStart:r,selectionEnd:r+n.slice(t,e).join("").length}},_updateTextarea:function(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){var t=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=t.selectionStart,this.hiddenTextarea.selectionEnd=t.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var t=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var t=this._calcTextareaPosition();this.hiddenTextarea.style.left=t.left,this.hiddenTextarea.style.top=t.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var t=this.inCompositionMode?this.compositionStart:this.selectionStart,e=this._getCursorBoundaries(t),n=this.get2DCursorLocation(t),r=n.lineIndex,i=n.charIndex,o=this.getValueOfPropertyAt(r,i,"fontSize")*this.lineHeight,a=e.leftOffset,s=this.calcTransformMatrix(),l={x:e.left+a,y:e.top+e.topOffset+o},c=this.canvas.getRetinaScaling(),h=this.canvas.upperCanvasEl,u=h.width/c,f=h.height/c,p=u-o,g=f-o,v=h.clientWidth/u,m=h.clientHeight/f;return l=d.util.transformPoint(l,s),(l=d.util.transformPoint(l,this.canvas.viewportTransform)).x*=v,l.y*=m,l.x<0&&(l.x=0),l.x>p&&(l.x=p),l.y<0&&(l.y=0),l.y>g&&(l.y=g),l.x+=this.canvas._offset.left,l.y+=this.canvas._offset.top,{left:l.x+"px",top:l.y+"px",fontSize:o+"px",charHeight:o}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var t=this._textBeforeEdit!==this.text,e=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),t&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),t&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var t in this.styles)this._textLines[t]||delete this.styles[t]},removeStyleFromTo:function(t,e){var n,r,i=this.get2DCursorLocation(t,!0),o=this.get2DCursorLocation(e,!0),a=i.lineIndex,s=i.charIndex,l=o.lineIndex,c=o.charIndex;if(a!==l){if(this.styles[a])for(n=s;n<this._unwrappedTextLines[a].length;n++)delete this.styles[a][n];if(this.styles[l])for(n=c;n<this._unwrappedTextLines[l].length;n++)(r=this.styles[l][n])&&(this.styles[a]||(this.styles[a]={}),this.styles[a][s+n-c]=r);for(n=a+1;n<=l;n++)delete this.styles[n];this.shiftLineStyles(l,a-l)}else if(this.styles[a]){r=this.styles[a];var h,u,f=c-s;for(n=s;n<c;n++)delete r[n];for(u in this.styles[a])c<=(h=parseInt(u,10))&&(r[h-f]=r[u],delete r[u])}},shiftLineStyles:function(t,e){var n=o(this.styles);for(var r in this.styles){var i=parseInt(r,10);t<i&&(this.styles[i+e]=n[i],n[i-e]||delete this.styles[i])}},restartCursorIfNeeded:function(){this._currentTickState&&!this._currentTickState.isAborted&&this._currentTickCompleteState&&!this._currentTickCompleteState.isAborted||this.initDelayedCursor()},insertNewlineStyleObject:function(t,e,n,r){var i,a={},s=!1,l=this._unwrappedTextLines[t].length===e;for(var c in n||(n=1),this.shiftLineStyles(t,n),this.styles[t]&&(i=this.styles[t][0===e?e:e-1]),this.styles[t]){var h=parseInt(c,10);e<=h&&(s=!0,a[h-e]=this.styles[t][c],l&&0===e||delete this.styles[t][c])}var u=!1;for(s&&!l&&(this.styles[t+n]=a,u=!0),u&&n--;0<n;)r&&r[n-1]?this.styles[t+n]={0:o(r[n-1])}:i?this.styles[t+n]={0:o(i)}:delete this.styles[t+n],n--;this._forceClearCache=!0},insertCharStyleObject:function(t,e,n,r){this.styles||(this.styles={});var i=this.styles[t],a=i?o(i):{};for(var s in n||(n=1),a){var l=parseInt(s,10);e<=l&&(i[l+n]=a[l],a[l-n]||delete i[l])}if(this._forceClearCache=!0,r)for(;n--;)Object.keys(r[n]).length&&(this.styles[t]||(this.styles[t]={}),this.styles[t][e+n]=o(r[n]));else if(i)for(var c=i[e?e-1:1];c&&n--;)this.styles[t][e+n]=o(c)},insertNewStyleBlock:function(t,e,n){for(var r=this.get2DCursorLocation(e,!0),i=[0],o=0,a=0;a<t.length;a++)"\n"===t[a]?i[++o]=0:i[o]++;for(0<i[0]&&(this.insertCharStyleObject(r.lineIndex,r.charIndex,i[0],n),n=n&&n.slice(i[0]+1)),o&&this.insertNewlineStyleObject(r.lineIndex,r.charIndex+i[0],o),a=1;a<o;a++)0<i[a]?this.insertCharStyleObject(r.lineIndex+a,0,i[a],n):n&&(this.styles[r.lineIndex+a][0]=n[0]),n=n&&n.slice(i[a]+1);0<i[a]&&this.insertCharStyleObject(r.lineIndex+a,0,i[a],n)},setSelectionStartEndWithShift:function(t,e,n){n<=t?(e===t?this._selectionDirection="left":"right"===this._selectionDirection&&(this._selectionDirection="left",this.selectionEnd=t),this.selectionStart=n):t<n&&n<e?"right"===this._selectionDirection?this.selectionEnd=n:this.selectionStart=n:(e===t?this._selectionDirection="right":"left"===this._selectionDirection&&(this._selectionDirection="right",this.selectionStart=e),this.selectionEnd=n)},setSelectionInBoundaries:function(){var t=this.text.length;this.selectionStart>t?this.selectionStart=t:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>t?this.selectionEnd=t:this.selectionEnd<0&&(this.selectionEnd=0)}}),d.util.object.extend(d.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(t){if(this.canvas){this.__newClickTime=+new Date;var e=t.pointer;this.isTripleClick(e)&&(this.fire("tripleclick",t),this._stopEvent(t.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=e,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y},_stopEvent:function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(t){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(t.e))},tripleClickHandler:function(t){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(t.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(t){!this.canvas||!this.editable||t.e.button&&1!==t.e.button||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(t.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(t){!this.canvas||!this.editable||t.e.button&&1!==t.e.button||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(t){if(this.__isMousedown=!1,!(!this.editable||this.group||t.transform&&t.transform.actionPerformed||t.e.button&&1!==t.e.button)){if(this.canvas){var e=this.canvas._activeObject;if(e&&e!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(t.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(t){var e=this.getSelectionStartFromPointer(t),n=this.selectionStart,r=this.selectionEnd;t.shiftKey?this.setSelectionStartEndWithShift(n,r,e):(this.selectionStart=e,this.selectionEnd=e),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(t){for(var e=this.getLocalPointer(t),n=0,r=0,i=0,o=0,a=0,s=0,l=this._textLines.length;s<l&&i<=e.y;s++)i+=this.getHeightOfLine(s)*this.scaleY,0<(a=s)&&(o+=this._textLines[s-1].length+this.missingNewlineOffset(s-1));r=this._getLineLeftOffset(a)*this.scaleX;for(var c=0,h=this._textLines[a].length;c<h&&(n=r,(r+=this.__charBounds[a][c].kernedWidth*this.scaleX)<=e.x);c++)o++;return this._getNewSelectionStartFromOffset(e,n,r,o,h)},_getNewSelectionStartFromOffset:function(t,e,n,r,i){var o=t.x-e,a=n-t.x,s=r+(o<a||a<0?0:1);return this.flipX&&(s=i-s),s>this._text.length&&(s=this._text.length),s}}),d.util.object.extend(d.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=d.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var t=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+t.top+"; left: "+t.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; paddingｰtop: "+t.fontSize+";",d.document.body.appendChild(this.hiddenTextarea),d.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),d.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),d.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),d.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),d.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),d.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),d.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),d.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),d.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(d.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(t){if(this.isEditing){if(t.keyCode in this.keysMap)this[this.keysMap[t.keyCode]](t);else{if(!(t.keyCode in this.ctrlKeysMapDown)||!t.ctrlKey&&!t.metaKey)return;this[this.ctrlKeysMapDown[t.keyCode]](t)}t.stopImmediatePropagation(),t.preventDefault(),33<=t.keyCode&&t.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(t){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:t.keyCode in this.ctrlKeysMapUp&&(t.ctrlKey||t.metaKey)&&(this[this.ctrlKeysMapUp[t.keyCode]](t),t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.requestRenderAll())},onInput:function(t){var e=this.fromPaste;if(this.fromPaste=!1,t&&t.stopPropagation(),this.isEditing){var n,r,i,o,a,s=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,l=this._text.length,c=s.length,h=c-l,u=this.selectionStart,f=this.selectionEnd,p=u!==f;if(""===this.hiddenTextarea.value)return this.styles={},this.updateFromTextArea(),this.fire("changed"),void(this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll()));var g=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),v=u>g.selectionStart;p?(n=this._text.slice(u,f),h+=f-u):c<l&&(n=v?this._text.slice(f+h,f):this._text.slice(u,u-h)),r=s.slice(g.selectionEnd-h,g.selectionEnd),n&&n.length&&(r.length&&(i=this.getSelectionStyles(u,u+1,!1),i=r.map((function(){return i[0]}))),p?(o=u,a=f):v?(o=f-n.length,a=f):a=(o=f)+n.length,this.removeStyleFromTo(o,a)),r.length&&(e&&r.join("")===d.copiedText&&!d.disableStyleCopyPaste&&(i=d.copiedTextStyle),this.insertNewStyleBlock(r,u,i)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(t){this.compositionStart=t.target.selectionStart,this.compositionEnd=t.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(d.copiedText=this.getSelectedText(),d.disableStyleCopyPaste?d.copiedTextStyle=null:d.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(t){return t&&t.clipboardData||d.window.clipboardData},_getWidthBeforeCursor:function(t,e){var n,r=this._getLineLeftOffset(t);return 0<e&&(r+=(n=this.__charBounds[t][e-1]).left+n.width),r},getDownCursorOffset:function(t,e){var n=this._getSelectionForOffset(t,e),r=this.get2DCursorLocation(n),i=r.lineIndex;if(i===this._textLines.length-1||t.metaKey||34===t.keyCode)return this._text.length-n;var o=r.charIndex,a=this._getWidthBeforeCursor(i,o),s=this._getIndexOnLine(i+1,a);return this._textLines[i].slice(o).length+s+1+this.missingNewlineOffset(i)},_getSelectionForOffset:function(t,e){return t.shiftKey&&this.selectionStart!==this.selectionEnd&&e?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(t,e){var n=this._getSelectionForOffset(t,e),r=this.get2DCursorLocation(n),i=r.lineIndex;if(0===i||t.metaKey||33===t.keyCode)return-n;var o=r.charIndex,a=this._getWidthBeforeCursor(i,o),s=this._getIndexOnLine(i-1,a),l=this._textLines[i].slice(0,o),c=this.missingNewlineOffset(i-1);return-this._textLines[i-1].length+s-l.length+(1-c)},_getIndexOnLine:function(t,e){for(var n,r,i=this._textLines[t],o=this._getLineLeftOffset(t),a=0,s=0,l=i.length;s<l;s++)if(e<(o+=n=this.__charBounds[t][s].width)){r=!0;var c=o-n,h=o,u=Math.abs(c-e);a=Math.abs(h-e)<u?s:s-1;break}return r||(a=i.length-1),a},moveCursorDown:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",t)},moveCursorUp:function(t){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorUpOrDown("Up",t)},_moveCursorUpOrDown:function(t,e){var n=this["get"+t+"CursorOffset"](e,"right"===this._selectionDirection);e.shiftKey?this.moveCursorWithShift(n):this.moveCursorWithoutShift(n),0!==n&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(t){var e="left"===this._selectionDirection?this.selectionStart+t:this.selectionEnd+t;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,e),0!==t},moveCursorWithoutShift:function(t){return t<0?(this.selectionStart+=t,this.selectionEnd=this.selectionStart):(this.selectionEnd+=t,this.selectionStart=this.selectionEnd),0!==t},moveCursorLeft:function(t){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorLeftOrRight("Left",t)},_move:function(t,e,n){var r;if(t.altKey)r=this["findWordBoundary"+n](this[e]);else{if(!t.metaKey&&35!==t.keyCode&&36!==t.keyCode)return this[e]+="Left"===n?-1:1,!0;r=this["findLineBoundary"+n](this[e])}if(void 0!==typeof r&&this[e]!==r)return this[e]=r,!0},_moveLeft:function(t,e){return this._move(t,e,"Left")},_moveRight:function(t,e){return this._move(t,e,"Right")},moveCursorLeftWithoutShift:function(t){var e=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&0!==this.selectionStart&&(e=this._moveLeft(t,"selectionStart")),this.selectionEnd=this.selectionStart,e},moveCursorLeftWithShift:function(t){return"right"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveLeft(t,"selectionEnd"):0!==this.selectionStart?(this._selectionDirection="left",this._moveLeft(t,"selectionStart")):void 0},moveCursorRight:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",t)},_moveCursorLeftOrRight:function(t,e){var n="moveCursor"+t+"With";this._currentCursorOpacity=1,e.shiftKey?n+="Shift":n+="outShift",this[n](e)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(t){return"left"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveRight(t,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection="right",this._moveRight(t,"selectionEnd")):void 0},moveCursorRightWithoutShift:function(t){var e=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(e=this._moveRight(t,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,e},removeChars:function(t,e){void 0===e&&(e=t+1),this.removeStyleFromTo(t,e),this._text.splice(t,e-t),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(t,e,n,r){void 0===r&&(r=n),n<r&&this.removeStyleFromTo(n,r);var i=d.util.string.graphemeSplit(t);this.insertNewStyleBlock(i,n,e),this._text=[].concat(this._text.slice(0,n),i,this._text.slice(r)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var t=d.util.toFixed,e=/  +/g;d.util.object.extend(d.Text.prototype,{_toSVG:function(){var t=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(t.textTop,t.textLeft);return this._wrapSVGTextAndBg(e)},toSVG:function(t){return this._createBaseSVGMarkup(this._toSVG(),{reviver:t,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(t){var e=this.getSvgTextDecoration(this);return[t.textBgRects.join(""),'\t\t<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",e?'text-decoration="'+e+'" ':"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.textSpans.join(""),"</text>\n"]},_getSVGTextAndBg:function(t,e){var n,r=[],i=[],o=t;this._setSVGBg(i);for(var a=0,s=this._textLines.length;a<s;a++)n=this._getLineLeftOffset(a),(this.textBackgroundColor||this.styleHas("textBackgroundColor",a))&&this._setSVGTextLineBg(i,a,e+n,o),this._setSVGTextLineText(r,a,e+n,o),o+=this.getHeightOfLine(a);return{textSpans:r,textBgRects:i}},_createTextCharSpan:function(n,r,i,o){var a=n!==n.trim()||n.match(e),s=this.getSvgSpanStyles(r,a),l=s?'style="'+s+'"':"",c=r.deltaY,h="",u=d.Object.NUM_FRACTION_DIGITS;return c&&(h=' dy="'+t(c,u)+'" '),['<tspan x="',t(i,u),'" y="',t(o,u),'" ',h,l,">",d.util.string.escapeXml(n),"</tspan>"].join("")},_setSVGTextLineText:function(t,e,n,r){var i,o,a,s,l,c=this.getHeightOfLine(e),h=-1!==this.textAlign.indexOf("justify"),u="",f=0,p=this._textLines[e];r+=c*(1-this._fontSizeFraction)/this.lineHeight;for(var d=0,g=p.length-1;d<=g;d++)l=d===g||this.charSpacing,u+=p[d],a=this.__charBounds[e][d],0===f?(n+=a.kernedWidth-a.width,f+=a.width):f+=a.kernedWidth,h&&!l&&this._reSpaceAndTab.test(p[d])&&(l=!0),l||(i=i||this.getCompleteStyleDeclaration(e,d),o=this.getCompleteStyleDeclaration(e,d+1),l=this._hasStyleChangedForSvg(i,o)),l&&(s=this._getStyleDeclaration(e,d)||{},t.push(this._createTextCharSpan(u,s,n,r)),u="",i=o,n+=f,f=0)},_pushTextBgRect:function(e,n,r,i,o,a){var s=d.Object.NUM_FRACTION_DIGITS;e.push("\t\t<rect ",this._getFillAttributes(n),' x="',t(r,s),'" y="',t(i,s),'" width="',t(o,s),'" height="',t(a,s),'"></rect>\n')},_setSVGTextLineBg:function(t,e,n,r){for(var i,o,a=this._textLines[e],s=this.getHeightOfLine(e)/this.lineHeight,l=0,c=0,h=this.getValueOfPropertyAt(e,0,"textBackgroundColor"),u=0,f=a.length;u<f;u++)i=this.__charBounds[e][u],(o=this.getValueOfPropertyAt(e,u,"textBackgroundColor"))!==h?(h&&this._pushTextBgRect(t,h,n+c,r,l,s),c=i.left,l=i.width,h=o):l+=i.kernedWidth;o&&this._pushTextBgRect(t,o,n+c,r,l,s)},_getFillAttributes:function(t){var e=t&&"string"==typeof t?new d.Color(t):"";return e&&e.getSource()&&1!==e.getAlpha()?'opacity="'+e.getAlpha()+'" fill="'+e.setAlpha(1).toRgb()+'"':'fill="'+t+'"'},_getSVGLineTopOffset:function(t){for(var e,n=0,r=0;r<t;r++)n+=this.getHeightOfLine(r);return e=this.getHeightOfLine(r),{lineTop:n,offset:(this._fontSizeMult-this._fontSizeFraction)*e/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(t){return d.Object.prototype.getSvgStyles.call(this,t)+" white-space: pre;"}})}(),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Textbox=e.util.createClass(e.IText,e.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:e.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(t){for(var e=0,n=0,r=0,i={},o=0;o<t.graphemeLines.length;o++)"\n"===t.graphemeText[r]&&0<o?(n=0,r++,e++):!this.splitByGrapheme&&this._reSpaceAndTab.test(t.graphemeText[r])&&0<o&&(n++,r++),i[o]={line:e,offset:n},r+=t.graphemeLines[o].length,n+=t.graphemeLines[o].length;return i},styleHas:function(t,n){if(this._styleMap&&!this.isWrapping){var r=this._styleMap[n];r&&(n=r.line)}return e.Text.prototype.styleHas.call(this,t,n)},isEmptyStyles:function(t){if(!this.styles)return!0;var e,n,r=0,i=!1,o=this._styleMap[t],a=this._styleMap[t+1];for(var s in o&&(t=o.line,r=o.offset),a&&(i=a.line===t,e=a.offset),n=void 0===t?this.styles:{line:this.styles[t]})for(var l in n[s])if(r<=l&&(!i||l<e))for(var c in n[s][l])return!1;return!0},_getStyleDeclaration:function(t,e){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[t];if(!n)return null;t=n.line,e=n.offset+e}return this.callSuper("_getStyleDeclaration",t,e)},_setStyleDeclaration:function(t,e,n){var r=this._styleMap[t];t=r.line,e=r.offset+e,this.styles[t][e]=n},_deleteStyleDeclaration:function(t,e){var n=this._styleMap[t];t=n.line,e=n.offset+e,delete this.styles[t][e]},_getLineStyle:function(t){var e=this._styleMap[t];return!!this.styles[e.line]},_setLineStyle:function(t){var e=this._styleMap[t];this.styles[e.line]={}},_wrapText:function(t,e){var n,r=[];for(this.isWrapping=!0,n=0;n<t.length;n++)r=r.concat(this._wrapLine(t[n],n,e));return this.isWrapping=!1,r},_measureWord:function(t,e,n){var r,i=0;n=n||0;for(var o=0,a=t.length;o<a;o++)i+=this._getGraphemeBox(t[o],e,o+n,r,!0).kernedWidth,r=t[o];return i},_wrapLine:function(t,n,r,i){var o=0,a=this.splitByGrapheme,s=[],l=[],c=a?e.util.string.graphemeSplit(t):t.split(this._wordJoiners),h="",u=0,f=a?"":" ",p=0,d=0,g=0,v=!0,m=this._getWidthOfCharSpacing();i=i||0,0===c.length&&c.push([]),r-=i;for(var y=0;y<c.length;y++)h=a?c[y]:e.util.string.graphemeSplit(c[y]),p=this._measureWord(h,n,u),u+=h.length,r<(o+=d+p-m)&&!v?(s.push(l),l=[],o=p,v=!0):o+=m,v||a||l.push(f),l=l.concat(h),d=a?0:this._measureWord([f],n,u),u++,v=!1,g<p&&(g=p);return y&&s.push(l),g+i>this.dynamicMinWidth&&(this.dynamicMinWidth=g-m+i),s},isEndOfWrapping:function(t){return!this._styleMap[t+1]||this._styleMap[t+1].line!==this._styleMap[t].line},missingNewlineOffset:function(t){return this.splitByGrapheme?this.isEndOfWrapping(t)?1:0:1},_splitTextIntoLines:function(t){for(var n=e.Text.prototype._splitTextIntoLines.call(this,t),r=this._wrapText(n.lines,this.width),i=new Array(r.length),o=0;o<r.length;o++)i[o]=r[o].join("");return n.lines=i,n.graphemeLines=r,n},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var t={};for(var e in this._styleMap)this._textLines[e]&&(t[this._styleMap[e].line]=1);for(var e in this.styles)t[e]||delete this.styles[e]},toObject:function(t){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(t))}}),e.Textbox.fromObject=function(t,n){return e.Object._fromObject("Textbox",t,n,"text")}}(e),function(){var t=d.controlsUtils,e=t.scaleSkewCursorStyleHandler,n=t.scaleCursorStyleHandler,r=t.scalingEqually,i=t.scalingYOrSkewingX,o=t.scalingXOrSkewingY,a=t.scaleOrSkewActionName,s=d.Object.prototype.controls;if(s.ml=new d.Control({x:-.5,y:0,cursorStyleHandler:e,actionHandler:o,getActionName:a}),s.mr=new d.Control({x:.5,y:0,cursorStyleHandler:e,actionHandler:o,getActionName:a}),s.mb=new d.Control({x:0,y:.5,cursorStyleHandler:e,actionHandler:i,getActionName:a}),s.mt=new d.Control({x:0,y:-.5,cursorStyleHandler:e,actionHandler:i,getActionName:a}),s.tl=new d.Control({x:-.5,y:-.5,cursorStyleHandler:n,actionHandler:r}),s.tr=new d.Control({x:.5,y:-.5,cursorStyleHandler:n,actionHandler:r}),s.bl=new d.Control({x:-.5,y:.5,cursorStyleHandler:n,actionHandler:r}),s.br=new d.Control({x:.5,y:.5,cursorStyleHandler:n,actionHandler:r}),s.mtr=new d.Control({x:0,y:-.5,actionHandler:t.rotationWithSnapping,cursorStyleHandler:t.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),d.Textbox){var l=d.Textbox.prototype.controls={};l.mtr=s.mtr,l.tr=s.tr,l.br=s.br,l.tl=s.tl,l.bl=s.bl,l.mt=s.mt,l.mb=s.mb,l.mr=new d.Control({x:.5,y:0,actionHandler:t.changeWidth,cursorStyleHandler:e,actionName:"resizing"}),l.ml=new d.Control({x:-.5,y:0,actionHandler:t.changeWidth,cursorStyleHandler:e,actionName:"resizing"})}}()}).call(this,n(11).Buffer)},17:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));class r{constructor(t,e,n,r){this.left=t,this.top=e,this.right=n,this.bottom=r,this.valid&&this.norm()}static fromJson(t){return new r(t.left,t.top,t.right,t.bottom)}static fromFabricObj(t){return new r(t.left,t.top,t.left+t.width,t.top+t.height)}norm(){if(this.right<this.left){const t=this.right;this.right=this.left,this.left=t}if(this.top>this.bottom){const t=this.top;this.top=this.bottom,this.bottom=t}}round(){const t=this.clone();return t.left=Math.round(t.left),t.right=Math.round(t.right),t.top=Math.round(t.top),t.bottom=Math.round(t.bottom),t}get valid(){return null!==this.left&&null!==this.right&&null!==this.top&&null!==this.bottom&&this.left!==1/0&&this.right!==1/0&&this.top!==1/0&&this.bottom!==1/0&&this.width>=0&&this.height>=0}get width(){return this.right-this.left}get height(){return this.bottom-this.top}get centerPoint(){return{x:(this.left+this.right)/2,y:(this.top+this.bottom)/2}}get leftTop(){return{x:this.left,y:this.top}}get isPoint(){return 0===this.width&&0===this.height}centerRelativeTo(t){const e=this.centerPoint,n=t.centerPoint;return{x:n.x-e.x,y:n.y-e.y}}contains(t){return this.left<=t.left&&this.top<=t.top&&this.right>=t.right&&this.bottom>=t.bottom}containsCoords(t,e){return t>=this.left&&t<this.right&&e>=this.top&&e<this.bottom}zoom(t){return new r(this.left*t,this.top*t,this.right*t,this.bottom*t)}clone(){return new r(this.left,this.top,this.right,this.bottom)}area(){return this.width*this.height}pan(t,e){const n=this.clone();return n.left+=t,n.right+=t,n.top+=e,n.bottom+=e,n}panMutate(t,e){this.left+=t,this.right+=t,this.top+=e,this.bottom+=e}combine(t){return t?new r(Math.min(this.left,t.left),Math.min(this.top,t.top),Math.max(this.right,t.right),Math.max(this.bottom,t.bottom)):this.clone()}clampedRelativeRect(t){return this.relativeRect(t).clampBy(this)}relativeTo(t){return new r(this.left-t.left,this.top-t.top,this.right-t.left,this.bottom-t.top)}relativeRect(t){return new r(this.left+t.left,this.top+t.top,this.left+t.right,this.top+t.bottom)}clampBy(t){return new r(Math.max(t.left,this.left),Math.max(t.top,this.top),Math.min(t.right,this.right),Math.min(t.bottom,this.bottom))}expand(t,e){return new r(this.left-t,this.top-e,this.right+t,this.bottom+e)}coordsToCenter(t){const e=(this.left+this.right)/2,n=(this.top+this.bottom)/2;return Math.sqrt(Math.pow(t.x-e,2)+Math.pow(t.y-n,2))}distanceToCoords(t,e){if(this.containsCoords(t,e))return 0;if(this.norm(),t>=this.left&&t<=this.right)return Math.min(Math.abs(e-this.top),Math.abs(e-this.bottom));if(e>=this.top&&e<=this.bottom)return Math.min(Math.abs(t-this.left),Math.abs(t-this.right));const n=Math.min(Math.abs(t-this.left),Math.abs(t-this.right)),r=Math.min(Math.abs(e-this.top),Math.abs(e-this.bottom));return Math.round(Math.sqrt(n*n+r*r))}includeCoordsMutate(t,e){this.left=Math.min(this.left,t),this.right=Math.max(this.right,t),this.top=Math.min(this.top,e),this.bottom=Math.max(this.bottom,e)}isOverlapTo(t){return this.left<t.right&&t.left<this.right&&this.top<t.bottom&&t.top<this.bottom}panTo(t){const e=t.x-this.left,n=t.y-this.top;return this.pan(e,n)}distance(t){const e=this,n=t,r={ll:0,lr:0,rr:0,rl:0,tt:0,tb:0,bb:0,bt:0};for(const t in r)r.hasOwnProperty(t)&&(r[t]=i(e,n,t));const o=e.width,a=e.height;e.left>=n.right?delete r.ll:delete r.lr,e.right<=n.left?delete r.rr:delete r.rl;const s=r.ll||r.lr,l=r.rr||r.rl,c=Math.abs(l-s);0===Math.round(c-o)&&(s<l?(delete r.rr,delete r.rl):(delete r.lr,delete r.ll)),e.top>=n.bottom?delete r.tt:delete r.tb,e.bottom<=n.top?delete r.bb:delete r.bt;const h=r.tt||r.tb,u=r.bb||r.bt,f=Math.abs(h-u);return 0===Math.round(f-a)&&(h<u?(delete r.bb,delete r.bt):(delete r.tt,delete r.tb)),r}}function i(t,e,n){const r={l:"left",r:"right",t:"top",b:"bottom"},i=r[n[0]],o=r[n[1]],a=t[i],s=e[o];return Math.abs(a-s)}},183:function(t,e,n){"use strict";n.r(e);var r=n(16),i=n(30),o=n(21),a=n(32);const s={opacity:"opacity",fillRule:"fillRule",fill:"fill"},l={color:"stroke",dashArray:"strokeDashArray",dashOffset:"strokeDashOffset",lineCap:"strokeLineCap",lineJoin:"strokeLineJoin",miterLimit:"strokeMiterLimit",width:"strokeWidth"};async function c(t,e){if(e){const n=Object.keys(s);for(const i of n)if(void 0!==e[i])if("fill"===i&&e.fill instanceof HTMLImageElement){const n=new r.fabric.Pattern({repeat:e.patternRepeat,source:e.fill});t.set({fill:n})}else t.set(s[i],e[i]);if(e.stroke){const n=Object.keys(l),r=e.stroke;for(const e of n)void 0!==r[e]&&t.set(l[e],r[e])}if(e.dropShadow){const n=new r.fabric.Shadow({offsetX:e.dropShadow.dx,offsetY:e.dropShadow.dy,blur:e.dropShadow.r,color:e.dropShadow.color});t.shadow=n}}}var h=n(24),u=n(120);var f=n(74);n(141);function p(t,e){return e.style?Object.assign(Object.assign({},t),e.style):t}async function d(t){const e=await g(t.font);return e.width=t.rect.width,e.height=t.rect.height,e.lineHeight=t.lineHeight,e}async function g(t){return{fontFamily:await f.a.loadFontDOM(t.family),fontSize:t.size,linethrough:t.lineThrough,underline:t.underline,fontWeight:f.a.metaToWeight(t.family),charSpacing:t.letterSpacing||0,fontStyle:t.family.italic?"italic":"normal"}}var v=n(17);async function m(t){return new Promise((e,n)=>{t.clone(t=>{e(t)})})}var y=n(101);r.fabric.Object.prototype.objectCaching=!1;const b={pixel:async function(t){const e=t,n=e.pixel,i=document.createElement("canvas");i.width=e.rect.width,i.height=e.rect.height;const o=i.getContext("2d");if(o.imageSmoothingQuality="high",e.scaleType&&"cover"===e.scaleType){const t=n.height/n.width,r=i.height/i.width,a=e.rect.width,s=e.rect.height,l=e.oriScale?e.oriScale:1,c=a*(e.offsetX?e.offsetX:0),h=s*(e.offsetY?e.offsetY:0);let u=r<t?n.width:n.height/r;u/=l;let f=u*r,p=-c,d=-h;p/=l,d/=l,p=(n.width-u)/2+p,d=(n.height-f)/2+d,null==o||o.drawImage(n,p,d,u,f,0,0,i.width,i.height)}else null==o||o.drawImage(n,0,0,n.width,n.height,0,0,i.width,i.height);const s=await Object(a.c)(i);return new Promise((e,n)=>{r.fabric.Image.fromURL(s,async n=>{await c(n,t.style),e(n)})})},folder:async function(t){const e=t;let n=[];n=await Promise.all(e.children.map(t=>x(t))),n.reverse();const i=new r.fabric.Group(n,{originX:"left",originY:"top"});return e.rect=v.a.fromFabricObj(i),await c(i,t.style),i},path:async function(t){const e=t,n=u.a.combinePathItems(e.paths);let i;if("line"===e.subType){const t=e;i=new r.fabric.Line([t.x1,t.y1,t.x2,t.y2])}else{const t=h.exporter.toSVGPathData(n,{accuracy:1e-4,origin:[0,0]});i=new r.fabric.Path(t,{strokeWidth:0})}return await c(i,t.style),i},text:async function(t){const e=t;return"positioned"===e.frame?async function(t){const e=await d(t),n=new r.fabric.Text(t.rawText,e);return await c(n,t.style),n}(e):"multiline"===e.frame?async function(t){const e=t.lines,n=t.rawText,i=[new r.fabric.Rect({left:0,top:0,width:t.rect.width,height:t.rect.height,fill:"transparent"})],o=await d(t);o.width=void 0,o.height=void 0;for(const a of e){const e=n.slice(a.from,a.to);let s=Object.assign({},o);if(a.font){const t=await g(a.font);s=Object.assign(Object.assign({},o),t)}const l=new r.fabric.Text(e,s);l.top=a.y,void 0===a.x?l.left=i[i.length-1].left+i[i.length-1].width+t.font.size/4:l.left=a.x,await c(l,p(t.style,a)),i.push(l)}return new r.fabric.Group(i)}(e):async function(t){const e=await d(t),n=new r.fabric.Textbox(t.rawText,e),i=t.lines.length?p(t.style,t.lines[0]):t.style;return await c(n,i),n}(e)},composite:async function(t){const e=t;let n=[];n=await Promise.all(e.layers.map(t=>x(t))),n=await Promise.all(n.map(t=>m(t))),n.reverse();const i=new r.fabric.Group(n,{originX:"left",originY:"top"});return i.left=0,i.top=0,e.rect=v.a.fromFabricObj(i),i}};async function x(t){var e,n;if(t.renderResult)return t.renderResult;let i;if(t.canvas)i=await async function(t){const e=await Object(a.c)(t);return new Promise((t,n)=>{r.fabric.Image.fromURL(e,e=>{t(e)})})}(t.canvas);else if(b[t.layerType]){const e=b[t.layerType];i=await e(t)}else Object(y.a)("Layer type "+t.layerType+" is not parsable by renderer.");if(t.transform?function(t,e){const n=e.transform;if(e.layerType!==o.a.folder){const i=t.calcTransformMatrix(),a=[1,0,0,1,t.left||0,t.top||0];let s=i;const l=[1,0,0,1,t.width/2,t.height/2];s=r.fabric.util.multiplyTransformMatrices(r.fabric.util.invertTransform(s),l),s=r.fabric.util.multiplyTransformMatrices(s,n),s=r.fabric.util.multiplyTransformMatrices(s,r.fabric.util.invertTransform(l)),s=r.fabric.util.multiplyTransformMatrices(s,i),s=r.fabric.util.multiplyTransformMatrices(s,a);const c=r.fabric.util.qrDecompose(s),h=new r.fabric.Point(c.translateX,c.translateY);t.setPositionByOrigin(h,"left","top"),t.flipX=!1,t.flipY=!1,t.set(c),e.layerType,o.a.pixel,t.setCoords();const{tl:u,tr:f,bl:p,br:d}=t.oCoords,g=Math.min(u.x,f.x,p.x,d.x),m=Math.min(u.y,f.y,p.y,d.y),y=Math.max(u.x,f.x,p.x,d.x),b=Math.max(u.y,f.y,p.y,d.y);e.rect=new v.a(g,m,y,b)}}(i,t):t.layerType!==o.a.folder&&(i.left=t.rect.left+(null!==(e=i.left)&&void 0!==e?e:0),i.top=t.rect.top+(null!==(n=i.top)&&void 0!==n?n:0)),i.visible=t.visible,t.clipBy){const e=await x(t.clipBy);if(e.originX="center",e.originY="center","page"===t.clipBy.clipOrigin){const t=i.left+i.width/2,n=i.top+i.height/2,r=e.left+e.width/2,o=e.top+e.height/2;e.left=r-t,e.top=o-n}i.clipPath=e}return t.renderResult=i,i}var w=n(27);async function S(t){var e;w.a.i("Get layers..."+t.name);const n=await t.getLayers();w.a.i("Render layers..."+t.name);const i=await Promise.all(n.map(t=>x(t)));w.a.i("layers rendered."),i.reverse();const o=new r.fabric.Rect({left:0,top:0,width:t.width,height:t.height,fill:null!==(e=t.background)&&void 0!==e?e:"transparent"});i.unshift(o);const a=new r.fabric.Group(i,{left:0,top:0});return function(t,e){const n=t._objects,r=-e.width/2,i=-e.height/2,o=e.left-r,a=e.top-i;n.forEach(t=>{t.left=t.left-o,t.top=t.top-a}),t.width=e.width,t.height=e.height}(a,o),t.renderResult=a,a}async function C(t,e=1){var n,i;const o=new r.fabric.StaticCanvas(null,{imageSmoothingEnabled:!1,width:Math.round(null!==(n=t.width)&&void 0!==n?n:0),height:Math.round(null!==(i=t.height)&&void 0!==i?i:0)});return t.left=0,t.top=0,o.add(t),o.toCanvasElement(e)}var T=n(56);class _ extends T.a{constructor(){super(...arguments),this.renderElem=document.createElement("canvas"),this.renderCanvas=new r.fabric.Canvas(this.renderElem,{imageSmoothingEnabled:!1,hoverCursor:"inherit",selection:!1,renderOnAddRemove:!0})}bindTo(t){this.container&&this.unbind(),this.container=t,this.container.appendChild(this.renderElem),this.renderCanvas.setWidth(this.container.clientWidth),this.renderCanvas.setHeight(this.container.clientHeight)}unbind(){this.container&&(this.container.removeChild(this.renderElem),this.container=void 0)}async renderSinglePage(t){const e=await this.singlePageToGroup(t,!1);return this.renderCanvas.clear(),this.renderCanvas.insertAt(e,0,!1),this.renderElem}async renderPages(t){const e=await this.parsePages(t);return this.renderCanvas.clear(),this.renderCanvas.insertAt(e,0,!1),this.renderElem}async parsePages(t){const e=await Promise.all(t.map(t=>this.singlePageToGroup(t,!0)));return new r.fabric.Group(e,{hasControls:!1,hasBorders:!1,left:0,top:-25})}async singlePageToGroup(t,e){t.canvas||(t.renderResult||(t.renderResult=await S(t)),t.canvas=await C(t.renderResult));const n=new r.fabric.Image(t.canvas);e?(n.left=t.offsetX,n.top=t.offsetY):(n.left=0,n.top=0);const i=new r.fabric.Text(t.name,{left:n.left+5,top:n.top-25,fontFamily:"Arial, Helvetica, sans-serif",fontSize:16,strokeWidth:0,fill:"white"}),o=t.name.split("");if(n.width>20)for(;i.width>n.width-10;){o.pop();const t=o.join("")+"...";i.set("text",t)}return new r.fabric.Group([n,i],{hasControls:!1,hasBorders:!1})}}async function O(t,e=1){const n=await m(await x(t));return n.left=0,n.top=0,`<svg width="${n.width*e}" height="${n.height*e}" viewBox="0 0 ${n.width} ${n.height}" version="1.1" xmlns="http://www.w3.org/2000/svg">\n  ${n.toSVG()}\n  </svg>\n  `}r.fabric.Object.prototype.hasControls=!1,r.fabric.Object.prototype.hasBorders=!1,r.fabric.Object.prototype.lockMovementX=!0,r.fabric.Object.prototype.lockMovementY=!0;class k extends T.a{constructor(){super(...arguments),this.parseLayer=x,this.parsePage=S,this.render=C,this.toSvg=O}}const P=new k;Object(i.a)("render",[],()=>P),Object(i.a)("renderUI",[],()=>new _)},21:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t.folder="folder",t.pixel="pixel",t.path="path",t.text="text",t.composite="composite",t.folderVector="foldervector",t.vectorMask="vectormask"}(r||(r={}))},23:function(t,e,n){"use strict";function r(t){}n.r(e),n.d(e,"lstatSync",(function(){return r})),n.d(e,"readFileSync",(function(){return o}));const i={"//../../.svgo.yml":n(55)};function o(t){return i[t]}},24:function(module,exports,__webpack_require__){var MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs,MakerJs;!function(MakerJs){function tryEval(name){try{var value=eval(name);return value}catch(t){}}function detectEnvironment(){return tryEval("WorkerGlobalScope")&&tryEval("self")?MakerJs.environmentTypes.WebWorker:tryEval("window")&&tryEval("document")?MakerJs.environmentTypes.BrowserUI:tryEval("global")&&tryEval("process")?MakerJs.environmentTypes.NodeJs:MakerJs.environmentTypes.Unknown}function split(t,e){var n=t.indexOf(e);return n<0?[t]:n>0?[t.substr(0,n),t.substr(n+1)]:["",t]}function splitDecimal(t){var e=t.toString();return e.indexOf("e")>0&&(e=t.toFixed(20).match(/.*[^(0+$)]/)[0]),split(e,".")}function round(t,e){if(void 0===e&&(e=1e-7),t%1==0)return t;var n=1-String(Math.ceil(1/e)).length;if(void 0===n||0==+n)return Math.round(t);if(t=+t,n=+n,isNaN(t)||"number"!=typeof n||n%1!=0)return NaN;if(t<0)return-round(-t,e);var r=split(t.toString(),"e");return+((r=split((t=Math.round(+(r[0]+"e"+(r[1]?+r[1]-n:-n)))).toString(),"e"))[0]+"e"+(r[1]?+r[1]+n:n))}function createRouteKey(t){for(var e=[],n=0;n<t.length;n++){var r,i=t[n];r=n%2==0?(n>0?".":"")+i:JSON.stringify([i]),e.push(r)}return e.join("")}function travel(t,e){if(!t||!e)return null;for(var n=(Array.isArray(e)?e:JSON.parse(e)).slice(),r=t,i=t.origin||[0,0];n.length;){if(!(r=r[n.shift()]))return null;r.origin&&n.length&&(i=MakerJs.point.add(i,r.origin))}return{result:r,offset:i}}MakerJs.version="debug",MakerJs.environmentTypes={BrowserUI:"browser",NodeJs:"node",WebWorker:"worker",Unknown:"unknown"},MakerJs.environment=detectEnvironment(),MakerJs.unitType={Centimeter:"cm",Foot:"foot",Inch:"inch",Meter:"m",Millimeter:"mm"},MakerJs.splitDecimal=splitDecimal,MakerJs.round=round,MakerJs.createRouteKey=createRouteKey,MakerJs.travel=travel;var clone=__webpack_require__(94);function cloneObject(t){return clone(t)}function extendObject(t,e){if(t&&e)for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}function isFunction(t){return"function"==typeof t}function isNumber(t){return"number"==typeof t}function isObject(t){return"object"==typeof t}function isPoint(t){return t&&Array.isArray(t)&&2==t.length&&isNumber(t[0])&&isNumber(t[1])}function isPath(t){return t&&t.type&&isPoint(t.origin)}function isPathLine(t){return isPath(t)&&t.type==MakerJs.pathType.Line&&isPoint(t.end)}function isPathCircle(t){return isPath(t)&&t.type==MakerJs.pathType.Circle&&isNumber(t.radius)}function isPathArc(t){return isPath(t)&&t.type==MakerJs.pathType.Arc&&isNumber(t.radius)&&isNumber(t.startAngle)&&isNumber(t.endAngle)}function isPathArcInBezierCurve(t){return isPathArc(t)&&isObject(t.bezierData)&&isNumber(t.bezierData.startT)&&isNumber(t.bezierData.endT)}function isModel(t){return t&&(t.paths||t.models)}function isChain(t){var e=t;return e&&e.links&&Array.isArray(e.links)&&isNumber(e.pathLength)}MakerJs.cloneObject=cloneObject,MakerJs.extendObject=extendObject,MakerJs.isFunction=isFunction,MakerJs.isNumber=isNumber,MakerJs.isObject=isObject,MakerJs.isPoint=isPoint,MakerJs.isPath=isPath,MakerJs.isPathLine=isPathLine,MakerJs.isPathCircle=isPathCircle,MakerJs.isPathArc=isPathArc,MakerJs.isPathArcInBezierCurve=isPathArcInBezierCurve,MakerJs.pathType={Line:"line",Circle:"circle",Arc:"arc",BezierSeed:"bezier-seed"},MakerJs.isModel=isModel,MakerJs.isChain=isChain;var Cascade=function(){function t(t,e){for(var n in this._module=t,this.$initial=e,this._module)this._shadow(n);this.$result=e}return t.prototype._shadow=function(t){var e=this;this[t]=function(){return e._apply(e._module[t],arguments)}},t.prototype._apply=function(t,e){var n=[].slice.call(e);return n.unshift(this.$result),this.$result=t.apply(void 0,n),this},t.prototype.$reset=function(){return this.$result=this.$initial,this},t}();function $(t){return isModel(t)?new Cascade(MakerJs.model,t):isPath(t)?new Cascade(MakerJs.path,t):isPoint(t)?new Cascade(MakerJs.point,t):void 0}MakerJs.$=$}(MakerJs||(MakerJs={})),module.exports=MakerJs,function(t){!function(e){function n(e,n){return e<0&&n<0||e>0&&n>0?function(e,n){return n?+(t.splitDecimal(e)[0]+"."+n):e}(n,(r=e,t.splitDecimal(r)[1])):n;var r}function r(t){var e=Math.floor(t/360);return 0===e?t:n(t,t-360*e)}function i(t){return 180*t/Math.PI}function o(n){var i=e.ofArcEnd(n)-n.startAngle;return t.round(i)>360?r(i):i}function a(t){return r(i(s(t.origin,t.end)))}function s(e,n){var r=t.point.subtract(n,e),i=r[0],o=r[1];return Math.atan2(-o,-i)+Math.PI}e.noRevolutions=r,e.toRadians=function(t){return r(t)*Math.PI/180},e.toDegrees=i,e.ofArcEnd=function(t){if(t.endAngle<t.startAngle){var e=360*Math.ceil((t.startAngle-t.endAngle)/360)+t.endAngle;return n(t.endAngle,e)}return t.endAngle},e.ofArcMiddle=function(t,e){return void 0===e&&(e=.5),t.startAngle+o(t)*e},e.ofArcSpan=o,e.ofLineInDegrees=a,e.ofPointInDegrees=function(t,e){return i(s(t,e))},e.ofPointInRadians=s,e.mirror=function(t,e,n){return n&&(t=360-t),e&&(t=(t<180?180:540)-t),t};var l={};function c(t,e){if(t){var n=t.walkedPath.pathContext,r=l[n.type];if(r)return r(n,e,t.reversed)}}l[t.pathType.Arc]=function(e,n,r){var i=n!=r,o=i?e.endAngle-90:e.startAngle+90,a=t.point.fromArc(e)[i?1:0],s=t.point.rotate(t.point.add(a,[e.radius,0]),o,a);return new t.paths.Line(n?[s,a]:[a,s])},l[t.pathType.Line]=function(e,n,r){return r?new t.paths.Line(e.end,e.origin):e},e.ofChainLinkJoint=function(t,e){if(arguments.length<2)return null;var n=[t,e].map((function(t,e){return c(t,0===e)})),i=r(a(n[1])-a(n[0]));return i>180&&(i-=360),i}}(t.angle||(t.angle={}))}(MakerJs||(MakerJs={})),function(t){!function(e){function n(t,e,n){var i=r(t);if(!e)return i;for(var o=2;o--;)n?i[o]-=e[o]:i[o]+=e[o];return i}function r(t){return t?[t[0],t[1]]:e.zero()}e.add=n,e.average=function(t,e){function n(n){return(t[n]+e[n])/2}return[n(0),n(1)]},e.clone=r,e.closest=function(e,n){for(var r={index:0,distance:-1},i=0;i<n.length;i++){var o=t.measure.pointDistance(e,n[i]);(-1==r.distance||o<r.distance)&&(r.distance=o,r.index=i)}return n[r.index]};var i={};i[Math.PI/2]=!0,i[3*Math.PI/2]=!0;var o={};function a(e,n){return[e in i?0:t.round(n*Math.cos(e)),e in o?0:t.round(n*Math.sin(e))]}function s(e,r){return n(r.origin,a(t.angle.toRadians(e),r.radius))}o[Math.PI]=!0,o[2*Math.PI]=!0,e.fromPolar=a,e.fromAngleOnCircle=s,e.fromArc=function(t){return[s(t.startAngle,t),s(t.endAngle,t)]};var l={};function c(t,e){var n=t.origin[0];return[n,e.slope*n+e.yIntercept]}function h(n,r){return e.add(n.origin,e.fromPolar(t.angle.toRadians(r),n.radius))}l[t.pathType.Arc]=function(t){return e.fromArc(t)},l[t.pathType.Line]=function(t){return[t.origin,t.end]},l[t.pathType.BezierSeed]=l[t.pathType.Line],e.fromPathEnds=function(t,e){var r=null,i=l[t.type];return i&&(r=i(t),e&&(r=r.map((function(t){return n(t,e)})))),r},e.fromSlopeIntersection=function(e,n,r){void 0===r&&(r={});var i,o=t.measure.lineSlope(e),a=t.measure.lineSlope(n);if(t.measure.isSlopeParallel(o,a))return t.measure.isSlopeEqual(o,a)&&(r.out_AreOverlapped=t.measure.isLineOverlapping(e,n,r.excludeTangents)),null;if(o.hasSlope)if(a.hasSlope){var s=(a.yIntercept-o.yIntercept)/(o.slope-a.slope);i=[s,o.slope*s+o.yIntercept]}else i=c(n,o);else i=c(e,a);return i};var u={};u[t.pathType.Arc]=function(e,n){return h(e,t.angle.ofArcMiddle(e,n))},u[t.pathType.Circle]=function(t,e){return h(t,360*e)},u[t.pathType.Line]=function(t,e){function n(t,n){return t+(n-t)*e}return[n(t.origin[0],t.end[0]),n(t.origin[1],t.end[1])]},u[t.pathType.BezierSeed]=function(e,n){return t.models.BezierCurve.computePoint(e,n)},e.middle=function(t,e){void 0===e&&(e=.5);var n=null,r=u[t.type];return r&&(n=r(t,e)),n},e.mirror=function(t,e,n){var i=r(t);return e&&(i[0]=-i[0]),n&&(i[1]=-i[1]),i},e.rounded=function(e,n){return[t.round(e[0],n),t.round(e[1],n)]},e.rotate=function(e,r,i){void 0===i&&(i=[0,0]);var o=t.angle.ofPointInRadians(i,e),s=t.measure.pointDistance(i,e);return n(i,a(o+t.angle.toRadians(r),s))},e.scale=function(t,e){for(var n=r(t),i=2;i--;)n[i]*=e;return n},e.distort=function(t,e,n){return[t[0]*e,t[1]*n]},e.subtract=function(t,e){return n(t,e,!0)},e.zero=function(){return[0,0]}}(t.point||(t.point={}))}(MakerJs||(MakerJs={})),function(t){!function(e){function n(t,e){t&&e&&void 0!==t.layer&&(e.layer=t.layer),t&&e&&"bezierData"in t&&(e.bezierData=t.bezierData)}e.addTo=function(e,n,r,i){return void 0===i&&(i=!1),t.model.addPath(n,e,r,i),e};var r={};r[t.pathType.Circle]=function(t,e,n){e.radius=t.radius},r[t.pathType.Arc]=function(e,n,i){r[t.pathType.Circle](e,n,i),n.startAngle=e.startAngle,n.endAngle=e.endAngle},r[t.pathType.Line]=function(e,n,r){n.end=t.point.add(e.end,r)},r[t.pathType.BezierSeed]=function(e,n,i){r[t.pathType.Line](e,n,i),n.controls=e.controls.map((function(e){return t.point.add(e,i)}))},e.clone=function(e,i){var o={type:e.type,origin:t.point.add(e.origin,i)},a=r[e.type];return a&&a(e,o,i),n(e,o),o},e.copyProps=function(e,i){var o=r[e.type];return o&&(i.origin=t.point.clone(e.origin),o(e,i)),n(e,i),e};var i={};i[t.pathType.Line]=function(e,n,r,i){return new t.paths.Line(n,t.point.mirror(e.end,r,i))},i[t.pathType.Circle]=function(e,n,r,i){return new t.paths.Circle(n,e.radius)},i[t.pathType.Arc]=function(e,n,r,i){var o=t.angle.mirror(e.startAngle,r,i),a=t.angle.mirror(t.angle.ofArcEnd(e),r,i),s=r!=i;return new t.paths.Arc(n,e.radius,s?a:o,s?o:a)},i[t.pathType.BezierSeed]=function(e,n,r,o){var a=i[t.pathType.Line](e,n,r,o);return a.type=t.pathType.BezierSeed,a.controls=e.controls.map((function(e){return t.point.mirror(e,r,o)})),a},e.layer=function(t,e){return t.layer=e,t},e.mirror=function(e,r,o){var a=null;if(e){var s=t.point.mirror(e.origin,r,o),l=i[e.type];l&&(a=l(e,s,r,o))}return n(e,a),a};var o={};function a(t,e){if(t){var n=o[t.type];n&&n(t,e),t.origin=e}return t}o[t.pathType.Line]=function(e,n){var r=t.point.subtract(e.end,e.origin);e.end=t.point.add(n,r)},e.move=a;var s={};function l(e,n,r){if(e&&n){e.origin=t.point.add(e.origin,n,r);var i=s[e.type];i&&i(e,n,r)}return e}s[t.pathType.Line]=function(e,n,r){e.end=t.point.add(e.end,n,r)},s[t.pathType.BezierSeed]=function(e,n,r){s[t.pathType.Line](e,n,r),e.controls=e.controls.map((function(e){return t.point.add(e,n,r)}))},e.moveRelative=l,e.moveTemporary=function(t,e,n){var r=!1;function i(t,n){e[n]&&l(t,e[n],r)}t.map(i),n(),r=!0,t.map(i)};var c={};c[t.pathType.Line]=function(e,n,r){e.end=t.point.rotate(e.end,n,r)},c[t.pathType.Arc]=function(e,n,r){e.startAngle=t.angle.noRevolutions(e.startAngle+n),e.endAngle=t.angle.noRevolutions(e.endAngle+n)},c[t.pathType.BezierSeed]=function(e,n,r){c[t.pathType.Line](e,n,r),e.controls=e.controls.map((function(e){return t.point.rotate(e,n,r)}))},e.rotate=function(e,n,r){if(void 0===r&&(r=[0,0]),!e||!n)return e;e.origin=t.point.rotate(e.origin,n,r);var i=c[e.type];return i&&i(e,n,r),e};var h={};h[t.pathType.Line]=function(e,n){e.end=t.point.scale(e.end,n)},h[t.pathType.BezierSeed]=function(e,n){h[t.pathType.Line](e,n),e.controls=e.controls.map((function(e){return t.point.scale(e,n)}))},h[t.pathType.Circle]=function(t,e){t.radius*=e},h[t.pathType.Arc]=h[t.pathType.Circle],e.scale=function(e,n){if(!e||1===n||!n)return e;e.origin=t.point.scale(e.origin,n);var r=h[e.type];return r&&r(e,n),e};var u={};u[t.pathType.Arc]=function(e,n,r){return new t.models.EllipticArc(e,n,r)},u[t.pathType.Circle]=function(e,n,r){var i=new t.models.Ellipse(e.radius*n,e.radius*r);return i.origin=t.point.distort(e.origin,n,r),i},u[t.pathType.Line]=function(e,n,r){return new t.paths.Line([e.origin,e.end].map((function(e){return t.point.distort(e,n,r)})))},u[t.pathType.BezierSeed]=function(e,n,r){var i=t.point.distort;return{type:t.pathType.BezierSeed,origin:i(e.origin,n,r),controls:e.controls.map((function(t){return i(t,n,r)})),end:i(e.end,n,r)}},e.distort=function(t,e,n){if(!t||!e||!n)return null;var r=u[t.type];if(r){var i=r(t,e,n);return void 0!==t.layer&&(i.layer=t.layer),i}return null},e.converge=function(e,n,r,i){var o=t.point.fromSlopeIntersection(e,n);if(o){var a=[e,n],s=[r,i];function l(t,e){var n;(n=e?t.origin:t.end)[0]=o[0],n[1]=o[1]}2===arguments.length&&a.forEach((function(e,n){s[n]=t.point.closest(o,[e.origin,e.end])===e.origin})),a.forEach((function(t,e){l(t,s[e])}))}return o};var f={};function p(e,n){if(1==n)return[t.point.middle(e)];var r=[],i=n;e.type!=t.pathType.Circle&&i--;for(var o=0;o<n;o++)r.push(t.point.middle(e,o/i));return r}f[t.pathType.Arc]=function(e,n,r,i){var o=t.angle.ofArcSpan(e),a=(n+r)*o/n-o;i?e.startAngle-=a:e.endAngle+=a},f[t.pathType.Circle]=function(t,e,n,r){t.radius*=(e+n)/e},f[t.pathType.Line]=function(e,n,r,i){var o=t.point.scale(t.point.subtract(e.end,e.origin),r/n);i?e.origin=t.point.subtract(e.origin,o):e.end=t.point.add(e.end,o)},e.alterLength=function(e,n,r){if(void 0===r&&(r=!1),!e||!n)return null;var i=f[e.type];if(i){var o=t.measure.pathLength(e);return!o||-n>=o?null:(i(e,o,n,r),e)}return null},e.toPoints=p;var d={};d[t.pathType.Line]=function(t){return 2},d[t.pathType.Circle]=function(e,n){var r=t.measure.pathLength(e);return r?(n=n||r,Math.max(8,Math.ceil(r/(n||r)))):0},d[t.pathType.Arc]=function(e,n){var r=t.measure.pathLength(e);if(!r)return 0;var i=Math.ceil(t.angle.ofArcSpan(e)/45)+1;return Math.max(i,Math.ceil(r/(n||r)))},e.toKeyPoints=function e(n,r){if(n.type==t.pathType.BezierSeed){var i,o=new t.models.BezierCurve(n);return t.model.findChains(o,(function(n,r,o){if(1==n.length){var a=n[0];switch(a.links[0].walkedPath.pathId){case"arc_0":case"line_0":break;default:t.chain.reverse(a)}i=t.chain.toKeyPoints(a)}else 1===r.length&&(i=e(r[0].pathContext))})),i}var a=d[n.type];if(a){var s=a(n,r);if(s)return p(n,s)}return[]},e.center=function(e){var n=t.measure.pathExtents(e),r=t.point.average(n.high,n.low);return a(e,t.point.subtract(e.origin||[0,0],r)),e},e.zero=function(e){var n=t.measure.pathExtents(e);return a(e,t.point.subtract(e.origin||[0,0],n.low)),e}}(t.path||(t.path={}))}(MakerJs||(MakerJs={})),function(t){var e,n;e=t.path||(t.path={}),(n={})[t.pathType.Arc]=function(e,n){var r=t.angle.ofPointInDegrees(e.origin,n);if(t.measure.isAngleEqual(r,e.startAngle)||t.measure.isAngleEqual(r,e.endAngle))return null;var i=function(){for(var n=t.angle.noRevolutions(e.startAngle),i=n+t.angle.ofArcEnd(e)-e.startAngle,o=[0,1,-1],a=0;a<o.length;a++){var s=360*o[a];if(t.measure.isBetween(r+s,n,i,!0))return e.startAngle+r+s-n}return null}();if(null==i)return null;var o=e.endAngle;e.endAngle=i;var a=t.cloneObject(e);return a.startAngle=i,a.endAngle=o,a},n[t.pathType.Circle]=function(e,n){e.type=t.pathType.Arc;var r=e,i=t.angle.ofPointInDegrees(e.origin,n);return r.startAngle=i,r.endAngle=i+360,null},n[t.pathType.Line]=function(e,n){if(!t.measure.isBetweenPoints(n,e,!0))return null;var r=e.end;e.end=n;var i=t.cloneObject(e);return i.origin=n,i.end=r,i},e.breakAtPoint=function(t,e){if(t&&e){var r=n[t.type];if(r){var i=r(t,e);return i&&"layer"in t&&(i.layer=t.layer),i}}return null}}(MakerJs||(MakerJs={})),function(t){!function(e){var n=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];function i(n){var r=t.angle.ofPointInDegrees(n,e[c?1:0]),i=t.angle.ofPointInDegrees(n,e[c?0:1]);return i<r&&(i+=360),{origin:n,startAngle:r,endAngle:i,size:i-r}}switch(e.length){case 5:var o=e[0],a=e[1];this.radius=e[2];var s,l=e[3],c=e[4],h=t.measure.pointDistance(o,a)/2;if(t.round(this.radius-h)<=0)this.radius=h,s=i(t.point.average(o,a));else{for(var u=t.path.intersection(new r(o,this.radius),new r(a,this.radius)),f=[],p=u.intersectionPoints.length;p--;)s=i(u.intersectionPoints[p]),0==f.length||s.size>f[0].size?f.push(s):f.unshift(s);var d=l?1:0;s=f[d]}this.origin=s.origin,this.startAngle=s.startAngle,this.endAngle=s.endAngle;break;case 4:this.origin=e[0],this.radius=e[1],this.startAngle=e[2],this.endAngle=e[3];break;case 3:if(t.isPoint(e[2])){r.apply(this,e);var g=[];for(p=0;p<3;p++)g.push(t.angle.ofPointInDegrees(this.origin,e[p]));this.startAngle=g[0],this.endAngle=g[2],t.measure.isBetweenArcAngles(g[1],this,!1)||(this.startAngle=g[2],this.endAngle=g[0]);break}case 2:c=e[2],r.call(this,e[0],e[1]),this.startAngle=t.angle.ofPointInDegrees(this.origin,e[c?1:0]),this.endAngle=t.angle.ofPointInDegrees(this.origin,e[c?0:1])}this.type=t.pathType.Arc};e.Arc=n;var r=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];switch(this.type=t.pathType.Circle,e.length){case 1:this.origin=[0,0],this.radius=e[0];break;case 2:t.isNumber(e[1])?(this.origin=e[0],this.radius=e[1]):(this.origin=t.point.average(e[0],e[1]),this.radius=t.measure.pointDistance(this.origin,e[0]));break;default:for(var r=[new i(e[0],e[1]),new i(e[1],e[2])],o=[],a=2;a--;){var s=t.point.middle(r[a]);o.push(t.path.rotate(r[a],90,s))}var l=t.point.fromSlopeIntersection(o[0],o[1]);if(!l)throw"invalid parameters - attempted to construct a circle from 3 points on a line: "+JSON.stringify(e);this.origin=l,this.radius=t.measure.pointDistance(this.origin,e[0])}};e.Circle=r;var i=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];switch(this.type=t.pathType.Line,e.length){case 1:var r=e[0];this.origin=r[0],this.end=r[1];break;case 2:this.origin=e[0],this.end=e[1]}};e.Line=i;var o=function(e){var n=t.point.fromArc(e);this.type=t.pathType.Line,this.origin=n[0],this.end=n[1]};e.Chord=o;var a=function(e,n,r){this.type=t.pathType.Line,this.origin=t.point.clone(e.origin),this.end=t.point.clone(e.end);var i=t.angle.ofLineInDegrees(this);function o(o){var a=t.point.add(e.origin,t.point.fromPolar(t.angle.toRadians(i+o),n));return{origin:a,nearness:t.measure.pointDistance(a,r)}}var a=[o(-90),o(90)],s=a[0].nearness<a[1].nearness?a[0].origin:a[1].origin;t.path.move(this,s)};e.Parallel=a}(t.paths||(t.paths={}))}(MakerJs||(MakerJs={})),function(t){!function(e){function n(t,e,n,r){void 0===r&&(r=!1);var i=r?n:a(t,n);return t.paths=t.paths||{},t.paths[i]=e,t}function r(t,e,n,r){void 0===r&&(r=!1);var i=r?n:o(t,n);return t.models=t.models||{},t.models[i]=e,t}function i(t,e){if(!t)return e;for(var n=0,r=e;r in t;)r=[e,++n].join("_");return r}function o(t,e){return i(t.models,e)}function a(t,e){return i(t.paths,e)}function s(e,n,r){if(void 0===r&&(r=!1),r&&e.origin&&(e.origin=t.point.scale(e.origin,n)),e.type===t.models.BezierCurve.typeName&&t.path.scale(e.seed,n),e.paths)for(var i in e.paths)t.path.scale(e.paths[i],n);if(e.models)for(var i in e.models)s(e.models[i],n,!0);return e.caption&&t.path.scale(e.caption.anchor,n),e}function l(e,i,o,a,s,l,c){var h=t.path.distort(i,s,l);((a=a||i.layer)&&(h.layer=a),t.isPath(h))?h.type===t.pathType.BezierSeed?r(e,new t.models.BezierCurve(h,c),o):n(e,h,o):r(e,h,o)}function c(e,n){if(e)return function e(r,i,o,a,s){var l=t.point.add(r.origin,o);if(i=null!=i?i:"",r.paths)for(var c in r.paths){var h=r.paths[c];if(h){var u={modelContext:r,layer:null!=h.layer?h.layer:i,offset:l,pathContext:h,pathId:c,route:a.concat(["paths",c]),routeKey:s+(s?".":"")+"paths"+JSON.stringify([c])};n.onPath&&n.onPath(u)}}if(r.models)for(var f in r.models){var p=r.models[f];if(p){var d={parentModel:r,layer:null!=p.layer?p.layer:i,offset:l,route:a.concat(["models",f]),routeKey:s+(s?".":"")+"models"+JSON.stringify([f]),childId:f,childModel:p};n.beforeChildWalk&&!n.beforeChildWalk(d)||(e(d.childModel,d.layer,l,d.route,d.routeKey),n.afterChildWalk&&n.afterChildWalk(d))}}}(e,e.layer,[0,0],[],""),e}e.addCaption=function(e,n,r,i){return r||(r=t.point.zero()),i||(i=t.point.clone(r)),e.caption={text:n,anchor:new t.paths.Line(r,i)},e},e.addPath=n,e.addModel=r,e.addTo=function(t,e,n,i){return void 0===i&&(i=!1),r(e,t,n,i),t},e.clone=function(e){return t.cloneObject(e)},e.countChildModels=function(t){var e=0;if(t.models)for(var n in t.models)e++;return e},e.getAllCaptionsOffset=function(n){var r=[];function i(e,n,i){e.caption&&r.push({text:e.caption.text,anchor:t.path.clone(e.caption.anchor,n),layer:e.caption.anchor.layer||i})}return i(n,n.origin,n.layer),e.walk(n,{afterChildWalk:function(t){return i(t.childModel,t.offset,t.layer)}}),r},e.getSimilarModelId=o,e.getSimilarPathId=a,e.layer=function(t,e){return t.layer=e,t},e.originate=function(e,n){return function e(n,r){if(n){var i=t.point.add(n.origin,r);if(n.type===t.models.BezierCurve.typeName&&t.path.moveRelative(n.seed,i),n.paths)for(var o in n.paths)t.path.moveRelative(n.paths[o],i);if(n.models)for(var o in n.models)e(n.models[o],i);n.caption&&t.path.moveRelative(n.caption.anchor,i),n.origin=t.point.zero()}}(e,n?t.point.subtract([0,0],n):[0,0]),n&&(e.origin=n),e},e.center=function(e,n,r){void 0===n&&(n=!0),void 0===r&&(r=!0);var i=t.measure.modelExtents(e),o=e.origin||[0,0];return n&&(o[0]-=i.center[0]),r&&(o[1]-=i.center[1]),e.origin=o,e},e.mirror=function e(n,r,i){var o={};if(!n)return null;if(n.origin&&(o.origin=t.point.mirror(n.origin,r,i)),n.type&&(o.type=n.type),"layer"in n&&(o.layer=n.layer),n.units&&(o.units=n.units),n.type===t.models.BezierCurve.typeName&&(o.type=t.models.BezierCurve.typeName,o.seed=t.path.mirror(n.seed,r,i)),n.paths)for(var a in o.paths={},n.paths){var s=n.paths[a];if(s){var l=t.path.mirror(s,r,i);l&&(o.paths[a]=l)}}if(n.models)for(var a in o.models={},n.models){var c=n.models[a];if(c){var h=e(c,r,i);h&&(o.models[a]=h)}}return n.caption&&(o.caption=t.cloneObject(n.caption),o.caption.anchor=t.path.mirror(n.caption.anchor,r,i)),o},e.move=function(e,n){return e.origin=t.point.clone(n),e},e.moveRelative=function(e,n){return e&&(e.origin=t.point.add(e.origin||t.point.zero(),n)),e},e.prefixPathIds=function(t,e){var n=[];c(t,{onPath:function(t){n.push(t)}});for(var r=0;r<n.length;r++){var i=n[r];delete i.modelContext.paths[i.pathId],i.modelContext.paths[e+i.pathId]=i.pathContext}return t},e.rotate=function e(n,r,i){if(void 0===i&&(i=[0,0]),!n||!r)return n;var o=t.point.subtract(i,n.origin);if(n.type===t.models.BezierCurve.typeName&&t.path.rotate(n.seed,r,o),n.paths)for(var a in n.paths)t.path.rotate(n.paths[a],r,o);if(n.models)for(var a in n.models)e(n.models[a],r,o);return n.caption&&t.path.rotate(n.caption.anchor,r,o),n},e.scale=s,e.distort=function e(n,i,o,a,s){void 0===a&&(a=!1);var c={};if(n.layer&&(c.layer=n.layer),a&&n.origin&&(c.origin=t.point.distort(n.origin,i,o)),n.type===t.models.BezierCurve.typeName){var h=n,u=t.models.BezierCurve.getBezierSeeds(h,{byLayers:!0}),f=function(t){u[t].forEach((function(e,n){l(c,e,n.toString(),t,i,o,s)}))};for(var p in u)f(p)}else if(n.paths)for(var d in n.paths){var g=n.paths[d];l(c,g,d,null,i,o,s)}if(n.models)for(var v in n.models){var m=e(n.models[v],i,o,!0,s);r(c,m,v)}return n.caption&&(c.caption=t.cloneObject(n.caption),c.caption.anchor=t.path.distort(n.caption.anchor,i,o)),c},e.convertUnits=function(e,n){if(e.units&&t.units.isValidUnit(e.units)&&t.units.isValidUnit(n)){var r=t.units.conversionScale(e.units,n);1!=r&&(s(e,r),e.units=n)}return e},e.walkPaths=function t(e,n){if(e.paths)for(var r in e.paths)e.paths[r]&&n(e,r,e.paths[r]);if(e.models)for(var i in e.models)e.models[i]&&t(e.models[i],n)},e.walk=c,e.zero=function(e,n,r){void 0===n&&(n=!0),void 0===r&&(r=!0);var i=t.measure.modelExtents(e),o=e.origin||[0,0];return n&&(o[0]-=i.low[0]),r&&(o[1]-=i.low[1]),e.origin=o,e}}(t.model||(t.model={}))}(MakerJs||(MakerJs={})),function(t){!function(e){function n(e,n){var r=t.cloneObject(e);if(!r)return null;var i=t.path.breakAtPoint(r,n);if(i){for(var o=[r,i],a=2;a--;)if(0==t.round(t.measure.pathLength(o[a]),1e-4))return null;return o}return e.type==t.pathType.Circle?[r]:null}function r(e,n,r){var i=[];return e.forEach((function(e){t.measure.isPointOnPath(e,n,1e-5,null,r)&&i.push(e)})),i}function i(i,o,a,s,l,c){var h=[],u=[],f={onPath:function(i){var f={absolutePath:t.path.clone(i.pathContext,i.offset),pathId:i.pathId,overlapped:!1,uniqueForeignIntersectionPoints:[]},p=i;p.broken=!1,p.segments=[f];var d={onPath:function(e){i.pathContext!==e.pathContext&&t.measure.isMeasurementOverlapping(s.pathMap[i.routeKey],l.pathMap[e.routeKey])&&function(e,i,o){var a=o.pathContext,s=e.segments;if(t.measure.isPathEqual(s[0].absolutePath,a,1e-4,null,o.offset))return s[0].overlapped=!0,s[0].duplicate=!0,void i.push(s[0]);for(var l={},c={path1Offset:e.offset,path2Offset:o.offset},h=t.path.intersection(e.pathContext,a,c),u=h?h.intersectionPoints:null,f=t.point.fromPathEnds(a,o.offset)||[],p=0;p<s.length;p++){var d=r(u?f.concat(u):f,s[p].absolutePath,l);if(c.out_AreOverlapped&&(s[p].overlapped=!0,i.push(s[p])),d.length>0){for(var g=null,v=0;!g&&v<d.length;)g=n(s[p].absolutePath,d[v]),v++;if(g){if(e.broken=!0,s[p].absolutePath=g[0],g[1]){var m={absolutePath:g[1],pathId:s[0].pathId,overlapped:s[p].overlapped,uniqueForeignIntersectionPoints:[]};s[p].overlapped&&i.push(m),s.push(m)}p--}}}}(p,u,e)},beforeChildWalk:function(e){var n=l.modelMap[e.routeKey];return n&&t.measure.isMeasurementOverlapping(s.pathMap[i.routeKey],n)}};if(e.walk(o,d),a)for(var g=0;g<p.segments.length;g++){var v=t.point.middle(p.segments[g].absolutePath),m={measureAtlas:l,farPoint:c};p.segments[g].isInside=t.measure.isPointInsideModel(v,o,m),p.segments[g].uniqueForeignIntersectionPoints=m.out_intersectionPoints}h.push(p)}};return e.walk(i,f),{crossedPaths:h,overlappedSegments:u}}function o(n,r,i,o,a,s){function l(r,i,o){var s=e.getSimilarPathId(r,i),l=s==i?n.routeKey:t.createRouteKey(n.route.slice(0,-1).concat([s]));if(o.addedPath=t.cloneObject(n.pathContext),o.addedPath.type=o.absolutePath.type,t.path.copyProps(o.absolutePath,o.addedPath),t.path.moveRelative(o.addedPath,n.offset,!0),r.paths[s]=o.addedPath,n.broken){var c=t.measure.pathExtents(o.absolutePath);a.pathMap[l]=c,a.modelsMeasured=!1}else a.pathMap[l]=f}var c,h,u,f=a.pathMap[n.routeKey];delete n.modelContext.paths[n.pathId],delete a.pathMap[n.routeKey];for(var p=0;p<n.segments.length;p++)n.segments[p].duplicate?o?l(n.modelContext,n.pathId,n.segments[p]):s(n.segments[p].absolutePath,n.routeKey,"segment is duplicate"):(c=n.modelContext,h=n.pathId,(u=n.segments[p]).isInside&&r||!u.isInside&&i?l(c,h,u):(a.modelsMeasured=!1,s(u.absolutePath,n.routeKey,"segment is "+(u.isInside?"inside":"outside")+" intersectionPoints="+JSON.stringify(u.uniqueForeignIntersectionPoints))))}function a(n,r,a,s,l,c,h){void 0===a&&(a=!1),void 0===s&&(s=!0),void 0===l&&(l=!1),void 0===c&&(c=!0);var u={trimDeadEnds:!0,pointMatchingDistance:.005,out_deleted:[{paths:{}},{paths:{}}]};if(t.extendObject(u,h),u.measureA=u.measureA||new t.measure.Atlas(n),u.measureB=u.measureB||new t.measure.Atlas(r),u.measureA.measureModels(),u.measureB.measureModels(),!u.farPoint){var f=t.measure.increase(t.measure.increase({high:[null,null],low:[null,null]},u.measureA.modelMap[""]),u.measureB.modelMap[""]);u.farPoint=t.point.add(f.high,[1,1])}var p=i(n,r,!0,u.measureA,u.measureB,u.farPoint),d=i(r,n,!0,u.measureB,u.measureA,u.farPoint);function g(t,n,r,i){e.addPath(u.out_deleted[t],n,"deleted");var o=n;o.reason=i,o.routeKey=r}!function(e,n,r){function i(e){for(var i=0;i<n.length;i++)o=n[i],a=e,t.measure.isPathEqual(o.absolutePath,a.absolutePath,r)&&(o.duplicate=a.duplicate=!0);var o,a}for(var o=0;o<e.length;o++)i(e[o])}(p.overlappedSegments,d.overlappedSegments,u.pointMatchingDistance);for(var v=0;v<p.crossedPaths.length;v++)o(p.crossedPaths[v],a,s,!0,u.measureA,(function(t,e,n){return g(0,t,e,n)}));for(v=0;v<d.crossedPaths.length;v++)o(d.crossedPaths[v],l,c,!1,u.measureB,(function(t,e,n){return g(1,t,e,n)}));var m,y={models:{a:n,b:r}};u.trimDeadEnds&&(a||l||(m=function(t){for(var e=0;e<p.overlappedSegments.length;e++)if(p.overlappedSegments[e].duplicate&&t.pathContext===p.overlappedSegments[e].addedPath)return!1;return!0}),e.removeDeadEnds(y,null,m,(function(t,e){g("a"===t.route[1]?0:1,t.pathContext,t.routeKey,e)})));return t.extendObject(h,u),y}e.isPathInsideModel=function(e,n,r,i,o){var a={farPoint:i,measureAtlas:o},s=t.point.add(t.point.middle(e),r);return t.measure.isPointInsideModel(s,n,a)},e.breakPathsAtIntersections=function(e,n){var r,o=new t.measure.Atlas(e);return o.measureModels(),n?(r=new t.measure.Atlas(n)).measureModels():(n=e,r=o),i(e,n||e,!1,o,r),e},e.combine=a,e.combineIntersection=function(t,e){return a(t,e,!0,!1,!0,!1)},e.combineSubtraction=function(t,e){return a(t,e,!1,!0,!0,!1)},e.combineUnion=function(t,e){return a(t,e,!1,!0,!1,!0)}}(t.model||(t.model={}))}(MakerJs||(MakerJs={})),function(t){var e=function(){function t(t){this.comparer=t,this.collections=[]}return t.prototype.addItemToCollection=function(t,e){var n=this.findCollection(t);if(n)n.push(e);else{var r={key:t,items:[e]};this.collections.push(r)}},t.prototype.findCollection=function(t,e){for(var n=0;n<this.collections.length;n++){var r=this.collections[n];if(this.comparer(t,r.key))return e&&e(n),r.items}return null},t.prototype.removeCollection=function(t){var e=this;return!!this.findCollection(t,(function(t){e.collections.splice(t,1)}))},t.prototype.removeItemFromCollection=function(t,e){var n=this.findCollection(t);if(n){for(var r=0;r<n.length;r++)if(n[r]===e)return n.splice(r,1),!0;return!1}},t.prototype.getCollectionsOfMultiple=function(t){for(var e=0;e<this.collections.length;e++){var n=this.collections[e];n.items.length>1&&t(n.key,n.items)}},t}();t.Collector=e;var n=__webpack_require__(119),r=n.default||n,i=function(){function e(){this.reset()}return e.prototype.reset=function(){this.insertedCount=0,this.graph={},this.index={},this.merged={},this.values=[]},e.prototype.insertValue=function(t){return this.values.push(t),this.values.length-1},e.prototype.insertValueIdAtPoint=function(t,e){var n=e[0],r=e[1];this.graph[n]||(this.graph[n]={});var i,o,a=this.graph[n],s=r in a;return s?((o=a[r])in this.merged&&(o=this.merged[o]),(i=this.index[o]).valueIds.push(t)):(a[r]=o=this.insertedCount++,i={pointId:o,point:e,valueIds:[t]},this.index[o]=i),{existed:s,pointId:o}},e.prototype.mergePoints=function(t){var e=this,n=[],i=[];for(var o in this.index){var a=this.index[o],s=a.point;a.kdId=n.length,n.push(s),i.push(a)}this.kdbush=r(n);var l=function(n){if(n in c.merged)return"continue";var r=c.index[n];c.kdbush.within(r.point[0],r.point[1],t).forEach((function(t){t!==r.kdId&&e.mergeIndexElements(r,i[t])}))},c=this;for(var o in this.index)l(o)},e.prototype.mergeNearestSinglePoints=function(e){var n=this,i=[];for(var o in this.index){var a=this.index[o];1===a.valueIds.length&&i.push(a)}this.kdbush=r(i.map((function(t){return t.point}))),i.forEach((function(r){if(!(r.pointId in n.merged)){var o=n.kdbush.within(r.point[0],r.point[1],e),a=[];o.forEach((function(e){var n=i[e];n.pointId!==r.pointId&&a.push({el:n,distance:t.measure.pointDistance(n.point,r.point)})})),a.sort((function(t,e){return t.distance-e.distance}));for(var s=0;s<a.length;s++){var l=a[s].el;if(!(l.pointId in n.merged))return void(l.merged&&l.merged.length>0?n.mergeIndexElements(l,r):n.mergeIndexElements(r,l))}}}))},e.prototype.mergeIndexElements=function(t,e){return t.merged=t.merged||[],t.merged.push(e.pointId),this.merged[e.pointId]=t.pointId,t.valueIds.push.apply(t.valueIds,e.valueIds),delete this.index[e.pointId],t.pointId},e.prototype.forEachPoint=function(t){for(var e=this,n=0;n<this.insertedCount;n++){var r=this.index[n];if(r)r.valueIds.length>0&&t(r.point,r.valueIds.map((function(t){return e.values[t]})),n,r)}},e.prototype.getIdOfPoint=function(t){var e=this.graph[t[0]];if(e){var n=e[t[1]];if(n>=0)return n in this.merged?this.merged[n]:n}},e.prototype.getElementAtPoint=function(t){var e=this.getIdOfPoint(t);if(e>=0)return this.index[e]},e}();t.PointGraph=i}(MakerJs||(MakerJs={})),function(t){!function(e){function n(t,e,n){var r=0;do{var i=t[r];do{for(var o=!1,a=r+1;a<t.length;a++){var s=t[a];if(o=e(i.pathContext,s.pathContext,!1)){n(i.pathContext,s.pathContext),delete s.modelContext.paths[s.pathId],t.splice(a,1);break}}}while(o);r++}while(r<t.length)}e.simplify=function(r,i){function o(e,n){return Math.abs(e.radius-n.radius)<=h.scalarMatchingDistance&&t.measure.pointDistance(e.origin,n.origin)<=h.pointMatchingDistance}var a=new t.Collector(o),s=new t.Collector(o),l=new t.Collector(t.measure.isSlopeEqual),c={};c[t.pathType.Arc]=function(t){a.addItemToCollection(t.pathContext,t)},c[t.pathType.Circle]=function(t){s.addItemToCollection(t.pathContext,t)},c[t.pathType.Line]=function(e){var n=t.measure.lineSlope(e.pathContext);l.addItemToCollection(n,e)};var h={scalarMatchingDistance:.001,pointMatchingDistance:.005};t.extendObject(h,i);var u={onPath:function(t){var e=c[t.pathContext.type];e&&e(t)}};return e.walk(r,u),a.getCollectionsOfMultiple((function(e,r){n(r,t.measure.isArcOverlapping,(function(e,n){var r=t.measure.isBetweenArcAngles(e.endAngle,n,!1),i=t.measure.isBetweenArcAngles(n.endAngle,e,!1);if(r&&i)e.endAngle=e.startAngle+360;else{var o=r?[e,n]:[n,e];e.startAngle=t.angle.noRevolutions(o[0].startAngle),e.endAngle=o[1].endAngle}}))})),s.getCollectionsOfMultiple((function(t,e){for(var n=1;n<e.length;n++){var r=e[n];delete r.modelContext.paths[r.pathId]}})),l.getCollectionsOfMultiple((function(e,r){n(r,t.measure.isLineOverlapping,(function(n,r){var i={paths:{lineA:n,lineB:r}},o=t.measure.modelExtents(i);e.hasSlope?e.slope<0?(n.origin=[o.low[0],o.high[1]],n.end=[o.high[0],o.low[1]]):e.slope>0?(n.origin=o.low,n.end=o.high):(n.origin[0]=o.low[0],n.end[0]=o.high[0]):(n.origin[1]=o.low[1],n.end[1]=o.high[1])}))})),r}}(t.model||(t.model={}))}(MakerJs||(MakerJs={})),function(t){!function(e){var n={};n[t.pathType.Arc]=function(e,n,r){return new t.models.OvalArc(e.startAngle,e.endAngle,e.radius,n,!1,r)},n[t.pathType.Circle]=function(e,n,r){return new t.models.Ring(e.radius+n,e.radius-n)},n[t.pathType.Line]=function(e,n,r){return new t.models.Slot(e.origin,e.end,n,r)},e.expand=function(t,e,r){if(!t)return null;var i=null,o=n[t.type];return o&&((i=o(t,e,r)).origin=t.origin),i},e.straighten=function(e,n,r,i){var o=t.angle.ofArcSpan(e),a=1;o>=270?a=4:o>180?a=3:(o>150||n)&&(a=2);for(var s=t.angle.toRadians(o/a),l=t.models.Polygon.circumscribedRadius(e.radius,s),c=t.point.fromArc(e),h=[t.point.subtract(c[0],e.origin)],u=t.angle.toRadians(e.startAngle)+s/2,f=0;f<a;f++)h.push(t.point.fromPolar(u,l)),u+=s;h.push(t.point.subtract(c[1],e.origin));var p=new t.models.ConnectTheDots(i,h);return p.origin=e.origin,"string"==typeof r&&r.length&&t.model.prefixPathIds(p,r),p}}(t.path||(t.path={}))}(MakerJs||(MakerJs={})),function(t){!function(e){function n(n,r,i,o){if(void 0===i&&(i=0),void 0===o&&(o={}),r<=0)return null;var a={models:{expansions:{models:{}},caps:{models:{}}}},s=!0,l=o.farPoint,c={onPath:function(n){if(!(o.pointMatchingDistance&&t.measure.pathLength(n.pathContext)<o.pointMatchingDistance)){var i=t.path.expand(n.pathContext,r,!0);if(i){e.moveRelative(i,n.offset);var c=e.getSimilarModelId(a.models.expansions,n.pathId);if(e.prefixPathIds(i,n.pathId+"_"),e.originate(i),s||(e.combine(a,i,!1,!0,!1,!0,o),o.measureA.modelsMeasured=!1,l=o.farPoint,delete o.farPoint,delete o.measureB),a.models.expansions.models[c]=i,i.models){var h=i.models.Caps;h&&(delete i.models.Caps,a.models.caps.models[c]=h)}s=!1}}}};if(e.walk(n,c),i){var h=a.models.caps,u={models:{}};for(var f in a.models.straightcaps=u,e.simplify(h),h.models)u.models[f]={models:{}},e.walk(h.models[f],{onPath:function(n){var r=n.pathContext,s=t.path.straighten(r,2==i,n.pathId+"_",!0);e.combine(a,s,!1,!0,!1,!0,o),o.measureA.modelsMeasured=!1,l=o.farPoint,delete o.farPoint,delete o.measureB,u.models[f].models[n.pathId]=s,delete n.modelContext.paths[n.pathId]}});delete a.models.caps}return o.farPoint=l,a}function r(t){var n=[];return e.findChains(t,(function(t,e,r){n=t.filter((function(t){return t.endless}))})),n}e.expandPaths=n,e.outline=function(e,i,o,a,s){void 0===o&&(o=0),void 0===a&&(a=!1),void 0===s&&(s={});var l=n(e,i,o,s);if(!l)return null;var c=function(e){var n=r(e);if(0==n.length)return null;var i={models:{}};return n.forEach((function(e,n){i.models[n]=t.chain.toNewModel(e)})),i}(e);if(c){var h=0,u={models:{}};return r(l).forEach((function(e){var n=e.links[0].walkedPath,r=t.measure.isPointInsideModel(t.point.middle(n.pathContext),c,n.offset);(a&&r||!a&&!r)&&(u.models[h++]=t.chain.toNewModel(e))})),u}return l}}(t.model||(t.model={}))}(MakerJs||(MakerJs={})),function(t){!function(e){var n,r=t.unitType.Millimeter;function i(t,e,r){function i(t){return n[t]||(n[t]={}),n[t]}i(t)[e]=r,i(e)[t]=1/r}function o(t,e){i(t,r,e)}e.conversionScale=function(e,a){return e==a?1:(n||(n={},o(t.unitType.Centimeter,10),o(t.unitType.Meter,1e3),o(t.unitType.Inch,25.4),o(t.unitType.Foot,25.4*12)),n[e][a]||i(e,a,n[e][r]*n[r][a]),n[e]&&n[e][a])},e.isValidUnit=function(e){for(var n in t.unitType)if(t.unitType[n]==e)return!0;return!1}}(t.units||(t.units={}))}(MakerJs||(MakerJs={})),function(t){!function(e){function n(e,n,r){void 0===r&&(r=1e-4);var i=t.angle.noRevolutions(e),o=t.angle.noRevolutions(n);return 0==t.angle.noRevolutions(t.round(o-i,r))}e.isAngleEqual=n;var r={};function i(n,r,i){return i?!(!n||!r)&&e.pointDistance(n,r)<=i:0==t.round(n[0]-r[0])&&0==t.round(n[1]-r[1])}function o(t,e,n){return void 0===n&&(n=0),e.hasSlope?Math.abs(t[1]-(e.slope*t[0]+e.yIntercept))<=n:Math.abs(t[0]-e.line.origin[0])<=n}function a(t,n,r){return void 0===r&&(r=0),Math.abs(e.pointDistance(t,n.origin)-n.radius)<=r}r[t.pathType.Line]=function(t,e,n){return i(t.origin,e.origin,n)&&i(t.end,e.end,n)||i(t.origin,e.end,n)&&i(t.end,e.origin,n)},r[t.pathType.Circle]=function(t,e,n){return i(t.origin,e.origin,n)&&t.radius==e.radius},r[t.pathType.Arc]=function(e,i,o){return r[t.pathType.Circle](e,i,o)&&n(e.startAngle,i.startAngle)&&n(e.endAngle,i.endAngle)},e.isPathEqual=function(e,n,i,o,a){var s=!1;if(e.type==n.type){var l=r[e.type];if(l){function c(){s=l(e,n,i)}o||a?t.path.moveTemporary([e,n],[o,a],c):c()}}return s},e.isPointEqual=i,e.isPointDistinct=function(t,e,n){for(var r=0;r<e.length;r++)if(i(e[r],t,n))return!1;return!0},e.isPointOnSlope=o,e.isPointOnCircle=a;var s={};function l(e,n){return!e.hasSlope&&!n.hasSlope||!(!e.hasSlope||!n.hasSlope||0!=t.round(e.slope-n.slope,1e-5))}s[t.pathType.Circle]=function(t,e,n){return a(t,e,n)},s[t.pathType.Arc]=function(n,r,i){if(s[t.pathType.Circle](n,r,i)){var o=t.angle.ofPointInDegrees(r.origin,n);return e.isBetweenArcAngles(o,r,!1)}return!1},s[t.pathType.Line]=function(t,n,r,i){var a=i&&i.cachedLineSlope||e.lineSlope(n);return i&&!i.cachedLineSlope&&(i.cachedLineSlope=a),o(t,a,r)&&e.isBetweenPoints(t,n,!1)},e.isPointOnPath=function(e,n,r,i,o){void 0===r&&(r=0);var a=s[n.type];return!!a&&a(e,i?t.path.clone(n,i):n,r,o)},e.isSlopeEqual=function(e,n){return!!l(e,n)&&(e.hasSlope||n.hasSlope?0==t.round(e.yIntercept-n.yIntercept,1e-5):0==t.round(e.line.origin[0]-n.line.origin[0]))},e.isSlopeParallel=l}(t.measure||(t.measure={}))}(MakerJs||(MakerJs={})),function(t){!function(e){function n(t,e,n){function r(t,e,n){if(e)for(var r=2;r--;)null!=e[r]&&(null==t[r]?t[r]=e[r]:t[r]=n(t[r],e[r]))}return e&&(r(t.low,e.low,Math.min),r(t.high,e.high,Math.max)),n&&b(t),t}function r(t,e,n){function r(t,e){function r(e){return o(e,t,n)}return r(e.startAngle)||r(e.endAngle)}return r(t,e)||r(e,t)||t.startAngle==e.startAngle&&t.endAngle==e.endAngle}function i(t,e,n,r){return r?Math.min(e,n)<t&&t<Math.max(e,n):Math.min(e,n)<=t&&t<=Math.max(e,n)}function o(e,n,r){var o=t.angle.noRevolutions(n.startAngle),a=o+t.angle.ofArcSpan(n);return i(e=t.angle.noRevolutions(e),o,a,r)||i(e,o+360,a+360,r)||i(e,o-360,a-360,r)}function a(e,n,r){for(var o=!1,a=2;a--;)if(0!=t.round(n.origin[a]-n.end[a],1e-6)){var s=t.round(n.origin[a]),l=t.round(n.end[a]);if(!i(t.round(e[a]),s,l,r))return!1}else{if(o)return!1;o=!0}return!0}e.increase=n,e.isArcConcaveTowardsPoint=function(e,n){if(f(e.origin,n)<=e.radius)return!0;var r=new t.paths.Line(t.point.middle(e),n),i={};return!(!t.path.intersection(r,new t.paths.Chord(e),i)&&!i.out_AreOverlapped)},e.isArcOverlapping=function(t,e,n){return r(t,e,n)},e.isArcSpanOverlapping=r,e.isBetween=i,e.isBetweenArcAngles=o,e.isBetweenPoints=a,e.isBezierSeedLinear=function(t,n){for(var r=u(t),i=0;i<t.controls.length;i++)if(!e.isPointOnSlope(t.controls[i],r)){if(!n)return!1;if(a(t.controls[i],t,!1))return!1}return!0};var s=__webpack_require__(95);function l(t){return t.join(",")}function c(t,e){var n=new s,r=[];t.forEach((function(t){n.addPoint(t[0],t[1]),r.push(l(t))}));var i=n.getHull(),o=i.slice(0,3).map((function(t){return l([t.x,t.y])})),a=[];switch(r.forEach((function(t){~o.indexOf(t)&&a.push(t)})),a.indexOf(o[1])){case 0:a.unshift(a.pop());break;case 2:a.push(a.shift())}return e&&(e.hullPoints=i.map((function(t){return[t.x,t.y]})),e.keyPoints=t),o[0]!=a[0]}function h(e,n){for(var r=2;r--;)if(!(t.round(e.low[r]-n.high[r])<=0&&t.round(e.high[r]-n.low[r])>=0))return!1;return!0}function u(e){var n=e.end[0]-e.origin[0];if(0==t.round(n,1e-6))return{line:e,hasSlope:!1};var r=(e.end[1]-e.origin[1])/n;return{line:e,hasSlope:!0,slope:r,yIntercept:e.origin[1]-r*e.origin[0]}}function f(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}function p(t,e,n){return[n(t[0],e[0]),n(t[1],e[1])]}e.isChainClockwise=function(e,n){return e.endless&&1!==e.links.length?c(t.chain.toKeyPoints(e),n):null},e.isPointArrayClockwise=c,e.isLineOverlapping=function(t,e,n){function r(t,e,r){function i(t){return a(t,e,n)}return i(r.origin)||i(r.end)}return r(0,t,e)||r(0,e,t)},e.isMeasurementOverlapping=h,e.lineSlope=u,e.pointDistance=f;var d={};function g(e,n){if(e){var r=d[e.type];if(r){var i=r(e);return n&&(i.high=t.point.add(i.high,n),i.low=t.point.add(i.low,n)),i}}return{low:null,high:null}}d[t.pathType.Line]=function(t){return{low:p(t.origin,t.end,Math.min),high:p(t.origin,t.end,Math.max)}},d[t.pathType.Circle]=function(e){var n=e.radius;return{low:t.point.add(e.origin,[-n,-n]),high:t.point.add(e.origin,[n,n])}},d[t.pathType.Arc]=function(e){var n=e.radius,r=t.point.fromArc(e);function i(t,n,i){for(var a=p(r[0],r[1],i),s=2;s--;)o(t[s],e,!1)&&(a[s]=n+e.origin[s]);return a}return{low:i([180,270],-n,Math.min),high:i([360,90],n,Math.max)}},e.pathExtents=g;var v={};function m(t){if(t){var e=v[t.type];if(e)return e(t)}return 0}function y(e,r){function i(e,i){if(i){var o,a=e.slice(0,-2),s=t.createRouteKey(a);s in r.modelMap?n(r.modelMap[s],i):r.modelMap[s]=(o=i,{high:t.point.clone(o.high),low:t.point.clone(o.low)})}}r||(r=new x(e));var o={onPath:function(t){t.routeKey in r.pathMap||(r.pathMap[t.routeKey]=g(t.pathContext,t.offset)),i(t.route,r.pathMap[t.routeKey])},afterChildWalk:function(t){i(t.route,r.modelMap[t.routeKey])}};t.model.walk(e,o),r.modelsMeasured=!0;var a=r.modelMap[""];return a?b(a):a}function b(e){var n=e;return n.center=t.point.average(n.high,n.low),n.width=n.high[0]-n.low[0],n.height=n.high[1]-n.low[1],n}v[t.pathType.Line]=function(t){return f(t.origin,t.end)},v[t.pathType.Circle]=function(t){return 2*Math.PI*t.radius},v[t.pathType.Arc]=function(e){var n=v[t.pathType.Circle](e);return n*=t.angle.ofArcSpan(e)/360},v[t.pathType.BezierSeed]=function(e){return t.models.BezierCurve.computeLength(e)},e.pathLength=m,e.modelPathLength=function(e){var n=0;return t.model.walk(e,{onPath:function(t){n+=m(t.pathContext)}}),n},e.modelExtents=y,e.augment=b;var x=function(){function t(t){this.modelContext=t,this.modelsMeasured=!1,this.modelMap={},this.pathMap={}}return t.prototype.measureModels=function(){this.modelsMeasured||y(this.modelContext,this)},t}();function w(t,e){return t.slope*e+t.yIntercept}function S(e,n,r,i){t.model.rotate(n,r);var o=y(n),a={index:e,rotation:i,center:t.point.rotate(o.center,i),width:o.height,height:o.width,bottom:new t.paths.Line(o.low,[o.high[0],o.low[1]]),middle:new t.paths.Line([o.low[0],o.center[1]],[o.high[0],o.center[1]]),top:new t.paths.Line(o.high,[o.low[0],o.high[1]])};return[a.top,a.middle,a.bottom].forEach((function(e){return t.path.rotate(e,i)})),a}function C(e,n){var r=e[1].origin,i=r[0],o=e[3].origin[0],a=e[0].origin[0],s=i-a;if(a-o>2*s)return null;var l=(i-o)/3;if(s<l)return null;var c,h,f=Math.min(l,s),p=t.solvers.equilateralSide(f),d=[t.point.fromSlopeIntersection(e[1],e[2]),t.point.fromSlopeIntersection(e[4],e[5])].map((function(t){return Math.abs(t[1]-r[1])})),g=d[0]>d[1]?0:1,v=d[g];if(v>p){var m=t.solvers.equilateralAltitude(v),y=i-2*m;if(a>y+m)return null;if(o<y-m)return null;var b=o-y+m,x=2*m-n[g+1].width,S=Math.min(b,x)/2;return{origin:(c=n[2-g].middle,h=y+S,[h,w(u(c),h)]),radius:v,type:"peak "+g}}return{origin:[i-2*f,r[1]],radius:p,type:"side"}}e.Atlas=x,e.boundingHexagon=function(n){var r=t.cloneObject(n);t.model.originate(r);var i=y(r),o=[],a={paths:{}};function s(e,n,r){return{radius:e,paths:new t.models.Polygon(6,e,30).paths,origin:t.point.add(n,i.center),notes:r}}t.model.center(r);for(var l=[[90,-90],[-60,-30],[-60,30]];l.length;){var c=l.shift(),h=S(o.length,r,c[0],c[1]),u=t.solvers.equilateralSide(h.width/2);if(u>=h.height)return s(u,h.center,"solved by bound "+o.length);o.push(h)}if(function(n){for(var r=1;r<3;r++)if(!e.isPointEqual(n[0].center,n[r].center,1e-6)||0!==t.round(n[0].width-n[r].width))return!1;return!0}(o))return s(t.solvers.equilateralSide(o[0].width/2),o[0].center,"solved as circular");var f=o.map((function(t){return t.top})).concat(o.map((function(t){return t.bottom})));f.forEach((function(e,n){a.paths[n]=e,t.path.converge(f[function(t,e){return e>=t?e-t:e<0?e+t:e}(6,n+2)],e,!0)})),o.forEach((function(t,e){a.paths["m"+e]=t.middle}));for(var p,d=o.slice(),g=0;g<6;g++){g>0&&(f.push(f.shift()),d.push(d.shift()),t.model.rotate(a,-60));var v=C(f,d);v&&(!p||v.radius<p.radius)&&((p=v).index=g)}var m=t.point.rotate(p.origin,60*p.index);return s(p.radius,m,"solved by "+p.index+" as "+p.type)},e.isPointInsideModel=function(n,r,i){var o;void 0===i&&(i={}),i.farPoint||(i.farPoint=function(e,n,r){if(n)return n;var i=y(e).high;return i?t.point.add(i,[1,1]):[7654321,1234567]}(r,i.farPoint,i.measureAtlas)),i.out_intersectionPoints=[];var a=new t.paths.Line(n,i.farPoint),s=g(a),l={onPath:function(n){if(!i.measureAtlas||h(s,i.measureAtlas.pathMap[n.routeKey])){var r={path2Offset:n.offset},l=t.path.intersection(a,n.pathContext,r);if(l)(function(t,n){var r=0;return n.forEach((function(n){e.isPointDistinct(n,t,1e-8)&&(t.push(n),r++)})),r})(i.out_intersectionPoints,l.intersectionPoints)%2==1&&(o=!o)}},beforeChildWalk:function(t){if(!i.measureAtlas)return!0;var e=i.measureAtlas.modelMap[t.routeKey];return e&&h(s,e)}};return t.model.walk(r,l),!!o}}(t.measure||(t.measure={}))}(MakerJs||(MakerJs={})),function(t){!function(e){e.toJson=function(e,n){return void 0===n&&(n={}),JSON.stringify(e,n.accuracy&&function(e,r){return t.isNumber(r)?t.round(r,n.accuracy):t.isPoint(r)?t.point.rounded(r,n.accuracy):r},n.indentation)},e.tryGetModelUnits=function(e){if(t.isModel(e))return e.units},e.colors={black:0,red:1,yellow:2,lime:3,aqua:4,blue:5,fuchsia:6,white:7,gray:9,maroon:14,orange:30,olive:58,green:94,teal:134,navy:174,purple:214,silver:254}}(t.exporter||(t.exporter={}))}(MakerJs||(MakerJs={})),function(t){!function(t){t.parseNumericList=function(t){for(var e,n=[],r=/[\.-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g;null!==(e=r.exec(t));)e.index===r.lastIndex&&r.lastIndex++,n.push(parseFloat(e[0]));return n}}(t.importer||(t.importer={}))}(MakerJs||(MakerJs={})),function(t){!function(e){e.toDXF=function(r,i){void 0===i&&(i={});var o={fontSize:9},a=[],s={entities:[],header:{},tables:{}};if(t.extendObject(o,i),t.isModel(r)){var l=r;l.exporterOptions&&t.extendObject(o,l.exporterOptions.toDXF)}function c(t){return o.layerOptions&&o.layerOptions[t]?o.layerOptions[t]:t in e.colors?{color:e.colors[t]}:void 0}function h(t,e){var n=t&&t.layer||e||"0";return a.indexOf(n)<0&&a.push(n),n}var u={};function f(e,n,r){return{type:"VERTEX",layer:h(null,n),x:t.round(e[0],o.accuracy),y:t.round(e[1],o.accuracy),bulge:r}}function p(e){var n={type:"POLYLINE",layer:h(null,e.layer),shape:e.chain.endless,vertices:[]};if(e.chain.links.forEach((function(r,i){var a;if(r.walkedPath.pathContext.type===t.pathType.Arc){var s=r.walkedPath.pathContext;a=t.round(Math.tan(t.angle.toRadians(t.angle.ofArcSpan(s))/4),o.accuracy),r.reversed&&(a*=-1)}var l=r.endPoints[r.reversed?1:0];n.vertices.push(f(l,e.layer,a))})),!e.chain.endless){var r=e.chain.links[e.chain.links.length-1],i=r.endPoints[r.reversed?0:1];n.vertices.push(f(i,e.layer))}return n}function d(e){var n=h(null,e.layer),r=c(n),i=t.point.middle(e.anchor);return{type:"TEXT",startPoint:f(i,null),endPoint:f(i,null),layer:n,textHeight:r&&r.fontSize||o.fontSize,text:e.text,halign:4,valign:0,rotation:t.angle.ofPointInDegrees(e.anchor.origin,e.anchor.end)}}if(u[t.pathType.Line]=function(e,n,r){return{type:"LINE",layer:h(e,r),vertices:[{x:t.round(e.origin[0]+n[0],o.accuracy),y:t.round(e.origin[1]+n[1],o.accuracy)},{x:t.round(e.end[0]+n[0],o.accuracy),y:t.round(e.end[1]+n[1],o.accuracy)}]}},u[t.pathType.Circle]=function(e,n,r){return{type:"CIRCLE",layer:h(e,r),center:{x:t.round(e.origin[0]+n[0],o.accuracy),y:t.round(e.origin[1]+n[1],o.accuracy)},radius:t.round(e.radius,o.accuracy)}},u[t.pathType.Arc]=function(e,n,r){return{type:"ARC",layer:h(e,r),center:{x:t.round(e.origin[0]+n[0],o.accuracy),y:t.round(e.origin[1]+n[1],o.accuracy)},radius:t.round(e.radius,o.accuracy),startAngle:t.round(e.startAngle,o.accuracy),endAngle:t.round(e.endAngle,o.accuracy)}},!o.units){var g=e.tryGetModelUnits(r);g&&(o.units=g)}t.extendObject(i,o);var v,m=[],y=[];if(o.usePOLYLINE){t.model.findChains(l,(function(e,n,r){e.forEach((function(e){if(e.endless&&1===e.links.length&&e.links[0].walkedPath.pathContext.type===t.pathType.Circle)y.push(e.links[0].walkedPath);else{var n={chain:e,layer:r};m.push(n)}})),y.push.apply(y,n)}),{byLayers:!0,pointMatchingDistance:o.pointMatchingDistance})}else{var b={onPath:function(t){y.push(t)}};t.model.walk(l,b)}return function(t,e,n){var r=s.entities;r.push.apply(r,e.map(p)),t.forEach((function(t){var e=u[t.pathContext.type];if(e){var n=e(t.pathContext,t.offset,t.layer);r.push(n)}})),r.push.apply(r,n.map(d))}(y,m,t.model.getAllCaptionsOffset(l)),function(){if(o.units){var t=n[o.units];s.header.$INSUNITS=t}}(),s.tables.lineType={lineTypes:{CONTINUOUS:{name:"CONTINUOUS",description:"______",patternLength:0}}},v={layers:{}},a.forEach((function(t){var e=c(t);e&&(v.layers[t]=function(t,e){return{name:t,color:e}}(t,e.color))})),s.tables.layer=v,function(t){var e=[];function n(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.push.apply(e,t)}var r={};function i(t){n("0","SECTION"),t(),n("0","ENDSEC")}function o(t){n("0","TABLE"),t(),n("0","ENDTAB")}function a(){n("2","TABLES"),o(c),o(h)}function s(t){n("0","LAYER","2",t.name,"70","0","62",t.color,"6","CONTINUOUS")}function l(t){n("0","LTYPE","72","65","70","64","2",t.name,"3",t.description,"73","0","40",t.patternLength)}function c(){var e=t.tables.lineType;for(var r in n("2","LTYPE"),e.lineTypes){l(e.lineTypes[r])}}function h(){var e=t.tables.layer;for(var r in n("2","LAYER"),e.layers){s(e.layers[r])}}function u(){for(var e in n("2","HEADER"),t.header){n("9",e,"70",t.header[e])}}return r.LINE=function(t){n("0","LINE","8",t.layer,"10",t.vertices[0].x,"20",t.vertices[0].y,"11",t.vertices[1].x,"21",t.vertices[1].y)},r.CIRCLE=function(t){n("0","CIRCLE","8",t.layer,"10",t.center.x,"20",t.center.y,"40",t.radius)},r.ARC=function(t){n("0","ARC","8",t.layer,"10",t.center.x,"20",t.center.y,"40",t.radius,"50",t.startAngle,"51",t.endAngle)},r.VERTEX=function(t){n("0","VERTEX","8",t.layer,"10",t.x,"20",t.y),void 0!==t.bulge&&n("42",t.bulge)},r.POLYLINE=function(t){n("0","POLYLINE","8",t.layer,"66",1,"70",t.shape?1:0),t.vertices.forEach((function(t){return r.VERTEX(t)})),n("0","SEQEND")},r.TEXT=function(t){n("0","TEXT","10",t.startPoint.x,"20",t.startPoint.y,"11",t.endPoint.x,"21",t.endPoint.y,"40",t.textHeight,"1",t.text,"50",t.rotation,"8",t.layer,"72",t.halign,"73",t.valign)},i(u),i(a),i((function(){return e=t.entities,n("2","ENTITIES"),void e.forEach((function(t){var e=r[t.type];e&&e(t)}));var e})),n("0","EOF"),e.join("\n")}(s)};var n={"":0};n[t.unitType.Inch]=1,n[t.unitType.Foot]=2,n[t.unitType.Millimeter]=4,n[t.unitType.Centimeter]=5,n[t.unitType.Meter]=6}(t.exporter||(t.exporter={}))}(MakerJs||(MakerJs={})),function(t){!function(e){var n=Math.sqrt(3)/2;e.equilateralAltitude=function(t){return t*n},e.equilateralSide=function(t){return t/n},e.solveTriangleSSS=function(e,n,r){return t.angle.toDegrees(Math.acos((n*n+r*r-e*e)/(2*n*r)))},e.solveTriangleASA=function(e,n,r){var i=180-e-r;return n*Math.sin(t.angle.toRadians(e))/Math.sin(t.angle.toRadians(i))},e.circleTangentAngles=function(e,n,r){void 0===r&&(r=!1);var i,o=new t.paths.Line(e.origin,n.origin),a=t.measure.pointDistance(e.origin,n.origin);if(e.radius>=a+n.radius||n.radius>=a+e.radius)return null;if(r&&e.radius+n.radius>=a)return null;if(r||0!=t.round(e.radius-n.radius)){var s=a/2,l=new t.paths.Circle([s,0],s),c=new t.paths.Circle(e.radius>n.radius?[0,0]:[a,0],r?e.radius+n.radius:Math.abs(e.radius-n.radius)),h=t.path.intersection(c,l);if(!h||!h.path1Angles)return null;i=h.path1Angles}else i=[90,270];var u=t.angle.ofLineInDegrees(o);return i.map((function(e){return t.angle.noRevolutions(e+u)}))}}(t.solvers||(t.solvers={}))}(MakerJs||(MakerJs={})),function(t){!function(e){var n={};function r(t,n,r,i){var o=r?[n.path2Offset,n.path1Offset]:[n.path1Offset,n.path2Offset];e.moveTemporary(t,o,i)}function i(t){var e=t.path1Angles;return t.path2Angles?t.path1Angles=t.path2Angles:delete t.path1Angles,e&&(t.path2Angles=e),t}function o(e,n){for(var r=[],i=0;i<e.length;i++)r.push(t.point.fromAngleOnCircle(e[i],n));return r}function a(e,n,r){if(!e)return null;for(var i=[],o=0;o<e.length;o++)t.measure.isBetweenArcAngles(e[o],n,r.excludeTangents)&&i.push(e[o]);return 0==i.length?null:i}function s(n,r,i){var o=t.round(r.radius);if(r.radius<=0)return null;var a=new t.paths.Line(t.point.subtract(n.origin,r.origin),t.point.subtract(n.end,r.origin)),s=t.angle.ofLineInDegrees(n),l=s>=180?s-360:s;function c(e){var n=e+l;return t.round(t.angle.noRevolutions(n))}e.rotate(a,-l,t.point.zero());var h=t.round(a.origin[1]),u=Math.abs(h);if(u>o)return null;var f=[];if(u==o){if(i.excludeTangents)return null;f.push(c(h>0?90:270))}else{function p(e,n){t.measure.isBetween(t.round(e),t.round(a.origin[0]),t.round(a.end[0]),i.excludeTangents)&&f.push(c(n))}var d=Math.asin(h/o),g=t.angle.toDegrees(d),v=Math.cos(d)*o;p(-v,180-g),p(v,g)}return f.length>0?f:null}function l(n,r,i){if(n.radius<=0||r.radius<=0)return null;if(n.radius==r.radius&&t.measure.isPointEqual(n.origin,r.origin,1e-4))return i.out_AreOverlapped=!0,null;t.point.subtract(t.point.zero(),n.origin);var o=new t.paths.Circle(t.point.zero(),n.radius),a=new t.paths.Circle(t.point.subtract(r.origin,n.origin),r.radius),s=t.angle.ofPointInDegrees(t.point.zero(),a.origin);function l(e){var n=e+s;return t.angle.noRevolutions(n)}e.rotate(a,-s,t.point.zero());var c=a.origin[0];if(0==t.round(a.radius-c-o.radius))return i.excludeTangents?null:[[l(180)],[l(180)]];if(0==t.round(a.radius+c-o.radius))return i.excludeTangents?null:[[l(0)],[l(0)]];if(0==t.round(c-a.radius-o.radius))return i.excludeTangents?null:[[l(0)],[l(180)]];if(t.round(c-a.radius)>o.radius)return null;if(t.round(c+a.radius)<o.radius)return null;if(t.round(c-a.radius)<-o.radius)return null;function h(e){return[l(e),l(t.angle.mirror(e,!1,!0))]}var u=t.solvers.solveTriangleSSS(a.radius,o.radius,c),f=t.solvers.solveTriangleSSS(o.radius,c,a.radius);return[h(u),h(180-f)]}n[t.pathType.Arc]={},n[t.pathType.Circle]={},n[t.pathType.Line]={},n[t.pathType.Arc][t.pathType.Arc]=function(e,n,i,s){var c=null;return r([e,n],i,s,(function(){var r=l(e,n,i);if(r){var s=a(r[0],e,i),h=a(r[1],n,i);if(s&&h)if(1===s.length||1===h.length)for(var u=0;u<s.length;u++)for(var f=0;f<h.length;f++){var p=t.point.fromAngleOnCircle(s[u],e),d=t.point.fromAngleOnCircle(h[f],n);if(t.measure.isPointEqual(p,d,1e-4))return void(c={intersectionPoints:[p],path1Angles:[s[u]],path2Angles:[h[f]]})}else c={intersectionPoints:o(s,e),path1Angles:s,path2Angles:h}}else i.out_AreOverlapped&&(i.out_AreOverlapped=t.measure.isArcOverlapping(e,n,i.excludeTangents))})),c},n[t.pathType.Arc][t.pathType.Circle]=function(t,e,n,i){var s=null;return r([t,e],n,i,(function(){var r=l(t,e,n);if(r){var i=a(r[0],t,n);if(i){var c;if(2==i.length)c=r[1];else{var h=function(t,e){for(var n=2;n--;)if(t[n]===e)return n}(r[0],i[0]);c=[r[1][h]]}s={intersectionPoints:o(i,t),path1Angles:i,path2Angles:c}}}})),s},n[t.pathType.Arc][t.pathType.Line]=function(t,e,n,i){var l=null;return r([t,e],n,i,(function(){var r=s(e,t,n);if(r){var i=a(r,t,n);i&&(l={intersectionPoints:o(i,t),path1Angles:i})}})),l},n[t.pathType.Circle][t.pathType.Arc]=function(e,r,o){var a=n[t.pathType.Arc][t.pathType.Circle](r,e,o,!0);return a?i(a):null},n[t.pathType.Circle][t.pathType.Circle]=function(t,e,n,i){var a=null;return r([t,e],n,i,(function(){var r=l(t,e,n);r&&(a={intersectionPoints:o(r[0],t),path1Angles:r[0],path2Angles:r[1]})})),a},n[t.pathType.Circle][t.pathType.Line]=function(t,e,n,i){var a=null;return r([t,e],n,i,(function(){var r=s(e,t,n);r&&(a={intersectionPoints:o(r,t),path1Angles:r})})),a},n[t.pathType.Line][t.pathType.Arc]=function(e,r,o){var a=n[t.pathType.Arc][t.pathType.Line](r,e,o,!0);return a?i(a):null},n[t.pathType.Line][t.pathType.Circle]=function(e,r,o){var a=n[t.pathType.Circle][t.pathType.Line](r,e,o,!0);return a?i(a):null},n[t.pathType.Line][t.pathType.Line]=function(e,n,i,o){var a=null;return r([e,n],i,o,(function(){var r=t.point.fromSlopeIntersection(e,n,i);r&&t.measure.isBetweenPoints(r,e,i.excludeTangents)&&t.measure.isBetweenPoints(r,n,i.excludeTangents)&&(a={intersectionPoints:[r]})})),a},e.intersection=function(t,e,r){if(void 0===r&&(r={}),t&&e){var i=n[t.type][e.type];if(i)return i(t,e,r)}return null}}(t.path||(t.path={}))}(MakerJs||(MakerJs={})),function(t){!function(e){var n={};function r(e){var r=t.point.fromPathEnds(e);if(r){function i(t){return{point:r[t],propertyName:o[t]}}var o=null,a=n[e.type];if(a)return o=a(e),[i(0),i(1)]}return null}function i(e,n,i){var o=r(e),a=r(n),s=null;function l(t,e,n){return{path:t,isStart:0==n,propertyName:e[n].propertyName,point:e[n].point,oppositePoint:e[1-n].point}}function c(r,i){return!!t.measure.isPointEqual(o[r].point,a[i].point,1e-4)&&(s=[l(e,o,r),l(n,a,i)],!0)}return c(0,0)||c(0,1)||c(1,0)||c(1,1),s}function o(n,r,i,o){for(var a=new t.paths.Circle(r,n),s=0;s<2;s++){var l=e.intersection(a,i[s].path);if(!l)return!1;if(i[s].shardPoint=l.intersectionPoints[0],t.measure.isPointEqual(i[s].point,l.intersectionPoints[0],1e-4)){if(!(l.intersectionPoints.length>1))return!1;i[s].shardPoint=l.intersectionPoints[1]}}return!0}n[t.pathType.Arc]=function(t){return["startAngle","endAngle"]},n[t.pathType.Line]=function(t){return["origin","end"]};var a={};function s(t,e,n){var r=null,i=a[t.path.type];return i&&(r=i(t.path,e,n,t.shardPoint,t.isStart)),r}a[t.pathType.Arc]=function(n,r,i,o,a){var s=n.radius,l=function(t,n){var r=e.clone(t);return[r,e.breakAtPoint(r,n)]}(n,o)[a?0:1];return l?(t.measure.isArcConcaveTowardsPoint(l,i)?s-=r:s+=r,t.round(s)<=0?null:new t.paths.Arc(n.origin,s,n.startAngle,n.endAngle)):null},a[t.pathType.Line]=function(e,n,r,i,o){return new t.paths.Parallel(e,n,r)};var l={};function c(t,e,n){var r=null,i=l[t.path.type];return i&&(r=i(t.path,t.propertyName,e,n)),u(t,r)||(r=null),r}function h(e,n){var r={filletAngle:t.angle.ofPointInDegrees(n,e.shardPoint),clipPath:function(){e.path[e.propertyName]=e.shardPoint}};return u(e,r)||(r=null),r}function u(e,n){var r=!1;if(n){var i=e.path[e.propertyName];n.clipPath(),t.measure.pathLength(e.path)>0&&(r=!0),e.path[e.propertyName]=i}return r}l[t.pathType.Arc]=function(e,n,r,i){var o=new t.paths.Line(e.origin,i),a=t.angle.ofLineInDegrees(o),s=a;return t.measure.isArcConcaveTowardsPoint(e,i)||(s+=180),{filletAngle:t.angle.noRevolutions(s),clipPath:function(){e[n]=a}}},l[t.pathType.Line]=function(n,r,i,o){var a=new t.paths.Line([0,0],[0,1]),s=t.angle.ofLineInDegrees(n);e.rotate(a,s,[0,0]),e.moveRelative(a,o);var l=t.point.fromSlopeIntersection(n,a);return l?{filletAngle:t.angle.ofPointInDegrees(o,l),clipPath:function(){n[r]=l}}:null},e.dogbone=function(e,n,r,a){if(t.isPathLine(e)&&t.isPathLine(n)&&r&&r>0){var s={pointMatchingDistance:.005};t.extendObject(s,a);var l=i(e,n);if(l){var c=function(e){for(var n=0,r=[],i=0;i<e.length;i++){var o=t.measure.pathLength(e[i]);r.push(o),n+=o}return r[0]/n}([e,n]),u=new t.paths.Line(l[0].oppositePoint,l[1].oppositePoint),f=t.point.middle(u,c),p=t.angle.ofPointInDegrees(l[0].point,f),d=t.point.add(l[0].point,t.point.fromPolar(t.angle.toRadians(p),r));if(!o(r,d,l))return null;for(var g=[],v=0;v<2;v++){var m=h(l[v],d);if(!m)return null;g.push(m)}var y=new t.paths.Arc(d,r,g[0].filletAngle,g[1].filletAngle);return t.round(t.angle.noRevolutions(t.angle.ofArcMiddle(y)))==t.round(p)&&(y.startAngle=g[1].filletAngle,y.endAngle=g[0].filletAngle),g[0].clipPath(),g[1].clipPath(),y}}return null},e.fillet=function(n,r,a,l){if(n&&r&&a&&a>0){var h={pointMatchingDistance:.005};t.extendObject(h,l);var u=i(n,r);if(u){if(!o(a,u[0].point,u))return null;for(var f=[],p=0;p<2;p++){var d=u[1-p].shardPoint;if(!d)return null;var g=s(u[p],a,d);f.push(g)}var v=e.intersection(f[0],f[1]);if(v){var m;m=1==v.intersectionPoints.length?v.intersectionPoints[0]:t.point.closest(u[0].point,v.intersectionPoints);var y=[];for(p=0;p<2;p++){var b=c(u[p],a,m);if(!b)return null;y.push(b)}if(0==t.round(y[0].filletAngle-y[1].filletAngle))return null;var x=new t.paths.Arc(m,a,y[0].filletAngle,y[1].filletAngle),w=t.angle.ofArcSpan(x);return 180==w?null:(w>180&&(x.startAngle=y[1].filletAngle,x.endAngle=y[0].filletAngle),y[0].clipPath(),y[1].clipPath(),x)}}}return null}}(t.path||(t.path={}))}(MakerJs||(MakerJs={})),function(t){!function(e){function n(e,n,r){var i={paths:{}},o=0,a=n.links;function s(n,s){var l=a[n].walkedPath,c=a[s].walkedPath;l.modelContext===c.modelContext&&l.modelContext.type==t.models.BezierCurve.typeName||t.path.moveTemporary([l.pathContext,c.pathContext],[l.offset,c.offset],(function(){var h,u;if(t.isObject(r)){var f=t.angle.ofChainLinkJoint(a[n],a[s]);if(0===t.round(f))return;h=f>0?r.left:r.right}else h=r;!h||h<0||(u=e?t.path.fillet(l.pathContext,c.pathContext,h):t.path.dogbone(l.pathContext,c.pathContext,h))&&(i.paths["fillet"+o]=u,o++)}))}for(var l=1;l<a.length;l++)s(l-1,l);return n.endless&&s(l-1,0),o?i:null}e.dogbone=function(t,e){return n(!1,t,e)},e.fillet=function(t,e){return n(!0,t,e)}}(t.chain||(t.chain={}))}(MakerJs||(MakerJs={})),function(t){!function(t){t.construct=function(t,e){function n(){return t.apply(this,e)}return n.prototype=t.prototype,new n},t.getParameterValues=function(t){var e=[],n=t.metaParameters;if(n)for(var r=0;r<n.length;r++){var i=n[r].value;Array.isArray(i)&&(i=i[0]),e.push(i)}return e}}(t.kit||(t.kit={}))}(MakerJs||(MakerJs={})),function(t){!function(e){function n(t,e,n){function r(e,n,r){for(;e;){n.links.push(e),n.pathLength+=e.pathLength;var i=e.reversed?0:1,o=e.endPoints[i],a=t.getElementAtPoint(o);if(!a||0===a.valueIds.length)break;var s=a.valueIds.map((function(e){return t.values[e]})),l=(c=s,h=e.walkedPath.pathContext,c[0].walkedPath.pathContext===h?c[1]:c[0]);if(a.valueIds.splice(0,2),!l)break;if(l.walkedPath.pathContext===r.walkedPath.pathContext){n.links.length>1&&(n.endless=!0);break}e=l}var c,h}t.forEachPoint((function(t,i,o,a){if(a.valueIds.length>0){var s={links:[],pathLength:0};if(r(i[0],s,i[0]),s.endless)e(s,!1);else{s.links.reverse();var l=s.links[0];s.links.map((function(t){t.reversed=!t.reversed})),s.pathLength-=s.links[s.links.length-1].pathLength,r(s.links.pop(),s,l),s.links.length>1?e(s,!0):n(s.links[0].walkedPath)}}}))}function r(t,e){var n=e===t.reversed?1:0;return t.endPoints[n]}function i(i){for(var l,c,h=[],u=1;u<arguments.length;u++)h[u-1]=arguments[u];switch(h.length){case 1:"function"==typeof h[0]?c=h[0]:l=h[0];break;case 2:c=h[0],l=h[1]}var f={pointMatchingDistance:.005};t.extendObject(f,l);var p,d={},g={},v={},m={onPath:function(e){var n=f.byLayers?e.layer:"";d[n]||(d[n]=new t.PointGraph);var r=d[n],i=t.measure.pathLength(e.pathContext);if(e.pathContext.type===t.pathType.Circle||e.pathContext.type===t.pathType.Arc&&0===t.round(t.angle.ofArcSpan(e.pathContext)-360)||e.pathContext.type===t.pathType.BezierSeed&&t.measure.isPointEqual(e.pathContext.origin,e.pathContext.end,f.pointMatchingDistance)){var o={links:[{walkedPath:e,reversed:null,endPoints:null,pathLength:i}],endless:!0,pathLength:i};g[n]||(g[n]=[]),g[n].push(o)}else{if(i<f.pointMatchingDistance/5)return v[n]||(v[n]=[]),void v[n].push(e);for(var a=t.point.fromPathEnds(e.pathContext,e.offset),s=0;s<2;s++){var l={walkedPath:e,endPoints:a,reversed:0!=s,pathLength:i},c=r.insertValue(l);r.insertValueIdAtPoint(c,a[s])}}}};f.shallow&&(m.beforeChildWalk=function(){return!1}),f.unifyBeziers&&s(p=a(i),!0),e.walk(i,m);var y,b,x,w=function(e){var i=d[e];i.mergeNearestSinglePoints(f.pointMatchingDistance),y=[],g[e]||(g[e]=[]),n(i,(function(n,i){n.endless=i?t.measure.isPointEqual(r(n.links[0],!0),r(n.links[n.links.length-1],!1),f.pointMatchingDistance):!!n.endless,g[e].push(n)}),(function(t){y.push(t)})),g[e].sort((function(t,e){return e.pathLength-t.pathLength})),f.contain&&(b=t.isObject(f.contain)?f.contain:{alternateDirection:!1},x=o(g[e],b),g[e]=x),c&&c(g[e],y,e,v[e])};for(var S in d)w(S);return p&&s(p,!1),f.byLayers?g:g[""]}function o(e,n){var r=e.map((function(e){return t.chain.toNewModel(e)})),i=[];e.forEach((function(n,o){if(n.endless){var a=n.links[0].walkedPath,s=t.path.clone(a.pathContext,a.offset);e.forEach((function(e,a){n!==e&&e.endless&&t.measure.isPointInsideModel(t.point.middle(s),r[a])&&(i[o]=e)}))}}));var o=[];if(e.forEach((function(t,e){var n=i[e];n?(n.contains||(n.contains=[]),n.contains.push(t)):o.push(t)})),n.alternateDirection){!function e(n,r){n.forEach((function(n,i){var o=t.measure.isChainClockwise(n);null!==o&&(!o&&r||o&&!r)&&t.chain.reverse(n),n.contains&&e(n.contains,!r)}))}(o,!0)}return o}function a(n){var r=[];function i(e){e.childModel.type===t.models.BezierCurve.typeName&&r.push(e)}var o={beforeChildWalk:function(t){return i(t),!0}};return i({childId:"",childModel:n,layer:n.layer,offset:n.origin,parentModel:null,route:[],routeKey:""}),e.walk(n,o),r}function s(e,n){e.forEach((function(e){var r=e.childModel;if(n){null!=e.layer&&""!==e.layer&&(r.tempLayer=r.layer,r.layer=e.layer);var i=t.models.BezierCurve.getBezierSeeds(r,{byLayers:!0});for(var o in i){var a=i[o];if(a.length>0){r.tempPaths=r.paths;var s={};a.forEach((function(t,e){t.layer=o,s["seed_"+e]=t})),r.paths=s}}}else"tempPaths"in r&&(r.paths=r.tempPaths,delete r.tempPaths),"tempLayer"in r&&(null==r.tempLayer?delete r.layer:r.layer=r.tempLayer,delete r.tempLayer)}))}e.findSingleChain=function(t){var e=null;return i(t,(function(t,n,r){e=t[0]}),{byLayers:!1}),e},e.findChains=i}(t.model||(t.model={}))}(MakerJs||(MakerJs={})),function(t){!function(e){function n(t,e){if(void 0===e&&(e=1),t.endless){for(var n=Math.abs(e),r=0;r<n;r++)e<0?t.links.push(t.links.shift()):t.links.unshift(t.links.pop());return t}}function r(e,n){!e||n.length<2||t.measure.isPointEqual(n[0],n[n.length-1],1e-5)&&n.pop()}e.cycle=n,e.reverse=function(t){return t.links.reverse(),t.links.forEach((function(t){return t.reversed=!t.reversed})),t},e.startAt=function(t,e){if(t.endless){for(var r=-1,i=0;i<t.links.length;i++)if(t.links[i].walkedPath.routeKey==e){r=i;break}return r>0&&n(t,r),t}},e.toNewModel=function(e,n){void 0===n&&(n=!1);for(var r={paths:{}},i=0;i<e.links.length;i++){var o=e.links[i].walkedPath;if(o.pathContext.type===t.pathType.BezierSeed){n&&delete o.modelContext.paths[o.pathId],r.models||(r.models={});var a=t.model.getSimilarModelId(r,o.pathId);r.models[a]=t.model.moveRelative(new t.models.BezierCurve(o.pathContext),o.offset)}else{var s;n?(s=o.pathContext,delete o.modelContext.paths[o.pathId]):s=t.path.clone(o.pathContext);var l=t.model.getSimilarPathId(r,o.pathId);r.paths[l]=t.path.moveRelative(s,o.offset)}}return r},e.toPoints=function(e,n,i){var o,a=[],s=0,l=0;Array.isArray(n)&&(o=n);for(var c=0;c<e.links.length;c++){for(var h=e.links[c],u=h.walkedPath,f=h.pathLength;t.round(f-l)>0;){var p,d=l/f;if(h.reversed&&(d=1-d),a.push(t.point.add(t.point.middle(u.pathContext,d),u.offset)),i&&a.length>=i)return a;if(o){if(p=o[s],++s>o.length)return a}else p=n;l+=p}l-=f}return r(e.endless,a),a},e.toKeyPoints=function(e,n){for(var i=[],o=0;o<e.links.length;o++){var a=e.links[o],s=a.walkedPath,l=t.path.toKeyPoints(s.pathContext,n);if(l.length>0){a.reversed&&l.reverse(),o>0&&l.shift();var c=l.map((function(e){return t.point.add(e,s.offset)}));i.push.apply(i,c)}}return r(e.endless,i),i}}(t.chain||(t.chain={}))}(MakerJs||(MakerJs={})),function(t){!function(e){var n=function(){function n(e,n){this.modelContext=e,this.options=n,this.pointMap=new t.PointGraph,this.list=[],this.removed=[],this.ordinals={},this.load()}return n.prototype.load=function(){var n=this,r={onPath:function(e){var r=t.point.fromPathEnds(e.pathContext,e.offset);if(r){var i=e;i.endPoints=r;for(var o=n.pointMap.insertValue(i),a=2;a--;)n.pointMap.insertValueIdAtPoint(o,r[a])}}};e.walk(this.modelContext,r),this.options.pointMatchingDistance&&this.pointMap.mergePoints(this.options.pointMatchingDistance)},n.prototype.findDeadEnds=function(){var t=this,e=0;this.pointMap.forEachPoint((function(n,r,i,o){t.ordinals[i]=e++,t.list.push(o)})),e=0;for(var n=function(){var n=r.list[e];1===n.valueIds.length?r.removePath(n,n.valueIds[0],e):r.options.keep&&n.valueIds.length%2&&n.valueIds.forEach((function(r){var i=t.pointMap.values[r];t.options.keep(i)||t.removePath(n,r,e)})),e++},r=this;e<this.list.length;)n();return this.removed},n.prototype.removePath=function(t,e,n){var r=this.pointMap.values[e],i=this.getOtherPointId(r.endPoints,t.pointId),o=this.pointMap.index[i];this.removed.push(r),this.removeValue(t,e),this.removeValue(o,e),o.valueIds.length>0&&this.appendQueue(o,n)},n.prototype.removeValue=function(t,e){var n=t.valueIds.indexOf(e);n>=0&&t.valueIds.splice(n,1)},n.prototype.appendQueue=function(t,e){var n=this.ordinals[t.pointId];n<e&&(this.list[n]=null,this.list.push(t),this.ordinals[t.pointId]=this.list.length)},n.prototype.getOtherPointId=function(t,e){for(var n=0;n<t.length;n++){var r=this.pointMap.getIdOfPoint(t[n]);if(e!==r)return r}},n}();e.removeDeadEnds=function(t,e,r,i){var o=new n(t,{pointMatchingDistance:e||.005,keep:r}),a=o.findDeadEnds();return a.length<o.pointMap.values.length&&a.forEach((function(t){i(t,"dead end"),delete t.modelContext.paths[t.pathId]})),t}}(t.model||(t.model={}))}(MakerJs||(MakerJs={})),function(t){!function(t){var e=function(){function t(t,e){this.name=t,this.attrs=e,this.innerText=""}return t.escapeString=function(t){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};for(var n in e)t=t.split(n).join(e[n]);return t},t.prototype.getOpeningTag=function(e){var n,r,i="";for(var o in this.attrs)n=o,null!=(r=this.attrs[o])&&void 0!==r&&((Array.isArray(r)||"object"==typeof r)&&(r=JSON.stringify(r)),"string"==typeof r&&(r=t.escapeString(r)),i+=" "+n+'="'+r+'"');return"<"+this.name+i+(e?"/":"")+">"},t.prototype.getInnerText=function(){return this.innerTextEscaped?this.innerText:t.escapeString(this.innerText)},t.prototype.getClosingTag=function(){return"</"+this.name+">"},t.prototype.toString=function(){return!this.innerText&&!this.closingTags?this.getOpeningTag(!0):this.getOpeningTag(!1)+this.getInnerText()+this.getClosingTag()},t}();t.XmlTag=e}(t.exporter||(t.exporter={}))}(MakerJs||(MakerJs={})),function(t){!function(e){function n(t,e,n){return n?t+"("+e+")":e}function r(e,n){if(n){var r=new t.paths.Circle([0,0],e.radius),i=t.measure.pathLength(r);if(i)return Math.ceil(i/n)}}function i(e,i,o){var a="",s="",l=!0,c=!1,h=!1,u={};u[t.pathType.Circle]=function(e,s){var l={center:t.point.rounded(t.point.add(e.origin,s.walkedPath.offset),o),radius:t.round(e.radius,o),resolution:r(e,i)};a=n("CAG.circle",JSON.stringify(l),!0),c=!0},u[t.pathType.Line]=function(e,r){var i=r.endPoints.map((function(e){return t.point.rounded(e,o)}));r.reversed&&i.reverse(),a=n("new CSG.Path2D",JSON.stringify(i),!0)},u[t.pathType.Arc]=function(e,s){var l=t.angle.ofArcEnd(e);s.reversed&&(h=!0);var c={center:t.point.rounded(t.point.add(e.origin,s.walkedPath.offset),o),radius:t.round(e.radius,o),startangle:t.round(e.startAngle,o),endangle:t.round(l,o),resolution:r(e,i)};a=n("new CSG.Path2D.arc",JSON.stringify(c),!0)};var f={};function p(t){h?s=t+s:s+=t}f[t.pathType.Line]=function(e,r){var i=h!=r.reversed,a=t.point.rounded(r.endPoints[i?0:1],o);p(n(".appendPoint",JSON.stringify(a),!0))},f[t.pathType.Arc]=function(e,a){var s=h!=a.reversed,l=t.angle.ofArcEnd(e),c={radius:t.round(e.radius,o),clockwise:s,large:Math.abs(l-e.startAngle)>180,resolution:r(e,i)},u=t.point.rounded(a.endPoints[s?0:1],o);p(n(".appendArc",JSON.stringify(u)+","+JSON.stringify(c),!0))};for(var d=0;d<e.links.length;d++){var g=e.links[d],v=g.walkedPath.pathContext,m=l?u[v.type]:f[v.type];if(m&&m(v,g),c)return a;l=!1}return a+s+".close().innerToCAG()"}function o(t,e,n){return function(r){t&&t({progress:e+r.progress*n/100})}}function a(e,n,r){return s((function(n,r){var i=t.chain.toKeyPoints(n,r);return i.push(i[0]),e.fromPoints(i)}),(function(t,e){return t.union(e)}),(function(t,e){return t.subtract(e)}),n,r)}function s(e,n,r,i,o){void 0===o&&(o={});var a={},s={total:0,complete:0};function l(t,e,r){var i=r.shift();return r.forEach((function(t){return i=n(i,t)})),s.complete++,o.statusCallback&&o.statusCallback({progress:t+e*s.complete/s.total}),i}function c(t,n){n.forEach((function(n){if(n.endless){var r={cag:e(n,o.maxArcFacet),subtracts:[]};if(n.contains){var i=function(t,n){var r=[];return n.forEach((function(n){n.endless&&(n.contains&&c(t,n.contains),s.total++,r.unshift(e(n,o.maxArcFacet)))})),r}(t,n.contains);i.length>0&&r.subtracts.push(i)}s.total++,t in a||(a[t]=[]),a[t].unshift(r)}}))}var h={pointMatchingDistance:o.pointMatchingDistance,byLayers:o.byLayers,contain:!0};o.statusCallback&&o.statusCallback({progress:25});var u=t.model.findChains(i,h);if(Array.isArray(u))c("",u);else for(var f in u)c(f,u[f]);o.statusCallback&&o.statusCallback({progress:50});var p=0;for(var f in a)p+=a[f].length;if(0===p)throw o.statusCallback&&o.statusCallback({progress:100}),"No closed geometries found.";var d={};for(var f in a){var g=a[f].map((function(t){var e=t.cag;return t.subtracts.forEach((function(t){var n=l(50,50,t);e=r(e,n)})),e}));d[f]=l(50,50,g)}return o.statusCallback&&o.statusCallback({progress:100}),h.byLayers?d:d[""]}function l(t,e,n){return c((function(n){return a(t,e,n)}),(function(t,e,n){var r=t.extrude({offset:[0,0,e]});return n&&(r=r.translate([0,0,n])),r}),(function(t,e){return t.union(e)}),e,n)}function c(e,n,r,i,a){void 0===a&&(a={});var s=a.statusCallback;i.exporterOptions&&t.extendObject(a,i.exporterOptions.toJscadCSG),a.byLayers=a.byLayers||a.layerOptions&&!0,a.statusCallback=o(s,0,50);var l,c,h=e(a),u=[];if(a.byLayers)for(var f in h){var p=a.layerOptions[f],d=n(h[f],p.extrude||a.extrude,(l=p.z,c=a.z,t.isNumber(l)?l:c));u.push(d)}else{d=n(h,a.extrude,a.z);u.push(d)}a.statusCallback=o(s,50,100);var g={total:u.length-1,complete:0},v=u.shift();return u.forEach((function(t,e){v=r(v,t),g.complete++,a.statusCallback({progress:g.complete/g.total})})),v}e.toJscadCAG=a,e.toJscadCSG=l,e.toJscadScript=function(t,e){function n(t,n){return a(i(t,n,e.accuracy))}function r(t,e){return t+".union("+e+")"}function o(t,e){return t+".subtract("+e+")"}function a(t){return""+h+l+t+h}void 0===e&&(e={});var l=new Array((e.indent||0)+1).join(" "),h=e.indent?"\n":"",u=c((function(i){return s(n,r,o,t,e)}),(function(t,e,n){var r=t+".extrude({ offset: [0, 0, "+e+"] })";return n&&(r=r+".translate([0, 0, "+n+"])"),r}),r,t,e).trim();return"function "+(e.functionName||"main")+"(){"+a("return "+u+";")+"}"+h},e.toJscadSTL=function(t,e,n,r){var i=r.statusCallback;r.statusCallback=o(i,0,50);var a=l(t,n,r);return e.serialize(a,{binary:!1,statusCallback:o(i,50,50)})}}(t.exporter||(t.exporter={}))}(MakerJs||(MakerJs={})),function(t){!function(e){e.toPDF=function(n,r,i){if(r){var o={fontName:"Courier",fontSize:9,origin:[0,0],stroke:"#000"};t.extendObject(o,i);var a=1,s=o.units||r.units;a=s?t.units.conversionScale(s,t.unitType.Inch):.01,a*=72;var l=t.model.scale(t.cloneObject(r),a),c=t.measure.modelExtents(l),h=[-c.low[0],c.high[1]];h=t.point.add(h,o.origin),t.model.findChains(l,(function(r,i,a){function s(t){var r=e.pathToSVGPathData(t.pathContext,t.offset,h);n.path(r).stroke(o.stroke)}r.map((function(r){if(r.links.length>1){var i=e.chainToSVGPathData(r,h);n.path(i).stroke(o.stroke)}else{var a,l=r.links[0].walkedPath;if(l.pathContext.type===t.pathType.Circle)t.path.moveTemporary([l.pathContext],[l.offset],(function(){a=t.path.mirror(l.pathContext,!1,!0)})),t.path.moveRelative(a,h),n.circle(a.origin[0],a.origin[1],l.pathContext.radius).stroke(o.stroke);else s(l)}})),i.map(s)}),{byLayers:!1}),n.font(o.fontName).fontSize(o.fontSize),t.model.getAllCaptionsOffset(l).forEach((function(e){var r=t.angle.ofLineInDegrees(e.anchor),i=t.path.mirror(e.anchor,!1,!0);t.path.moveRelative(i,h);var o=e.text,a=[n.widthOfString(o)/2,n.heightOfString(o)/2],s=t.point.middle(i),l=t.point.subtract(s,a);n.rotate(-r,{origin:s}),n.text(o,l[0],l[1]),n.rotate(r,{origin:s})}))}}}(t.exporter||(t.exporter={}))}(MakerJs||(MakerJs={})),function(t){!function(e){var n={};function r(e){return t.point.mirror(e,!1,!0)}function i(e){var n=t.angle.ofArcSpan(e);e.startAngle=t.angle.noRevolutions(e.startAngle),e.endAngle=e.startAngle+n}function o(e,i,o){function a(e){return t.point.add(e,i)}for(var s=e.links[0],l=a(r(s.endPoints[s.reversed?1:0])),c=["M",t.round(l[0],o),t.round(l[1],o)],h=0;h<e.links.length;h++){var u,f=e.links[h],p=f.walkedPath.pathContext,d=n[p.type];if(d)t.path.moveTemporary([p],[f.walkedPath.offset],(function(){u=t.path.mirror(p,!1,!0)})),t.path.moveRelative(u,i),d(u,a(r(f.endPoints[f.reversed?0:1])),f.reversed,c,o)}return e.endless&&c.push("Z"),c.join(" ")}function a(e,n,r){return["M",t.round(e[0],r),t.round(e[1],r)].concat(n)}n[t.pathType.Arc]=function(e,n,r,i,o){i.push("A"),f(i,e.radius,n,o,t.angle.ofArcSpan(e)>180,r?e.startAngle>e.endAngle:e.startAngle<e.endAngle)},n[t.pathType.Line]=function(e,n,r,i,o){i.push("L",t.round(n[0],o),t.round(n[1],o))},n[t.pathType.BezierSeed]=function(t,e,n,r,i){u(r,t,i,n)},e.chainToSVGPathData=o;var s={};function l(e,n,r,i,o){var a,l=s[e.type];return l?(t.path.moveTemporary([e],[n],(function(){a=t.path.mirror(e,!1,!0)})),t.path.moveRelative(a,r),l(a,i,o).join(" ")):""}function c(e,n,r,i){var a={};return r.unifyBeziers=!0,t.model.findChains(e,(function(t,e,r){function s(t,e){var o=l(t.pathContext,t.offset,n,i,e);a[r].push(o)}a[r]=[],function t(e,l){e.forEach((function(e){if(e.links.length>1){var c=o(e,n,i);a[r].push(c)}else s(e.links[0].walkedPath,l);e.contains&&t(e.contains,!l)}))}(t,!0),e.forEach((function(t){return s(t)}))}),r),a}function h(e,n,r){var i=t.round(e,n),o=["m",-i,0];function a(t){o.push("a"),f(o,i,[2*i*t,0],n,!1,!r)}return a(1),a(-1),o.push("z"),o}function u(e,n,r,i){if(1===n.controls.length)e.push("Q",t.round(n.controls[0][0],r),t.round(n.controls[0][1],r));else{var o=i?[n.controls[1],n.controls[0]]:n.controls;e.push("C",t.round(o[0][0],r),t.round(o[0][1],r),t.round(o[1][0],r),t.round(o[1][1],r))}var a=i?n.origin:n.end;e.push(t.round(a[0],r),t.round(a[1],r))}function f(e,n,r,i,o,a){var s=t.round(n,i),l=r;e.push(s,s),e.push(0),e.push(o?1:0),e.push(a?0:1),e.push(t.round(l[0],i),t.round(l[1],i))}s[t.pathType.Line]=function(e,n){return a(e.origin,t.point.rounded(e.end,n),n)},s[t.pathType.Circle]=function(t,e,n){return a(t.origin,h(t.radius,e,n),e)},s[t.pathType.Arc]=function(e,n){i(e);var r=t.point.fromArc(e);if(t.measure.isPointEqual(r[0],r[1]))return s[t.pathType.Circle](e,n);var o=["A"];return f(o,e.radius,r[1],n,t.angle.ofArcSpan(e)>180,e.startAngle>e.endAngle),a(r[0],o,n)},s[t.pathType.BezierSeed]=function(t,e){var n=[];return u(n,t,e),a(t.origin,n,e)},e.pathToSVGPathData=l,e.toSVGPathData=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i={fillRule:"evenodd"};"boolean"==typeof n[0]?(i.byLayers=n[0],i.origin=n[1],i.accuracy=n[2]):t.isObject(n[0])&&t.extendObject(i,n[0]);var o={byLayers:i.byLayers,contain:!1};"nonzero"===i.fillRule&&(o.contain={alternateDirection:!0});var a=t.measure.modelExtents(e);i.origin||(i.origin=[-a.low[0],a.high[1]]);var s=c(e,i.origin,o,i.accuracy),l={};for(var h in s)l[h]=s[h].join(" ");return o.byLayers?l:l[""]},e.toSVG=function(n,o){function a(t,e,n){void 0===n&&(n=!1),!n&&"string"==typeof e&&e.length>0?(e in x||(x[e]=[]),x[e].push(t)):b.push(t)}function s(t){var e=[];function n(t,n){void 0!==n&&e.push(t+":"+n)}return n("stroke",t.stroke),n("stroke-width",t.strokeWidth),n("fill",t.fill),e.join(";")}function l(e,n){n&&t.extendObject(e,{stroke:n.stroke,"stroke-width":n.strokeWidth,fill:n.fill,style:n.cssStyle||s(n)})}function p(t){return m.layerOptions&&m.layerOptions[t]?m.layerOptions[t]:t in e.colors?{stroke:t}:void 0}function d(t,n,r,i,o){void 0===i&&(i=null),void 0===o&&(o=!1),"text"!==t&&l(n,p(r)),m.scalingStroke||(n["vector-effect"]="non-scaling-stroke");var s=new e.XmlTag(t,n);s.closingTags=m.closingTags,i&&(s.innerText=i),a(s.toString(),r,o)}function g(e,n){var r=t.path.mirror(e,!1,!0);return t.path.moveRelative(t.path.scale(r,m.scale),n)}var v,m={accuracy:.001,annotate:!1,origin:null,scale:1,stroke:"#000",strokeLineCap:"round",strokeWidth:"0.25mm",fill:"none",fillRule:"evenodd",fontSize:"9pt",useSvgPathOnly:!0,viewBox:!0};t.extendObject(m,o);var y=t.isModel(n);y&&(v=n).exporterOptions&&t.extendObject(m,v.exporterOptions.toSVG);var b=[],x={};if(y)v=n;else if(Array.isArray(n)){var w={};n.forEach((function(t,e){w[e]=t})),v={paths:w}}else t.isPath(n)&&(v={paths:{modelToMeasure:n}});var S=t.measure.modelExtents(v),C=t.model.getAllCaptionsOffset(v);if(C.forEach((function(e){t.measure.increase(S,t.measure.pathExtents(e.anchor),!0)})),!m.units){var T=e.tryGetModelUnits(n);T&&(m.units=T)}var _=e.svgUnit[m.units];if(_&&m.viewBox&&(m.scale*=_.scaleConversion),S&&!m.origin){var O=-S.low[0]*m.scale;m.origin=[O,S.high[1]*m.scale]}t.extendObject(o,m);var k={};if(S&&m.viewBox){var P=t.round(S.width*m.scale,m.accuracy),E=t.round(S.height*m.scale,m.accuracy),M=[0,0,P,E],A=_?_.svgUnitType:"";k={width:P+A,height:E+A,viewBox:M.join(" ")}}k.xmlns="http://www.w3.org/2000/svg";var L=new e.XmlTag("svg",t.extendObject(k,m.svgAttrs));a(L.getOpeningTag(!1));var D={id:"svgGroup","stroke-linecap":m.strokeLineCap,"fill-rule":m.fillRule,"font-size":m.fontSize};l(D,m);var I=new e.XmlTag("g",D);if(a(I.getOpeningTag(!1)),m.useSvgPathOnly){var R={byLayers:!0};"nonzero"===m.fillRule&&(R.contain={alternateDirection:!0});var j=c(v,m.origin,R,m.accuracy);for(var B in j){var F={d:j[B].join(" ")};B.length>0&&(F.id=B),d("path",F,B,null,!0)}}else{function U(e,n,r){d("text",{id:e+"_text",x:t.round(n[0],m.accuracy),y:t.round(n[1],m.accuracy)},r,e)}function z(e,n,r,i,o,a,s,l,c){d("path",{id:e,"data-route":a,d:["M",t.round(n,m.accuracy),t.round(r,m.accuracy)].concat(i).join(" ")},o),l&&U(e,s,o)}var G={};function N(e,n,r,i,o){G[t.pathType.Circle]("",new t.paths.Circle(r,e.size/2),n,"flow",null,!1,null);var a=[-1*e.size,e.size/2];[a,t.point.mirror(a,!1,!0)].map((function(e){return new t.paths.Line(t.point.add(t.point.rotate(e,o),i),i)})).forEach((function(e){return G[t.pathType.Line]("",e,n,"flow",null,!1,null)}))}function H(t,e){W.attrs={id:t},a(W.getOpeningTag(!1),e.layer)}function X(t){a(W.getClosingTag(),t.layer)}G[t.pathType.Line]=function(e,n,r,i,o,a,s){var l=n.origin,c=n.end;d("line",{id:e,class:i,"data-route":o,x1:t.round(l[0],m.accuracy),y1:t.round(l[1],m.accuracy),x2:t.round(c[0],m.accuracy),y2:t.round(c[1],m.accuracy)},r),a&&U(e,t.point.middle(n),r),s&&N(s,r,n.origin,n.end,t.angle.ofLineInDegrees(n))},G[t.pathType.Circle]=function(e,n,r,i,o,a,s){var l=n.origin;d("circle",{id:e,class:i,"data-route":o,r:n.radius,cx:t.round(l[0],m.accuracy),cy:t.round(l[1],m.accuracy)},r),a&&U(e,l,r)},G[t.pathType.Arc]=function(e,n,r,o,a,s,l){i(n);var c=t.point.fromArc(n);if(t.measure.isPointEqual(c[0],c[1]))!function(t,e,n,r,i,o,a){var s=h(n,m.accuracy);z(t,e[0],e[1],s,r,i,e,o)}(e,n.origin,n.radius,r,a,s);else{var u=["A"];f(u,n.radius,c[1],m.accuracy,t.angle.ofArcSpan(n)>180,n.startAngle>n.endAngle),z(e,c[0][0],c[0][1],u,r,a,t.point.middle(n),s),l&&N(l,r,c[1],c[0],t.angle.noRevolutions(n.startAngle-90))}},G[t.pathType.BezierSeed]=function(e,n,r,i,o,a,s){var l=[];u(l,n,m.accuracy),z(e,n.origin[0],n.origin[1],l,r,o,t.point.middle(n),a)};var W=new e.XmlTag("g"),Y={beforeChildWalk:function(t){return H(t.childId,t.childModel),!0},onPath:function(e){var n,i,o=G[e.pathContext.type];if(o){var a=t.point.add((n=e.offset,i=r(n),t.point.scale(i,m.scale)),m.origin);o(e.pathId,g(e.pathContext,a),e.layer,null,e.route,m.annotate,m.flow)}},afterChildWalk:function(t){X(t.childModel)}};for(var V in H("0",v),t.model.walk(v,Y),x){var q=new e.XmlTag("g",{id:V});l(q.attrs,p(V));for(var J=0;J<x[V].length;J++)q.innerText+=x[V][J];q.innerTextEscaped=!0,a(q.toString())}X(v)}var K=C.map((function(n){var r=g(n.anchor,m.origin),i=t.point.rounded(t.point.middle(r),m.accuracy),o=new e.XmlTag("text",{"alignment-baseline":"middle","text-anchor":"middle",transform:"rotate("+t.angle.ofLineInDegrees(r)+","+i[0]+","+i[1]+")",x:i[0],y:i[1]});return l(o.attrs,p(n.layer)),o.innerText=n.text,o.toString()}));if(K.length){var Z=new e.XmlTag("g",{id:"captions"});l(Z.attrs,p(Z.attrs.id)),Z.innerText=K.join(""),Z.innerTextEscaped=!0,a(Z.toString())}return a(I.getClosingTag()),a(L.getClosingTag()),b.join("")},e.svgUnit={},e.svgUnit[t.unitType.Inch]={svgUnitType:"in",scaleConversion:1},e.svgUnit[t.unitType.Millimeter]={svgUnitType:"mm",scaleConversion:1},e.svgUnit[t.unitType.Centimeter]={svgUnitType:"cm",scaleConversion:1},e.svgUnit[t.unitType.Foot]={svgUnitType:"in",scaleConversion:12},e.svgUnit[t.unitType.Meter]={svgUnitType:"cm",scaleConversion:100}}(t.exporter||(t.exporter={}))}(MakerJs||(MakerJs={})),function(t){!function(e){e.fromSVGPathData=function(n,r){void 0===r&&(r={});var i={};function o(t){i.paths||(i.paths={}),i.paths["p_"+ ++d]=t}function a(t){i.models||(i.models={}),i.models["p_"+ ++d]=t}function s(e,n){void 0===n&&(n=0);var r=t.point.mirror([e.data[0+n],e.data[1+n]],!1,!0);return e.absolute?r:t.point.add(r,e.from)}function l(e,n){return t.measure.isPointEqual(e.from,n)||o(new t.paths.Line(e.from,n)),n}for(var c,h,u={M:function(t){return f=s(t)},Z:function(t){return l(t,f)},H:function(e){var n=t.point.clone(e.from);return e.absolute?n[0]=e.data[0]:n[0]+=e.data[0],l(e,n)},V:function(e){var n=t.point.clone(e.from);return e.absolute?n[1]=-e.data[0]:n[1]-=e.data[0],l(e,n)},L:function(t){return l(t,s(t))},A:function(e){var n=e.data[0],i=e.data[1],l=e.data[2],c=1===e.data[3],h=1===e.data[4],u=s(e,5),f=n!==i,p=new t.paths.Line(e.from,t.point.rotate(u,l,e.from));f&&(p=t.path.distort(p,1,n/i));var d=new t.paths.Arc(p.origin,p.end,n,c,h);if(f){if(n<d.radius){var g=d.radius/n;n*=g,i*=g}var v=new t.models.EllipticArc(d,1,i/n,r.bezierAccuracy);t.model.rotate(v,-l,e.from),a(v)}else t.path.rotate(d,-l,e.from),o(d);return u},C:function(e){var n=s(e,0),i=s(e,2),o=s(e,4);return a(new t.models.BezierCurve(e.from,n,i,o,r.bezierAccuracy)),o},S:function(e){var n,i;"C"===e.prev.command?(i=s(e.prev,2),n=t.point.rotate(i,180,e.from)):"S"===e.prev.command?(i=s(e.prev,0),n=t.point.rotate(i,180,e.from)):n=e.from;var o=s(e,0),l=s(e,2);return a(new t.models.BezierCurve(e.from,n,o,l,r.bezierAccuracy)),l},Q:function(e){var n=s(e,0),i=s(e,2);return a(new t.models.BezierCurve(e.from,n,i,r.bezierAccuracy)),i},T:function(e){var n,i;"Q"===e.prev.command?(i=s(e.prev,0),n=t.point.rotate(i,180,e.from)):"T"===e.prev.command?(i=s(e.prev,2),n=t.point.rotate(i,180,e.from)):n=e.from;var o=t.point.mirror(n,!1,!0);e.data.push.apply(e.data,o);var l=s(e,0);return a(new t.models.BezierCurve(e.from,n,l,r.bezierAccuracy)),l}},f=[0,0],p=[0,0],d=0,g=/([achlmqstvz])([0-9e\.,\+-\s]*)/gi;null!==(h=g.exec(n));){h.index===g.lastIndex&&g.lastIndex++;var v=h[1],m=h[2],y={command:v.toUpperCase(),data:[],from:p,prev:c};v===y.command&&(y.absolute=!0),y.data=e.parseNumericList(m);var b=u[y.command];b&&(p=b(y)),c=y}return i}}(t.importer||(t.importer={}))}(MakerJs||(MakerJs={})),function(t){!function(e){function n(e,n){var r=new t.measure.Atlas(e),i=t.measure.modelExtents(e,r),o=i.high[1],a=[],s={},l={beforeChildWalk:function(e){var l=e.childModel,c=r.modelMap[e.routeKey];if(c){var h=t.measure.augment(c);t.model.originate(l,[h.center[0],o*n]);var u=l.origin[0]-i.low[0];s[e.childId]=u;var f=u/i.width;return a.push({childId:e.childId,xRatio:f}),!1}}};t.model.walk(e,l),a.sort((function(t,e){return t.xRatio-e.xRatio}));var c=a[0],h=a[a.length-1],u=c.xRatio,f=h.xRatio-u;return a.forEach((function(t){return t.xRatio=(t.xRatio-u)/f})),{cpa:a,firstX:s[c.childId],lastX:i.width-s[h.childId]}}function r(e,n,r){n.forEach((function(n){var i=e.models[n.childId];i.origin=n.origin,r&&t.model.rotate(i,n.angle,n.origin)}))}var i={};function o(e,n,r,i){var o,a,s,l={};t.isModel(n)?(a=t.measure.modelExtents,o=l.models={},s=t.model.move):(a=t.measure.pathExtents,o=l.paths={},s=t.path.move);for(var c=a(n),h=c.high[e]-c.low[e],u=0;u<r;u++){var f=[0,0];f[e]=u*(h+i),o[u]=s(t.cloneObject(n),f)}return l}function a(t,e,n){return void 0===n&&(n=0),o(1,t,e,n)}function s(t,e,n){return void 0===n&&(n=0),o(0,t,e,n)}function l(t){return Array.isArray(t)?t:[t,t]}function c(e,n,r,i){for(var o=i(t.isModel(e)?e:{paths:{0:e}}),a={models:{}},l=0;l<r;l++){var c=l%2;a.models[l]=t.model.move(s(e,n+c,o.xMargin),[c*o.x,l*o.y])}return a}i[t.pathType.Arc]=function(e,n,r){var i=t.angle.ofArcSpan(e);r.forEach((function(t){return t.angle=n?e.endAngle-t.xRatio*i-90:e.startAngle+t.xRatio*i+90}))},i[t.pathType.Line]=function(e,n,r){var i=t.angle.ofLineInDegrees(e);r.forEach((function(t){return t.angle=i}))},e.childrenOnPath=function(e,o,a,s,l,c){void 0===a&&(a=0),void 0===s&&(s=!1),void 0===l&&(l=!1),void 0===c&&(c=!0);var h=n(e,a),u=h.cpa,f=o;if(l){var p=t.measure.pathLength(o);h.firstX+h.lastX<p&&(f=t.path.clone(o),t.path.alterLength(f,-h.firstX,!0),t.path.alterLength(f,-h.lastX))}u.forEach((function(e){return e.origin=t.point.middle(f,s?1-e.xRatio:e.xRatio)}));var d=i[f.type];return d&&d(f,s,u),r(e,u,c),e},e.childrenOnChain=function(e,i,o,a,s,l){void 0===o&&(o=0),void 0===a&&(a=!1),void 0===s&&(s=!1),void 0===l&&(l=!0);var c=n(e,o),h=c.cpa,u=i.pathLength;s&&(u-=c.firstX+c.lastX);var f,p=h.map((function(t){return(a?1-t.xRatio:t.xRatio)*u}));a&&p.reverse(),f=p.map((function(t,e){return Math.abs(t-(0==e?0:p[e-1]))})),s?f[0]+=a?c.lastX:c.firstX:f.shift();var d=t.chain.toPoints(i,f);if(d.length<h.length){var g=i.links[i.links.length-1];d.push(g.endPoints[g.reversed?0:1])}s&&d.shift(),a&&d.reverse();var v=function(e,n){var r=new t.paths.Arc([0,0],0,0,0);return e.map((function(i,o){var a;return 0===o?a=t.angle.ofPointInDegrees(i,e[o+1])+90:o===e.length-1?a=t.angle.ofPointInDegrees(e[o-1],i)+90:(r.origin=i,r.startAngle=t.angle.ofPointInDegrees(i,e[o+1]),r.endAngle=t.angle.ofPointInDegrees(i,e[o-1]),a=t.angle.ofArcMiddle(r)),a+n}))}(d,-90);return h.forEach((function(t,e){t.angle=v[e],t.origin=d[e]})),r(e,h,l),e},e.cloneToRadial=function(e,n,r,i){var o,a,s={};t.isModel(e)?(o=s.models={},a=t.model.rotate):(o=s.paths={},a=t.path.rotate);for(var l=0;l<n;l++)o[l]=a(t.cloneObject(e),l*r,i);return s},e.cloneToColumn=a,e.cloneToRow=s,e.cloneToGrid=function(t,e,n,r){var i=l(r);return a(s(t,e,i[0]),n,i[1])},e.cloneToBrick=function(e,n,r,i){var o=l(i);return c(e,n,r,(function(e){var n=t.measure.modelExtents(e),r=o[0]||0,i=o[1]||0;return{x:(n.width+r)/-2,y:n.height+i,xMargin:r}}))},e.cloneToHoneycomb=function(e,n,r,i){return void 0===i&&(i=0),c(e,n,r,(function(e){var n=t.measure.boundingHexagon(e),r=2*t.solvers.equilateralAltitude(n.radius)+i;return{x:r/-2,y:t.solvers.equilateralAltitude(r),xMargin:i}}))}}(t.layout||(t.layout={}))}(MakerJs||(MakerJs={})),function(t){!function(e){var n,r=!1;function i(){if(!r)try{Bezier.prototype;r=!0}catch(t){throw"Bezier library not found. If you are using Node, try running 'npm install' or if you are in the browser, download http://pomax.github.io/bezierjs/bezier.js to your website and add a script tag."}}function o(t){var e=[t.origin];e.push.apply(e,t.controls),e.push(t.end);var r=e.map((function(t){return{x:t[0],y:t[1]}}));return n?Bezier.apply(n,r):(i(),n=new Bezier(r)),n}function a(t,e){var n=t.points.map(c),r=new g(n);return e&&(r.parentRange=e),r}function s(t){var e=[];return e.push.apply(e,t.origin),e.push.apply(e,t.controls[0]),t.controls.length>1&&e.push.apply(e,t.controls[1]),e.push.apply(e,t.end),i(),new Bezier(e)}function l(e){var n=e.extrema().values.map((function(e){return t.round(e)})).filter((function(t,e,n){return n.indexOf(t)===e})).sort();return 0===n.length?[0,1]:(0!==n[0]&&n.unshift(0),1!==n[n.length-1]&&n.push(1),n)}function c(t){return[t.x,t.y]}var h=function(e,n,r){this.t=n,this.point=t.point.add(c(e.get(n)),r)};function u(e,n,r,i,o){var a=r-n;function s(r){var s=n+a*r,l=c(e.get(s)),h=t.point.middle(i,o?1-r:r);return t.measure.pointDistance(h,l)}return s(.25)+s(.75)}function f(e,n,r,i){for(var o,a,s,l=new h(e,n),f=new h(e,r),p=l,d=0,g=f;d<100;){var v=c(e.get((l.t+g.t)/2));try{o=new t.paths.Arc(l.point,v,g.point)}catch(t){if(a)return a;break}if(void 0===s&&(s=t.measure.isPointEqual(l.point,t.point.fromAngleOnCircle(o.endAngle,o))),u(e,n,g.t,o,s)<=i?(o.bezierData={startT:n,endT:g.t},p=g,a=o):f=g,p.t===f.t||a&&a!==o&&t.angle.ofArcSpan(o)-t.angle.ofArcSpan(a)<.5)return a;d++,g=new h(e,(p.t+f.t)/2)}var m=new t.paths.Line(l.point,g.point);return m.bezierData={startT:n,endT:g.t},m}function p(e,n,r,i,o,a){for(var s,l=0;i<o;){i=(s=f(n,i,o,r)).bezierData.endT,t.measure.pathLength(s)<1e-4||(e.paths[s.type+"_"+(a+l)]=s,l++)}return l}function d(e,n,r,i){var a=o(e.seed),s=[n.bezierData.startT,n.bezierData.endT].map((function(t){return new h(a,t,i)})),l=r.slice(),c=l.map((function(e){return t.measure.pointDistance(e,s[0].point)}));c[0]>c[1]&&l.reverse();for(var u=2;u--;)if(!t.measure.isPointEqual(l[u],s[u].point))return null;return n.bezierData}var g=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];switch(this.type=t.pathType.BezierSeed,e.length){case 1:var r=e[0];this.origin=r[0],3===r.length?(this.controls=[r[1]],this.end=r[2]):4===r.length?(this.controls=[r[1],r[2]],this.end=r[3]):this.end=r[1];break;case 3:Array.isArray(e[1])?this.controls=e[1]:this.controls=[e[1]],this.end=e[2];break;case 4:this.controls=[e[1],e[2]],this.end=e[3]}},v=function(){function e(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];this.type=e.typeName;var i=Array.isArray(n[0]);switch(n.length){case 2:if(!i){this.seed=n[0],this.accuracy=n[1];break}this.accuracy=n[1];case 1:if(i){var o=n[0];this.seed=new g(o)}else this.seed=n[0];break;default:switch(n.length){case 4:if(t.isPoint(n[3])){this.seed=new g(n);break}this.accuracy=n[3];case 3:i&&(this.seed=new g(n.slice(0,3)));break;case 5:this.accuracy=n[4],this.seed=new g(n.slice(0,4))}}if(this.paths={},t.measure.isBezierSeedLinear(this.seed)){var a=new t.paths.Line(t.point.clone(this.seed.origin),t.point.clone(this.seed.end));return a.bezierData={startT:0,endT:1},void(this.paths={0:a})}var c=s(this.seed),h=l(c);if(this.paths={},!this.accuracy){var u=c.length();this.accuracy=u/100}for(var f=0,d=1;d<h.length;d++){var v=h[d]-h[d-1];f+=p(this,c,this.accuracy*v,h[d-1],h[d],f)}}return e.getBezierSeeds=function(e,n){void 0===n&&(n={}),n.shallow=!0,n.unifyBeziers=!1;var r={},i=function(e,n,i){void 0===i&&(i=!1),r[n]||(r[n]=[]),r[n].push(i?t.path.clone(e):e)};return t.model.findChains(e,(function(n,r,s){n.forEach((function(n){var r=function(e,n,r,i){var o=[n.links[0],n.links[n.links.length-1]];o[0].walkedPath.pathContext.bezierData.startT>o[1].walkedPath.pathContext.bezierData.startT&&(t.chain.reverse(n),o.reverse());var a=o.map((function(t){return d(e,t.walkedPath.pathContext,t.endPoints,t.walkedPath.offset)})),s={startT:a[0]?a[0].startT:null,endT:a[1]?a[1].endT:null};return null!==s.startT&&null!==s.endT?s:n.links.length>2?(null===s.startT&&(i(n.links[0].walkedPath.pathContext,r,!0),s.startT=n.links[1].walkedPath.pathContext.bezierData.startT),null===s.endT&&(i(n.links[n.links.length-1].walkedPath.pathContext,r,!0),s.endT=n.links[n.links.length-2].walkedPath.pathContext.bezierData.endT),s):null}(e,n,s,i);if(r){var l=o(e.seed).split(r.startT,r.endT);i(a(l),s)}else n.links.forEach((function(t){return i(t.walkedPath.pathContext,s,!0)}))})),r.forEach((function(n){if(n.pathContext.type===t.pathType.Line)return i(n.pathContext,s,!0);var r=d(e,n.pathContext,t.point.fromPathEnds(n.pathContext),n.offset);if(r){var l=o(e.seed).split(r.startT,r.endT);i(a(l),s)}else i(n.pathContext,s,!0)}))}),n),n.byLayers?r:r[""]},e.computeLength=function(t){return s(t).length()},e.computePoint=function(t,e){return c(o(t).compute(e))},e.typeName="BezierCurve",e}();e.BezierCurve=v,v.metaParameters=[{title:"points",type:"select",value:[[[100,0],[-80,-60],[100,220],[100,60]],[[0,0],[100,0],[100,100]],[[0,0],[20,0],[80,100],[100,100]]]}]}(t.models||(t.models={}))}(MakerJs||(MakerJs={})),function(t){!function(e){function n(e){var n,r=t.angle.ofArcSpan(e),i=(n=t.angle.toRadians(r),Math.tan(n/4)/3*4),o=[e.radius,e.radius*i];return[o,t.point.rotate(t.point.mirror(o,!1,!0),r,[0,0])].map((function(n){return t.point.add(e.origin,t.point.rotate(n,e.startAngle,[0,0]))}))}function r(e){if(t.angle.ofArcSpan(e)<=90){var r=t.point.fromPathEnds(e),i=n(e);return{type:t.pathType.BezierSeed,origin:r[0],controls:i,end:r[1]}}return null}var i=function(){for(var n=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];this.models={};var a,s=8,l=t.isPoint(i[0]),c=function(o){switch(o){case 2:l&&(n.origin=i[0]);break;case 3:n.origin=i[0];break;case 4:n.origin=[i[0],i[1]]}for(var c=360/s,h=new t.paths.Arc([0,0],1,0,c),u=0;u<s;u++){var f=r(h);switch(o){case 1:f=t.path.scale(f,i[0]);break;case 2:f=l?t.path.scale(f,i[1]):t.path.distort(f,i[0],i[1]);break;case 3:f=t.path.distort(f,i[1],i[2]);break;case 4:f=t.path.distort(f,i[2],i[3])}n.models["Curve_"+(1+u)]=new e.BezierCurve(f,a),h.startAngle+=c,h.endAngle+=c}};switch(i.length){case 2:c(2);break;case 3:l?c(3):(a=i[2],c(2));break;case 4:l?(a=i[3],c(3)):c(4);break;case 5:a=i[4],c(4)}};e.Ellipse=i,i.metaParameters=[{title:"radiusX",type:"range",min:1,max:50,value:50},{title:"radiusY",type:"range",min:1,max:50,value:25}];var o=function(){for(var n,i,o,a,s=[],l=0;l<arguments.length;l++)s[l]=arguments[l];this.models={},t.isPathArc(s[0])?(n=s[0],o=s[1],a=s[2],i=s[3]):(n=new t.paths.Arc([0,0],1,s[0],s[1]),o=s[2],a=s[3],i=s[4]);for(var c=t.angle.ofArcSpan(n),h=Math.ceil(c/45),u=c/h,f=t.path.clone(n),p=0;p<h;p++){f.startAngle=n.startAngle+p*u,f.endAngle=f.startAngle+u;var d=r(f);d=t.path.distort(d,o,a),this.models["Curve_"+(1+p)]=new e.BezierCurve(d,i)}};e.EllipticArc=o,o.metaParameters=[{title:"startAngle",type:"range",min:0,max:90,value:0},{title:"endAngle",type:"range",min:90,max:360,value:180},{title:"radiusX",type:"range",min:1,max:50,value:50},{title:"radiusY",type:"range",min:1,max:50,value:25}]}(t.models||(t.models={}))}(MakerJs||(MakerJs={})),function(t){!function(e){function n(e){var n;if(Array.isArray(e)){if(t.isPoint(e[0]))return e;n=e}else n=t.importer.parseNumericList(e);for(var r=[],i=0;i<n.length;i+=2)r.push([n[i],n[i+1]]);return r}var r=function(){for(var e,r,i=this,o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];switch(this.paths={},o.length){case 1:e=!0,r=n(o[0]);break;case 2:e=o[0],r=n(o[1])}for(var s=function(e,n,o){void 0===o&&(o=!1),o&&0==t.measure.pointDistance(r[e],r[n])||(i.paths["ShapeLine"+l]=new t.paths.Line(r[e],r[n]))},l=1;l<r.length;l++)s(l-1,l);e&&r.length>2&&s(r.length-1,0,!0)};e.ConnectTheDots=r,r.metaParameters=[{title:"closed",type:"bool",value:!0},{title:"points",type:"select",value:[[[0,0],[40,40],[60,20],[100,100],[60,60],[40,80]],[[0,0],[100,0],[50,87]],[-10,0,10,0,0,20],"-10 0 10 0 0 20"]}]}(t.models||(t.models={}))}(MakerJs||(MakerJs={})),function(t){!function(e){var n=function(){function n(t,r,i,o){this.paths={},this.paths=new e.ConnectTheDots(!0,n.getPoints(t,r,i,o)).paths}return n.circumscribedRadius=function(t,e){return t/Math.cos(e/2)},n.getPoints=function(e,r,i,o){void 0===i&&(i=0),void 0===o&&(o=!1);var a=[],s=t.angle.toRadians(i),l=2*Math.PI/e;o&&(r=n.circumscribedRadius(r,l));for(var c=0;c<e;c++)a.push(t.point.fromPolar(l*c+s,r));return a},n}();e.Polygon=n,n.metaParameters=[{title:"number of sides",type:"range",min:3,max:24,value:6},{title:"radius",type:"range",min:1,max:100,value:50},{title:"offset angle",type:"range",min:0,max:180,value:0},{title:"radius on flats (vs radius on vertexes)",type:"bool",value:!1}]}(t.models||(t.models={}))}(MakerJs||(MakerJs={})),function(t){!function(e){var n=function(e,n,r){this.paths={};for(var i=0;i<n.length;i++){var o=r?r[i]:i.toString();this.paths[o]=new t.paths.Circle(n[i],e)}};e.Holes=n,n.metaParameters=[{title:"holeRadius",type:"range",min:.1,max:10,step:.1,value:1},{title:"points",type:"select",value:[[[0,0],[10,10],[20,20],[30,30],[40,40],[50,50],[60,60],[70,70],[80,80]],[[0,0],[0,25],[0,50],[0,75],[0,100],[25,50],[50,50],[75,50],[100,100],[100,75],[100,50],[100,25],[100,0]]]}]}(t.models||(t.models={}))}(MakerJs||(MakerJs={})),function(t){!function(t){var e=function(e,n,r,i){void 0===i&&(i=0),this.paths={};var o=t.Polygon.getPoints(r,e,i),a=o.map((function(t,e){return"bolt "+e}));this.paths=new t.Holes(n,o,a).paths};t.BoltCircle=e,e.metaParameters=[{title:"bolt circle radius",type:"range",min:1,max:100,value:50},{title:"hole radius",type:"range",min:1,max:50,value:5},{title:"bolt count",type:"range",min:3,max:24,value:12},{title:"offset angle",type:"range",min:0,max:180,value:0}]}(t.models||(t.models={}))}(MakerJs||(MakerJs={})),function(t){!function(t){var e=function(e,n,r){this.paths={};var i=[[0,0],[e,0],[e,n],[0,n]];this.paths=new t.Holes(r,i,["BottomLeft_bolt","BottomRight_bolt","TopRight_bolt","TopLeft_bolt"]).paths};t.BoltRectangle=e,e.metaParameters=[{title:"width",type:"range",min:1,max:100,value:100},{title:"height",type:"range",min:1,max:100,value:50},{title:"hole radius",type:"range",min:1,max:50,value:5}]}(t.models||(t.models={}))}(MakerJs||(MakerJs={})),function(t){!function(e){var n=function(e,n,r,i,o){void 0===i&&(i=0),void 0===o&&(o=!1),this.paths={};var a,s,l,c,h,u,f=Math.min(n,e)/2;switch(i){case-1:case 1:a=f/2;break;case 0:default:a=f*Math.SQRT2/2}switch(r=Math.min(r,a),i){case-1:s=0,l=r,c=0,h=2*r,u=[180,0,0,180];break;case 1:s=r,l=0,c=2*r,h=0,u=[270,270,90,90];break;case 0:default:c=h=2*(s=l=r/Math.SQRT2),u=[225,315,45,135]}o?(this.paths.Left=new t.paths.Line([0,0],[0,n-h]),this.paths.Right=new t.paths.Line([e,0],[e,n-h])):(this.paths.Left=new t.paths.Line([0,h],[0,n-h]),this.paths.Right=new t.paths.Line([e,h],[e,n-h]),this.paths.Bottom=new t.paths.Line([c,0],[e-c,0]),this.paths.BottomLeft=new t.paths.Arc([s,l],r,u[0]-90,u[0]+90),this.paths.BottomRight=new t.paths.Arc([e-s,l],r,u[1]-90,u[1]+90)),this.paths.TopRight=new t.paths.Arc([e-s,n-l],r,u[2]-90,u[2]+90),this.paths.TopLeft=new t.paths.Arc([s,n-l],r,u[3]-90,u[3]+90),this.paths.Top=new t.paths.Line([c,n],[e-c,n])};e.Dogbone=n,n.metaParameters=[{title:"width",type:"range",min:1,max:100,value:50},{title:"height",type:"range",min:1,max:100,value:100},{title:"radius",type:"range",min:0,max:50,value:5},{title:"style",type:"select",value:[0,1,-1]},{title:"bottomless",type:"bool",value:!1}]}(t.models||(t.models={}))}(MakerJs||(MakerJs={})),function(t){!function(e){var n=function(e,n,r,i){this.paths={};var o=e/2;r<0&&(r=0),void 0===r&&(r=o),r=Math.min(r,o),r=Math.min(r,n);var a=Math.max(o-r,0),s=Math.max(n-r,0);i||(this.paths.Bottom=new t.paths.Line([-o,0],[o,0])),s&&(this.paths.Left=new t.paths.Line([-o,0],[-o,s]),this.paths.Right=new t.paths.Line([o,0],[o,s])),r>0&&(this.paths.TopLeft=new t.paths.Arc([-a,s],r,90,180),this.paths.TopRight=new t.paths.Arc([a,s],r,0,90)),a&&(this.paths.Top=new t.paths.Line([-a,n],[a,n]))};e.Dome=n,n.metaParameters=[{title:"width",type:"range",min:1,max:100,value:50},{title:"height",type:"range",min:1,max:100,value:100},{title:"radius",type:"range",min:0,max:50,value:25},{title:"bottomless",type:"bool",value:!1}]}(t.models||(t.models={}))}(MakerJs||(MakerJs={})),function(t){!function(e){var n=function(){for(var e,n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];this.paths={};var o=0;switch(r.length){case 3:e=r[0],n=r[1],o=r[2];break;case 2:o=r[1];case 1:var a=t.measure.modelExtents(r[0]);this.origin=t.point.subtract(a.low,[o,o]),e=a.high[0]-a.low[0]+2*o,n=a.high[1]-a.low[1]+2*o}var s=Math.min(n,e)/2,l=e-(o=Math.min(o,s)),c=n-o;o>0&&(this.paths.BottomLeft=new t.paths.Arc([o,o],o,180,270),this.paths.BottomRight=new t.paths.Arc([l,o],o,270,0),this.paths.TopRight=new t.paths.Arc([l,c],o,0,90),this.paths.TopLeft=new t.paths.Arc([o,c],o,90,180)),l-o>0&&(this.paths.Bottom=new t.paths.Line([o,0],[l,0]),this.paths.Top=new t.paths.Line([l,n],[o,n])),c-o>0&&(this.paths.Right=new t.paths.Line([e,o],[e,c]),this.paths.Left=new t.paths.Line([0,c],[0,o]))};e.RoundRectangle=n,n.metaParameters=[{title:"width",type:"range",min:1,max:100,value:50},{title:"height",type:"range",min:1,max:100,value:100},{title:"radius",type:"range",min:0,max:50,value:11}]}(t.models||(t.models={}))}(MakerJs||(MakerJs={})),function(t){!function(t){var e=function(e,n){this.paths={},this.paths=new t.RoundRectangle(e,n,Math.min(n/2,e/2)).paths};t.Oval=e,e.metaParameters=[{title:"width",type:"range",min:1,max:100,value:50},{title:"height",type:"range",min:1,max:100,value:100}]}(t.models||(t.models={}))}(MakerJs||(MakerJs={})),function(t){!function(e){var n=function(e,n,r,i,o,a){var s,l=this;if(void 0===o&&(o=!1),void 0===a&&(a=!1),this.paths={},a&&(s={models:{}},this.models={Caps:s}),!(i<=0||r<=0)&&(e=t.angle.noRevolutions(e),n=t.angle.noRevolutions(n),0!=t.round(e-n))){n<e&&(n+=360);var c=function(e,n,o,c){var h;return a?(h={paths:{}},s.models[e]=h):h=l,h.paths[e]=new t.paths.Arc(t.point.fromPolar(t.angle.toRadians(n),r),i,n+o,n+c)},h=function(i,o){return l.paths[i]=new t.paths.Arc([0,0],r+o,e,n)};h("Outer",i);var u=r-i>0;u&&h("Inner",-i);var f=[];if(f.push(c("StartCap",e,180,0)),f.push(c("EndCap",n,0,180)),t.measure.pointDistance(f[0].origin,f[1].origin)/2<i){var p=t.path.intersection(f[0],f[1]);p&&(u&&o||(f[0].startAngle=p.path1Angles[0],f[1].endAngle=p.path2Angles[0]),!o&&u&&2==p.intersectionPoints.length&&(c("StartCap2",e,180,0).endAngle=p.path1Angles[1],c("EndCap2",n,0,180).startAngle=p.path2Angles[1]+360))}}};e.OvalArc=n,n.metaParameters=[{title:"start angle",type:"range",min:-360,max:360,step:1,value:180},{title:"end angle",type:"range",min:-360,max:360,step:1,value:0},{title:"sweep",type:"range",min:0,max:100,step:1,value:50},{title:"radius",type:"range",min:0,max:100,step:1,value:15},{title:"self intersect",type:"bool",value:!1}]}(t.models||(t.models={}))}(MakerJs||(MakerJs={})),function(t){!function(e){var n=function(){for(var n,r,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];if(this.paths={},2!==i.length||t.isObject(i[0])){var a,s=0;t.isModel(i[0])?(a=t.measure.modelExtents(i[0]),2===i.length&&(s=i[1])):a=i[0],this.origin=t.point.subtract(a.low,[s,s]),n=a.high[0]-a.low[0]+2*s,r=a.high[1]-a.low[1]+2*s}else n=i[0],r=i[1];this.paths=new e.ConnectTheDots(!0,[[0,0],[n,0],[n,r],[0,r]]).paths};e.Rectangle=n,n.metaParameters=[{title:"width",type:"range",min:1,max:100,value:50},{title:"height",type:"range",min:1,max:100,value:100}]}(t.models||(t.models={}))}(MakerJs||(MakerJs={})),function(t){!function(e){var n=function(e,n){this.paths={};var r={Ring_outer:e,Ring_inner:n};for(var i in r){var o=r[i];void 0===o||o<=0||(this.paths[i]=new t.paths.Circle(t.point.zero(),o))}};e.Ring=n,n.metaParameters=[{title:"outer radius",type:"range",min:0,max:100,step:1,value:50},{title:"inner radius",type:"range",min:0,max:100,step:1,value:20}]}(t.models||(t.models={}))}(MakerJs||(MakerJs={})),function(t){!function(e){var n=function(e,n,r){this.paths={};var i=new t.paths.Arc([0,0],e,0,360),o=new t.paths.Arc([n,0],r,0,360),a=t.solvers.circleTangentAngles(i,o);a?(a=a.sort((function(t,e){return t-e})),i.startAngle=a[0],i.endAngle=a[1],o.startAngle=a[1],o.endAngle=a[0],this.paths.Left=i,this.paths.Right=o,this.paths.Top=new t.paths.Line(t.point.fromAngleOnCircle(a[0],i),t.point.fromAngleOnCircle(a[0],o)),this.paths.Bottom=new t.paths.Line(t.point.fromAngleOnCircle(a[1],i),t.point.fromAngleOnCircle(a[1],o))):this.paths.Belt=new t.paths.Circle(Math.max(e,r))};e.Belt=n,n.metaParameters=[{title:"left radius",type:"range",min:0,max:100,value:30},{title:"distance between centers",type:"range",min:0,max:100,value:50},{title:"right radius",type:"range",min:0,max:100,value:15}]}(t.models||(t.models={}))}(MakerJs||(MakerJs={})),function(t){!function(e){var n=function(e,n){function r(t,e){return t+(e*e-t*t)/(2*t)}this.paths={};var i,o,a,s,l=n/2,c=e/2;e>n?(i=r(l,c),o=270,a=360-t.angle.toDegrees(Math.acos(c/i)),s=[0,i]):(i=r(c,l),o=180-t.angle.toDegrees(Math.asin(l/i)),a=180,s=[i,0]);var h=new t.paths.Arc(s,i,o,a);this.paths.curve_start=h,this.paths.curve_end=t.path.moveRelative(t.path.mirror(h,!0,!0),[e,n])};e.SCurve=n,n.metaParameters=[{title:"width",type:"range",min:1,max:100,value:50},{title:"height",type:"range",min:1,max:100,value:100}]}(t.models||(t.models={}))}(MakerJs||(MakerJs={})),function(t){!function(e){var n=function(e,n,r,i){var o,a=this;void 0===i&&(i=!1),this.paths={},i&&(o={models:{}},this.models={Caps:o});var s=function(t,e){var n;i?(n={paths:{}},o.models[t]=n):n=a,n.paths[t]=e},l=t.angle.ofPointInDegrees(e,n),c=t.measure.pointDistance(e,n);this.paths.Top=new t.paths.Line([0,r],[c,r]),this.paths.Bottom=new t.paths.Line([0,-r],[c,-r]),s("StartCap",new t.paths.Arc([0,0],r,90,270)),s("EndCap",new t.paths.Arc([c,0],r,270,90)),t.model.rotate(this,l,[0,0]),this.origin=e};e.Slot=n,n.metaParameters=[{title:"origin",type:"select",value:[[0,0],[10,0],[10,10]]},{title:"end",type:"select",value:[[80,0],[0,30],[10,30]]},{title:"radius",type:"range",min:1,max:50,value:10}]}(t.models||(t.models={}))}(MakerJs||(MakerJs={})),function(t){!function(t){var e=function(e){this.paths={},this.paths=new t.Rectangle(e,e).paths};t.Square=e,e.metaParameters=[{title:"side",type:"range",min:1,max:100,value:100}]}(t.models||(t.models={}))}(MakerJs||(MakerJs={})),function(t){!function(t){var e=function(){function e(n,r,i,o){void 0===o&&(o=2),this.paths={},i||(i=r*e.InnerRadiusRatio(n,o));for(var a=t.Polygon.getPoints(n,r),s=t.Polygon.getPoints(n,i,180/n),l=[],c=0;c<n;c++)l.push(a[c]),l.push(s[c]);var h=new t.ConnectTheDots(!0,l);this.paths=h.paths,delete h.paths}return e.InnerRadiusRatio=function(t,e){return t>0&&e>1&&e<t/2?Math.cos(Math.PI*e/t)/Math.cos(Math.PI*(e-1)/t):0},e}();t.Star=e,e.metaParameters=[{title:"number of sides",type:"range",min:3,max:24,value:8},{title:"outer radius",type:"range",min:1,max:100,value:50},{title:"inner radius",type:"range",min:0,max:100,value:15},{title:"skip points (when inner radius is zero)",type:"range",min:0,max:12,value:2}]}(t.models||(t.models={}))}(MakerJs||(MakerJs={})),function(t){!function(e){var n=function(){function n(e,r,i,o,a,s,l){var c=this;void 0===o&&(o=!1),void 0===a&&(a=!1),this.models={};var h,u,f=0;e.forEachGlyph(r,0,0,i,l,(function(e,r,i,l,p){var d=n.glyphToModel(e,l,s);if(d.origin=[r,0],a&&(d.paths||d.models)){var g=t.measure.modelExtents(d);if(g){var v=g.high[0]-g.low[0];t.model.originate(d,[g.low[0]+v/2,0])}}if(o&&f>0){var m,y={};m=h?{models:{deleted:h,char:u}}:u,t.model.combine(m,d,!1,!0,!1,!0,y),h=y.out_deleted[1]}c.models[f]=d,f++,u=d}))}return n.glyphToModel=function(n,r,i){var o,a,s={},l=0;function c(t){s.models||(s.models={}),s.models["p_"+ ++l]=t}return n.getPath(0,0,r).commands.map((function(n,r){var h=[[n.x,n.y],[n.x1,n.y1],[n.x2,n.y2]].map((function(e){if(void 0!==e[0])return t.point.mirror(e,!1,!0)}));switch(n.type){case"M":o=h[0];break;case"Z":h[0]=o;case"L":t.measure.isPointEqual(a,h[0])||function(t){s.paths||(s.paths={}),s.paths["p_"+ ++l]=t}(new t.paths.Line(a,h[0]));break;case"C":c(new e.BezierCurve(a,h[1],h[2],h[0],i));break;case"Q":c(new e.BezierCurve(a,h[1],h[0],i))}a=h[0]})),s},n}();e.Text=n,n.metaParameters=[{title:"font",type:"font",value:"*"},{title:"text",type:"text",value:"Hello"},{title:"font size",type:"range",min:10,max:200,value:72},{title:"combine",type:"bool",value:!1},{title:"center character origin",type:"bool",value:!1}]}(t.models||(t.models={}))}(MakerJs||(MakerJs={})),MakerJs.version="0.17.1";var Bezier=__webpack_require__(96)},28:function(t,e,n){"use strict";async function r(t){const e=new(await n.e(3).then(n.t.bind(null,167,7)).then(t=>t.default));return(await e.optimize(t)).data}async function i(t){return new Promise((e,r)=>{const i=new FileReader;i.readAsArrayBuffer(t),i.onloadend=async()=>{const t=new Uint8Array(i.result),o=(await n.e(17).then(n.bind(null,304))).encode(t);o.stderr?r(new Error(o.stderr)):e(new Blob([o.data],{type:"image/jpg"}))}})}async function o(t,e,r){const i=(await n.e(10).then(n.t.bind(null,305,7))).encode([t.buffer],e,r,256);return new Blob([i],{type:"image/png"})}n.r(e),n.d(e,"optimizeSvg",(function(){return r})),n.d(e,"optimizeJpg",(function(){return i})),n.d(e,"optimizePng",(function(){return o}))},32:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o})),n.d(e,"d",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"e",(function(){return l})),n.d(e,"f",(function(){return c}));var r=n(51);const i=["image/png","image/jpeg","image/webp"];async function o(t,e,n,i){return new Promise((o,a)=>{t.toBlob(t=>{if(t){const r=new File([t],e,{type:n});o(r)}else a(Object(r.c)("error_canvas_convert_file_fail",n,"Blob returned as null."))},n,i)})}function a(t,e){const n=document.createElement("canvas");n.width=e.width,n.height=e.height;const r=n.getContext("2d");return r&&r.drawImage(t,e.left,e.top,e.width,e.height,0,0,e.width,e.height),n}async function s(t,e=!1){return!e&&t.height>0&&t.width>0?new Promise((e,n)=>{t.toBlob(t=>{const n=URL.createObjectURL(t);e(n)},"png")}):t.toDataURL("png")}function l(t,e=0,n=0,r=t.naturalWidth,i=t.naturalHeight){const o=document.createElement("canvas");return o.width=r,o.height=i,o.getContext("2d").drawImage(t,e,n,t.naturalWidth,t.naturalHeight,0,0,r,i),o}function c(t,e,n=!0){if(1===e)return t;const r=document.createElement("canvas");r.width=t.width*e,r.height=t.height*e;const i=r.getContext("2d");if(n)i.drawImage(t,0,0,t.width,t.height,0,0,r.width,r.height);else{const n=t.getContext("2d").getImageData(0,0,t.width,t.height),o=new Uint8ClampedArray(n.data.length*e*e);for(let i=0;i<o.length;i+=4){const a=Math.floor(i/4/r.width),s=i/4%r.width,l=Math.floor(a/e),c=Math.floor(s/e);if(l===a/e||c===s/e){const n=c===Math.floor(t.width/2)&&l===Math.floor(t.height/2)||c===s/e&&c-1===Math.floor(t.width/2)&&l===Math.floor(t.height/2)||l===a/e&&c===Math.floor(t.width/2)&&l-1===Math.floor(t.height/2);o[i]=n?0:210,o[i+1]=n?0:210,o[i+2]=n?0:210,o[i+3]=255}else{const e=4*(l*t.width+c);o[i]=n.data[e],o[i+1]=n.data[e+1],o[i+2]=n.data[e+2],o[i+3]=n.data[e+3]}}i.putImageData(new ImageData(o,r.width,r.height),0,0)}return r}},33:function(t,e,n){"use strict";n.r(e),n.d(e,"lang",(function(){return a}));var r=n(44);n.d(e,"facade",(function(){return r}));var i=n(63);n.d(e,"tools",(function(){return i}));var o=n(40);n.d(e,"i18n",(function(){return o}));const a=o.lang},353:function(t,e,n){var r=n(354);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(14)(r,i);r.locals&&(t.exports=r.locals)},354:function(t,e,n){(t.exports=n(13)(!1)).push([t.i,".inspectStudio{flex-grow:1;flex-shrink:1;position:relative;display:flex}.inspectStudio>.mainContainer{display:flex;position:absolute;top:0;bottom:0;left:0;right:0}.inspectStudio>.mainContainer .flexColumn{flex-direction:column}.inspectStudio>.mainContainer .flexItem{flex:1}.inspectStudio>.mainContainer .main{order:2;border-left:1px solid #404a4b;border-right:1px solid #404a4b;display:flex;position:relative}.inspectStudio>.mainContainer .main .ad{position:absolute;left:0;right:0;top:0;z-index:9999}.inspectStudio>.mainContainer .main .canvasWrapper{flex:1 1 auto;position:relative}.inspectStudio>.mainContainer .sidebarLeft{order:1}.inspectStudio>.mainContainer .sidebarRight{order:3}.inspectStudio>.fileLoaderWrapper .formatsWrapper{padding:20px;border-radius:10px;background:#282f2f;position:absolute;top:20px;right:20px;z-index:5}.inspectStudio>.fileLoaderWrapper .fileDropper{position:absolute;top:0;bottom:0;left:0;right:0}.inspectStudio>.loading{margin-left:auto;margin-right:auto;align-self:center;display:flex;align-items:center}.inspectStudio>.loading>i{margin-right:10px;color:#2ecc71}\n",""])},355:function(t,e,n){var r=n(356);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(14)(r,i);r.locals&&(t.exports=r.locals)},356:function(t,e,n){(t.exports=n(13)(!1)).push([t.i,".canvas{position:absolute;left:0;right:0;top:0;bottom:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.canvas .tools{position:absolute;bottom:20px;right:20px;background:rgba(0,0,0,0.6);z-index:10;display:flex;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;align-items:stretch;border-radius:8px}.canvas .tools>*{padding:4px;padding-top:3px;padding-bottom:3px}.canvas .tools .text{font-size:0.8em;font-weight:bold;margin-right:5px}.canvas .tools .zoomTool{display:flex;align-items:center}.canvas .tools .zoomTool .zoom{margin-left:8px;margin-right:8px;cursor:pointer;font-size:1.2em}.canvas .tools .metricScale{background:rgba(255,255,255,0.05);cursor:pointer}.canvas .tools .metricScale .metrics{padding-left:3px}.canvas .tools .metricScale .selectable:hover{background:#104ecb}\n",""])},357:function(t,e,n){var r=n(358);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(14)(r,i);r.locals&&(t.exports=r.locals)},358:function(t,e,n){(t.exports=n(13)(!1)).push([t.i,".sidebarRight{overflow-y:auto;overflow-x:hidden;width:300px}.sidebarRight .card{border-radius:0}.sidebarRight .card .title{font-size:1em;font-weight:bold;padding:3px;padding-top:5px;padding-bottom:5px;margin:0}\n",""])},359:function(t,e,n){var r=n(360);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(14)(r,i);r.locals&&(t.exports=r.locals)},360:function(t,e,n){(t.exports=n(13)(!1)).push([t.i,"",""])},361:function(t,e,n){var r=n(362);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(14)(r,i);r.locals&&(t.exports=r.locals)},362:function(t,e,n){(t.exports=n(13)(!1)).push([t.i,".layerBasicView .title{display:flex}.layerBasicView .title .showCss{padding-right:8px;font-size:0.8em;font-weight:bold;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.layerBasicView .cardBody{padding-top:10px;padding-bottom:10px;font-size:0.8em}.layerBasicView .cardBody table{width:100%}.layerBasicView .cardBody table tr td{border-bottom:1px solid #aaa;padding-top:5px;padding-bottom:5px}.layerBasicView .cardBody table tr td:first-child{padding-right:1em;font-weight:bold;text-align:right;width:50px;padding-left:1em}.layerBasicView .cardBody table tr td:last-child{padding-left:1em;font-size:1.2em;color:white;cursor:pointer}\n",""])},363:function(t,e,n){var r=n(364);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(14)(r,i);r.locals&&(t.exports=r.locals)},364:function(t,e,n){(t.exports=n(13)(!1)).push([t.i,".clickCopyDiv{position:relative}.clickCopyDiv:hover .labelToCopy{background:#2064EE;color:white}.clickCopyDiv .copied{position:absolute;padding:3px;background:black;border:1px solid #999;left:30px;top:-10px;color:#fff}\n",""])},365:function(t,e,n){var r=n(366);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(14)(r,i);r.locals&&(t.exports=r.locals)},366:function(t,e,n){(t.exports=n(13)(!1)).push([t.i,".layerExportView .cardBody .formats{display:flex;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.layerExportView .cardBody .formats>span{flex:1 1 0;padding-top:10px;padding-bottom:10px;text-align:center}.layerExportView .cardBody .formats>span.active{background:#2064EE}.layerExportView .cardBody .imgParam .preview{position:relative;height:200px}.layerExportView .cardBody .imgParam .preview .mask{position:absolute;left:0;right:0;bottom:0;top:0;z-index:1;background:rgba(0,0,0,0.8);opacity:0;transition:opacity ease 500ms}.layerExportView .cardBody .imgParam .preview:hover .mask{opacity:1}.layerExportView .cardBody .imgParam .preview>img{max-width:90%;max-height:90%;position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);z-index:10}.layerExportView .cardBody .imgParam .preview .size{z-index:15;position:absolute;right:0;top:0;padding:3px;padding-left:10px;padding-right:10px;font-size:1em;color:white;background:rgba(0,0,0,0.5)}.layerExportView .cardBody .imgParam .options{display:flex;flex-wrap:wrap}.layerExportView .cardBody .imgParam .options>*{width:50%;border-bottom:1px solid #8c9b9d}.layerExportView .cardBody .imgParam .options>*:nth-child(even){border-left:1px solid #8c9b9d}.layerExportView .cardBody .imgParam .options .dropdown-content{background:#000}.layerExportView .cardBody .row{display:flex;align-items:center}.layerExportView .cardBody .row>div{padding:8px;flex:1 0 auto}.layerExportView .cardBody .fileExport{padding:10px}.layerExportView .cardBody .fileExport .fileName{font-weight:bold;font-size:0.85em;color:#d9d9d9}.layerExportView .cardBody .fileExport .exporters{display:flex;justify-content:space-around;margin-top:10px;margin-bottom:10px}.layerExportView .cardBody .fileExport .exporters>button>i{margin-right:5px}\n",""])},367:function(t,e,n){var r=n(368);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(14)(r,i);r.locals&&(t.exports=r.locals)},368:function(t,e,n){(t.exports=n(13)(!1)).push([t.i,".exporModal .preview{position:relative}.exporModal .preview>canvas{z-index:10}.exporModal .preview .mask{position:absolute;left:0;right:0;bottom:0;top:0;z-index:1;background:rgba(0,0,0,0.8);opacity:0;transition:opacity ease 500ms}.exporModal .preview:hover .mask{opacity:1}.exporModal .variantList{min-height:230px;border-bottom:1px solid #dbdee0}.exporModal .variantList .variantItem{border-bottom:1px solid #8c9b9d}.exporModal .baseName{width:96px;border-bottom:1px solid #dbdee0}\n",""])},369:function(t,e,n){var r=n(370);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(14)(r,i);r.locals&&(t.exports=r.locals)},370:function(t,e,n){(t.exports=n(13)(!1)).push([t.i,".layerItemContainer{display:flex;border-bottom:1px solid #666;cursor:pointer}.layerItemContainer .layerItem{padding:8px;color:#efefef;display:flex;align-items:center;font-size:0.9em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;flex-shrink:1;flex-grow:1;overflow:hidden}.layerItemContainer .layerItem.active{background-color:#0c3c9c}.layerItemContainer .layerItem:hover{background-color:#4f85f2}.layerItemContainer .layerItem.invisible{color:#444}.layerItemContainer .layerItem .icon{margin-right:5px;height:16px}.layerItemContainer .layerItem .icon .material-icons{font-size:16px}.layerItemContainer .layerItem .indent{flex-shrink:0}.layerItemContainer .layerItem .name{flex-shrink:1;flex-grow:1;min-width:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.layerItemContainer .layerItem .hint{flex-shrink:0;font-size:0.8em;color:#ebebeb}\n",""])},371:function(t,e,n){var r=n(372);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(14)(r,i);r.locals&&(t.exports=r.locals)},372:function(t,e,n){(t.exports=n(13)(!1)).push([t.i,".nearByLayers .page-head{padding:8px;padding-left:18px;background:#0c3c9c;cursor:default;text-align:center;display:block}\n",""])},373:function(t,e,n){var r=n(374);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(14)(r,i);r.locals&&(t.exports=r.locals)},374:function(t,e,n){(t.exports=n(13)(!1)).push([t.i,".colorPickedView .cardBody{padding:15px}.colorPickedView .cardBody .hoverColor{display:flex;align-items:center;padding-bottom:15px;border-bottom:1px solid #aaa}.colorPickedView .cardBody .hoverColor .preview{padding:25px;margin-right:20px;border:1px solid #aaa;border-radius:5px}.colorPickedView .cardBody .hoverColor .txt{display:flex;flex-direction:column}.colorPickedView .cardBody .hoverColor .txt>span{font-size:0.8em}.colorPickedView .cardBody .hoverColor .txt .hex{font-weight:bold;font-size:1.2rem}.colorPickedView .cardBody .pickedColors{margin-top:15px;display:flex;flex-wrap:wrap}.colorPickedView .cardBody .pickedColors .pickedColor{padding:10px;display:flex;flex-direction:column;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer}.colorPickedView .cardBody .pickedColors .pickedColor:hover{background:#404a4b}.colorPickedView .cardBody .pickedColors .pickedColor .preview{padding:15px;margin-bottom:8px;border-radius:5px}.colorPickedView .cardBody .pickedColors .pickedColor>span{font-size:0.85rem}\n",""])},375:function(t,e,n){var r=n(376);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(14)(r,i);r.locals&&(t.exports=r.locals)},376:function(t,e,n){(t.exports=n(13)(!1)).push([t.i,".toolbar{display:flex;flex-direction:column;background:#404a4b}\n",""])},377:function(t,e,n){var r=n(378);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(14)(r,i);r.locals&&(t.exports=r.locals)},378:function(t,e,n){(t.exports=n(13)(!1)).push([t.i,".toolBtn{padding-top:1rem;padding-bottom:1rem;padding-left:1rem;padding-right:1rem;font-size:1.5rem;display:flex;align-items:center;justify-content:center;cursor:pointer;color:#8c9b9d}.toolBtn:hover{color:white}.toolBtn.active{color:#2ecc71;background:#2d3435}.toolBtn.toggle.toolLayers.active{background:#282f2f}\n",""])},379:function(t,e,n){var r=n(380);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(14)(r,i);r.locals&&(t.exports=r.locals)},380:function(t,e,n){(t.exports=n(13)(!1)).push([t.i,".sidebarLeft{display:flex}\n",""])},381:function(t,e,n){var r=n(382);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(14)(r,i);r.locals&&(t.exports=r.locals)},382:function(t,e,n){(t.exports=n(13)(!1)).push([t.i,".pageList{width:300px;background:#282f2f;border-right:1px solid white;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;overflow-y:auto}.pageList .page-head{background:#1d2122;font-size:1.1em;font-weight:bold;border-bottom:1px solid #404a4b;display:flex;align-items:center;cursor:pointer}.pageList .page-head>.name{padding:8px;padding-left:15px;flex-grow:1;flex-shrink:1;overflow:hidden;text-overflow:ellipsis}.pageList .page-head>.name:hover{background-color:#4f85f2}.pageList .page-head>.hint{flex-shrink:0;font-size:0.7em}.pageList .page-head.active{background-color:#092d76}.pageList .layerListWrapper{display:flex;flex-direction:column;width:100%;height:100%}.pageList .layerListWrapper .back{flex-shrink:0;background:#4c5759;display:flex;align-items:center}.pageList .layerListWrapper .back .backBtn{padding:15px;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.pageList .layerListWrapper .back .backBtn:hover{background:#576567}.pageList .layerListWrapper .layerList{flex:1 1 auto}.pageList .pageLayerInfo{padding:8px;font-size:0.8em;text-align:center}.pageList .itemBtn{align-self:stretch;width:40px;flex-shrink:0;flex-grow:0;display:flex;align-items:center;justify-content:center;background-color:#2f3738;border-left:1px solid #343c3d;border-right:1px solid #1d2122}.pageList .itemBtn:hover{color:#2ecc71}\n",""])},383:function(t,e,n){var r=n(384);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(14)(r,i);r.locals&&(t.exports=r.locals)},384:function(t,e,n){(t.exports=n(13)(!1)).push([t.i,".layerList{overflow-y:auto}\n",""])},39:function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},40:function(t,e,n){"use strict";n.r(e);var r=n(51);n.d(e,"lang",(function(){return r.c})),n.d(e,"setCurLang",(function(){return r.d})),n.d(e,"getLangs",(function(){return r.b})),n.d(e,"getCurLang",(function(){return r.a}))},44:function(t,e,n){"use strict";n.r(e),n.d(e,"projectOpenLocalFile",(function(){return s})),n.d(e,"initRendererOnCanvas",(function(){return D})),n.d(e,"metricScales",(function(){return h})),n.d(e,"zoomIn",(function(){return u})),n.d(e,"centerTo",(function(){return f})),n.d(e,"centerToPage",(function(){return p})),n.d(e,"setZoom",(function(){return d})),n.d(e,"setMetricScale",(function(){return g})),n.d(e,"zoomOut",(function(){return v})),n.d(e,"getZoom",(function(){return m})),n.d(e,"fitToPage",(function(){return y})),n.d(e,"exporters",(function(){return U})),n.d(e,"findLocalExporter",(function(){return z})),n.d(e,"exportBlob",(function(){return G})),n.d(e,"copyColor",(function(){return Y})),n.d(e,"layer",(function(){return V}));var r=n(30),i=n(40),o=n(1),a=n(20);async function s(t){const e=Object(r.b)("adaptermanager").listDecoders(),n={meta:{name:t.name,mime:t.type},file:t};for(const r of e)if(r.checkFileMeta(n.meta))try{Object(a.c)(r.type,t.name,Math.round(t.size/1024));const e=Object(a.d)("parse",r.type),i=await r.decodeProject(n);return e(),o.b.dispatch({type:"openProject",project:i}),i}catch(t){return Object(a.b)(t.toString(),r.type),Promise.reject(t)}return Object(a.b)("no decoder: "+n.meta.name),Promise.reject(Object(i.lang)("error_openfile_no_adapter",n.meta.name))}var l=n(17);const c=[.1,.25,.33,.5,.75,1,1.5,2,3,4],h=[1,2,3,4];function u(){const t=m();var e;d((e=t,c.find(t=>t>e)||c[c.length-1]))}function f(t){const e=o.b.getState().canvasState.renderer;if(e){const n={x:e.renderWidth/2,y:e.renderHeight/2},r={x:t.x*m()-n.x,y:t.y*m()-n.y};e.panX(r.x),e.panY(r.y)}}function p(t){const e=t.offsetX?t.offsetX:0,n=t.offsetY?t.offsetY:0;f(new l.a(e,n,t.width+e,t.height+n).centerPoint)}function d(t){o.b.getState().canvasState.renderer&&o.b.dispatch({value:t,type:"canvasStateZoomLevel"})}function g(t){o.b.dispatch({type:"canvasStateMetricScale",value:t})}function v(){d(b(m()))}function m(){return o.b.getState().canvasState.zoomLevel}function y(){const t=o.b.getState().canvasState.renderer,e=Math.round(1/Math.max(t.imgWidth/t.renderWidth,t.imgHeight/t.renderHeight,1)*100)/100,n=-1!==c.indexOf(e)?e:b(e);f({x:t.imgWidth/2,y:t.imgHeight/2}),d(n)}function b(t){return c.concat().reverse().find(e=>e<t)||c[0]}var x=n(56);const w=["mousedown","mouseup","mousemove","click","mouseleave"];class S extends x.a{constructor(t){super(),this.parent=t,setTimeout(()=>{this._delegateEvents()}),Object(o.a)(t=>t.viewState.showListColumn,t=>{setTimeout(()=>{this.resizeRender()},50)})}get metricScale(){return o.b.getState().canvasState.metricScale}get zoom(){return o.b.getState().canvasState.zoomLevel}get renderWidth(){return this.parent.clientWidth}get renderHeight(){return this.parent.clientHeight}get minX(){return-this.renderWidth/2}get minY(){return-this.renderHeight/2}get maxX(){return this.imgWidth-this.renderWidth/2}get maxY(){return this.imgHeight-this.renderHeight/2}_delegateEvents(){w.forEach(t=>{this.delegateEvents(t,e=>{this.emit(t,e)})})}mouseEventToCoords(t){const e=t.e,n=this.parent.getBoundingClientRect();return{x:e.clientX-n.left,y:e.clientY-n.top}}rendererPointToRealPoint(t,e=!0){let n;return n=e?{x:Math.round(Math.min(Math.max(t.x+this.panX(),0),this.imgWidth)/this.zoom),y:Math.round(Math.min(Math.max(t.y+this.panY(),0),this.imgHeight)/this.zoom)}:{x:Math.round((t.x+this.panX())/this.zoom),y:Math.round((t.y+this.panY())/this.zoom)},n}realPointToRendererPoint(t){return{x:Math.round(t.x*this.zoom-this.panX()),y:Math.round(t.y*this.zoom-this.panY())}}realPointApplyMetricScale(t){return{x:Math.round(t.x/this.metricScale),y:Math.round(t.y/this.metricScale)}}panX(t){if(void 0!==t){const e=t;this._panX(e)}return this._panX()}panY(t){if(void 0!==t){const e=t;this._panY(e)}return this._panY()}realRectToRendererRect(t){return t.pan(-this.panX()/this.zoom,-this.panY()/this.zoom).zoom(this.zoom)}rendererRectToRealRect(t){return t.pan(this.panX(),this.panY()).zoom(1/this.zoom)}}function C(t){return!!t.img}function T(t){return void 0!==t.x1}function _(t){return void 0!==t.txt}function O(t){return void 0!==t.radius}function k(t){return void 0!==t.width}var P=n(16),E=n(33);function M(t){let e;const n=[],r=[],i=[],o=[];if(t.forEach(t=>{void 0!==t.offsetX&&void 0!==t.offsetY?i.push(t):o.push(t)}),i.forEach(t=>{let n=new l.a(t.offsetX,t.offsetY,t.offsetX+t.width,t.offsetY+t.height);e=e?e.combine(n):n,r.push({page:t,rect:n})}),e&&(0!==e.left||0!==e.top)){for(const t of r)t.rect=t.rect.pan(-e.left,-e.top);e=e.pan(-e.left,-e.top)}return o.forEach(t=>{const i=function(t){const e=Math.floor(t.length/4),n=t.length%4,r=t.slice(4*e).reduce((t,e)=>t+e.width+20,0);let i=0;if(n>0)i=t[4*e+n-1].top;else for(let n=0;n<e;n++){for(let e=0;e<4;e++){const r=t[4*n+e];i=Math.max(i,r.top+r.height)}i+=20}return{x:r,y:i}}(n);e&&(i.y+=e.height+20);let o=new l.a(i.x,i.y,t.width,t.height);n.push(o),r.push({page:t,rect:o})}),r}n(183),P.fabric.Object.prototype.objectCaching=!1;class A extends S{constructor(t){super(t),this.parent=t,this.drawGroup=[],this.renderUI=Object(r.b)("renderUI"),this.canvas=document.createElement("canvas"),this.canvas.width=this.renderWidth,this.canvas.height=this.renderHeight,t.innerHTML="",t.appendChild(this.canvas),this.fabricCanvas=new P.fabric.Canvas(this.canvas,{hoverCursor:"inherit",selection:!1,renderOnAddRemove:!1,preserveObjectStacking:!0}),this.resizeRender(),this.bindEvents(),Object(o.a)(t=>t.canvasState.zoomLevel,t=>{this.fabricCanvas.zoomToPoint(new P.fabric.Point(this.renderWidth/2,this.renderHeight/2),t),this.fabricCanvas.requestRenderAll()})}updateDraw(t,e){return T(e)?t.set({x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2}):_(e)?t.set({text:e.txt,fontSize:e.fontSize,fontWeight:e.fontWeight,fontFamily:e.fontFamily}):k(e)?t.set({width:e.width,height:e.height,left:e.left,top:e.top}):O(e)?t.set({radius:e.radius,left:e.left,top:e.top}):C(e)&&(t.setElement(e.img.src),t.set({left:e.left,top:e.top}),t.scaleToWidth(e.img.width),t.scaleToHeight(e.img.height)),this.applyDrawOptions(t,e),this.fabricCanvas.requestRenderAll(),t}measureText(t,e){const n=this.draw(e);return{width:n.width,height:n.height}}realPointToPagePoint(t,e){if(this.pages){const n=this.pages.find(t=>t.page===e);return n?{x:t.x-n.rect.left,y:t.y-n.rect.top}:(console.warn("page not found in realPointToPagePoint"),{x:0,y:0})}return console.warn("pageLayout is not ready while realPointToPagePoint is called"),{x:0,y:0}}pagePointToRealPoint(t,e){if(this.pages){const n=this.pages.find(t=>t.page===e);return n?{x:t.x+n.rect.left,y:t.y+n.rect.top}:(console.warn("page not found in pagePointToRealPoint"),{x:0,y:0})}return console.warn("pageLayout is not ready while pagePointToRealPoint is called"),{x:0,y:0}}removeDrawableGroup(t){this.fabricCanvas.remove(...t)}getDrawableGroup(){return[]}pageByRealCoords(t){if(this.pages)for(const e of this.pages)if(e.rect.containsCoords(t.x,t.y))return e.page;return null}resizeRender(){this.fabricCanvas.setWidth(this.renderWidth),this.fabricCanvas.setHeight(this.renderHeight)}get imgWidth(){return this.canvasBackground?this.canvasBackground.getScaledWidth():0}get imgHeight(){return this.canvasBackground?this.canvasBackground.getScaledHeight():0}async renderPages(t){this.pages=M(t),this.canvasBackground=await this.renderUI.parsePages(t),this.fabricCanvas.clear(),this.fabricCanvas.insertAt(this.canvasBackground,0,!1),this.fabricCanvas.requestRenderAll()}setCanvasSize(t,e){this.fabricCanvas.setDimensions({width:t,height:e}),this.fabricCanvas.renderAll()}bindEvents(){let t;this.fabricCanvas.__onMouseWheel=t=>{t.preventDefault(),t.stopPropagation();const e=this.zoom;E.facade.setZoom(t.deltaY>0?.95*e:1.05*e)},this.fabricCanvas.on("mouse:down",e=>{t=e}),this.fabricCanvas.on("mouse:up",e=>{t&&e.e.timeStamp-t.e.timeStamp<200&&Math.sqrt(Math.pow(e.e.offsetX-t.e.offsetX,2)+Math.pow(e.e.offsetY-t.e.offsetY,2))<50&&this.emit("click",e)})}delegateEvents(t,e){switch(t){case"mousedown":this.fabricCanvas.on("mouse:down",e);break;case"mouseup":this.fabricCanvas.on("mouse:up",e);break;case"mousemove":this.fabricCanvas.on("mouse:move",e);break;case"mouseleave":this.fabricCanvas.on("mouse:out",e)}}off(t,e){if(super.off(t,e),t)switch(t){case"mousedown":this.fabricCanvas.off("mouse:down",e);break;case"mouseup":this.fabricCanvas.off("mouse:up",e);break;case"mousemove":this.fabricCanvas.off("mouse:move",e);break;case"mouseleave":this.fabricCanvas.off("mouse:out",e);break;default:super.off(t,e)}else this.fabricCanvas.off()}clearDrawing(t,e){if(t)for(this.fabricCanvas.remove(...t);t.length;)t.pop();else this.fabricCanvas.clear(),this.canvasBackground&&this.fabricCanvas.insertAt(this.canvasBackground,0,!1)}draw(t,e){let n=void 0;if(T(t))n=new P.fabric.Line([t.x1,t.y1,t.x2,t.y2]);else if(_(t)){const e=new P.fabric.Text(t.txt,{left:t.left+5,top:t.top+5,fontSize:t.fontSize,fontWeight:t.fontWeight,fill:t.fillColor,fontFamily:t.fontFamily||"Arial, Helvetica, sans-serif"}),r=new P.fabric.Rect({left:t.left,top:t.top,width:e.width+10,height:e.height+10,fill:t.textBackgroundFill});n=new P.fabric.Group([r,e])}else k(t)?n=new P.fabric.Rect({width:t.width,height:t.height}):O(t)?n=new P.fabric.Circle({radius:t.radius}):C(t)&&(n=new P.fabric.Image(t.img.src,{left:t.left,top:t.top}));return n&&this.applyDrawOptions(n,t),e&&(this.fabricCanvas.add(n),e.push(n),this.fabricCanvas.requestRenderAll()),n}applyDrawOptions(t,e){var n,r;"group"===t.type?t.set({opacity:e.opacity||1,scaleX:e.scaleX||1,scaleY:e.scaleY||1}):t.set({stroke:e.strokeColor,strokeWidth:null!==(n=e.strokeWidth)&&void 0!==n?n:1,strokeDashArray:(null===(r=e.strokeDashArray)||void 0===r?void 0:r.split(" ").map(t=>parseInt(t)))||void 0,fill:e.fillColor,fillRule:e.fillRule||"evenodd",opacity:e.opacity||1,scaleX:e.scaleX||1,scaleY:e.scaleY||1,left:t.left||e.left||0,top:t.top||e.top||0}),e.clip&&e.clip.circle&&t.set({clipPath:this.draw(e.clip.circle)})}destroy(){this.fabricCanvas.dispose()}_panX(t){return void 0!==t&&(this.fabricCanvas.absolutePan(new P.fabric.Point(t,this.panY())),this.fabricCanvas.requestRenderAll()),-this.fabricCanvas.viewportTransform[4]}_panY(t){return void 0!==t&&(this.fabricCanvas.absolutePan(new P.fabric.Point(this.panX(),t)),this.fabricCanvas.requestRenderAll()),-this.fabricCanvas.viewportTransform[5]}}let L;async function D(t){await Promise.resolve().then(n.bind(null,183)),L&&(L.destroy(),L.off("mousemove",R)),L=new A(t),function(t){t.on("mousemove",R)}(L),o.b.dispatch({type:"canvasStateRenderer",renderer:L});const e=await o.b.getState().sessionState.project.pages;return await L.renderPages(e),y(),L}let I=null;function R(t){if(t){const e=L.realPointApplyMetricScale(L.rendererPointToRealPoint(L.mouseEventToCoords(t)));o.b.dispatch({type:"canvasStateMouseCoords",coords:e})}}window.addEventListener("resize",()=>{I&&(clearTimeout(I),I=null),L&&(I=window.setTimeout(()=>{I=null,L&&L.resizeRender()},100))});var j=n(145),B=n.n(j);class F{constructor(){this.name=Object(i.lang)("localDownload"),this.iconCls="fas fa-download"}exportBlob(t,e){return B.a.saveAs(t,e),Promise.resolve()}}const U=[new F];function z(){return U.find(t=>t instanceof F)}async function G(t,e,n){return n.exportBlob(e,t)}var N=n(102),H=n(121);const X=n(147).Toast;const W=new class{info(t){X(t,{style:{main:{bottom:"auto",top:"10%",left:"auto",width:"auto",right:"8%",background:"rgba(255,255,255,0.85",color:"black"}},settings:{duration:800}})}};function Y(t){const e=Object(N.a)(t).toUpperCase();Object(H.a)(e),W.info("Copied "+e)}const V=n(129)},45:function(t,e,n){!function(){"use strict";var e=Math.abs,r=Math.min,i=Math.max,o=Math.cos,a=Math.sin,s=Math.acos,l=Math.sqrt,c=Math.PI,h={x:0,y:0,z:0},u=n(46),f=n(97),p=function(t){var n=t&&t.forEach?t:[].slice.call(arguments),r=!1;if("object"==typeof n[0]){r=n.length;var i=[];n.forEach((function(t){["x","y","z"].forEach((function(e){void 0!==t[e]&&i.push(t[e])}))})),n=i}var o=!1,a=n.length;if(r){if(r>4){if(1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");o=!0}}else if(6!==a&&8!==a&&9!==a&&12!==a&&1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");var s=!o&&(9===a||12===a)||t&&t[0]&&void 0!==t[0].z;this._3d=s;for(var l=[],c=0,h=s?3:2;c<a;c+=h){var f={x:n[c],y:n[c+1]};s&&(f.z=n[c+2]),l.push(f)}this.order=l.length-1,this.points=l;var p=["x","y"];s&&p.push("z"),this.dims=p,this.dimlen=p.length,function(t){for(var n=t.order,r=t.points,i=u.align(r,{p1:r[0],p2:r[n]}),o=0;o<i.length;o++)if(e(i[o].y)>1e-4)return void(t._linear=!1);t._linear=!0}(this),this._t1=0,this._t2=1,this.update()},d=n(98);function g(t,e,n,r,i){void 0===i&&(i=.5);var o=u.projectionratio(i,t),a=1-o,s={x:o*e.x+a*r.x,y:o*e.y+a*r.y},l=u.abcratio(i,t);return{A:{x:n.x+(n.x-s.x)/l,y:n.y+(n.y-s.y)/l},B:n,C:s}}p.SVGtoBeziers=function(t){return d(p,t)},p.quadraticFromPoints=function(t,e,n,r){if(void 0===r&&(r=.5),0===r)return new p(e,e,n);if(1===r)return new p(t,e,e);var i=g(2,t,e,n,r);return new p(t,i.A,n)},p.cubicFromPoints=function(t,e,n,r,i){void 0===r&&(r=.5);var o=g(3,t,e,n,r);void 0===i&&(i=u.dist(e,o.C));var a=i*(1-r)/r,s=u.dist(t,n),l=(n.x-t.x)/s,c=(n.y-t.y)/s,h=i*l,f=i*c,d=a*l,v=a*c,m=e.x-h,y=e.y-f,b=e.x+d,x=e.y+v,w=o.A,S=w.x+(m-w.x)/(1-r),C=w.y+(y-w.y)/(1-r),T=w.x+(b-w.x)/r,_=w.y+(x-w.y)/r,O={x:t.x+(S-t.x)/r,y:t.y+(C-t.y)/r},k={x:n.x+(T-n.x)/(1-r),y:n.y+(_-n.y)/(1-r)};return new p(t,O,k,n)};var v=function(){return u};p.getUtils=v,p.PolyBezier=f,p.prototype={getUtils:v,valueOf:function(){return this.toString()},toString:function(){return u.pointsToString(this.points)},toSVG:function(t){if(this._3d)return!1;for(var e=this.points,n=["M",e[0].x,e[0].y,2===this.order?"Q":"C"],r=1,i=e.length;r<i;r++)n.push(e[r].x),n.push(e[r].y);return n.join(" ")},setRatios:function(t){if(t.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=t,this._lut=[]},verify:function(){var t=this.coordDigest();t!==this._print&&(this._print=t,this.update())},coordDigest:function(){return this.points.map((function(t,e){return""+e+t.x+t.y+(t.z?t.z:0)})).join("")},update:function(t){this._lut=[],this.dpoints=u.derive(this.points,this._3d),this.computedirection()},computedirection:function(){var t=this.points,e=u.angle(t[0],t[this.order],t[1]);this.clockwise=e>0},length:function(){return u.length(this.derivative.bind(this))},_lut:[],getLUT:function(t){if(this.verify(),t=t||100,this._lut.length===t)return this._lut;this._lut=[],t--;for(var e=0;e<=t;e++)this._lut.push(this.compute(e/t));return this._lut},on:function(t,e){e=e||5;for(var n,r=this.getLUT(),i=[],o=0,a=0;a<r.length;a++)n=r[a],u.dist(n,t)<e&&(i.push(n),o+=a/r.length);return!!i.length&&o/i.length},project:function(t){var e,n,r,i,o=this.getLUT(),a=o.length-1,s=u.closest(o,t),l=s.mdist,c=s.mpos,h=(c+1)/a,f=.1/a;for(l+=1,e=n=(c-1)/a;n<h+f;n+=f)r=this.compute(n),(i=u.dist(t,r))<l&&(l=i,e=n);return(r=this.compute(e)).t=e,r.d=l,r},get:function(t){return this.compute(t)},point:function(t){return this.points[t]},compute:function(t){return this.ratios?u.computeWithRatios(t,this.points,this.ratios,this._3d):u.compute(t,this.points,this._3d,this.ratios)},raise:function(){for(var t,e,n=this.points,r=[n[0]],i=n.length,o=1;o<i;o++)t=n[o],e=n[o-1],r[o]={x:(i-o)/i*t.x+o/i*e.x,y:(i-o)/i*t.y+o/i*e.y};return r[i]=n[i-1],new p(r)},derivative:function(t){var e,n,r=1-t,i=0,o=this.dpoints[0];2===this.order&&(o=[o[0],o[1],h],e=r,n=t),3===this.order&&(e=r*r,n=r*t*2,i=t*t);var a={x:e*o[0].x+n*o[1].x+i*o[2].x,y:e*o[0].y+n*o[1].y+i*o[2].y};return this._3d&&(a.z=e*o[0].z+n*o[1].z+i*o[2].z),a},curvature:function(t){return u.curvature(t,this.points,this._3d)},inflections:function(){return u.inflections(this.points)},normal:function(t){return this._3d?this.__normal3(t):this.__normal2(t)},__normal2:function(t){var e=this.derivative(t),n=l(e.x*e.x+e.y*e.y);return{x:-e.y/n,y:e.x/n}},__normal3:function(t){var e=this.derivative(t),n=this.derivative(t+.01),r=l(e.x*e.x+e.y*e.y+e.z*e.z),i=l(n.x*n.x+n.y*n.y+n.z*n.z);e.x/=r,e.y/=r,e.z/=r,n.x/=i,n.y/=i,n.z/=i;var o={x:n.y*e.z-n.z*e.y,y:n.z*e.x-n.x*e.z,z:n.x*e.y-n.y*e.x},a=l(o.x*o.x+o.y*o.y+o.z*o.z);o.x/=a,o.y/=a,o.z/=a;var s=[o.x*o.x,o.x*o.y-o.z,o.x*o.z+o.y,o.x*o.y+o.z,o.y*o.y,o.y*o.z-o.x,o.x*o.z-o.y,o.y*o.z+o.x,o.z*o.z];return{x:s[0]*e.x+s[1]*e.y+s[2]*e.z,y:s[3]*e.x+s[4]*e.y+s[5]*e.z,z:s[6]*e.x+s[7]*e.y+s[8]*e.z}},hull:function(t){var e,n=this.points,r=[],i=[],o=0,a=0,s=0;for(i[o++]=n[0],i[o++]=n[1],i[o++]=n[2],3===this.order&&(i[o++]=n[3]);n.length>1;){for(r=[],a=0,s=n.length-1;a<s;a++)e=u.lerp(t,n[a],n[a+1]),i[o++]=e,r.push(e);n=r}return i},split:function(t,e){if(0===t&&e)return this.split(e).left;if(1===e)return this.split(t).right;var n=this.hull(t),r={left:2===this.order?new p([n[0],n[3],n[5]]):new p([n[0],n[4],n[7],n[9]]),right:2===this.order?new p([n[5],n[4],n[2]]):new p([n[9],n[8],n[6],n[3]]),span:n};return r.left._t1=u.map(0,0,1,this._t1,this._t2),r.left._t2=u.map(t,0,1,this._t1,this._t2),r.right._t1=u.map(t,0,1,this._t1,this._t2),r.right._t2=u.map(1,0,1,this._t1,this._t2),e?(e=u.map(e,t,1,0,1),r.right.split(e).left):r},extrema:function(){var t,e,n=this.dims,r={},i=[];return n.forEach(function(n){e=function(t){return t[n]},t=this.dpoints[0].map(e),r[n]=u.droots(t),3===this.order&&(t=this.dpoints[1].map(e),r[n]=r[n].concat(u.droots(t))),r[n]=r[n].filter((function(t){return t>=0&&t<=1})),i=i.concat(r[n].sort(u.numberSort))}.bind(this)),i=i.sort(u.numberSort).filter((function(t,e){return i.indexOf(t)===e})),r.values=i,r},bbox:function(){var t=this.extrema(),e={};return this.dims.forEach(function(n){e[n]=u.getminmax(this,n,t[n])}.bind(this)),e},overlaps:function(t){var e=this.bbox(),n=t.bbox();return u.bboxoverlap(e,n)},offset:function(t,e){if(void 0!==e){var n=this.get(t),r=this.normal(t),i={c:n,n:r,x:n.x+r.x*e,y:n.y+r.y*e};return this._3d&&(i.z=n.z+r.z*e),i}if(this._linear){var o=this.normal(0),a=this.points.map((function(e){var n={x:e.x+t*o.x,y:e.y+t*o.y};return e.z&&r.z&&(n.z=e.z+t*o.z),n}));return[new p(a)]}return this.reduce().map((function(e){return e._linear?e.offset(t)[0]:e.scale(t)}))},simple:function(){if(3===this.order){var t=u.angle(this.points[0],this.points[3],this.points[1]),n=u.angle(this.points[0],this.points[3],this.points[2]);if(t>0&&n<0||t<0&&n>0)return!1}var r=this.normal(0),i=this.normal(1),o=r.x*i.x+r.y*i.y;return this._3d&&(o+=r.z*i.z),e(s(o))<c/3},reduce:function(){var t,n,r=0,i=0,o=[],a=[],s=this.extrema().values;for(-1===s.indexOf(0)&&(s=[0].concat(s)),-1===s.indexOf(1)&&s.push(1),r=s[0],t=1;t<s.length;t++)i=s[t],(n=this.split(r,i))._t1=r,n._t2=i,o.push(n),r=i;return o.forEach((function(t){for(r=0,i=0;i<=1;)for(i=r+.01;i<=1.01;i+=.01)if(!(n=t.split(r,i)).simple()){if(e(r-(i-=.01))<.01)return[];(n=t.split(r,i))._t1=u.map(r,0,1,t._t1,t._t2),n._t2=u.map(i,0,1,t._t1,t._t2),a.push(n),r=i;break}r<1&&((n=t.split(r,1))._t1=u.map(r,0,1,t._t1,t._t2),n._t2=t._t2,a.push(n))})),a},scale:function(t){var e=this.order,n=!1;if("function"==typeof t&&(n=t),n&&2===e)return this.raise().scale(n);var r=this.clockwise,i=n?n(0):t,o=n?n(1):t,a=[this.offset(0,10),this.offset(1,10)],s=u.lli4(a[0],a[0].c,a[1],a[1].c);if(!s)throw new Error("cannot scale this curve. Try reducing it first.");var c=this.points,h=[];return[0,1].forEach(function(t){var n=h[t*e]=u.copy(c[t*e]);n.x+=(t?o:i)*a[t].n.x,n.y+=(t?o:i)*a[t].n.y}.bind(this)),n?([0,1].forEach(function(i){if(2!==this.order||!i){var o=c[i+1],a={x:o.x-s.x,y:o.y-s.y},u=n?n((i+1)/e):t;n&&!r&&(u=-u);var f=l(a.x*a.x+a.y*a.y);a.x/=f,a.y/=f,h[i+1]={x:o.x+u*a.x,y:o.y+u*a.y}}}.bind(this)),new p(h)):([0,1].forEach(function(t){if(2!==this.order||!t){var n=h[t*e],r=this.derivative(t),i={x:n.x+r.x,y:n.y+r.y};h[t+1]=u.lli4(n,i,s,c[t+1])}}.bind(this)),new p(h))},outline:function(t,e,n,r){e=void 0===e?t:e;var i,o=this.reduce(),a=o.length,s=[],l=[],c=0,h=this.length(),p=void 0!==n&&void 0!==r;function d(t,e,n,r,i){return function(o){var a=r/n,s=(r+i)/n,l=e-t;return u.map(o,0,1,t+a*l,t+s*l)}}o.forEach((function(i){S=i.length(),p?(s.push(i.scale(d(t,n,h,c,S))),l.push(i.scale(d(-e,-r,h,c,S)))):(s.push(i.scale(t)),l.push(i.scale(-e))),c+=S})),l=l.map((function(t){return(i=t.points)[3]?t.points=[i[3],i[2],i[1],i[0]]:t.points=[i[2],i[1],i[0]],t})).reverse();var g=s[0].points[0],v=s[a-1].points[s[a-1].points.length-1],m=l[a-1].points[l[a-1].points.length-1],y=l[0].points[0],b=u.makeline(m,g),x=u.makeline(v,y),w=[b].concat(s).concat([x]).concat(l),S=w.length;return new f(w)},outlineshapes:function(t,e,n){e=e||t;for(var r=this.outline(t,e).curves,i=[],o=1,a=r.length;o<a/2;o++){var s=u.makeshape(r[o],r[a-o],n);s.startcap.virtual=o>1,s.endcap.virtual=o<a/2-1,i.push(s)}return i},intersects:function(t,e){return t?t.p1&&t.p2?this.lineIntersects(t):(t instanceof p&&(t=t.reduce()),this.curveintersects(this.reduce(),t,e)):this.selfintersects(e)},lineIntersects:function(t){var e=r(t.p1.x,t.p2.x),n=r(t.p1.y,t.p2.y),o=i(t.p1.x,t.p2.x),a=i(t.p1.y,t.p2.y),s=this;return u.roots(this.points,t).filter((function(t){var r=s.get(t);return u.between(r.x,e,o)&&u.between(r.y,n,a)}))},selfintersects:function(t){var e,n,r,i,o=this.reduce(),a=o.length-2,s=[];for(e=0;e<a;e++)r=o.slice(e,e+1),i=o.slice(e+2),n=this.curveintersects(r,i,t),s=s.concat(n);return s},curveintersects:function(t,e,n){var r=[];t.forEach((function(t){e.forEach((function(e){t.overlaps(e)&&r.push({left:t,right:e})}))}));var i=[];return r.forEach((function(t){var e=u.pairiteration(t.left,t.right,n);e.length>0&&(i=i.concat(e))})),i},arcs:function(t){t=t||.5;return this._iterate(t,[])},_error:function(t,n,r,i){var o=(i-r)/4,a=this.get(r+o),s=this.get(i-o),l=u.dist(t,n),c=u.dist(t,a),h=u.dist(t,s);return e(c-l)+e(h-l)},_iterate:function(t,e){var n,r=0,i=1;do{n=0,i=1;var s,l,c,h,f,p=this.get(r),d=!1,g=!1,v=i,m=1;do{if(g=d,h=c,v=(r+i)/2,s=this.get(v),l=this.get(i),(c=u.getccenter(p,s,l)).interval={start:r,end:i},d=this._error(c,p,r,i)<=t,(f=g&&!d)||(m=i),d){if(i>=1){if(c.interval.end=m=1,h=c,i>1){var y={x:c.x+c.r*o(c.e),y:c.y+c.r*a(c.e)};c.e+=u.angle({x:c.x,y:c.y},y,this.get(1))}break}i+=(i-r)/2}else i=v}while(!f&&n++<100);if(n>=100)break;h=h||c,e.push(h),r=m}while(i<1);return e}},t.exports=p}()},46:function(t,e,n){!function(){"use strict";var e=Math.abs,r=Math.cos,i=Math.sin,o=Math.acos,a=Math.atan2,s=Math.sqrt,l=Math.pow,c=function(t){return t<0?-l(-t,1/3):l(t,1/3)},h=Math.PI,u=2*h,f=h/2,p=Number.MAX_SAFE_INTEGER||9007199254740991,d=Number.MIN_SAFE_INTEGER||-9007199254740991,g={x:0,y:0,z:0},v={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(t,e){var n=e(t),r=n.x*n.x+n.y*n.y;return void 0!==n.z&&(r+=n.z*n.z),s(r)},compute:function(t,e,n){if(0===t)return e[0];var r=e.length-1;if(1===t)return e[r];var i=e,o=1-t;if(0===r)return e[0];if(1===r)return f={x:o*i[0].x+t*i[1].x,y:o*i[0].y+t*i[1].y},n&&(f.z=o*i[0].z+t*i[1].z),f;if(r<4){var a,s,l,c=o*o,h=t*t,u=0;2===r?(i=[i[0],i[1],i[2],g],a=c,s=o*t*2,l=h):3===r&&(a=c*o,s=c*t*3,l=o*h*3,u=t*h);var f={x:a*i[0].x+s*i[1].x+l*i[2].x+u*i[3].x,y:a*i[0].y+s*i[1].y+l*i[2].y+u*i[3].y};return n&&(f.z=a*i[0].z+s*i[1].z+l*i[2].z+u*i[3].z),f}for(var p=JSON.parse(JSON.stringify(e));p.length>1;){for(var d=0;d<p.length-1;d++)p[d]={x:p[d].x+(p[d+1].x-p[d].x)*t,y:p[d].y+(p[d+1].y-p[d].y)*t},void 0!==p[d].z&&(p[d]=p[d].z+(p[d+1].z-p[d].z)*t);p.splice(p.length-1,1)}return p[0]},computeWithRatios:function(t,e,n,r){var i,o=1-t,a=n,s=e,l=a[0],c=a[1],h=a[2],u=a[3];return l*=o,c*=t,2===s.length?(i=l+c,{x:(l*s[0].x+c*s[1].x)/i,y:(l*s[0].y+c*s[1].y)/i,z:!!r&&(l*s[0].z+c*s[1].z)/i}):(l*=o,c*=2*o,h*=t*t,3===s.length?(i=l+c+h,{x:(l*s[0].x+c*s[1].x+h*s[2].x)/i,y:(l*s[0].y+c*s[1].y+h*s[2].y)/i,z:!!r&&(l*s[0].z+c*s[1].z+h*s[2].z)/i}):(l*=o,c*=1.5*o,h*=3*o,u*=t*t*t,4===s.length?(i=l+c+h+u,{x:(l*s[0].x+c*s[1].x+h*s[2].x+u*s[3].x)/i,y:(l*s[0].y+c*s[1].y+h*s[2].y+u*s[3].y)/i,z:!!r&&(l*s[0].z+c*s[1].z+h*s[2].z+u*s[3].z)/i}):void 0))},derive:function(t,e){for(var n=[],r=t,i=r.length,o=i-1;i>1;i--,o--){for(var a,s=[],l=0;l<o;l++)a={x:o*(r[l+1].x-r[l].x),y:o*(r[l+1].y-r[l].y)},e&&(a.z=o*(r[l+1].z-r[l].z)),s.push(a);n.push(s),r=s}return n},between:function(t,e,n){return e<=t&&t<=n||v.approximately(t,e)||v.approximately(t,n)},approximately:function(t,n,r){return e(t-n)<=(r||1e-6)},length:function(t){var e,n,r=0,i=v.Tvalues.length;for(e=0;e<i;e++)n=.5*v.Tvalues[e]+.5,r+=v.Cvalues[e]*v.arcfn(n,t);return.5*r},map:function(t,e,n,r,i){return r+(i-r)*((t-e)/(n-e))},lerp:function(t,e,n){var r={x:e.x+t*(n.x-e.x),y:e.y+t*(n.y-e.y)};return e.z&&n.z&&(r.z=e.z+t*(n.z-e.z)),r},pointToString:function(t){var e=t.x+"/"+t.y;return void 0!==t.z&&(e+="/"+t.z),e},pointsToString:function(t){return"["+t.map(v.pointToString).join(", ")+"]"},copy:function(t){return JSON.parse(JSON.stringify(t))},angle:function(t,e,n){var r=e.x-t.x,i=e.y-t.y,o=n.x-t.x,s=n.y-t.y;return a(r*s-i*o,r*o+i*s)},round:function(t,e){var n=""+t,r=n.indexOf(".");return parseFloat(n.substring(0,r+1+e))},dist:function(t,e){var n=t.x-e.x,r=t.y-e.y;return s(n*n+r*r)},closest:function(t,e){var n,r,i=l(2,63);return t.forEach((function(t,o){(r=v.dist(e,t))<i&&(i=r,n=o)})),{mdist:i,mpos:n}},abcratio:function(t,n){if(2!==n&&3!==n)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;var r=l(t,n)+l(1-t,n);return e((r-1)/r)},projectionratio:function(t,e){if(2!==e&&3!==e)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;var n=l(1-t,e);return n/(l(t,e)+n)},lli8:function(t,e,n,r,i,o,a,s){var l=(t-n)*(o-s)-(e-r)*(i-a);return 0!=l&&{x:((t*r-e*n)*(i-a)-(t-n)*(i*s-o*a))/l,y:((t*r-e*n)*(o-s)-(e-r)*(i*s-o*a))/l}},lli4:function(t,e,n,r){var i=t.x,o=t.y,a=e.x,s=e.y,l=n.x,c=n.y,h=r.x,u=r.y;return v.lli8(i,o,a,s,l,c,h,u)},lli:function(t,e){return v.lli4(t,t.c,e,e.c)},makeline:function(t,e){var r=n(45),i=t.x,o=t.y,a=e.x,s=e.y,l=(a-i)/3,c=(s-o)/3;return new r(i,o,i+l,o+c,i+2*l,o+2*c,a,s)},findbbox:function(t){var e=p,n=p,r=d,i=d;return t.forEach((function(t){var o=t.bbox();e>o.x.min&&(e=o.x.min),n>o.y.min&&(n=o.y.min),r<o.x.max&&(r=o.x.max),i<o.y.max&&(i=o.y.max)})),{x:{min:e,mid:(e+r)/2,max:r,size:r-e},y:{min:n,mid:(n+i)/2,max:i,size:i-n}}},shapeintersections:function(t,e,n,r,i){if(!v.bboxoverlap(e,r))return[];var o=[],a=[t.startcap,t.forward,t.back,t.endcap],s=[n.startcap,n.forward,n.back,n.endcap];return a.forEach((function(e){e.virtual||s.forEach((function(r){if(!r.virtual){var a=e.intersects(r,i);a.length>0&&(a.c1=e,a.c2=r,a.s1=t,a.s2=n,o.push(a))}}))})),o},makeshape:function(t,e,n){var r=e.points.length,i=t.points.length,o=v.makeline(e.points[r-1],t.points[0]),a=v.makeline(t.points[i-1],e.points[0]),s={startcap:o,forward:t,back:e,endcap:a,bbox:v.findbbox([o,t,e,a])},l=v;return s.intersections=function(t){return l.shapeintersections(s,s.bbox,t,t.bbox,n)},s},getminmax:function(t,e,n){if(!n)return{min:0,max:0};var r,i,o=p,a=d;-1===n.indexOf(0)&&(n=[0].concat(n)),-1===n.indexOf(1)&&n.push(1);for(var s=0,l=n.length;s<l;s++)r=n[s],(i=t.get(r))[e]<o&&(o=i[e]),i[e]>a&&(a=i[e]);return{min:o,mid:(o+a)/2,max:a,size:a-o}},align:function(t,e){var n=e.p1.x,o=e.p1.y,s=-a(e.p2.y-o,e.p2.x-n);return t.map((function(t){return{x:(t.x-n)*r(s)-(t.y-o)*i(s),y:(t.x-n)*i(s)+(t.y-o)*r(s)}}))},roots:function(t,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};var n=t.length-1,i=v.align(t,e),a=function(t){return 0<=t&&t<=1};if(2===n){if(0!==(g=(m=i[0].y)-2*(y=i[1].y)+(b=i[2].y))){var l=-s(y*y-m*b),h=-m+y;return[-(l+h)/g,-(-l+h)/g].filter(a)}return y!==b&&0===g?[(2*y-b)/(2*y-2*b)].filter(a):[]}var f=i[0].y,p=i[1].y,d=i[2].y,g=3*p-f-3*d+i[3].y,m=3*f-6*p+3*d,y=-3*f+3*p,b=f;if(v.approximately(g,0)){if(v.approximately(m,0))return v.approximately(y,0)?[]:[-b/y].filter(a);var x=2*m;return[((w=s(y*y-4*m*b))-y)/x,(-y-w)/x].filter(a)}var w,S,C=(i=(3*(y/=g)-(m/=g)*m)/3)/3,T=(w=(2*m*m*m-9*m*y+27*(b/=g))/27)/2,_=T*T+C*C*C;if(_<0){var O=-i/3,k=s(O*O*O),P=-w/(2*k),E=o(P<-1?-1:P>1?1:P),M=2*c(k);return[M*r(E/3)-m/3,M*r((E+u)/3)-m/3,M*r((E+2*u)/3)-m/3].filter(a)}if(0===_)return[2*(S=T<0?c(-T):-c(T))-m/3,-S-m/3].filter(a);var A=s(_);return[(S=c(-T+A))-c(T+A)-m/3].filter(a)},droots:function(t){if(3===t.length){var e=t[0],n=t[1],r=t[2],i=e-2*n+r;if(0!==i){var o=-s(n*n-e*r),a=-e+n;return[-(o+a)/i,-(-o+a)/i]}return n!==r&&0===i?[(2*n-r)/(2*(n-r))]:[]}if(2===t.length)return(e=t[0])!==(n=t[1])?[e/(e-n)]:[]},curvature:function(t,n,r,i){var o,a,c,h,u,f,p=v.derive(n),d=p[0],g=p[1],m=v.compute(t,d),y=v.compute(t,g),b=m.x*m.x+m.y*m.y;if(r?(o=s(l(m.y*y.z-y.y*m.z,2)+l(m.z*y.x-y.z*m.x,2)+l(m.x*y.y-y.x*m.y,2)),a=l(b+m.z*m.z,1.5)):(o=m.x*y.y-m.y*y.x,a=l(b,1.5)),0===o||0===a)return{k:0,r:0};if(u=o/a,f=a/o,!i){var x=v.curvature(t-.001,n,r,!0).k,w=v.curvature(t+.001,n,r,!0).k;h=(w-u+(u-x))/2,c=(e(w-u)+e(u-x))/2}return{k:u,r:f,dk:h,adk:c}},inflections:function(t){if(t.length<4)return[];var e=v.align(t,{p1:t[0],p2:t.slice(-1)[0]}),n=e[2].x*e[1].y,r=e[3].x*e[1].y,i=e[1].x*e[2].y,o=18*(-3*n+2*r+3*i-(u=e[3].x*e[2].y)),a=18*(3*n-r-3*i),s=18*(i-n);if(v.approximately(o,0)){if(!v.approximately(a,0)){var l=-s/a;if(0<=l&&l<=1)return[l]}return[]}var c=a*a-4*o*s,h=Math.sqrt(c),u=2*o;return v.approximately(u,0)?[]:[(h-a)/u,-(a+h)/u].filter((function(t){return 0<=t&&t<=1}))},bboxoverlap:function(t,n){var r,i,o,a,s,l=["x","y"],c=l.length;for(r=0;r<c;r++)if(o=t[i=l[r]].mid,a=n[i].mid,s=(t[i].size+n[i].size)/2,e(o-a)>=s)return!1;return!0},expandbox:function(t,e){e.x.min<t.x.min&&(t.x.min=e.x.min),e.y.min<t.y.min&&(t.y.min=e.y.min),e.z&&e.z.min<t.z.min&&(t.z.min=e.z.min),e.x.max>t.x.max&&(t.x.max=e.x.max),e.y.max>t.y.max&&(t.y.max=e.y.max),e.z&&e.z.max>t.z.max&&(t.z.max=e.z.max),t.x.mid=(t.x.min+t.x.max)/2,t.y.mid=(t.y.min+t.y.max)/2,t.z&&(t.z.mid=(t.z.min+t.z.max)/2),t.x.size=t.x.max-t.x.min,t.y.size=t.y.max-t.y.min,t.z&&(t.z.size=t.z.max-t.z.min)},pairiteration:function(t,e,n){var r=t.bbox(),i=e.bbox(),o=1e5,a=n||.5;if(r.x.size+r.y.size<a&&i.x.size+i.y.size<a)return[(o*(t._t1+t._t2)/2|0)/o+"/"+(o*(e._t1+e._t2)/2|0)/o];var s=t.split(.5),l=e.split(.5),c=[{left:s.left,right:l.left},{left:s.left,right:l.right},{left:s.right,right:l.right},{left:s.right,right:l.left}];c=c.filter((function(t){return v.bboxoverlap(t.left.bbox(),t.right.bbox())}));var h=[];return 0===c.length?h:(c.forEach((function(t){h=h.concat(v.pairiteration(t.left,t.right,a))})),h=h.filter((function(t,e){return h.indexOf(t)===e})))},getccenter:function(t,e,n){var o,s=e.x-t.x,l=e.y-t.y,c=n.x-e.x,h=n.y-e.y,p=s*r(f)-l*i(f),d=s*i(f)+l*r(f),g=c*r(f)-h*i(f),m=c*i(f)+h*r(f),y=(t.x+e.x)/2,b=(t.y+e.y)/2,x=(e.x+n.x)/2,w=(e.y+n.y)/2,S=y+p,C=b+d,T=x+g,_=w+m,O=v.lli8(y,b,S,C,x,w,T,_),k=v.dist(O,t),P=a(t.y-O.y,t.x-O.x),E=a(e.y-O.y,e.x-O.x),M=a(n.y-O.y,n.x-O.x);return P<M?((P>E||E>M)&&(P+=u),P>M&&(o=M,M=P,P=o)):M<E&&E<P?(o=M,M=P,P=o):M+=u,O.s=P,O.e=M,O.r=k,O},numberSort:function(t,e){return t-e}};t.exports=v}()},47:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var r=n(65);async function i(t,e,n=!0){let o=[];const{x:a,y:s}=t;for(let n=e.length-1;n>=0;n--){const l=e[n];if(l.visible&&(!l.rect.valid||l.rect.containsCoords(a,s)))if(Object(r.a)(l)){if(l.children.length>0){const e=await i(t,l.children,!1);e.length>0&&(o=e.concat(o),o.push({layer:l,dist:l.rect.coordsToCenter({x:a,y:s})}))}}else l.rect.valid&&l.rect.containsCoords(a,s)&&o.push({layer:l,dist:l.rect.coordsToCenter({x:a,y:s})})}return o.sort((t,e)=>t.dist-e.dist),n&&(o=o.slice(0,7)),o}async function o(t,e){if(t===e)return!0;let n=e.parent;for(;n;){if(n===t)return!0;n=n.parent}return!1}},48:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var r=n(21);function i(t,e="CompositeLayer"){if(0===t.length)return null;return{layers:t,name:e,rect:t.reduce((t,e)=>t.valid&&e.rect.valid?t.combine(e.rect):t.valid?t.clone():e.rect.clone(),t[0].rect.clone()),page:t[0].page,layerType:r.a.composite,visible:!0,style:{}}}function o(t,e="CompositeLayer"){return 1===t.length?t[0]:0===t.length?null:i(t)}},53:function(t,e,n){"use strict";e.byteLength=function(t){var e=c(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){for(var e,n=c(t),r=n[0],a=n[1],s=new o(function(t,e,n){return 3*(e+n)/4-n}(0,r,a)),l=0,h=a>0?r-4:r,u=0;u<h;u+=4)e=i[t.charCodeAt(u)]<<18|i[t.charCodeAt(u+1)]<<12|i[t.charCodeAt(u+2)]<<6|i[t.charCodeAt(u+3)],s[l++]=e>>16&255,s[l++]=e>>8&255,s[l++]=255&e;2===a&&(e=i[t.charCodeAt(u)]<<2|i[t.charCodeAt(u+1)]>>4,s[l++]=255&e);1===a&&(e=i[t.charCodeAt(u)]<<10|i[t.charCodeAt(u+1)]<<4|i[t.charCodeAt(u+2)]>>2,s[l++]=e>>8&255,s[l++]=255&e);return s},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],a=0,s=n-i;a<s;a+=16383)o.push(h(t,a,a+16383>s?s:a+16383));1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=a.length;s<l;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function h(t,e,n){for(var i,o,a=[],s=e;s<n;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},54:function(t,e){e.read=function(t,e,n,r,i){var o,a,s=8*i-r-1,l=(1<<s)-1,c=l>>1,h=-7,u=n?i-1:0,f=n?-1:1,p=t[e+u];for(u+=f,o=p&(1<<-h)-1,p>>=-h,h+=s;h>0;o=256*o+t[e+u],u+=f,h-=8);for(a=o&(1<<-h)-1,o>>=-h,h+=r;h>0;a=256*a+t[e+u],u+=f,h-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),o-=c}return(p?-1:1)*a*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var a,s,l,c=8*o-i-1,h=(1<<c)-1,u=h>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=h):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),(e+=a+u>=1?f/l:f*Math.pow(2,1-u))*l>=2&&(a++,l/=2),a+u>=h?(s=0,a=h):a+u>=1?(s=(e*l-1)*Math.pow(2,i),a+=u):(s=e*Math.pow(2,u-1)*Math.pow(2,i),a=0));i>=8;t[n+p]=255&s,p+=d,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;t[n+p]=255&a,p+=d,a/=256,c-=8);t[n+p-d]|=128*g}},55:function(t,e){t.exports="# replace default config\n\n# multipass: true\n# full: true\n\nplugins:\n\n  # - name\n  #\n  # or:\n  # - name: false\n  # - name: true\n  #\n  # or:\n  # - name:\n  #     param1: 1\n  #     param2: 2\n\n  - removeDoctype\n  - removeXMLProcInst\n  - removeComments\n  - removeMetadata\n  - removeXMLNS\n  - removeEditorsNSData\n  - cleanupAttrs\n  - inlineStyles\n  - minifyStyles\n  - convertStyleToAttrs\n  - cleanupIDs\n  - prefixIds\n  - removeRasterImages\n  - removeUselessDefs\n  - cleanupNumericValues\n  - cleanupListOfValues\n  - convertColors\n  - removeUnknownsAndDefaults\n  - removeNonInheritableGroupAttrs\n  - removeUselessStrokeAndFill\n  - removeViewBox\n  - cleanupEnableBackground\n  - removeHiddenElems\n  - removeEmptyText\n  - convertShapeToPath\n  - moveElemsAttrsToGroup\n  - moveGroupAttrsToElems\n  - collapseGroups\n  - convertPathData\n  - convertTransform\n  - removeEmptyAttrs\n  - removeEmptyContainers\n  - mergePaths\n  - removeUnusedNS\n  - sortAttrs\n  - removeTitle\n  - removeDesc\n  - removeDimensions\n  - removeAttrs\n  - removeAttributesBySelector\n  - removeElementsByAttr\n  - addClassesToSVGElement\n  - removeStyleElement\n  - removeScriptElement\n  - addAttributesToSVGElement\n  - removeOffCanvasPaths\n  - reusePaths\n\n# configure the indent (default 4 spaces) used by `--pretty` here:\n#\n# @see https://github.com/svg/svgo/blob/master/lib/svgo/js2svg.js#L6 for more config options\n#\n# js2svg:\n#  pretty: true\n#  indent: '  '\n"},56:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));class r{constructor(){this.regEvents={}}off(t,e){if(void 0===t)this.regEvents={};else if(void 0===e)delete this.regEvents[t];else if(this.regEvents[t]){const n=this.regEvents[t].indexOf(e);this.regEvents[t].splice(n,1)}}on(t,e){this.regEvents[t]||(this.regEvents[t]=[]),this.regEvents[t]&&this.regEvents[t].push(e)}once(t,e){const n=r=>{setTimeout(()=>{this.off(t,n)}),e(r)};this.on(t,n)}emit(t,e){if(this.regEvents[t])for(const n of this.regEvents[t])n(e)}}},57:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(30),i=n(16);async function o(t,e){const n=Object(r.b)("render");return new Promise(async(r,o)=>{(await n.parseLayer(t)).clone(async t=>{t.setPositionByOrigin(new i.fabric.Point(0,0),"left","top");const o=await n.render(t,e);r(o)})})}},63:function(t,e,n){"use strict";n.r(e),n.d(e,"ColorTool",(function(){return p})),n.d(e,"HandTool",(function(){return o})),n.d(e,"InspectTool",(function(){return l})),n.d(e,"BaseTool",(function(){return r})),n.d(e,"getToolInst",(function(){return d})),n.d(e,"tools",(function(){return v})),n.d(e,"setActiveTool",(function(){return m})),n.d(e,"toggleTool",(function(){return y}));class r{constructor(){this.isClsSVG=!1,this.activated=!1}get renderer(){if(this._renderer)return this._renderer;throw new Error("Renderer is not inited")}setRenderer(t){this.activated?this.deactivate().then(()=>{if(this._renderer=t,this._renderer)return this.activate()}):this._renderer=t}activate(){return this._renderer?this.bindRenderer().then(()=>{this.activated=!0}):Promise.reject(new Error("Renederer is not set. cannot activate"))}deactivate(){return this.unbindRenderer().then(()=>{this.activated=!1})}}var i=n(1);class o extends r{constructor(){super(...arguments),this.name="tool_hand_name",this.slug="tool_hand",this.cls="fas fa-hand-paper",this.mouseDown=!1,this.onMouseDown=t=>{if(t){this.mouseDown=!0;const e=t.e;this.lastPoint={x:e.clientX,y:e.clientY},i.b.dispatch({type:"toolStateHandPanStart"}),e.stopPropagation(),e.preventDefault()}},this.onMouseMove=t=>{if(this.mouseDown&&t){const e=t.e;e.stopPropagation(),e.preventDefault();const n={x:e.clientX,y:e.clientY},r=this.renderer;this.lastPoint&&(r.panX(r.panX()-n.x+this.lastPoint.x),r.panY(r.panY()-n.y+this.lastPoint.y)),this.lastPoint=n}},this.onMouseUpAndLeave=t=>{if(this.mouseDown=!1,this.lastPoint=void 0,i.b.dispatch({type:"toolStateHandPanEnd"}),t){const e=t.e;e.stopPropagation(),e.preventDefault()}}}async bindRenderer(){const t=this.renderer;t.on("mousedown",this.onMouseDown),t.on("mousemove",this.onMouseMove),t.on("mouseup",this.onMouseUpAndLeave),t.on("mouseleave",this.onMouseUpAndLeave)}async unbindRenderer(){const t=this.renderer;t.off("mousedown",this.onMouseDown),t.off("mousemove",this.onMouseMove),t.off("mouseup",this.onMouseUpAndLeave),t.off("mouseleave",this.onMouseUpAndLeave)}}var a=n(48),s=n(47);class l extends r{constructor(){super(...arguments),this.name="tool_inspect_name",this.slug="tool_inspect",this.cls="fas fa-mouse-pointer",this.isClsSVG=!1,this.hoverLayers=[],this.onMouseDown=t=>{const e=this.hoverLayers[0];if(e&&e!==this.compositeChoseLayer){const n=t.e;n.metaKey||n.shiftKey||n.ctrlKey?i.b.dispatch({type:"toolStateToggleChoseLayer",layers:[e]}):i.b.dispatch({type:"toolStateChoseLayer",layers:[e]})}this.hoverLayers.length>0&&i.b.dispatch({type:"toolStateNeabyLayers",layers:this.hoverLayers.concat([])})},this.onMouseMove=async t=>{if(t){const e=this.renderer.rendererPointToRealPoint(this.renderer.mouseEventToCoords(t),!1),n=this.renderer.pageByRealCoords(e);if(n){const t=this.renderer.realPointToPagePoint(e,n),r=(await Object(s.a)(t,await n.getLayers())).map(t=>t.layer);this.renderer.clearDrawing(this.hoverLayerGroup),this.hoverLayers=r,this.drawHoverLayer(),this.prepareDrawMeasure()}else this.renderer.clearDrawing(this.hoverLayerGroup),this.renderer.clearDrawing(this.measureLinesGroup),this.hoverLayers=[]}},this.refreshTimer=void 0,this.refreshDrawing=()=>{this.refreshTimer&&clearTimeout(this.refreshTimer),this.refreshTimer=setTimeout(()=>{this.refreshTimer=void 0,this.renderer.clearDrawing(this.hoverLayerGroup),this.drawHoverLayer(),this.drawCompositeLayer(),this.prepareDrawMeasure()},50)}}get choseLayers(){return i.b.getState().toolState.choseLayers}get compositeChoseLayer(){return Object(a.b)(this.choseLayers)}get hoverLayer(){return this.hoverLayers[0]}get zoomLevel(){return 1}get metricScale(){return i.b.getState().canvasState.metricScale}prepareDrawMeasure(){this.renderer.clearDrawing(this.measureLinesGroup),this.compositeChoseLayer&&this.hoverLayer&&this.compositeChoseLayer!==this.hoverLayer&&this.compositeChoseLayer.page===this.hoverLayer.page&&this.drawMeasurement(this.compositeChoseLayer,this.hoverLayer)}drawMeasurement(t,e){const n=t.rect.panTo(this.renderer.pagePointToRealPoint(t.rect.leftTop,t.page)).zoom(this.zoomLevel),r=e.rect.panTo(this.renderer.pagePointToRealPoint(e.rect.leftTop,t.page)).zoom(this.zoomLevel),i=n.distance(r);for(const t in i)if(i.hasOwnProperty(t)){const e=i[t];if(0===e)continue;const o=t[0],a=t[1],s=Math.round(null!=e?e:0/this.metricScale/this.zoomLevel);switch(o){case"l":case"r":this.drawVLineMeasurements("l"===o?n.left:n.right,n.top,n.bottom,"l"===a?r.left:r.right,r.top,r.bottom,n.left>r.left,s.toString());break;case"t":case"b":this.drawHLineMeasurements("t"===o?n.top:n.bottom,n.left,n.right,"t"===a?r.top:r.bottom,r.left,r.right,n.top>r.top,s.toString())}}}drawMeasureLineOnRenderer(t,e,n){this.renderer.draw(Object.assign(Object.assign({},n),{x1:t.x,y1:t.y,x2:e.x,y2:e.y}),this.measureLinesGroup)}drawMeasureLabelOnRenderer(t){t=Object.assign(Object.assign({},t),{textBackgroundFill:"black",fillColor:"white",fontSize:14,fontWeight:"bold"});var e=this.renderer.measureText(t.txt,t);t.top-=e.height/2,t.left-=e.width/2,this.renderer.draw(t,this.measureLinesGroup)}drawVLineMeasurements(t,e,n,r,i,o,a,s){const l={strokeColor:"orange",strokeDashArray:"5 5",strokeWidth:1},h={strokeColor:"orange",strokeWidth:1};let u=Math.min(e,n,i,o),f=Math.max(e,n,i,o);if(t===r)return void this.drawMeasureLineOnRenderer({x:t,y:u},{x:t,y:f},l);if(a){const a=r;r=t,t=a,u=i,i=e,e=u,f=o,o=n,n=f}e>o&&this.drawMeasureLineOnRenderer({x:t,y:e},{x:t,y:i},l),n<i&&this.drawMeasureLineOnRenderer({x:t,y:n},{x:t,y:o},l);const p=c(e,n,i,o);let d=0;d=p?Math.round((p.s+p.e)/2):Math.round((i+o)/2),this.drawMeasureLineOnRenderer({x:t,y:d},{x:r,y:d},h),this.drawMeasureLabelOnRenderer({left:(t+r)/2,top:d,txt:s})}drawHLineMeasurements(t,e,n,r,i,o,a,s){const l={strokeColor:"orange",strokeDashArray:"5 5",strokeWidth:1},h={strokeColor:"orange",strokeWidth:1};let u=Math.min(e,n,i,o),f=Math.max(e,n,i,o);if(t===r)return void this.drawMeasureLineOnRenderer({x:t,y:u},{x:t,y:f},l);if(a){const a=r;r=t,t=a,u=i,i=e,e=u,f=o,o=n,n=f}e>o&&this.drawMeasureLineOnRenderer({x:e,y:t},{x:i,y:t},l),n<i&&this.drawMeasureLineOnRenderer({x:n,y:t},{x:o,y:t},l);const p=c(e,n,i,o);let d=0;d=p?Math.round((p.s+p.e)/2):Math.round((i+o)/2),this.drawMeasureLineOnRenderer({x:d,y:t},{x:d,y:r},h),this.drawMeasureLabelOnRenderer({left:d,top:(t+r)/2,txt:s})}drawLayer(t,e){if(e){const{layer:n,rect:r,txt:i}=e,o=e.layer.page,a=this.zoomLevel,s=this.renderer.pagePointToRealPoint({x:n.rect.left,y:n.rect.top},o),l=n.rect.zoom(1/this.metricScale),c=`  ${Math.round(l.width)} x ${Math.round(l.height)}    `,h=Object.assign(Object.assign({},r),{left:s.x*a,top:s.y*a,width:n.rect.width*a,height:n.rect.height*a}),u=Object.assign(Object.assign({},e.txt),{fontWeight:"bold",left:s.x*a,top:s.y*a,textBackgroundFill:r.strokeColor,txt:c});this.renderer.draw(h,t),this.renderer.draw(u,t)}else this.renderer.clearDrawing(t)}drawCompositeLayer(){this.drawLayer(this.choseLayerGroup),this.compositeChoseLayer&&this.drawLayer(this.choseLayerGroup,{layer:this.compositeChoseLayer,rect:{fillColor:"rgba(112,0,0,1)".replace("1)","0.2)"),strokeColor:"rgba(112,0,0,1)"},txt:{fontSize:14,fillColor:"white"}})}drawHoverLayer(){this.drawLayer(this.hoverLayerGroup),this.hoverLayer&&this.drawLayer(this.hoverLayerGroup,{layer:this.hoverLayer,rect:{fillColor:"rgba(0, 68, 37,1)".replace("1)","0.2)"),strokeColor:"rgba(0, 68, 37,1)"},txt:{fontSize:14,fillColor:"white"}})}async bindRenderer(){const t=this.renderer;t.on("mousemove",this.onMouseMove),t.on("click",this.onMouseDown),this.hoverLayerGroup=t.getDrawableGroup(),this.choseLayerGroup=t.getDrawableGroup(),this.measureLinesGroup=t.getDrawableGroup(),this.unsubscribe=Object(i.c)([Object(i.a)(t=>t.toolState.choseLayers,this.refreshDrawing),Object(i.a)(t=>t.canvasState.metricScale,this.refreshDrawing),Object(i.a)(t=>t.canvasState.zoomLevel,this.refreshDrawing)])}async unbindRenderer(){const t=this.renderer;t.off("click",this.onMouseDown),t.off("mousemove",this.onMouseMove),t.removeDrawableGroup(this.hoverLayerGroup),t.removeDrawableGroup(this.choseLayerGroup),t.removeDrawableGroup(this.measureLinesGroup),this.hoverLayerGroup=void 0,this.choseLayerGroup=void 0,this.measureLinesGroup=void 0,this.unsubscribe&&this.unsubscribe()}}function c(t,e,n,r){const i=Math.max(t,n),o=Math.min(e,r);return o>=i?{s:i,e:o}:null}var h=n(44),u=n(17),f=n(32);class p extends r{constructor(){super(...arguments),this.name="tool_color_name",this.slug="tool_color",this.cls="fas fa-eye-dropper",this.inited=!1,this.onMouseDown=t=>{this.hoverColor&&(i.b.dispatch({type:"toolStateColorPick",color:this.hoverColor}),Object(h.copyColor)(this.hoverColor))},this.onMouseMove=async t=>{if(t){const e=this.renderer.rendererPointToRealPoint(this.renderer.mouseEventToCoords(t),!1),n=this.renderer.pageByRealCoords(e);if(n){if(this.curPageContext&&this.curPageContext.page!==n&&(this.curPageContext=void 0),!this.curPageContext){const t=n.canvas;this.curPageContext={page:n,pageCanvas:t}}const t=this.renderer.realPointToPagePoint(e,n),r=this.curPageContext.pageCanvas.getContext("2d").getImageData(t.x,t.y,1,1);this.drawColor(r.data[0],r.data[1],r.data[2],t,n),this.hoverColor=`rgb(${r.data[0]}, ${r.data[1]},${r.data[2]})`,i.b.dispatch({type:"toolStateColorHover",color:this.hoverColor})}else this.hoverColor=void 0}}}get zoomLevel(){return i.b.getState().canvasState.zoomLevel}async drawColor(t,e,n,r,i){const o=new u.a(Math.ceil(r.x-100/18),Math.ceil(r.y-100/18),Math.ceil(r.x+100/18),Math.ceil(r.y+100/18)),a=Object(f.f)(Object(f.d)(this.curPageContext.pageCanvas,o),18,!1),s=o.zoom(18),l=this.renderer.pagePointToRealPoint(r,i),c=l.x,h=l.y,p={circle:{radius:100,left:-100,top:-100}};this.inited?(this.renderer.updateDraw(this.colorBand,{radius:123,left:c+0,top:h+0,fillColor:`rgb(${t},${e},${n})`}),this.renderer.updateDraw(this.roundEdge,{radius:103,left:c+20,top:h+20,fillColor:"#d1d1d1"}),this.renderer.updateDraw(this.magImg,{img:{src:a,width:s.width,height:s.height},left:c+23,top:h+23,clip:p})):(this.colorBand=this.renderer.draw({radius:123,left:c+0,top:h+0,fillColor:`rgb(${t},${e},${n})`},this.colorGroup),this.roundEdge=this.renderer.draw({radius:103,left:c+20,top:h+20,fillColor:"#d1d1d1"},this.colorGroup),this.magImg=this.renderer.draw({img:{src:a,width:s.width,height:s.height},left:c+23,top:h+23,clip:p},this.colorGroup),this.inited=!0)}async bindRenderer(){const t=this.renderer;this.colorGroup=t.getDrawableGroup(),t.on("mousemove",this.onMouseMove),t.on("click",this.onMouseDown)}async unbindRenderer(){const t=this.renderer;t.off("click",this.onMouseDown),t.off("mousemove",this.onMouseMove),t.removeDrawableGroup(this.colorGroup),this.inited=!1}}function d(t){return g().find(e=>e instanceof t)}function g(){let t=[];return Object.keys(v).forEach(e=>{t=t.concat(v[e])}),t}const v={inspect:[new l,new p],general:[new o],prototype:[]};async function m(t){const e=i.b.getState().toolState.curTool;e!==t&&(e&&await e.deactivate(),t&&await t.activate(),i.b.dispatch({type:"toolStateChooseTool",tool:t}))}async function y(t){t.activated?await t.deactivate():await t.activate()}Object(i.a)(t=>t.canvasState.renderer,t=>{if(g().forEach(e=>{e.setRenderer(t)}),t){m(v.inspect[0]);const t=d(o);t&&y(t)}})},64:function(t,e,n){"use strict";n.d(e,"e",(function(){return l})),n.d(e,"a",(function(){return c})),n.d(e,"d",(function(){return h})),n.d(e,"g",(function(){return u})),n.d(e,"f",(function(){return f})),n.d(e,"b",(function(){return p})),n.d(e,"c",(function(){return d}));var r=n(57),i=n(20),o=n(100),a=n(32),s=n(30);function l(t){const e=a.a.concat([]);return e.push("image/svg"),e}async function c(t,e){let n=await Object(r.a)(t,e.scale);return e.trim&&(n=Object(o.b)(n)),Object(a.c)(n)}function h(t,e){return e&&"image/svg"!==e.format?`${t.name}@${e.scale}X.${e.format.replace("image/","")}`:`${t.name}.svg`}async function u(t,e,r){const i=new(0,(await n.e(15).then(n.t.bind(null,207,7))).default);for(let n=0;n<e.length;n++){const o=e[n],a=r[n],s=await f(t,a);i.file(o,s,{binary:!0})}return i.generateAsync({type:"blob"})}async function f(t,e){if("image/svg"===e.format){const r=Object(s.b)("render");let i=await r.toSvg(t,e.scale);if(e.optimize){const{optimizeSvg:t}=await Promise.resolve().then(n.bind(null,28));i=await t(i)}return new Blob([i],{type:"image/svg+xml"})}{const{optimizeJpg:i,optimizePng:s}=await Promise.resolve().then(n.bind(null,28));let l=await Object(r.a)(t,e.scale);e.trim&&(l=Object(o.b)(l));let c=null;const u=h(t,e);if(e.optimize&&"image/png"===e.format){const t=l.getContext("2d");c=await s(t.getImageData(0,0,l.width,l.height).data,l.width,l.height)}return c||(c=await Object(a.b)(l,u,e.format,100),e.optimize&&"image/jpeg"===e.format&&(c=await i(c))),c}}async function p(t,e,s){const{optimizeJpg:l,optimizePng:c}=await Promise.resolve().then(n.bind(null,28));if(Object(i.a)("export"),"image/svg"===s.format)return d(t,e,s.optimize);{let n=await Object(r.a)(t,s.scale);s.trim&&(n=Object(o.b)(n));let i=null;const u=h(t,s);if(s.optimize&&"image/png"===s.format){const t=n.getContext("2d");i=await c(t.getImageData(0,0,n.width,n.height).data,n.width,n.height)}return i||(i=await Object(a.b)(n,u,s.format,100),s.optimize&&"image/jpeg"===s.format&&(i=await l(i))),e.exportBlob(i,u)}}async function d(t,e,r){const i=Object(s.b)("render");let o=await i.toSvg(t);if(r){const{optimizeSvg:t}=await Promise.resolve().then(n.bind(null,28));o=await t(o)}return e.exportBlob(new Blob([o],{type:"image/svg+xml"}),h(t))}},65:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o}));var r=n(21);function i(t){return t.layerType===r.a.text}function o(t){return t.layerType===r.a.folder}},74:function(t,e,n){"use strict";n.d(e,"a",(function(){return k}));var r=n(75);const i=n(76),o=n(77),a=n(78),s=n(79),l=n(80),c=n(81),h=n(82),u=n(83),f=n(84),p=n(85),d=n(86),g=n(87),v=n(88),m=n(89),y=n(90),b=n(91),x=n(92);var w=n(93),S=n.n(w),C=n(27),T=n(20);const _=["roboto-regular","roboto-italic","roboto-bold","roboto-bolditalic","roboto-black","roboto-blackitalic","roboto-light","roboto-lightitalic","roboto-medium","roboto-mediumitalic","roboto-thin","roboto-thinitalic","droidserif-regular","droidserif-bold","droidserif-italic","droidserif-bolditalic","fontawesome-regular"].concat([]),O={"roboto-regular":i,"roboto-italic":o,"roboto-bold":l,"roboto-bolditalic":c,"roboto-black":a,"roboto-blackitalic":s,"roboto-light":h,"roboto-lightitalic":u,"roboto-medium":f,"roboto-mediumitalic":p,"roboto-thin":d,"roboto-thinitalic":g,"droidserif-regular":b,"droidserif-bold":v,"droidserif-italic":y,"droidserif-bolditalic":m,"fontawesome-regular":x};const k=new class{constructor(){this.builtInFonts=_.concat([]),this.fontCache={},this.missedFont=[],this.fontUrls={},this.domFontMap={}}get fontMap(){const t=localStorage.getItem("psdetch-fonts");return t?JSON.parse(t):{}}existsLocalOrBuiltIn(t){return this.existsLocal(t)||this.builtInFonts.indexOf(t.toLowerCase())>-1}existsLocal(t){return!!this.fontMap[t.toLowerCase()]}async loadFont(t){let e=t.name;if(e=e.toLowerCase(),this.builtInFonts.indexOf(e)>-1)return this.loadBuiltInFont(e);if(this.existsLocal(e)){return console.log(`Load Font from local: ${e}`),await this.loadLocalFont(e)}{const n=this.mapFontMetaToName(t);return-1===this.missedFont.indexOf(e)&&(console.log(`Font not exists: ${e}. Swap with built in fonts: ${n}`),this.missedFont.push(e)),this.loadBuiltInFont(n)}}metaToWeight(t){return t.bold?"700":t.black?"900":t.light?"300":t.medium?"500":t.thin?"100":"400"}async loadDefaultDomFont(){await this.loadFontCSS("Roboto"),await this.loadFontCSS("Droid Serif")}async loadFontCSS(t){await async function(t){return new Promise((e,n)=>{var r=document.createElement("link");r.setAttribute("rel","stylesheet"),r.onload=()=>e(),r.onerror=()=>n(),r.setAttribute("href",t),document.getElementsByTagName("head")[0].appendChild(r)})}(`https://fonts.googleapis.com/css2?family=${t}:wght@200;300;400;600;700;900&display=swap`)}toGoogleFontName(t){const e=(t=(t=t.replace(/\-/g," ")).replace(/\_/g," ")).split(" ");return t=e.map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}checkSystemFont(t){try{return document.fonts.check(`12px ${t}`)}catch(t){return Object(T.b)(t.message,"fontLib"),!1}}async loadFontDOM(t){const e=t.name;if(this.domFontMap[e])return this.domFontMap[e];if(this.checkSystemFont(e))return C.a.i(`Built-in Font loaded: ${e}`),this.domFontMap[e]=e,e;{const n=this.toGoogleFontName(e);try{await this.loadFontCSS(n);const r=new S.a(n,{weight:this.metaToWeight(t)});return await r.load(),C.a.i(`Font loaded: ${e}`),this.domFontMap[e]=n,n}catch(t){return this.domFontMap[e]=-1!==e.toLowerCase().indexOf("serif")?"Droid Serif":"Roboto",C.a.w(`Font load failed: ${e} use alternative font: ${this.domFontMap[e]}`),this.domFontMap[e]}}}async loadLocalFont(t){throw new Error("not yet implemented")}async loadBuiltInFont(t){if(this.fontCache[t])return this.fontCache[t];if(this.builtInFonts.indexOf(t)>-1){const e=await fetch(O[t]),n=await e.arrayBuffer();return this.fontCache[t]=n,n}return Promise.reject(`font: ${t} is not built in font`)}realFontName(t){return this.existsLocal(t)?t:this.fontNameMap(t)}inferFontMeta(t){return{name:t=t.toLowerCase(),italic:-1!==t.indexOf("italic")||-1!==t.indexOf("oblique")||t.endsWith("-it"),bold:-1!==t.indexOf("bold")&&-1===t.indexOf("semibold"),black:-1!==t.indexOf("black"),light:-1!==t.indexOf("light"),thin:-1!==t.indexOf("thin"),medium:-1!==t.indexOf("medium")||-1!==t.indexOf("semibold")}}mapFontMetaToName(t){const e=t.name.toLowerCase();let n="";const r=this.builtInFonts.find(t=>e.indexOf(t.split("-")[0])>-1);n=r?r.split("-")[0]:-1!==e.indexOf("serif")?"droidserif":"roboto";let i="";for(const e in t)if("name"!==e&&"italic"!==e&&t[e]){i=t.italic?e+"italic":e;break}let o=n+"-"+i;return-1===_.indexOf(o)&&(o=n+"-regular"),o}async loadOpenTypeFont(t){const e=await this.loadFont(t);return r.a.parse(e)}fontNameMap(t){const e=t.toLowerCase();let n="";const r=this.builtInFonts.find(t=>e.indexOf(t.split("-")[0])>-1);n=r?r.split("-")[0]:-1!==e.indexOf("serif")?"droidserif":"roboto";const i=this.inferFontMeta(t);let o="";for(const t in i)if("name"!==t&&"italic"!==t&&i[t]){o=i.italic?t+"italic":t;break}let a=n+"-"+o;return-1===_.indexOf(a)&&(a=n+"-regular"),a}};k.loadDefaultDomFont()},75:function(t,e,n){"use strict";(function(t){var r,i;
/*! https://mths.be/codepointat v0.2.0 by @mathias */
String.prototype.codePointAt||(r=function(){try{var t={},e=Object.defineProperty,n=e(t,t,t)&&e}catch(t){}return n}(),i=function(t){if(null==this)throw TypeError();var e=String(this),n=e.length,r=t?Number(t):0;if(r!=r&&(r=0),!(r<0||r>=n)){var i,o=e.charCodeAt(r);return o>=55296&&o<=56319&&n>r+1&&(i=e.charCodeAt(r+1))>=56320&&i<=57343?1024*(o-55296)+i-56320+65536:o}},r?r(String.prototype,"codePointAt",{value:i,configurable:!0,writable:!0}):String.prototype.codePointAt=i);function o(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function a(t,e){this.source=t,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=e,this.destLen=0,this.ltree=new o,this.dtree=new o}var s=new o,l=new o,c=new Uint8Array(30),h=new Uint16Array(30),u=new Uint8Array(30),f=new Uint16Array(30),p=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),d=new o,g=new Uint8Array(320);function v(t,e,n,r){var i,o;for(i=0;i<n;++i)t[i]=0;for(i=0;i<30-n;++i)t[i+n]=i/n|0;for(o=r,i=0;i<30;++i)e[i]=o,o+=1<<t[i]}var m=new Uint16Array(16);function y(t,e,n,r){var i,o;for(i=0;i<16;++i)t.table[i]=0;for(i=0;i<r;++i)t.table[e[n+i]]++;for(t.table[0]=0,o=0,i=0;i<16;++i)m[i]=o,o+=t.table[i];for(i=0;i<r;++i)e[n+i]&&(t.trans[m[e[n+i]]++]=i)}function b(t){t.bitcount--||(t.tag=t.source[t.sourceIndex++],t.bitcount=7);var e=1&t.tag;return t.tag>>>=1,e}function x(t,e,n){if(!e)return n;for(;t.bitcount<24;)t.tag|=t.source[t.sourceIndex++]<<t.bitcount,t.bitcount+=8;var r=t.tag&65535>>>16-e;return t.tag>>>=e,t.bitcount-=e,r+n}function w(t,e){for(;t.bitcount<24;)t.tag|=t.source[t.sourceIndex++]<<t.bitcount,t.bitcount+=8;var n=0,r=0,i=0,o=t.tag;do{r=2*r+(1&o),o>>>=1,++i,n+=e.table[i],r-=e.table[i]}while(r>=0);return t.tag=o,t.bitcount-=i,e.trans[n+r]}function S(t,e,n){var r,i,o,a,s,l;for(r=x(t,5,257),i=x(t,5,1),o=x(t,4,4),a=0;a<19;++a)g[a]=0;for(a=0;a<o;++a){var c=x(t,3,0);g[p[a]]=c}for(y(d,g,0,19),s=0;s<r+i;){var h=w(t,d);switch(h){case 16:var u=g[s-1];for(l=x(t,2,3);l;--l)g[s++]=u;break;case 17:for(l=x(t,3,3);l;--l)g[s++]=0;break;case 18:for(l=x(t,7,11);l;--l)g[s++]=0;break;default:g[s++]=h}}y(e,g,0,r),y(n,g,r,i)}function C(t,e,n){for(;;){var r,i,o,a,s=w(t,e);if(256===s)return 0;if(s<256)t.dest[t.destLen++]=s;else for(r=x(t,c[s-=257],h[s]),i=w(t,n),a=o=t.destLen-x(t,u[i],f[i]);a<o+r;++a)t.dest[t.destLen++]=t.dest[a]}}function T(t){for(var e,n;t.bitcount>8;)t.sourceIndex--,t.bitcount-=8;if((e=256*(e=t.source[t.sourceIndex+1])+t.source[t.sourceIndex])!==(65535&~(256*t.source[t.sourceIndex+3]+t.source[t.sourceIndex+2])))return-3;for(t.sourceIndex+=4,n=e;n;--n)t.dest[t.destLen++]=t.source[t.sourceIndex++];return t.bitcount=0,0}!function(t,e){var n;for(n=0;n<7;++n)t.table[n]=0;for(t.table[7]=24,t.table[8]=152,t.table[9]=112,n=0;n<24;++n)t.trans[n]=256+n;for(n=0;n<144;++n)t.trans[24+n]=n;for(n=0;n<8;++n)t.trans[168+n]=280+n;for(n=0;n<112;++n)t.trans[176+n]=144+n;for(n=0;n<5;++n)e.table[n]=0;for(e.table[5]=32,n=0;n<32;++n)e.trans[n]=n}(s,l),v(c,h,4,3),v(u,f,2,1),c[28]=0,h[28]=258;var _=function(t,e){var n,r,i=new a(t,e);do{switch(n=b(i),x(i,2,0)){case 0:r=T(i);break;case 1:r=C(i,s,l);break;case 2:S(i,i.ltree,i.dtree),r=C(i,i.ltree,i.dtree);break;default:r=-3}if(0!==r)throw new Error("Data error")}while(!n);return i.destLen<i.dest.length?"function"==typeof i.dest.slice?i.dest.slice(0,i.destLen):i.dest.subarray(0,i.destLen):i.dest};function O(t,e,n,r,i){return Math.pow(1-i,3)*t+3*Math.pow(1-i,2)*i*e+3*(1-i)*Math.pow(i,2)*n+Math.pow(i,3)*r}function k(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}function P(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}function E(t){throw new Error(t)}function M(t,e){t||E(e)}k.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)},k.prototype.addPoint=function(t,e){"number"==typeof t&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),"number"==typeof e&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))},k.prototype.addX=function(t){this.addPoint(t,null)},k.prototype.addY=function(t){this.addPoint(null,t)},k.prototype.addBezier=function(t,e,n,r,i,o,a,s){var l=[t,e],c=[n,r],h=[i,o],u=[a,s];this.addPoint(t,e),this.addPoint(a,s);for(var f=0;f<=1;f++){var p=6*l[f]-12*c[f]+6*h[f],d=-3*l[f]+9*c[f]-9*h[f]+3*u[f],g=3*c[f]-3*l[f];if(0!==d){var v=Math.pow(p,2)-4*g*d;if(!(v<0)){var m=(-p+Math.sqrt(v))/(2*d);0<m&&m<1&&(0===f&&this.addX(O(l[f],c[f],h[f],u[f],m)),1===f&&this.addY(O(l[f],c[f],h[f],u[f],m)));var y=(-p-Math.sqrt(v))/(2*d);0<y&&y<1&&(0===f&&this.addX(O(l[f],c[f],h[f],u[f],y)),1===f&&this.addY(O(l[f],c[f],h[f],u[f],y)))}}else{if(0===p)continue;var b=-g/p;0<b&&b<1&&(0===f&&this.addX(O(l[f],c[f],h[f],u[f],b)),1===f&&this.addY(O(l[f],c[f],h[f],u[f],b)))}}},k.prototype.addQuad=function(t,e,n,r,i,o){var a=t+2/3*(n-t),s=e+2/3*(r-e),l=a+1/3*(i-t),c=s+1/3*(o-e);this.addBezier(t,e,a,s,l,c,i,o)},P.prototype.moveTo=function(t,e){this.commands.push({type:"M",x:t,y:e})},P.prototype.lineTo=function(t,e){this.commands.push({type:"L",x:t,y:e})},P.prototype.curveTo=P.prototype.bezierCurveTo=function(t,e,n,r,i,o){this.commands.push({type:"C",x1:t,y1:e,x2:n,y2:r,x:i,y:o})},P.prototype.quadTo=P.prototype.quadraticCurveTo=function(t,e,n,r){this.commands.push({type:"Q",x1:t,y1:e,x:n,y:r})},P.prototype.close=P.prototype.closePath=function(){this.commands.push({type:"Z"})},P.prototype.extend=function(t){if(t.commands)t=t.commands;else if(t instanceof k){var e=t;return this.moveTo(e.x1,e.y1),this.lineTo(e.x2,e.y1),this.lineTo(e.x2,e.y2),this.lineTo(e.x1,e.y2),void this.close()}Array.prototype.push.apply(this.commands,t)},P.prototype.getBoundingBox=function(){for(var t=new k,e=0,n=0,r=0,i=0,o=0;o<this.commands.length;o++){var a=this.commands[o];switch(a.type){case"M":t.addPoint(a.x,a.y),e=r=a.x,n=i=a.y;break;case"L":t.addPoint(a.x,a.y),r=a.x,i=a.y;break;case"Q":t.addQuad(r,i,a.x1,a.y1,a.x,a.y),r=a.x,i=a.y;break;case"C":t.addBezier(r,i,a.x1,a.y1,a.x2,a.y2,a.x,a.y),r=a.x,i=a.y;break;case"Z":r=e,i=n;break;default:throw new Error("Unexpected path command "+a.type)}}return t.isEmpty()&&t.addPoint(0,0),t},P.prototype.draw=function(t){t.beginPath();for(var e=0;e<this.commands.length;e+=1){var n=this.commands[e];"M"===n.type?t.moveTo(n.x,n.y):"L"===n.type?t.lineTo(n.x,n.y):"C"===n.type?t.bezierCurveTo(n.x1,n.y1,n.x2,n.y2,n.x,n.y):"Q"===n.type?t.quadraticCurveTo(n.x1,n.y1,n.x,n.y):"Z"===n.type&&t.closePath()}this.fill&&(t.fillStyle=this.fill,t.fill()),this.stroke&&(t.strokeStyle=this.stroke,t.lineWidth=this.strokeWidth,t.stroke())},P.prototype.toPathData=function(t){function e(e){return Math.round(e)===e?""+Math.round(e):e.toFixed(t)}function n(){for(var t=arguments,n="",r=0;r<arguments.length;r+=1){var i=t[r];i>=0&&r>0&&(n+=" "),n+=e(i)}return n}t=void 0!==t?t:2;for(var r="",i=0;i<this.commands.length;i+=1){var o=this.commands[i];"M"===o.type?r+="M"+n(o.x,o.y):"L"===o.type?r+="L"+n(o.x,o.y):"C"===o.type?r+="C"+n(o.x1,o.y1,o.x2,o.y2,o.x,o.y):"Q"===o.type?r+="Q"+n(o.x1,o.y1,o.x,o.y):"Z"===o.type&&(r+="Z")}return r},P.prototype.toSVG=function(t){var e='<path d="';return e+=this.toPathData(t),e+='"',this.fill&&"black"!==this.fill&&(null===this.fill?e+=' fill="none"':e+=' fill="'+this.fill+'"'),this.stroke&&(e+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),e+="/>"},P.prototype.toDOMElement=function(t){var e=this.toPathData(t),n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d",e),n};var A={fail:E,argument:M,assert:M},L={},D={},I={};function R(t){return function(){return t}}D.BYTE=function(t){return A.argument(t>=0&&t<=255,"Byte value should be between 0 and 255."),[t]},I.BYTE=R(1),D.CHAR=function(t){return[t.charCodeAt(0)]},I.CHAR=R(1),D.CHARARRAY=function(t){void 0===t&&(t="",console.warn("Undefined CHARARRAY encountered and treated as an empty string. This is probably caused by a missing glyph name."));for(var e=[],n=0;n<t.length;n+=1)e[n]=t.charCodeAt(n);return e},I.CHARARRAY=function(t){return void 0===t?0:t.length},D.USHORT=function(t){return[t>>8&255,255&t]},I.USHORT=R(2),D.SHORT=function(t){return t>=32768&&(t=-(65536-t)),[t>>8&255,255&t]},I.SHORT=R(2),D.UINT24=function(t){return[t>>16&255,t>>8&255,255&t]},I.UINT24=R(3),D.ULONG=function(t){return[t>>24&255,t>>16&255,t>>8&255,255&t]},I.ULONG=R(4),D.LONG=function(t){return t>=2147483648&&(t=-(4294967296-t)),[t>>24&255,t>>16&255,t>>8&255,255&t]},I.LONG=R(4),D.FIXED=D.ULONG,I.FIXED=I.ULONG,D.FWORD=D.SHORT,I.FWORD=I.SHORT,D.UFWORD=D.USHORT,I.UFWORD=I.USHORT,D.LONGDATETIME=function(t){return[0,0,0,0,t>>24&255,t>>16&255,t>>8&255,255&t]},I.LONGDATETIME=R(8),D.TAG=function(t){return A.argument(4===t.length,"Tag should be exactly 4 ASCII characters."),[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]},I.TAG=R(4),D.Card8=D.BYTE,I.Card8=I.BYTE,D.Card16=D.USHORT,I.Card16=I.USHORT,D.OffSize=D.BYTE,I.OffSize=I.BYTE,D.SID=D.USHORT,I.SID=I.USHORT,D.NUMBER=function(t){return t>=-107&&t<=107?[t+139]:t>=108&&t<=1131?[247+((t-=108)>>8),255&t]:t>=-1131&&t<=-108?[251+((t=-t-108)>>8),255&t]:t>=-32768&&t<=32767?D.NUMBER16(t):D.NUMBER32(t)},I.NUMBER=function(t){return D.NUMBER(t).length},D.NUMBER16=function(t){return[28,t>>8&255,255&t]},I.NUMBER16=R(3),D.NUMBER32=function(t){return[29,t>>24&255,t>>16&255,t>>8&255,255&t]},I.NUMBER32=R(5),D.REAL=function(t){var e=t.toString(),n=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(e);if(n){var r=parseFloat("1e"+((n[2]?+n[2]:0)+n[1].length));e=(Math.round(t*r)/r).toString()}for(var i="",o=0,a=e.length;o<a;o+=1){var s=e[o];i+="e"===s?"-"===e[++o]?"c":"b":"."===s?"a":"-"===s?"e":s}for(var l=[30],c=0,h=(i+=1&i.length?"f":"ff").length;c<h;c+=2)l.push(parseInt(i.substr(c,2),16));return l},I.REAL=function(t){return D.REAL(t).length},D.NAME=D.CHARARRAY,I.NAME=I.CHARARRAY,D.STRING=D.CHARARRAY,I.STRING=I.CHARARRAY,L.UTF8=function(t,e,n){for(var r=[],i=n,o=0;o<i;o++,e+=1)r[o]=t.getUint8(e);return String.fromCharCode.apply(null,r)},L.UTF16=function(t,e,n){for(var r=[],i=n/2,o=0;o<i;o++,e+=2)r[o]=t.getUint16(e);return String.fromCharCode.apply(null,r)},D.UTF16=function(t){for(var e=[],n=0;n<t.length;n+=1){var r=t.charCodeAt(n);e[e.length]=r>>8&255,e[e.length]=255&r}return e},I.UTF16=function(t){return 2*t.length};var j={"x-mac-croatian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®Š™´¨≠ŽØ∞±≤≥∆µ∂∑∏š∫ªºΩžø¿¡¬√ƒ≈Ć«Č… ÀÃÕŒœĐ—“”‘’÷◊©⁄€‹›Æ»–·‚„‰ÂćÁčÈÍÎÏÌÓÔđÒÚÛÙıˆ˜¯πË˚¸Êæˇ","x-mac-cyrillic":"АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ†°Ґ£§•¶І®©™Ђђ≠Ѓѓ∞±≤≥іµґЈЄєЇїЉљЊњјЅ¬√ƒ≈∆«»… ЋћЌќѕ–—“”‘’÷„ЎўЏџ№Ёёяабвгдежзийклмнопрстуфхцчшщъыьэю","x-mac-gaelic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØḂ±≤≥ḃĊċḊḋḞḟĠġṀæøṁṖṗɼƒſṠ«»… ÀÃÕŒœ–—“”‘’ṡẛÿŸṪ€‹›Ŷŷṫ·Ỳỳ⁊ÂÊÁËÈÍÎÏÌÓÔ♣ÒÚÛÙıÝýŴŵẄẅẀẁẂẃ","x-mac-greek":"Ä¹²É³ÖÜ΅àâä΄¨çéèêë£™îï•½‰ôö¦€ùûü†ΓΔΘΛΞΠß®©ΣΪ§≠°·Α±≤≥¥ΒΕΖΗΙΚΜΦΫΨΩάΝ¬ΟΡ≈Τ«»… ΥΧΆΈœ–―“”‘’÷ΉΊΌΎέήίόΏύαβψδεφγηιξκλμνοπώρστθωςχυζϊϋΐΰ­","x-mac-icelandic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûüÝ°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€ÐðÞþý·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-inuit":"ᐃᐄᐅᐆᐊᐋᐱᐲᐳᐴᐸᐹᑉᑎᑏᑐᑑᑕᑖᑦᑭᑮᑯᑰᑲᑳᒃᒋᒌᒍᒎᒐᒑ°ᒡᒥᒦ•¶ᒧ®©™ᒨᒪᒫᒻᓂᓃᓄᓅᓇᓈᓐᓯᓰᓱᓲᓴᓵᔅᓕᓖᓗᓘᓚᓛᓪᔨᔩᔪᔫᔭ… ᔮᔾᕕᕖᕗ–—“”‘’ᕘᕙᕚᕝᕆᕇᕈᕉᕋᕌᕐᕿᖀᖁᖂᖃᖄᖅᖏᖐᖑᖒᖓᖔᖕᙱᙲᙳᙴᙵᙶᖖᖠᖡᖢᖣᖤᖥᖦᕼŁł","x-mac-ce":"ÄĀāÉĄÖÜáąČäčĆćéŹźĎíďĒēĖóėôöõúĚěü†°Ę£§•¶ß®©™ę¨≠ģĮįĪ≤≥īĶ∂∑łĻļĽľĹĺŅņŃ¬√ńŇ∆«»… ňŐÕőŌ–—“”‘’÷◊ōŔŕŘ‹›řŖŗŠ‚„šŚśÁŤťÍŽžŪÓÔūŮÚůŰűŲųÝýķŻŁżĢˇ",macintosh:"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›ﬁﬂ‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-romanian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ĂȘ∞±≤≥¥µ∂∑∏π∫ªºΩăș¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›Țț‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-turkish":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸĞğİıŞş‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙˆ˜¯˘˙˚¸˝˛ˇ"};L.MACSTRING=function(t,e,n,r){var i=j[r];if(void 0!==i){for(var o="",a=0;a<n;a++){var s=t.getUint8(e+a);o+=s<=127?String.fromCharCode(s):i[127&s]}return o}};var B,F="function"==typeof WeakMap&&new WeakMap;function U(t){return t>=-128&&t<=127}function z(t,e,n){for(var r=0,i=t.length;e<i&&r<64&&0===t[e];)++e,++r;return n.push(128|r-1),e}function G(t,e,n){for(var r=0,i=t.length,o=e;o<i&&r<64;){var a=t[o];if(!U(a))break;if(0===a&&o+1<i&&0===t[o+1])break;++o,++r}n.push(r-1);for(var s=e;s<o;++s)n.push(t[s]+256&255);return o}function N(t,e,n){for(var r=0,i=t.length,o=e;o<i&&r<64;){var a=t[o];if(0===a)break;if(U(a)&&o+1<i&&U(t[o+1]))break;++o,++r}n.push(64|r-1);for(var s=e;s<o;++s){var l=t[s];n.push(l+65536>>8&255,l+256&255)}return o}D.MACSTRING=function(t,e){var n=function(t){if(!B)for(var e in B={},j)B[e]=new String(e);var n=B[t];if(void 0!==n){if(F){var r=F.get(n);if(void 0!==r)return r}var i=j[t];if(void 0!==i){for(var o={},a=0;a<i.length;a++)o[i.charCodeAt(a)]=a+128;return F&&F.set(n,o),o}}}(e);if(void 0!==n){for(var r=[],i=0;i<t.length;i++){var o=t.charCodeAt(i);if(o>=128&&void 0===(o=n[o]))return;r[i]=o}return r}},I.MACSTRING=function(t,e){var n=D.MACSTRING(t,e);return void 0!==n?n.length:0},D.VARDELTAS=function(t){for(var e=0,n=[];e<t.length;){var r=t[e];e=0===r?z(t,e,n):r>=-128&&r<=127?G(t,e,n):N(t,e,n)}return n},D.INDEX=function(t){for(var e=1,n=[e],r=[],i=0;i<t.length;i+=1){var o=D.OBJECT(t[i]);Array.prototype.push.apply(r,o),e+=o.length,n.push(e)}if(0===r.length)return[0,0];for(var a=[],s=1+Math.floor(Math.log(e)/Math.log(2))/8|0,l=[void 0,D.BYTE,D.USHORT,D.UINT24,D.ULONG][s],c=0;c<n.length;c+=1){var h=l(n[c]);Array.prototype.push.apply(a,h)}return Array.prototype.concat(D.Card16(t.length),D.OffSize(s),a,r)},I.INDEX=function(t){return D.INDEX(t).length},D.DICT=function(t){for(var e=[],n=Object.keys(t),r=n.length,i=0;i<r;i+=1){var o=parseInt(n[i],0),a=t[o];e=(e=e.concat(D.OPERAND(a.value,a.type))).concat(D.OPERATOR(o))}return e},I.DICT=function(t){return D.DICT(t).length},D.OPERATOR=function(t){return t<1200?[t]:[12,t-1200]},D.OPERAND=function(t,e){var n=[];if(Array.isArray(e))for(var r=0;r<e.length;r+=1)A.argument(t.length===e.length,"Not enough arguments given for type"+e),n=n.concat(D.OPERAND(t[r],e[r]));else if("SID"===e)n=n.concat(D.NUMBER(t));else if("offset"===e)n=n.concat(D.NUMBER32(t));else if("number"===e)n=n.concat(D.NUMBER(t));else{if("real"!==e)throw new Error("Unknown operand type "+e);n=n.concat(D.REAL(t))}return n},D.OP=D.BYTE,I.OP=I.BYTE;var H="function"==typeof WeakMap&&new WeakMap;function X(t,e,n){if(e.length&&("coverageFormat"!==e[0].name||1===e[0].value))for(var r=0;r<e.length;r+=1){var i=e[r];this[i.name]=i.value}if(this.tableName=t,this.fields=e,n)for(var o=Object.keys(n),a=0;a<o.length;a+=1){var s=o[a],l=n[s];void 0!==this[s]&&(this[s]=l)}}function W(t,e,n){void 0===n&&(n=e.length);var r=new Array(e.length+1);r[0]={name:t+"Count",type:"USHORT",value:n};for(var i=0;i<e.length;i++)r[i+1]={name:t+i,type:"USHORT",value:e[i]};return r}function Y(t,e,n){var r=e.length,i=new Array(r+1);i[0]={name:t+"Count",type:"USHORT",value:r};for(var o=0;o<r;o++)i[o+1]={name:t+o,type:"TABLE",value:n(e[o],o)};return i}function V(t,e,n){var r=e.length,i=[];i[0]={name:t+"Count",type:"USHORT",value:r};for(var o=0;o<r;o++)i=i.concat(n(e[o],o));return i}function q(t){1===t.format?X.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(W("glyph",t.glyphs))):2===t.format?X.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:2}].concat(V("rangeRecord",t.ranges,(function(t){return[{name:"startGlyphID",type:"USHORT",value:t.start},{name:"endGlyphID",type:"USHORT",value:t.end},{name:"startCoverageIndex",type:"USHORT",value:t.index}]})))):A.assert(!1,"Coverage format must be 1 or 2.")}function J(t){X.call(this,"scriptListTable",V("scriptRecord",t,(function(t,e){var n=t.script,r=n.defaultLangSys;return A.assert(!!r,"Unable to write GSUB: script "+t.tag+" has no default language system."),[{name:"scriptTag"+e,type:"TAG",value:t.tag},{name:"script"+e,type:"TABLE",value:new X("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new X("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:r.reqFeatureIndex}].concat(W("featureIndex",r.featureIndexes)))}].concat(V("langSys",n.langSysRecords,(function(t,e){var n=t.langSys;return[{name:"langSysTag"+e,type:"TAG",value:t.tag},{name:"langSys"+e,type:"TABLE",value:new X("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:n.reqFeatureIndex}].concat(W("featureIndex",n.featureIndexes)))}]}))))}]})))}function K(t){X.call(this,"featureListTable",V("featureRecord",t,(function(t,e){var n=t.feature;return[{name:"featureTag"+e,type:"TAG",value:t.tag},{name:"feature"+e,type:"TABLE",value:new X("featureTable",[{name:"featureParams",type:"USHORT",value:n.featureParams}].concat(W("lookupListIndex",n.lookupListIndexes)))}]})))}function Z(t,e){X.call(this,"lookupListTable",Y("lookup",t,(function(t){var n=e[t.lookupType];return A.assert(!!n,"Unable to write GSUB lookup type "+t.lookupType+" tables."),new X("lookupTable",[{name:"lookupType",type:"USHORT",value:t.lookupType},{name:"lookupFlag",type:"USHORT",value:t.lookupFlag}].concat(Y("subtable",t.subtables,n)))})))}D.CHARSTRING=function(t){if(H){var e=H.get(t);if(void 0!==e)return e}for(var n=[],r=t.length,i=0;i<r;i+=1){var o=t[i];n=n.concat(D[o.type](o.value))}return H&&H.set(t,n),n},I.CHARSTRING=function(t){return D.CHARSTRING(t).length},D.OBJECT=function(t){var e=D[t.type];return A.argument(void 0!==e,"No encoding function for type "+t.type),e(t.value)},I.OBJECT=function(t){var e=I[t.type];return A.argument(void 0!==e,"No sizeOf function for type "+t.type),e(t.value)},D.TABLE=function(t){for(var e=[],n=t.fields.length,r=[],i=[],o=0;o<n;o+=1){var a=t.fields[o],s=D[a.type];A.argument(void 0!==s,"No encoding function for field type "+a.type+" ("+a.name+")");var l=t[a.name];void 0===l&&(l=a.value);var c=s(l);"TABLE"===a.type?(i.push(e.length),e=e.concat([0,0]),r.push(c)):e=e.concat(c)}for(var h=0;h<r.length;h+=1){var u=i[h],f=e.length;A.argument(f<65536,"Table "+t.tableName+" too big."),e[u]=f>>8,e[u+1]=255&f,e=e.concat(r[h])}return e},I.TABLE=function(t){for(var e=0,n=t.fields.length,r=0;r<n;r+=1){var i=t.fields[r],o=I[i.type];A.argument(void 0!==o,"No sizeOf function for field type "+i.type+" ("+i.name+")");var a=t[i.name];void 0===a&&(a=i.value),e+=o(a),"TABLE"===i.type&&(e+=2)}return e},D.RECORD=D.TABLE,I.RECORD=I.TABLE,D.LITERAL=function(t){return t},I.LITERAL=function(t){return t.length},X.prototype.encode=function(){return D.TABLE(this)},X.prototype.sizeOf=function(){return I.TABLE(this)},q.prototype=Object.create(X.prototype),q.prototype.constructor=q,J.prototype=Object.create(X.prototype),J.prototype.constructor=J,K.prototype=Object.create(X.prototype),K.prototype.constructor=K,Z.prototype=Object.create(X.prototype),Z.prototype.constructor=Z;var $={Table:X,Record:X,Coverage:q,ScriptList:J,FeatureList:K,LookupList:Z,ushortList:W,tableList:Y,recordList:V};function Q(t,e){return t.getUint8(e)}function tt(t,e){return t.getUint16(e,!1)}function et(t,e){return t.getUint32(e,!1)}function nt(t,e){return t.getInt16(e,!1)+t.getUint16(e+2,!1)/65535}var rt={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function it(t,e){this.data=t,this.offset=e,this.relativeOffset=0}it.prototype.parseByte=function(){var t=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,t},it.prototype.parseChar=function(){var t=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,t},it.prototype.parseCard8=it.prototype.parseByte,it.prototype.parseUShort=function(){var t=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,t},it.prototype.parseCard16=it.prototype.parseUShort,it.prototype.parseSID=it.prototype.parseUShort,it.prototype.parseOffset16=it.prototype.parseUShort,it.prototype.parseShort=function(){var t=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,t},it.prototype.parseF2Dot14=function(){var t=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,t},it.prototype.parseULong=function(){var t=et(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,t},it.prototype.parseOffset32=it.prototype.parseULong,it.prototype.parseFixed=function(){var t=nt(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,t},it.prototype.parseString=function(t){var e=this.data,n=this.offset+this.relativeOffset,r="";this.relativeOffset+=t;for(var i=0;i<t;i++)r+=String.fromCharCode(e.getUint8(n+i));return r},it.prototype.parseTag=function(){return this.parseString(4)},it.prototype.parseLongDateTime=function(){var t=et(this.data,this.offset+this.relativeOffset+4);return t-=2082844800,this.relativeOffset+=8,t},it.prototype.parseVersion=function(t){var e=tt(this.data,this.offset+this.relativeOffset),n=tt(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,void 0===t&&(t=4096),e+n/t/10},it.prototype.skip=function(t,e){void 0===e&&(e=1),this.relativeOffset+=rt[t]*e},it.prototype.parseULongList=function(t){void 0===t&&(t=this.parseULong());for(var e=new Array(t),n=this.data,r=this.offset+this.relativeOffset,i=0;i<t;i++)e[i]=n.getUint32(r),r+=4;return this.relativeOffset+=4*t,e},it.prototype.parseOffset16List=it.prototype.parseUShortList=function(t){void 0===t&&(t=this.parseUShort());for(var e=new Array(t),n=this.data,r=this.offset+this.relativeOffset,i=0;i<t;i++)e[i]=n.getUint16(r),r+=2;return this.relativeOffset+=2*t,e},it.prototype.parseShortList=function(t){for(var e=new Array(t),n=this.data,r=this.offset+this.relativeOffset,i=0;i<t;i++)e[i]=n.getInt16(r),r+=2;return this.relativeOffset+=2*t,e},it.prototype.parseByteList=function(t){for(var e=new Array(t),n=this.data,r=this.offset+this.relativeOffset,i=0;i<t;i++)e[i]=n.getUint8(r++);return this.relativeOffset+=t,e},it.prototype.parseList=function(t,e){e||(e=t,t=this.parseUShort());for(var n=new Array(t),r=0;r<t;r++)n[r]=e.call(this);return n},it.prototype.parseList32=function(t,e){e||(e=t,t=this.parseULong());for(var n=new Array(t),r=0;r<t;r++)n[r]=e.call(this);return n},it.prototype.parseRecordList=function(t,e){e||(e=t,t=this.parseUShort());for(var n=new Array(t),r=Object.keys(e),i=0;i<t;i++){for(var o={},a=0;a<r.length;a++){var s=r[a],l=e[s];o[s]=l.call(this)}n[i]=o}return n},it.prototype.parseRecordList32=function(t,e){e||(e=t,t=this.parseULong());for(var n=new Array(t),r=Object.keys(e),i=0;i<t;i++){for(var o={},a=0;a<r.length;a++){var s=r[a],l=e[s];o[s]=l.call(this)}n[i]=o}return n},it.prototype.parseStruct=function(t){if("function"==typeof t)return t.call(this);for(var e=Object.keys(t),n={},r=0;r<e.length;r++){var i=e[r],o=t[i];n[i]=o.call(this)}return n},it.prototype.parseValueRecord=function(t){if(void 0===t&&(t=this.parseUShort()),0!==t){var e={};return 1&t&&(e.xPlacement=this.parseShort()),2&t&&(e.yPlacement=this.parseShort()),4&t&&(e.xAdvance=this.parseShort()),8&t&&(e.yAdvance=this.parseShort()),16&t&&(e.xPlaDevice=void 0,this.parseShort()),32&t&&(e.yPlaDevice=void 0,this.parseShort()),64&t&&(e.xAdvDevice=void 0,this.parseShort()),128&t&&(e.yAdvDevice=void 0,this.parseShort()),e}},it.prototype.parseValueRecordList=function(){for(var t=this.parseUShort(),e=this.parseUShort(),n=new Array(e),r=0;r<e;r++)n[r]=this.parseValueRecord(t);return n},it.prototype.parsePointer=function(t){var e=this.parseOffset16();if(e>0)return new it(this.data,this.offset+e).parseStruct(t)},it.prototype.parsePointer32=function(t){var e=this.parseOffset32();if(e>0)return new it(this.data,this.offset+e).parseStruct(t)},it.prototype.parseListOfLists=function(t){for(var e=this.parseOffset16List(),n=e.length,r=this.relativeOffset,i=new Array(n),o=0;o<n;o++){var a=e[o];if(0!==a)if(this.relativeOffset=a,t){for(var s=this.parseOffset16List(),l=new Array(s.length),c=0;c<s.length;c++)this.relativeOffset=a+s[c],l[c]=t.call(this);i[o]=l}else i[o]=this.parseUShortList();else i[o]=void 0}return this.relativeOffset=r,i},it.prototype.parseCoverage=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort(),n=this.parseUShort();if(1===e)return{format:1,glyphs:this.parseUShortList(n)};if(2===e){for(var r=new Array(n),i=0;i<n;i++)r[i]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:r}}throw new Error("0x"+t.toString(16)+": Coverage format must be 1 or 2.")},it.prototype.parseClassDef=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();if(1===e)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(2===e)return{format:2,ranges:this.parseRecordList({start:it.uShort,end:it.uShort,classId:it.uShort})};throw new Error("0x"+t.toString(16)+": ClassDef format must be 1 or 2.")},it.list=function(t,e){return function(){return this.parseList(t,e)}},it.list32=function(t,e){return function(){return this.parseList32(t,e)}},it.recordList=function(t,e){return function(){return this.parseRecordList(t,e)}},it.recordList32=function(t,e){return function(){return this.parseRecordList32(t,e)}},it.pointer=function(t){return function(){return this.parsePointer(t)}},it.pointer32=function(t){return function(){return this.parsePointer32(t)}},it.tag=it.prototype.parseTag,it.byte=it.prototype.parseByte,it.uShort=it.offset16=it.prototype.parseUShort,it.uShortList=it.prototype.parseUShortList,it.uLong=it.offset32=it.prototype.parseULong,it.uLongList=it.prototype.parseULongList,it.struct=it.prototype.parseStruct,it.coverage=it.prototype.parseCoverage,it.classDef=it.prototype.parseClassDef;var ot={reserved:it.uShort,reqFeatureIndex:it.uShort,featureIndexes:it.uShortList};it.prototype.parseScriptList=function(){return this.parsePointer(it.recordList({tag:it.tag,script:it.pointer({defaultLangSys:it.pointer(ot),langSysRecords:it.recordList({tag:it.tag,langSys:it.pointer(ot)})})}))||[]},it.prototype.parseFeatureList=function(){return this.parsePointer(it.recordList({tag:it.tag,feature:it.pointer({featureParams:it.offset16,lookupListIndexes:it.uShortList})}))||[]},it.prototype.parseLookupList=function(t){return this.parsePointer(it.list(it.pointer((function(){var e=this.parseUShort();A.argument(1<=e&&e<=9,"GPOS/GSUB lookup type "+e+" unknown.");var n=this.parseUShort(),r=16&n;return{lookupType:e,lookupFlag:n,subtables:this.parseList(it.pointer(t[e])),markFilteringSet:r?this.parseUShort():void 0}}))))||[]},it.prototype.parseFeatureVariationsList=function(){return this.parsePointer32((function(){var t=this.parseUShort(),e=this.parseUShort();return A.argument(1===t&&e<1,"GPOS/GSUB feature variations table unknown."),this.parseRecordList32({conditionSetOffset:it.offset32,featureTableSubstitutionOffset:it.offset32})}))||[]};var at={getByte:Q,getCard8:Q,getUShort:tt,getCard16:tt,getShort:function(t,e){return t.getInt16(e,!1)},getULong:et,getFixed:nt,getTag:function(t,e){for(var n="",r=e;r<e+4;r+=1)n+=String.fromCharCode(t.getInt8(r));return n},getOffset:function(t,e,n){for(var r=0,i=0;i<n;i+=1)r<<=8,r+=t.getUint8(e+i);return r},getBytes:function(t,e,n){for(var r=[],i=e;i<n;i+=1)r.push(t.getUint8(i));return r},bytesToString:function(t){for(var e="",n=0;n<t.length;n+=1)e+=String.fromCharCode(t[n]);return e},Parser:it};function st(t,e,n){t.segments.push({end:e,start:e,delta:-(e-n),offset:0,glyphIndex:n})}var lt={parse:function(t,e){var n={};n.version=at.getUShort(t,e),A.argument(0===n.version,"cmap table version should be 0."),n.numTables=at.getUShort(t,e+2);for(var r=-1,i=n.numTables-1;i>=0;i-=1){var o=at.getUShort(t,e+4+8*i),a=at.getUShort(t,e+4+8*i+2);if(3===o&&(0===a||1===a||10===a)||0===o&&(0===a||1===a||2===a||3===a||4===a)){r=at.getULong(t,e+4+8*i+4);break}}if(-1===r)throw new Error("No valid cmap sub-tables found.");var s=new at.Parser(t,e+r);if(n.format=s.parseUShort(),12===n.format)!function(t,e){var n;e.parseUShort(),t.length=e.parseULong(),t.language=e.parseULong(),t.groupCount=n=e.parseULong(),t.glyphIndexMap={};for(var r=0;r<n;r+=1)for(var i=e.parseULong(),o=e.parseULong(),a=e.parseULong(),s=i;s<=o;s+=1)t.glyphIndexMap[s]=a,a++}(n,s);else{if(4!==n.format)throw new Error("Only format 4 and 12 cmap tables are supported (found format "+n.format+").");!function(t,e,n,r,i){var o;t.length=e.parseUShort(),t.language=e.parseUShort(),t.segCount=o=e.parseUShort()>>1,e.skip("uShort",3),t.glyphIndexMap={};for(var a=new at.Parser(n,r+i+14),s=new at.Parser(n,r+i+16+2*o),l=new at.Parser(n,r+i+16+4*o),c=new at.Parser(n,r+i+16+6*o),h=r+i+16+8*o,u=0;u<o-1;u+=1)for(var f=void 0,p=a.parseUShort(),d=s.parseUShort(),g=l.parseShort(),v=c.parseUShort(),m=d;m<=p;m+=1)0!==v?(h=c.offset+c.relativeOffset-2,h+=v,h+=2*(m-d),0!==(f=at.getUShort(n,h))&&(f=f+g&65535)):f=m+g&65535,t.glyphIndexMap[m]=f}(n,s,t,e,r)}return n},make:function(t){var e,n=!0;for(e=t.length-1;e>0;e-=1){if(t.get(e).unicode>65535){console.log("Adding CMAP format 12 (needed!)"),n=!1;break}}var r=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:n?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:n?12:20}];n||(r=r.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])),r=r.concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);var i=new $.Table("cmap",r);for(i.segments=[],e=0;e<t.length;e+=1){for(var o=t.get(e),a=0;a<o.unicodes.length;a+=1)st(i,o.unicodes[a],e);i.segments=i.segments.sort((function(t,e){return t.start-e.start}))}!function(t){t.segments.push({end:65535,start:65535,delta:1,offset:0})}(i);var s=i.segments.length,l=0,c=[],h=[],u=[],f=[],p=[],d=[];for(e=0;e<s;e+=1){var g=i.segments[e];g.end<=65535&&g.start<=65535?(c=c.concat({name:"end_"+e,type:"USHORT",value:g.end}),h=h.concat({name:"start_"+e,type:"USHORT",value:g.start}),u=u.concat({name:"idDelta_"+e,type:"SHORT",value:g.delta}),f=f.concat({name:"idRangeOffset_"+e,type:"USHORT",value:g.offset}),void 0!==g.glyphId&&(p=p.concat({name:"glyph_"+e,type:"USHORT",value:g.glyphId}))):l+=1,n||void 0===g.glyphIndex||(d=(d=(d=d.concat({name:"cmap12Start_"+e,type:"ULONG",value:g.start})).concat({name:"cmap12End_"+e,type:"ULONG",value:g.end})).concat({name:"cmap12Glyph_"+e,type:"ULONG",value:g.glyphIndex}))}if(i.segCountX2=2*(s-l),i.searchRange=2*Math.pow(2,Math.floor(Math.log(s-l)/Math.log(2))),i.entrySelector=Math.log(i.searchRange/2)/Math.log(2),i.rangeShift=i.segCountX2-i.searchRange,i.fields=i.fields.concat(c),i.fields.push({name:"reservedPad",type:"USHORT",value:0}),i.fields=i.fields.concat(h),i.fields=i.fields.concat(u),i.fields=i.fields.concat(f),i.fields=i.fields.concat(p),i.cmap4Length=14+2*c.length+2+2*h.length+2*u.length+2*f.length+2*p.length,!n){var v=16+4*d.length;i.cmap12Offset=20+i.cmap4Length,i.fields=i.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:v},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:d.length/3}]),i.fields=i.fields.concat(d)}return i}},ct=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],ht=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],ut=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],ft=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function pt(t){this.font=t}function dt(t){this.cmap=t}function gt(t,e){this.encoding=t,this.charset=e}function vt(t){switch(t.version){case 1:this.names=ft.slice();break;case 2:this.names=new Array(t.numberOfGlyphs);for(var e=0;e<t.numberOfGlyphs;e++)t.glyphNameIndex[e]<ft.length?this.names[e]=ft[t.glyphNameIndex[e]]:this.names[e]=t.names[t.glyphNameIndex[e]-ft.length];break;case 2.5:this.names=new Array(t.numberOfGlyphs);for(var n=0;n<t.numberOfGlyphs;n++)this.names[n]=ft[n+t.glyphNameIndex[n]];break;case 3:default:this.names=[]}}function mt(t,e){e.lowMemory?function(t){t._IndexToUnicodeMap={};for(var e=t.tables.cmap.glyphIndexMap,n=Object.keys(e),r=0;r<n.length;r+=1){var i=n[r],o=e[i];void 0===t._IndexToUnicodeMap[o]?t._IndexToUnicodeMap[o]={unicodes:[parseInt(i)]}:t._IndexToUnicodeMap[o].unicodes.push(parseInt(i))}}(t):function(t){for(var e,n=t.tables.cmap.glyphIndexMap,r=Object.keys(n),i=0;i<r.length;i+=1){var o=r[i],a=n[o];(e=t.glyphs.get(a)).addUnicode(parseInt(o))}for(var s=0;s<t.glyphs.length;s+=1)e=t.glyphs.get(s),t.cffEncoding?t.isCIDFont?e.name="gid"+s:e.name=t.cffEncoding.charset[s]:t.glyphNames.names&&(e.name=t.glyphNames.glyphIndexToName(s))}(t)}pt.prototype.charToGlyphIndex=function(t){var e=t.codePointAt(0),n=this.font.glyphs;if(n)for(var r=0;r<n.length;r+=1)for(var i=n.get(r),o=0;o<i.unicodes.length;o+=1)if(i.unicodes[o]===e)return r;return null},dt.prototype.charToGlyphIndex=function(t){return this.cmap.glyphIndexMap[t.codePointAt(0)]||0},gt.prototype.charToGlyphIndex=function(t){var e=t.codePointAt(0),n=this.encoding[e];return this.charset.indexOf(n)},vt.prototype.nameToGlyphIndex=function(t){return this.names.indexOf(t)},vt.prototype.glyphIndexToName=function(t){return this.names[t]};var yt={line:function(t,e,n,r,i){t.beginPath(),t.moveTo(e,n),t.lineTo(r,i),t.stroke()}};function bt(t){this.bindConstructorValues(t)}function xt(t,e,n){Object.defineProperty(t,e,{get:function(){return t.path,t[n]},set:function(e){t[n]=e},enumerable:!0,configurable:!0})}function wt(t,e){if(this.font=t,this.glyphs={},Array.isArray(e))for(var n=0;n<e.length;n++){var r=e[n];r.path.unitsPerEm=t.unitsPerEm,this.glyphs[n]=r}this.length=e&&e.length||0}bt.prototype.bindConstructorValues=function(t){var e,n;this.index=t.index||0,this.name=t.name||null,this.unicode=t.unicode||void 0,this.unicodes=t.unicodes||void 0!==t.unicode?[t.unicode]:[],"xMin"in t&&(this.xMin=t.xMin),"yMin"in t&&(this.yMin=t.yMin),"xMax"in t&&(this.xMax=t.xMax),"yMax"in t&&(this.yMax=t.yMax),"advanceWidth"in t&&(this.advanceWidth=t.advanceWidth),Object.defineProperty(this,"path",(e=t.path,n=e||new P,{configurable:!0,get:function(){return"function"==typeof n&&(n=n()),n},set:function(t){n=t}}))},bt.prototype.addUnicode=function(t){0===this.unicodes.length&&(this.unicode=t),this.unicodes.push(t)},bt.prototype.getBoundingBox=function(){return this.path.getBoundingBox()},bt.prototype.getPath=function(t,e,n,r,i){var o,a;t=void 0!==t?t:0,e=void 0!==e?e:0,n=void 0!==n?n:72,r||(r={});var s=r.xScale,l=r.yScale;if(r.hinting&&i&&i.hinting&&(a=this.path&&i.hinting.exec(this,n)),a)o=i.hinting.getCommands(a),t=Math.round(t),e=Math.round(e),s=l=1;else{o=this.path.commands;var c=1/(this.path.unitsPerEm||1e3)*n;void 0===s&&(s=c),void 0===l&&(l=c)}for(var h=new P,u=0;u<o.length;u+=1){var f=o[u];"M"===f.type?h.moveTo(t+f.x*s,e+-f.y*l):"L"===f.type?h.lineTo(t+f.x*s,e+-f.y*l):"Q"===f.type?h.quadraticCurveTo(t+f.x1*s,e+-f.y1*l,t+f.x*s,e+-f.y*l):"C"===f.type?h.curveTo(t+f.x1*s,e+-f.y1*l,t+f.x2*s,e+-f.y2*l,t+f.x*s,e+-f.y*l):"Z"===f.type&&h.closePath()}return h},bt.prototype.getContours=function(){if(void 0===this.points)return[];for(var t=[],e=[],n=0;n<this.points.length;n+=1){var r=this.points[n];e.push(r),r.lastPointOfContour&&(t.push(e),e=[])}return A.argument(0===e.length,"There are still points left in the current contour."),t},bt.prototype.getMetrics=function(){for(var t=this.path.commands,e=[],n=[],r=0;r<t.length;r+=1){var i=t[r];"Z"!==i.type&&(e.push(i.x),n.push(i.y)),"Q"!==i.type&&"C"!==i.type||(e.push(i.x1),n.push(i.y1)),"C"===i.type&&(e.push(i.x2),n.push(i.y2))}var o={xMin:Math.min.apply(null,e),yMin:Math.min.apply(null,n),xMax:Math.max.apply(null,e),yMax:Math.max.apply(null,n),leftSideBearing:this.leftSideBearing};return isFinite(o.xMin)||(o.xMin=0),isFinite(o.xMax)||(o.xMax=this.advanceWidth),isFinite(o.yMin)||(o.yMin=0),isFinite(o.yMax)||(o.yMax=0),o.rightSideBearing=this.advanceWidth-o.leftSideBearing-(o.xMax-o.xMin),o},bt.prototype.draw=function(t,e,n,r,i){this.getPath(e,n,r,i).draw(t)},bt.prototype.drawPoints=function(t,e,n,r){function i(e,n,r,i){t.beginPath();for(var o=0;o<e.length;o+=1)t.moveTo(n+e[o].x*i,r+e[o].y*i),t.arc(n+e[o].x*i,r+e[o].y*i,2,0,2*Math.PI,!1);t.closePath(),t.fill()}e=void 0!==e?e:0,n=void 0!==n?n:0,r=void 0!==r?r:24;for(var o=1/this.path.unitsPerEm*r,a=[],s=[],l=this.path,c=0;c<l.commands.length;c+=1){var h=l.commands[c];void 0!==h.x&&a.push({x:h.x,y:-h.y}),void 0!==h.x1&&s.push({x:h.x1,y:-h.y1}),void 0!==h.x2&&s.push({x:h.x2,y:-h.y2})}t.fillStyle="blue",i(a,e,n,o),t.fillStyle="red",i(s,e,n,o)},bt.prototype.drawMetrics=function(t,e,n,r){var i;e=void 0!==e?e:0,n=void 0!==n?n:0,r=void 0!==r?r:24,i=1/this.path.unitsPerEm*r,t.lineWidth=1,t.strokeStyle="black",yt.line(t,e,-1e4,e,1e4),yt.line(t,-1e4,n,1e4,n);var o=this.xMin||0,a=this.yMin||0,s=this.xMax||0,l=this.yMax||0,c=this.advanceWidth||0;t.strokeStyle="blue",yt.line(t,e+o*i,-1e4,e+o*i,1e4),yt.line(t,e+s*i,-1e4,e+s*i,1e4),yt.line(t,-1e4,n+-a*i,1e4,n+-a*i),yt.line(t,-1e4,n+-l*i,1e4,n+-l*i),t.strokeStyle="green",yt.line(t,e+c*i,-1e4,e+c*i,1e4)},wt.prototype.get=function(t){if(void 0===this.glyphs[t]){this.font._push(t),"function"==typeof this.glyphs[t]&&(this.glyphs[t]=this.glyphs[t]());var e=this.glyphs[t],n=this.font._IndexToUnicodeMap[t];if(n)for(var r=0;r<n.unicodes.length;r++)e.addUnicode(n.unicodes[r]);this.font.cffEncoding?this.font.isCIDFont?e.name="gid"+t:e.name=this.font.cffEncoding.charset[t]:this.font.glyphNames.names&&(e.name=this.font.glyphNames.glyphIndexToName(t)),this.glyphs[t].advanceWidth=this.font._hmtxTableData[t].advanceWidth,this.glyphs[t].leftSideBearing=this.font._hmtxTableData[t].leftSideBearing}else"function"==typeof this.glyphs[t]&&(this.glyphs[t]=this.glyphs[t]());return this.glyphs[t]},wt.prototype.push=function(t,e){this.glyphs[t]=e,this.length++};var St={GlyphSet:wt,glyphLoader:function(t,e){return new bt({index:e,font:t})},ttfGlyphLoader:function(t,e,n,r,i,o){return function(){var a=new bt({index:e,font:t});return a.path=function(){n(a,r,i);var e=o(t.glyphs,a);return e.unitsPerEm=t.unitsPerEm,e},xt(a,"xMin","_xMin"),xt(a,"xMax","_xMax"),xt(a,"yMin","_yMin"),xt(a,"yMax","_yMax"),a}},cffGlyphLoader:function(t,e,n,r){return function(){var i=new bt({index:e,font:t});return i.path=function(){var e=n(t,i,r);return e.unitsPerEm=t.unitsPerEm,e},i}}};function Ct(t,e){if(t===e)return!0;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n+=1)if(!Ct(t[n],e[n]))return!1;return!0}return!1}function Tt(t){return t.length<1240?107:t.length<33900?1131:32768}function _t(t,e,n){var r,i,o=[],a=[],s=at.getCard16(t,e);if(0!==s){var l=at.getByte(t,e+2);r=e+(s+1)*l+2;for(var c=e+3,h=0;h<s+1;h+=1)o.push(at.getOffset(t,c,l)),c+=l;i=r+o[s]}else i=e+2;for(var u=0;u<o.length-1;u+=1){var f=at.getBytes(t,r+o[u],r+o[u+1]);n&&(f=n(f)),a.push(f)}return{objects:a,startOffset:e,endOffset:i}}function Ot(t,e){if(28===e)return t.parseByte()<<8|t.parseByte();if(29===e)return t.parseByte()<<24|t.parseByte()<<16|t.parseByte()<<8|t.parseByte();if(30===e)return function(t){for(var e="",n=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var r=t.parseByte(),i=r>>4,o=15&r;if(15===i)break;if(e+=n[i],15===o)break;e+=n[o]}return parseFloat(e)}(t);if(e>=32&&e<=246)return e-139;if(e>=247&&e<=250)return 256*(e-247)+t.parseByte()+108;if(e>=251&&e<=254)return 256*-(e-251)-t.parseByte()-108;throw new Error("Invalid b0 "+e)}function kt(t,e,n){e=void 0!==e?e:0;var r=new at.Parser(t,e),i=[],o=[];for(n=void 0!==n?n:t.length;r.relativeOffset<n;){var a=r.parseByte();a<=21?(12===a&&(a=1200+r.parseByte()),i.push([a,o]),o=[]):o.push(Ot(r,a))}return function(t){for(var e={},n=0;n<t.length;n+=1){var r=t[n][0],i=t[n][1],o=void 0;if(o=1===i.length?i[0]:i,e.hasOwnProperty(r)&&!isNaN(e[r]))throw new Error("Object "+e+" already has key "+r);e[r]=o}return e}(i)}function Pt(t,e){return e=e<=390?ct[e]:t[e-391]}function Et(t,e,n){for(var r,i={},o=0;o<e.length;o+=1){var a=e[o];if(Array.isArray(a.type)){var s=[];s.length=a.type.length;for(var l=0;l<a.type.length;l++)void 0===(r=void 0!==t[a.op]?t[a.op][l]:void 0)&&(r=void 0!==a.value&&void 0!==a.value[l]?a.value[l]:null),"SID"===a.type[l]&&(r=Pt(n,r)),s[l]=r;i[a.name]=s}else void 0===(r=t[a.op])&&(r=void 0!==a.value?a.value:null),"SID"===a.type&&(r=Pt(n,r)),i[a.name]=r}return i}var Mt=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],At=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function Lt(t,e){return Et(kt(t,0,t.byteLength),Mt,e)}function Dt(t,e,n,r){return Et(kt(t,e,n),At,r)}function It(t,e,n,r){for(var i=[],o=0;o<n.length;o+=1){var a=Lt(new DataView(new Uint8Array(n[o]).buffer),r);a._subrs=[],a._subrsBias=0,a._defaultWidthX=0,a._nominalWidthX=0;var s=a.private[0],l=a.private[1];if(0!==s&&0!==l){var c=Dt(t,l+e,s,r);if(a._defaultWidthX=c.defaultWidthX,a._nominalWidthX=c.nominalWidthX,0!==c.subrs){var h=_t(t,l+c.subrs+e);a._subrs=h.objects,a._subrsBias=Tt(a._subrs)}a._privateDict=c}i.push(a)}return i}function Rt(t,e,n){var r,i,o,a,s,l,c,h,u=new P,f=[],p=0,d=!1,g=!1,v=0,m=0;if(t.isCIDFont){var y=t.tables.cff.topDict._fdSelect[e.index],b=t.tables.cff.topDict._fdArray[y];s=b._subrs,l=b._subrsBias,c=b._defaultWidthX,h=b._nominalWidthX}else s=t.tables.cff.topDict._subrs,l=t.tables.cff.topDict._subrsBias,c=t.tables.cff.topDict._defaultWidthX,h=t.tables.cff.topDict._nominalWidthX;var x=c;function w(t,e){g&&u.closePath(),u.moveTo(t,e),g=!0}function S(){f.length%2!=0&&!d&&(x=f.shift()+h),p+=f.length>>1,f.length=0,d=!0}return function n(c){for(var y,b,C,T,_,O,k,P,E,M,A,L,D=0;D<c.length;){var I=c[D];switch(D+=1,I){case 1:case 3:S();break;case 4:f.length>1&&!d&&(x=f.shift()+h,d=!0),m+=f.pop(),w(v,m);break;case 5:for(;f.length>0;)v+=f.shift(),m+=f.shift(),u.lineTo(v,m);break;case 6:for(;f.length>0&&(v+=f.shift(),u.lineTo(v,m),0!==f.length);)m+=f.shift(),u.lineTo(v,m);break;case 7:for(;f.length>0&&(m+=f.shift(),u.lineTo(v,m),0!==f.length);)v+=f.shift(),u.lineTo(v,m);break;case 8:for(;f.length>0;)r=v+f.shift(),i=m+f.shift(),o=r+f.shift(),a=i+f.shift(),v=o+f.shift(),m=a+f.shift(),u.curveTo(r,i,o,a,v,m);break;case 10:_=f.pop()+l,(O=s[_])&&n(O);break;case 11:return;case 12:switch(I=c[D],D+=1,I){case 35:r=v+f.shift(),i=m+f.shift(),o=r+f.shift(),a=i+f.shift(),k=o+f.shift(),P=a+f.shift(),E=k+f.shift(),M=P+f.shift(),A=E+f.shift(),L=M+f.shift(),v=A+f.shift(),m=L+f.shift(),f.shift(),u.curveTo(r,i,o,a,k,P),u.curveTo(E,M,A,L,v,m);break;case 34:r=v+f.shift(),i=m,o=r+f.shift(),a=i+f.shift(),k=o+f.shift(),P=a,E=k+f.shift(),M=a,A=E+f.shift(),L=m,v=A+f.shift(),u.curveTo(r,i,o,a,k,P),u.curveTo(E,M,A,L,v,m);break;case 36:r=v+f.shift(),i=m+f.shift(),o=r+f.shift(),a=i+f.shift(),k=o+f.shift(),P=a,E=k+f.shift(),M=a,A=E+f.shift(),L=M+f.shift(),v=A+f.shift(),u.curveTo(r,i,o,a,k,P),u.curveTo(E,M,A,L,v,m);break;case 37:r=v+f.shift(),i=m+f.shift(),o=r+f.shift(),a=i+f.shift(),k=o+f.shift(),P=a+f.shift(),E=k+f.shift(),M=P+f.shift(),A=E+f.shift(),L=M+f.shift(),Math.abs(A-v)>Math.abs(L-m)?v=A+f.shift():m=L+f.shift(),u.curveTo(r,i,o,a,k,P),u.curveTo(E,M,A,L,v,m);break;default:console.log("Glyph "+e.index+": unknown operator 1200"+I),f.length=0}break;case 14:f.length>0&&!d&&(x=f.shift()+h,d=!0),g&&(u.closePath(),g=!1);break;case 18:S();break;case 19:case 20:S(),D+=p+7>>3;break;case 21:f.length>2&&!d&&(x=f.shift()+h,d=!0),m+=f.pop(),w(v+=f.pop(),m);break;case 22:f.length>1&&!d&&(x=f.shift()+h,d=!0),w(v+=f.pop(),m);break;case 23:S();break;case 24:for(;f.length>2;)r=v+f.shift(),i=m+f.shift(),o=r+f.shift(),a=i+f.shift(),v=o+f.shift(),m=a+f.shift(),u.curveTo(r,i,o,a,v,m);v+=f.shift(),m+=f.shift(),u.lineTo(v,m);break;case 25:for(;f.length>6;)v+=f.shift(),m+=f.shift(),u.lineTo(v,m);r=v+f.shift(),i=m+f.shift(),o=r+f.shift(),a=i+f.shift(),v=o+f.shift(),m=a+f.shift(),u.curveTo(r,i,o,a,v,m);break;case 26:for(f.length%2&&(v+=f.shift());f.length>0;)r=v,i=m+f.shift(),o=r+f.shift(),a=i+f.shift(),v=o,m=a+f.shift(),u.curveTo(r,i,o,a,v,m);break;case 27:for(f.length%2&&(m+=f.shift());f.length>0;)r=v+f.shift(),i=m,o=r+f.shift(),a=i+f.shift(),v=o+f.shift(),m=a,u.curveTo(r,i,o,a,v,m);break;case 28:y=c[D],b=c[D+1],f.push((y<<24|b<<16)>>16),D+=2;break;case 29:_=f.pop()+t.gsubrsBias,(O=t.gsubrs[_])&&n(O);break;case 30:for(;f.length>0&&(r=v,i=m+f.shift(),o=r+f.shift(),a=i+f.shift(),v=o+f.shift(),m=a+(1===f.length?f.shift():0),u.curveTo(r,i,o,a,v,m),0!==f.length);)r=v+f.shift(),i=m,o=r+f.shift(),a=i+f.shift(),m=a+f.shift(),v=o+(1===f.length?f.shift():0),u.curveTo(r,i,o,a,v,m);break;case 31:for(;f.length>0&&(r=v+f.shift(),i=m,o=r+f.shift(),a=i+f.shift(),m=a+f.shift(),v=o+(1===f.length?f.shift():0),u.curveTo(r,i,o,a,v,m),0!==f.length);)r=v,i=m+f.shift(),o=r+f.shift(),a=i+f.shift(),v=o+f.shift(),m=a+(1===f.length?f.shift():0),u.curveTo(r,i,o,a,v,m);break;default:I<32?console.log("Glyph "+e.index+": unknown operator "+I):I<247?f.push(I-139):I<251?(y=c[D],D+=1,f.push(256*(I-247)+y+108)):I<255?(y=c[D],D+=1,f.push(256*-(I-251)-y-108)):(y=c[D],b=c[D+1],C=c[D+2],T=c[D+3],D+=4,f.push((y<<24|b<<16|C<<8|T)/65536))}}}(n),e.advanceWidth=x,u}function jt(t,e){var n,r=ct.indexOf(t);return r>=0&&(n=r),(r=e.indexOf(t))>=0?n=r+ct.length:(n=ct.length+e.length,e.push(t)),n}function Bt(t,e,n){for(var r={},i=0;i<t.length;i+=1){var o=t[i],a=e[o.name];void 0===a||Ct(a,o.value)||("SID"===o.type&&(a=jt(a,n)),r[o.op]={name:o.name,type:o.type,value:a})}return r}function Ft(t,e){var n=new $.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return n.dict=Bt(Mt,t,e),n}function Ut(t){var e=new $.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return e.topDicts=[{name:"topDict_0",type:"TABLE",value:t}],e}function zt(t){var e=[],n=t.path;e.push({name:"width",type:"NUMBER",value:t.advanceWidth});for(var r=0,i=0,o=0;o<n.commands.length;o+=1){var a=void 0,s=void 0,l=n.commands[o];if("Q"===l.type){l={type:"C",x:l.x,y:l.y,x1:Math.round(1/3*r+2/3*l.x1),y1:Math.round(1/3*i+2/3*l.y1),x2:Math.round(1/3*l.x+2/3*l.x1),y2:Math.round(1/3*l.y+2/3*l.y1)}}if("M"===l.type)a=Math.round(l.x-r),s=Math.round(l.y-i),e.push({name:"dx",type:"NUMBER",value:a}),e.push({name:"dy",type:"NUMBER",value:s}),e.push({name:"rmoveto",type:"OP",value:21}),r=Math.round(l.x),i=Math.round(l.y);else if("L"===l.type)a=Math.round(l.x-r),s=Math.round(l.y-i),e.push({name:"dx",type:"NUMBER",value:a}),e.push({name:"dy",type:"NUMBER",value:s}),e.push({name:"rlineto",type:"OP",value:5}),r=Math.round(l.x),i=Math.round(l.y);else if("C"===l.type){var c=Math.round(l.x1-r),h=Math.round(l.y1-i),u=Math.round(l.x2-l.x1),f=Math.round(l.y2-l.y1);a=Math.round(l.x-l.x2),s=Math.round(l.y-l.y2),e.push({name:"dx1",type:"NUMBER",value:c}),e.push({name:"dy1",type:"NUMBER",value:h}),e.push({name:"dx2",type:"NUMBER",value:u}),e.push({name:"dy2",type:"NUMBER",value:f}),e.push({name:"dx",type:"NUMBER",value:a}),e.push({name:"dy",type:"NUMBER",value:s}),e.push({name:"rrcurveto",type:"OP",value:8}),r=Math.round(l.x),i=Math.round(l.y)}}return e.push({name:"endchar",type:"OP",value:14}),e}var Gt={parse:function(t,e,n,r){n.tables.cff={};var i=function(t,e){var n={};return n.formatMajor=at.getCard8(t,e),n.formatMinor=at.getCard8(t,e+1),n.size=at.getCard8(t,e+2),n.offsetSize=at.getCard8(t,e+3),n.startOffset=e,n.endOffset=e+4,n}(t,e),o=_t(t,i.endOffset,at.bytesToString),a=_t(t,o.endOffset),s=_t(t,a.endOffset,at.bytesToString),l=_t(t,s.endOffset);n.gsubrs=l.objects,n.gsubrsBias=Tt(n.gsubrs);var c=It(t,e,a.objects,s.objects);if(1!==c.length)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+c.length);var h=c[0];if(n.tables.cff.topDict=h,h._privateDict&&(n.defaultWidthX=h._privateDict.defaultWidthX,n.nominalWidthX=h._privateDict.nominalWidthX),void 0!==h.ros[0]&&void 0!==h.ros[1]&&(n.isCIDFont=!0),n.isCIDFont){var u=h.fdArray,f=h.fdSelect;if(0===u||0===f)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");var p=_t(t,u+=e),d=It(t,e,p.objects,s.objects);h._fdArray=d,f+=e,h._fdSelect=function(t,e,n,r){var i,o=[],a=new at.Parser(t,e),s=a.parseCard8();if(0===s)for(var l=0;l<n;l++){if((i=a.parseCard8())>=r)throw new Error("CFF table CID Font FDSelect has bad FD index value "+i+" (FD count "+r+")");o.push(i)}else{if(3!==s)throw new Error("CFF Table CID Font FDSelect table has unsupported format "+s);var c,h=a.parseCard16(),u=a.parseCard16();if(0!==u)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+u);for(var f=0;f<h;f++){if(i=a.parseCard8(),c=a.parseCard16(),i>=r)throw new Error("CFF table CID Font FDSelect has bad FD index value "+i+" (FD count "+r+")");if(c>n)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+c);for(;u<c;u++)o.push(i);u=c}if(c!==n)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+c)}return o}(t,f,n.numGlyphs,d.length)}var g,v=e+h.private[1],m=Dt(t,v,h.private[0],s.objects);if(n.defaultWidthX=m.defaultWidthX,n.nominalWidthX=m.nominalWidthX,0!==m.subrs){var y=v+m.subrs,b=_t(t,y);n.subrs=b.objects,n.subrsBias=Tt(n.subrs)}else n.subrs=[],n.subrsBias=0;r.lowMemory?(g=function(t,e){var n,r,i=[],o=at.getCard16(t,e);if(0!==o){var a=at.getByte(t,e+2);n=e+(o+1)*a+2;for(var s=e+3,l=0;l<o+1;l+=1)i.push(at.getOffset(t,s,a)),s+=a;r=n+i[o]}else r=e+2;return{offsets:i,startOffset:e,endOffset:r}}(t,e+h.charStrings),n.nGlyphs=g.offsets.length):(g=_t(t,e+h.charStrings),n.nGlyphs=g.objects.length);var x=function(t,e,n,r){var i,o,a=new at.Parser(t,e);n-=1;var s=[".notdef"],l=a.parseCard8();if(0===l)for(var c=0;c<n;c+=1)i=a.parseSID(),s.push(Pt(r,i));else if(1===l)for(;s.length<=n;){i=a.parseSID(),o=a.parseCard8();for(var h=0;h<=o;h+=1)s.push(Pt(r,i)),i+=1}else{if(2!==l)throw new Error("Unknown charset format "+l);for(;s.length<=n;){i=a.parseSID(),o=a.parseCard16();for(var u=0;u<=o;u+=1)s.push(Pt(r,i)),i+=1}}return s}(t,e+h.charset,n.nGlyphs,s.objects);if(0===h.encoding?n.cffEncoding=new gt(ht,x):1===h.encoding?n.cffEncoding=new gt(ut,x):n.cffEncoding=function(t,e,n){var r,i={},o=new at.Parser(t,e),a=o.parseCard8();if(0===a)for(var s=o.parseCard8(),l=0;l<s;l+=1)i[r=o.parseCard8()]=l;else{if(1!==a)throw new Error("Unknown encoding format "+a);var c=o.parseCard8();r=1;for(var h=0;h<c;h+=1)for(var u=o.parseCard8(),f=o.parseCard8(),p=u;p<=u+f;p+=1)i[p]=r,r+=1}return new gt(i,n)}(t,e+h.encoding,x),n.encoding=n.encoding||n.cffEncoding,n.glyphs=new St.GlyphSet(n),r.lowMemory)n._push=function(r){var i=function(t,e,n,r,i){var o=at.getCard16(n,r),a=0;0!==o&&(a=r+(o+1)*at.getByte(n,r+2)+2);var s=at.getBytes(n,a+e[t],a+e[t+1]);return i&&(s=i(s)),s}(r,g.offsets,t,e+h.charStrings);n.glyphs.push(r,St.cffGlyphLoader(n,r,Rt,i))};else for(var w=0;w<n.nGlyphs;w+=1){var S=g.objects[w];n.glyphs.push(w,St.cffGlyphLoader(n,w,Rt,S))}},make:function(t,e){for(var n,r=new $.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),i=1/e.unitsPerEm,o={version:e.version,fullName:e.fullName,familyName:e.familyName,weight:e.weightName,fontBBox:e.fontBBox||[0,0,0,0],fontMatrix:[i,0,0,i,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},a=[],s=1;s<t.length;s+=1)n=t.get(s),a.push(n.name);var l=[];r.header=new $.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}]),r.nameIndex=function(t){var e=new $.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);e.names=[];for(var n=0;n<t.length;n+=1)e.names.push({name:"name_"+n,type:"NAME",value:t[n]});return e}([e.postScriptName]);var c=Ft(o,l);r.topDictIndex=Ut(c),r.globalSubrIndex=new $.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}]),r.charsets=function(t,e){for(var n=new $.Record("Charsets",[{name:"format",type:"Card8",value:0}]),r=0;r<t.length;r+=1){var i=jt(t[r],e);n.fields.push({name:"glyph_"+r,type:"SID",value:i})}return n}(a,l),r.charStringsIndex=function(t){for(var e=new $.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),n=0;n<t.length;n+=1){var r=t.get(n),i=zt(r);e.charStrings.push({name:r.name,type:"CHARSTRING",value:i})}return e}(t),r.privateDict=function(t,e){var n=new $.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return n.dict=Bt(At,t,e),n}({},l),r.stringIndex=function(t){var e=new $.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);e.strings=[];for(var n=0;n<t.length;n+=1)e.strings.push({name:"string_"+n,type:"STRING",value:t[n]});return e}(l);var h=r.header.sizeOf()+r.nameIndex.sizeOf()+r.topDictIndex.sizeOf()+r.stringIndex.sizeOf()+r.globalSubrIndex.sizeOf();return o.charset=h,o.encoding=0,o.charStrings=o.charset+r.charsets.sizeOf(),o.private[1]=o.charStrings+r.charStringsIndex.sizeOf(),c=Ft(o,l),r.topDictIndex=Ut(c),r}};var Nt={parse:function(t,e){var n={},r=new at.Parser(t,e);return n.version=r.parseVersion(),n.fontRevision=Math.round(1e3*r.parseFixed())/1e3,n.checkSumAdjustment=r.parseULong(),n.magicNumber=r.parseULong(),A.argument(1594834165===n.magicNumber,"Font header has wrong magic number."),n.flags=r.parseUShort(),n.unitsPerEm=r.parseUShort(),n.created=r.parseLongDateTime(),n.modified=r.parseLongDateTime(),n.xMin=r.parseShort(),n.yMin=r.parseShort(),n.xMax=r.parseShort(),n.yMax=r.parseShort(),n.macStyle=r.parseUShort(),n.lowestRecPPEM=r.parseUShort(),n.fontDirectionHint=r.parseShort(),n.indexToLocFormat=r.parseShort(),n.glyphDataFormat=r.parseShort(),n},make:function(t){var e=Math.round((new Date).getTime()/1e3)+2082844800,n=e;return t.createdTimestamp&&(n=t.createdTimestamp+2082844800),new $.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:n},{name:"modified",type:"LONGDATETIME",value:e},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],t)}};var Ht={parse:function(t,e){var n={},r=new at.Parser(t,e);return n.version=r.parseVersion(),n.ascender=r.parseShort(),n.descender=r.parseShort(),n.lineGap=r.parseShort(),n.advanceWidthMax=r.parseUShort(),n.minLeftSideBearing=r.parseShort(),n.minRightSideBearing=r.parseShort(),n.xMaxExtent=r.parseShort(),n.caretSlopeRise=r.parseShort(),n.caretSlopeRun=r.parseShort(),n.caretOffset=r.parseShort(),r.relativeOffset+=8,n.metricDataFormat=r.parseShort(),n.numberOfHMetrics=r.parseUShort(),n},make:function(t){return new $.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],t)}};var Xt={parse:function(t,e,n,r,i,o,a){a.lowMemory?function(t,e,n,r,i){var o,a;t._hmtxTableData={};for(var s=new at.Parser(e,n),l=0;l<i;l+=1)l<r&&(o=s.parseUShort(),a=s.parseShort()),t._hmtxTableData[l]={advanceWidth:o,leftSideBearing:a}}(t,e,n,r,i):function(t,e,n,r,i){for(var o,a,s=new at.Parser(t,e),l=0;l<r;l+=1){l<n&&(o=s.parseUShort(),a=s.parseShort());var c=i.get(l);c.advanceWidth=o,c.leftSideBearing=a}}(e,n,r,i,o)},make:function(t){for(var e=new $.Table("hmtx",[]),n=0;n<t.length;n+=1){var r=t.get(n),i=r.advanceWidth||0,o=r.leftSideBearing||0;e.fields.push({name:"advanceWidth_"+n,type:"USHORT",value:i}),e.fields.push({name:"leftSideBearing_"+n,type:"SHORT",value:o})}return e}};var Wt={make:function(t){for(var e=new $.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:t.length}]),n="",r=12+4*t.length,i=0;i<t.length;++i){var o=n.indexOf(t[i]);o<0&&(o=n.length,n+=t[i]),e.fields.push({name:"offset "+i,type:"USHORT",value:r+o}),e.fields.push({name:"length "+i,type:"USHORT",value:t[i].length})}return e.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),e},parse:function(t,e){var n=new at.Parser(t,e),r=n.parseULong();A.argument(1===r,"Unsupported ltag table version."),n.skip("uLong",1);for(var i=n.parseULong(),o=[],a=0;a<i;a++){for(var s="",l=e+n.parseUShort(),c=n.parseUShort(),h=l;h<l+c;++h)s+=String.fromCharCode(t.getInt8(h));o.push(s)}return o}};var Yt={parse:function(t,e){var n={},r=new at.Parser(t,e);return n.version=r.parseVersion(),n.numGlyphs=r.parseUShort(),1===n.version&&(n.maxPoints=r.parseUShort(),n.maxContours=r.parseUShort(),n.maxCompositePoints=r.parseUShort(),n.maxCompositeContours=r.parseUShort(),n.maxZones=r.parseUShort(),n.maxTwilightPoints=r.parseUShort(),n.maxStorage=r.parseUShort(),n.maxFunctionDefs=r.parseUShort(),n.maxInstructionDefs=r.parseUShort(),n.maxStackElements=r.parseUShort(),n.maxSizeOfInstructions=r.parseUShort(),n.maxComponentElements=r.parseUShort(),n.maxComponentDepth=r.parseUShort()),n},make:function(t){return new $.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:t}])}},Vt=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],qt={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},Jt={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},Kt={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function Zt(t,e,n){switch(t){case 0:if(65535===e)return"und";if(n)return n[e];break;case 1:return qt[e];case 3:return Kt[e]}}var $t={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},Qt={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function te(t,e,n){switch(t){case 0:return"utf-16";case 1:return Qt[n]||$t[e];case 3:if(1===e||10===e)return"utf-16"}}function ee(t){var e={};for(var n in t)e[t[n]]=parseInt(n);return e}function ne(t,e,n,r,i,o){return new $.Record("NameRecord",[{name:"platformID",type:"USHORT",value:t},{name:"encodingID",type:"USHORT",value:e},{name:"languageID",type:"USHORT",value:n},{name:"nameID",type:"USHORT",value:r},{name:"length",type:"USHORT",value:i},{name:"offset",type:"USHORT",value:o}])}function re(t,e){var n=function(t,e){var n=t.length,r=e.length-n+1;t:for(var i=0;i<r;i++)for(;i<r;i++){for(var o=0;o<n;o++)if(e[i+o]!==t[o])continue t;return i}return-1}(t,e);if(n<0){n=e.length;for(var r=0,i=t.length;r<i;++r)e.push(t[r])}return n}var ie={parse:function(t,e,n){for(var r={},i=new at.Parser(t,e),o=i.parseUShort(),a=i.parseUShort(),s=i.offset+i.parseUShort(),l=0;l<a;l++){var c=i.parseUShort(),h=i.parseUShort(),u=i.parseUShort(),f=i.parseUShort(),p=Vt[f]||f,d=i.parseUShort(),g=i.parseUShort(),v=Zt(c,u,n),m=te(c,h,u);if(void 0!==m&&void 0!==v){var y=void 0;if(y="utf-16"===m?L.UTF16(t,s+g,d):L.MACSTRING(t,s+g,d,m)){var b=r[p];void 0===b&&(b=r[p]={}),b[v]=y}}}return 1===o&&i.parseUShort(),r},make:function(t,e){var n,r=[],i={},o=ee(Vt);for(var a in t){var s=o[a];if(void 0===s&&(s=a),n=parseInt(s),isNaN(n))throw new Error('Name table entry "'+a+'" does not exist, see nameTableNames for complete list.');i[n]=t[a],r.push(n)}for(var l=ee(qt),c=ee(Kt),h=[],u=[],f=0;f<r.length;f++){var p=i[n=r[f]];for(var d in p){var g=p[d],v=1,m=l[d],y=Jt[m],b=te(v,y,m),x=D.MACSTRING(g,b);void 0===x&&(v=0,(m=e.indexOf(d))<0&&(m=e.length,e.push(d)),y=4,x=D.UTF16(g));var w=re(x,u);h.push(ne(v,y,m,n,x.length,w));var S=c[d];if(void 0!==S){var C=D.UTF16(g),T=re(C,u);h.push(ne(3,1,S,n,C.length,T))}}}h.sort((function(t,e){return t.platformID-e.platformID||t.encodingID-e.encodingID||t.languageID-e.languageID||t.nameID-e.nameID}));for(var _=new $.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:h.length},{name:"stringOffset",type:"USHORT",value:6+12*h.length}]),O=0;O<h.length;O++)_.fields.push({name:"record_"+O,type:"RECORD",value:h[O]});return _.fields.push({name:"strings",type:"LITERAL",value:u}),_}},oe=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];var ae={parse:function(t,e){var n={},r=new at.Parser(t,e);n.version=r.parseUShort(),n.xAvgCharWidth=r.parseShort(),n.usWeightClass=r.parseUShort(),n.usWidthClass=r.parseUShort(),n.fsType=r.parseUShort(),n.ySubscriptXSize=r.parseShort(),n.ySubscriptYSize=r.parseShort(),n.ySubscriptXOffset=r.parseShort(),n.ySubscriptYOffset=r.parseShort(),n.ySuperscriptXSize=r.parseShort(),n.ySuperscriptYSize=r.parseShort(),n.ySuperscriptXOffset=r.parseShort(),n.ySuperscriptYOffset=r.parseShort(),n.yStrikeoutSize=r.parseShort(),n.yStrikeoutPosition=r.parseShort(),n.sFamilyClass=r.parseShort(),n.panose=[];for(var i=0;i<10;i++)n.panose[i]=r.parseByte();return n.ulUnicodeRange1=r.parseULong(),n.ulUnicodeRange2=r.parseULong(),n.ulUnicodeRange3=r.parseULong(),n.ulUnicodeRange4=r.parseULong(),n.achVendID=String.fromCharCode(r.parseByte(),r.parseByte(),r.parseByte(),r.parseByte()),n.fsSelection=r.parseUShort(),n.usFirstCharIndex=r.parseUShort(),n.usLastCharIndex=r.parseUShort(),n.sTypoAscender=r.parseShort(),n.sTypoDescender=r.parseShort(),n.sTypoLineGap=r.parseShort(),n.usWinAscent=r.parseUShort(),n.usWinDescent=r.parseUShort(),n.version>=1&&(n.ulCodePageRange1=r.parseULong(),n.ulCodePageRange2=r.parseULong()),n.version>=2&&(n.sxHeight=r.parseShort(),n.sCapHeight=r.parseShort(),n.usDefaultChar=r.parseUShort(),n.usBreakChar=r.parseUShort(),n.usMaxContent=r.parseUShort()),n},make:function(t){return new $.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],t)},unicodeRanges:oe,getUnicodeRange:function(t){for(var e=0;e<oe.length;e+=1){var n=oe[e];if(t>=n.begin&&t<n.end)return e}return-1}};var se={parse:function(t,e){var n={},r=new at.Parser(t,e);switch(n.version=r.parseVersion(),n.italicAngle=r.parseFixed(),n.underlinePosition=r.parseShort(),n.underlineThickness=r.parseShort(),n.isFixedPitch=r.parseULong(),n.minMemType42=r.parseULong(),n.maxMemType42=r.parseULong(),n.minMemType1=r.parseULong(),n.maxMemType1=r.parseULong(),n.version){case 1:n.names=ft.slice();break;case 2:n.numberOfGlyphs=r.parseUShort(),n.glyphNameIndex=new Array(n.numberOfGlyphs);for(var i=0;i<n.numberOfGlyphs;i++)n.glyphNameIndex[i]=r.parseUShort();n.names=[];for(var o=0;o<n.numberOfGlyphs;o++)if(n.glyphNameIndex[o]>=ft.length){var a=r.parseChar();n.names.push(r.parseString(a))}break;case 2.5:n.numberOfGlyphs=r.parseUShort(),n.offset=new Array(n.numberOfGlyphs);for(var s=0;s<n.numberOfGlyphs;s++)n.offset[s]=r.parseChar()}return n},make:function(){return new $.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}},le=new Array(9);le[1]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();return 1===e?{substFormat:1,coverage:this.parsePointer(it.coverage),deltaGlyphId:this.parseUShort()}:2===e?{substFormat:2,coverage:this.parsePointer(it.coverage),substitute:this.parseOffset16List()}:void A.assert(!1,"0x"+t.toString(16)+": lookup type 1 format must be 1 or 2.")},le[2]=function(){var t=this.parseUShort();return A.argument(1===t,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(it.coverage),sequences:this.parseListOfLists()}},le[3]=function(){var t=this.parseUShort();return A.argument(1===t,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(it.coverage),alternateSets:this.parseListOfLists()}},le[4]=function(){var t=this.parseUShort();return A.argument(1===t,"GSUB ligature table identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(it.coverage),ligatureSets:this.parseListOfLists((function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}}))}};var ce={sequenceIndex:it.uShort,lookupListIndex:it.uShort};le[5]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();if(1===e)return{substFormat:e,coverage:this.parsePointer(it.coverage),ruleSets:this.parseListOfLists((function(){var t=this.parseUShort(),e=this.parseUShort();return{input:this.parseUShortList(t-1),lookupRecords:this.parseRecordList(e,ce)}}))};if(2===e)return{substFormat:e,coverage:this.parsePointer(it.coverage),classDef:this.parsePointer(it.classDef),classSets:this.parseListOfLists((function(){var t=this.parseUShort(),e=this.parseUShort();return{classes:this.parseUShortList(t-1),lookupRecords:this.parseRecordList(e,ce)}}))};if(3===e){var n=this.parseUShort(),r=this.parseUShort();return{substFormat:e,coverages:this.parseList(n,it.pointer(it.coverage)),lookupRecords:this.parseRecordList(r,ce)}}A.assert(!1,"0x"+t.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},le[6]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();return 1===e?{substFormat:1,coverage:this.parsePointer(it.coverage),chainRuleSets:this.parseListOfLists((function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(ce)}}))}:2===e?{substFormat:2,coverage:this.parsePointer(it.coverage),backtrackClassDef:this.parsePointer(it.classDef),inputClassDef:this.parsePointer(it.classDef),lookaheadClassDef:this.parsePointer(it.classDef),chainClassSet:this.parseListOfLists((function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(ce)}}))}:3===e?{substFormat:3,backtrackCoverage:this.parseList(it.pointer(it.coverage)),inputCoverage:this.parseList(it.pointer(it.coverage)),lookaheadCoverage:this.parseList(it.pointer(it.coverage)),lookupRecords:this.parseRecordList(ce)}:void A.assert(!1,"0x"+t.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},le[7]=function(){var t=this.parseUShort();A.argument(1===t,"GSUB Extension Substitution subtable identifier-format must be 1");var e=this.parseUShort(),n=new it(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:e,extension:le[e].call(n)}},le[8]=function(){var t=this.parseUShort();return A.argument(1===t,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(it.coverage),backtrackCoverage:this.parseList(it.pointer(it.coverage)),lookaheadCoverage:this.parseList(it.pointer(it.coverage)),substitutes:this.parseUShortList()}};var he=new Array(9);he[1]=function(t){return 1===t.substFormat?new $.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new $.Coverage(t.coverage)},{name:"deltaGlyphID",type:"USHORT",value:t.deltaGlyphId}]):new $.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new $.Coverage(t.coverage)}].concat($.ushortList("substitute",t.substitute)))},he[2]=function(t){return A.assert(1===t.substFormat,"Lookup type 2 substFormat must be 1."),new $.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new $.Coverage(t.coverage)}].concat($.tableList("seqSet",t.sequences,(function(t){return new $.Table("sequenceSetTable",$.ushortList("sequence",t))}))))},he[3]=function(t){return A.assert(1===t.substFormat,"Lookup type 3 substFormat must be 1."),new $.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new $.Coverage(t.coverage)}].concat($.tableList("altSet",t.alternateSets,(function(t){return new $.Table("alternateSetTable",$.ushortList("alternate",t))}))))},he[4]=function(t){return A.assert(1===t.substFormat,"Lookup type 4 substFormat must be 1."),new $.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new $.Coverage(t.coverage)}].concat($.tableList("ligSet",t.ligatureSets,(function(t){return new $.Table("ligatureSetTable",$.tableList("ligature",t,(function(t){return new $.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:t.ligGlyph}].concat($.ushortList("component",t.components,t.components.length+1)))})))}))))},he[6]=function(t){if(1===t.substFormat)return new $.Table("chainContextTable",[{name:"substFormat",type:"USHORT",value:t.substFormat},{name:"coverage",type:"TABLE",value:new $.Coverage(t.coverage)}].concat($.tableList("chainRuleSet",t.chainRuleSets,(function(t){return new $.Table("chainRuleSetTable",$.tableList("chainRule",t,(function(t){var e=$.ushortList("backtrackGlyph",t.backtrack,t.backtrack.length).concat($.ushortList("inputGlyph",t.input,t.input.length+1)).concat($.ushortList("lookaheadGlyph",t.lookahead,t.lookahead.length)).concat($.ushortList("substitution",[],t.lookupRecords.length));return t.lookupRecords.forEach((function(t,n){e=e.concat({name:"sequenceIndex"+n,type:"USHORT",value:t.sequenceIndex}).concat({name:"lookupListIndex"+n,type:"USHORT",value:t.lookupListIndex})})),new $.Table("chainRuleTable",e)})))}))));if(2===t.substFormat)A.assert(!1,"lookup type 6 format 2 is not yet supported.");else if(3===t.substFormat){var e=[{name:"substFormat",type:"USHORT",value:t.substFormat}];return e.push({name:"backtrackGlyphCount",type:"USHORT",value:t.backtrackCoverage.length}),t.backtrackCoverage.forEach((function(t,n){e.push({name:"backtrackCoverage"+n,type:"TABLE",value:new $.Coverage(t)})})),e.push({name:"inputGlyphCount",type:"USHORT",value:t.inputCoverage.length}),t.inputCoverage.forEach((function(t,n){e.push({name:"inputCoverage"+n,type:"TABLE",value:new $.Coverage(t)})})),e.push({name:"lookaheadGlyphCount",type:"USHORT",value:t.lookaheadCoverage.length}),t.lookaheadCoverage.forEach((function(t,n){e.push({name:"lookaheadCoverage"+n,type:"TABLE",value:new $.Coverage(t)})})),e.push({name:"substitutionCount",type:"USHORT",value:t.lookupRecords.length}),t.lookupRecords.forEach((function(t,n){e=e.concat({name:"sequenceIndex"+n,type:"USHORT",value:t.sequenceIndex}).concat({name:"lookupListIndex"+n,type:"USHORT",value:t.lookupListIndex})})),new $.Table("chainContextTable",e)}A.assert(!1,"lookup type 6 format must be 1, 2 or 3.")};var ue={parse:function(t,e){var n=new it(t,e=e||0),r=n.parseVersion(1);return A.argument(1===r||1.1===r,"Unsupported GSUB table version."),1===r?{version:r,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(le)}:{version:r,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(le),variations:n.parseFeatureVariationsList()}},make:function(t){return new $.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new $.ScriptList(t.scripts)},{name:"features",type:"TABLE",value:new $.FeatureList(t.features)},{name:"lookups",type:"TABLE",value:new $.LookupList(t.lookups,he)}])}};var fe={parse:function(t,e){var n=new at.Parser(t,e),r=n.parseULong();A.argument(1===r,"Unsupported META table version."),n.parseULong(),n.parseULong();for(var i=n.parseULong(),o={},a=0;a<i;a++){var s=n.parseTag(),l=n.parseULong(),c=n.parseULong(),h=L.UTF8(t,e+l,c);o[s]=h}return o},make:function(t){var e=Object.keys(t).length,n="",r=16+12*e,i=new $.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:r},{name:"numTags",type:"ULONG",value:e}]);for(var o in t){var a=n.length;n+=t[o],i.fields.push({name:"tag "+o,type:"TAG",value:o}),i.fields.push({name:"offset "+o,type:"ULONG",value:r+a}),i.fields.push({name:"length "+o,type:"ULONG",value:t[o].length})}return i.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),i}};function pe(t){return Math.log(t)/Math.log(2)|0}function de(t){for(;t.length%4!=0;)t.push(0);for(var e=0,n=0;n<t.length;n+=4)e+=(t[n]<<24)+(t[n+1]<<16)+(t[n+2]<<8)+t[n+3];return e%=Math.pow(2,32)}function ge(t,e,n,r){return new $.Record("Table Record",[{name:"tag",type:"TAG",value:void 0!==t?t:""},{name:"checkSum",type:"ULONG",value:void 0!==e?e:0},{name:"offset",type:"ULONG",value:void 0!==n?n:0},{name:"length",type:"ULONG",value:void 0!==r?r:0}])}function ve(t){var e=new $.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);e.tables=t,e.numTables=t.length;var n=Math.pow(2,pe(e.numTables));e.searchRange=16*n,e.entrySelector=pe(n),e.rangeShift=16*e.numTables-e.searchRange;for(var r=[],i=[],o=e.sizeOf()+ge().sizeOf()*e.numTables;o%4!=0;)o+=1,i.push({name:"padding",type:"BYTE",value:0});for(var a=0;a<t.length;a+=1){var s=t[a];A.argument(4===s.tableName.length,"Table name"+s.tableName+" is invalid.");var l=s.sizeOf(),c=ge(s.tableName,de(s.encode()),o,l);for(r.push({name:c.tag+" Table Record",type:"RECORD",value:c}),i.push({name:s.tableName+" table",type:"RECORD",value:s}),o+=l,A.argument(!isNaN(o),"Something went wrong calculating the offset.");o%4!=0;)o+=1,i.push({name:"padding",type:"BYTE",value:0})}return r.sort((function(t,e){return t.value.tag>e.value.tag?1:-1})),e.fields=e.fields.concat(r),e.fields=e.fields.concat(i),e}function me(t,e,n){for(var r=0;r<e.length;r+=1){var i=t.charToGlyphIndex(e[r]);if(i>0)return t.glyphs.get(i).getMetrics()}return n}function ye(t){for(var e=0,n=0;n<t.length;n+=1)e+=t[n];return e/t.length}var be={make:ve,fontToTable:function(t){for(var e,n=[],r=[],i=[],o=[],a=[],s=[],l=[],c=0,h=0,u=0,f=0,p=0,d=0;d<t.glyphs.length;d+=1){var g=t.glyphs.get(d),v=0|g.unicode;if(isNaN(g.advanceWidth))throw new Error("Glyph "+g.name+" ("+d+"): advanceWidth is not a number.");(e>v||void 0===e)&&v>0&&(e=v),c<v&&(c=v);var m=ae.getUnicodeRange(v);if(m<32)h|=1<<m;else if(m<64)u|=1<<m-32;else if(m<96)f|=1<<m-64;else{if(!(m<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");p|=1<<m-96}if(".notdef"!==g.name){var y=g.getMetrics();n.push(y.xMin),r.push(y.yMin),i.push(y.xMax),o.push(y.yMax),s.push(y.leftSideBearing),l.push(y.rightSideBearing),a.push(g.advanceWidth)}}var b={xMin:Math.min.apply(null,n),yMin:Math.min.apply(null,r),xMax:Math.max.apply(null,i),yMax:Math.max.apply(null,o),advanceWidthMax:Math.max.apply(null,a),advanceWidthAvg:ye(a),minLeftSideBearing:Math.min.apply(null,s),maxLeftSideBearing:Math.max.apply(null,s),minRightSideBearing:Math.min.apply(null,l)};b.ascender=t.ascender,b.descender=t.descender;var x=Nt.make({flags:3,unitsPerEm:t.unitsPerEm,xMin:b.xMin,yMin:b.yMin,xMax:b.xMax,yMax:b.yMax,lowestRecPPEM:3,createdTimestamp:t.createdTimestamp}),w=Ht.make({ascender:b.ascender,descender:b.descender,advanceWidthMax:b.advanceWidthMax,minLeftSideBearing:b.minLeftSideBearing,minRightSideBearing:b.minRightSideBearing,xMaxExtent:b.maxLeftSideBearing+(b.xMax-b.xMin),numberOfHMetrics:t.glyphs.length}),S=Yt.make(t.glyphs.length),C=ae.make(Object.assign({xAvgCharWidth:Math.round(b.advanceWidthAvg),usFirstCharIndex:e,usLastCharIndex:c,ulUnicodeRange1:h,ulUnicodeRange2:u,ulUnicodeRange3:f,ulUnicodeRange4:p,sTypoAscender:b.ascender,sTypoDescender:b.descender,sTypoLineGap:0,usWinAscent:b.yMax,usWinDescent:Math.abs(b.yMin),ulCodePageRange1:1,sxHeight:me(t,"xyvw",{yMax:Math.round(b.ascender/2)}).yMax,sCapHeight:me(t,"HIKLEFJMNTZBDPRAGOQSUVWXY",b).yMax,usDefaultChar:t.hasChar(" ")?32:0,usBreakChar:t.hasChar(" ")?32:0},t.tables.os2)),T=Xt.make(t.glyphs),_=lt.make(t.glyphs),O=t.getEnglishName("fontFamily"),k=t.getEnglishName("fontSubfamily"),P=O+" "+k,E=t.getEnglishName("postScriptName");E||(E=O.replace(/\s/g,"")+"-"+k);var M={};for(var A in t.names)M[A]=t.names[A];M.uniqueID||(M.uniqueID={en:t.getEnglishName("manufacturer")+":"+P}),M.postScriptName||(M.postScriptName={en:E}),M.preferredFamily||(M.preferredFamily=t.names.fontFamily),M.preferredSubfamily||(M.preferredSubfamily=t.names.fontSubfamily);var L=[],D=ie.make(M,L),I=L.length>0?Wt.make(L):void 0,R=se.make(),j=Gt.make(t.glyphs,{version:t.getEnglishName("version"),fullName:P,familyName:O,weightName:k,postScriptName:E,unitsPerEm:t.unitsPerEm,fontBBox:[0,b.yMin,b.ascender,b.advanceWidthMax]}),B=t.metas&&Object.keys(t.metas).length>0?fe.make(t.metas):void 0,F=[x,w,S,C,D,_,R,j,T];I&&F.push(I),t.tables.gsub&&F.push(ue.make(t.tables.gsub)),B&&F.push(B);for(var U=ve(F),z=de(U.encode()),G=U.fields,N=!1,H=0;H<G.length;H+=1)if("head table"===G[H].name){G[H].value.checkSumAdjustment=2981146554-z,N=!0;break}if(!N)throw new Error("Could not find head table with checkSum to adjust.");return U},computeCheckSum:de};function xe(t,e){for(var n=0,r=t.length-1;n<=r;){var i=n+r>>>1,o=t[i].tag;if(o===e)return i;o<e?n=i+1:r=i-1}return-n-1}function we(t,e){for(var n=0,r=t.length-1;n<=r;){var i=n+r>>>1,o=t[i];if(o===e)return i;o<e?n=i+1:r=i-1}return-n-1}function Se(t,e){for(var n,r=0,i=t.length-1;r<=i;){var o=r+i>>>1,a=(n=t[o]).start;if(a===e)return n;a<e?r=o+1:i=o-1}if(r>0)return e>(n=t[r-1]).end?0:n}function Ce(t,e){this.font=t,this.tableName=e}function Te(t){Ce.call(this,t,"gpos")}function _e(t){Ce.call(this,t,"gsub")}function Oe(t,e){var n=t.length;if(n!==e.length)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function ke(t,e,n){for(var r=t.subtables,i=0;i<r.length;i++){var o=r[i];if(o.substFormat===e)return o}if(n)return r.push(n),n}function Pe(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),r=0;r<t.length;++r)n[r]=t[r];return e}function Ee(t,e){if(!t)throw e}function Me(t,e,n,r,i){var o;return(e&r)>0?(o=t.parseByte(),0==(e&i)&&(o=-o),o=n+o):o=(e&i)>0?n:n+t.parseShort(),o}function Ae(t,e,n){var r,i,o=new at.Parser(e,n);if(t.numberOfContours=o.parseShort(),t._xMin=o.parseShort(),t._yMin=o.parseShort(),t._xMax=o.parseShort(),t._yMax=o.parseShort(),t.numberOfContours>0){for(var a=t.endPointIndices=[],s=0;s<t.numberOfContours;s+=1)a.push(o.parseUShort());t.instructionLength=o.parseUShort(),t.instructions=[];for(var l=0;l<t.instructionLength;l+=1)t.instructions.push(o.parseByte());var c=a[a.length-1]+1;r=[];for(var h=0;h<c;h+=1)if(i=o.parseByte(),r.push(i),(8&i)>0)for(var u=o.parseByte(),f=0;f<u;f+=1)r.push(i),h+=1;if(A.argument(r.length===c,"Bad flags."),a.length>0){var p,d=[];if(c>0){for(var g=0;g<c;g+=1)i=r[g],(p={}).onCurve=!!(1&i),p.lastPointOfContour=a.indexOf(g)>=0,d.push(p);for(var v=0,m=0;m<c;m+=1)i=r[m],(p=d[m]).x=Me(o,i,v,2,16),v=p.x;for(var y=0,b=0;b<c;b+=1)i=r[b],(p=d[b]).y=Me(o,i,y,4,32),y=p.y}t.points=d}else t.points=[]}else if(0===t.numberOfContours)t.points=[];else{t.isComposite=!0,t.points=[],t.components=[];for(var x=!0;x;){r=o.parseUShort();var w={glyphIndex:o.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(1&r)>0?(2&r)>0?(w.dx=o.parseShort(),w.dy=o.parseShort()):w.matchedPoints=[o.parseUShort(),o.parseUShort()]:(2&r)>0?(w.dx=o.parseChar(),w.dy=o.parseChar()):w.matchedPoints=[o.parseByte(),o.parseByte()],(8&r)>0?w.xScale=w.yScale=o.parseF2Dot14():(64&r)>0?(w.xScale=o.parseF2Dot14(),w.yScale=o.parseF2Dot14()):(128&r)>0&&(w.xScale=o.parseF2Dot14(),w.scale01=o.parseF2Dot14(),w.scale10=o.parseF2Dot14(),w.yScale=o.parseF2Dot14()),t.components.push(w),x=!!(32&r)}if(256&r){t.instructionLength=o.parseUShort(),t.instructions=[];for(var S=0;S<t.instructionLength;S+=1)t.instructions.push(o.parseByte())}}}function Le(t,e){for(var n=[],r=0;r<t.length;r+=1){var i=t[r],o={x:e.xScale*i.x+e.scale01*i.y+e.dx,y:e.scale10*i.x+e.yScale*i.y+e.dy,onCurve:i.onCurve,lastPointOfContour:i.lastPointOfContour};n.push(o)}return n}function De(t){var e=new P;if(!t)return e;for(var n=function(t){for(var e=[],n=[],r=0;r<t.length;r+=1){var i=t[r];n.push(i),i.lastPointOfContour&&(e.push(n),n=[])}return A.argument(0===n.length,"There are still points left in the current contour."),e}(t),r=0;r<n.length;++r){var i=n[r],o=null,a=i[i.length-1],s=i[0];if(a.onCurve)e.moveTo(a.x,a.y);else if(s.onCurve)e.moveTo(s.x,s.y);else{var l={x:.5*(a.x+s.x),y:.5*(a.y+s.y)};e.moveTo(l.x,l.y)}for(var c=0;c<i.length;++c)if(o=a,a=s,s=i[(c+1)%i.length],a.onCurve)e.lineTo(a.x,a.y);else{var h=s;o.onCurve||{x:.5*(a.x+o.x),y:.5*(a.y+o.y)},s.onCurve||(h={x:.5*(a.x+s.x),y:.5*(a.y+s.y)}),e.quadraticCurveTo(a.x,a.y,h.x,h.y)}e.closePath()}return e}function Ie(t,e){if(e.isComposite)for(var n=0;n<e.components.length;n+=1){var r=e.components[n],i=t.get(r.glyphIndex);if(i.getPath(),i.points){var o=void 0;if(void 0===r.matchedPoints)o=Le(i.points,r);else{if(r.matchedPoints[0]>e.points.length-1||r.matchedPoints[1]>i.points.length-1)throw Error("Matched points out of range in "+e.name);var a=e.points[r.matchedPoints[0]],s=i.points[r.matchedPoints[1]],l={xScale:r.xScale,scale01:r.scale01,scale10:r.scale10,yScale:r.yScale,dx:0,dy:0};s=Le([s],l)[0],l.dx=a.x-s.x,l.dy=a.y-s.y,o=Le(i.points,l)}e.points=e.points.concat(o)}}return De(e.points)}Ce.prototype={searchTag:xe,binSearch:we,getTable:function(t){var e=this.font.tables[this.tableName];return!e&&t&&(e=this.font.tables[this.tableName]=this.createDefaultTable()),e},getScriptNames:function(){var t=this.getTable();return t?t.scripts.map((function(t){return t.tag})):[]},getDefaultScriptName:function(){var t=this.getTable();if(t){for(var e=!1,n=0;n<t.scripts.length;n++){var r=t.scripts[n].tag;if("DFLT"===r)return r;"latn"===r&&(e=!0)}return e?"latn":void 0}},getScriptTable:function(t,e){var n=this.getTable(e);if(n){t=t||"DFLT";var r=n.scripts,i=xe(n.scripts,t);if(i>=0)return r[i].script;if(e){var o={tag:t,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return r.splice(-1-i,0,o),o.script}}},getLangSysTable:function(t,e,n){var r=this.getScriptTable(t,n);if(r){if(!e||"dflt"===e||"DFLT"===e)return r.defaultLangSys;var i=xe(r.langSysRecords,e);if(i>=0)return r.langSysRecords[i].langSys;if(n){var o={tag:e,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return r.langSysRecords.splice(-1-i,0,o),o.langSys}}},getFeatureTable:function(t,e,n,r){var i=this.getLangSysTable(t,e,r);if(i){for(var o,a=i.featureIndexes,s=this.font.tables[this.tableName].features,l=0;l<a.length;l++)if((o=s[a[l]]).tag===n)return o.feature;if(r){var c=s.length;return A.assert(0===c||n>=s[c-1].tag,"Features must be added in alphabetical order."),o={tag:n,feature:{params:0,lookupListIndexes:[]}},s.push(o),a.push(c),o.feature}}},getLookupTables:function(t,e,n,r,i){var o=this.getFeatureTable(t,e,n,i),a=[];if(o){for(var s,l=o.lookupListIndexes,c=this.font.tables[this.tableName].lookups,h=0;h<l.length;h++)(s=c[l[h]]).lookupType===r&&a.push(s);if(0===a.length&&i){s={lookupType:r,lookupFlag:0,subtables:[],markFilteringSet:void 0};var u=c.length;return c.push(s),l.push(u),[s]}}return a},getGlyphClass:function(t,e){switch(t.format){case 1:return t.startGlyph<=e&&e<t.startGlyph+t.classes.length?t.classes[e-t.startGlyph]:0;case 2:var n=Se(t.ranges,e);return n?n.classId:0}},getCoverageIndex:function(t,e){switch(t.format){case 1:var n=we(t.glyphs,e);return n>=0?n:-1;case 2:var r=Se(t.ranges,e);return r?r.index+e-r.start:-1}},expandCoverage:function(t){if(1===t.format)return t.glyphs;for(var e=[],n=t.ranges,r=0;r<n.length;r++)for(var i=n[r],o=i.start,a=i.end,s=o;s<=a;s++)e.push(s);return e}},Te.prototype=Ce.prototype,Te.prototype.init=function(){var t=this.getDefaultScriptName();this.defaultKerningTables=this.getKerningTables(t)},Te.prototype.getKerningValue=function(t,e,n){for(var r=0;r<t.length;r++)for(var i=t[r].subtables,o=0;o<i.length;o++){var a=i[o],s=this.getCoverageIndex(a.coverage,e);if(!(s<0))switch(a.posFormat){case 1:for(var l=a.pairSets[s],c=0;c<l.length;c++){var h=l[c];if(h.secondGlyph===n)return h.value1&&h.value1.xAdvance||0}break;case 2:var u=this.getGlyphClass(a.classDef1,e),f=this.getGlyphClass(a.classDef2,n),p=a.classRecords[u][f];return p.value1&&p.value1.xAdvance||0}}return 0},Te.prototype.getKerningTables=function(t,e){if(this.font.tables.gpos)return this.getLookupTables(t,e,"kern",2)},_e.prototype=Ce.prototype,_e.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}},_e.prototype.getSingle=function(t,e,n){for(var r=[],i=this.getLookupTables(e,n,t,1),o=0;o<i.length;o++)for(var a=i[o].subtables,s=0;s<a.length;s++){var l=a[s],c=this.expandCoverage(l.coverage),h=void 0;if(1===l.substFormat){var u=l.deltaGlyphId;for(h=0;h<c.length;h++){var f=c[h];r.push({sub:f,by:f+u})}}else{var p=l.substitute;for(h=0;h<c.length;h++)r.push({sub:c[h],by:p[h]})}}return r},_e.prototype.getMultiple=function(t,e,n){for(var r=[],i=this.getLookupTables(e,n,t,2),o=0;o<i.length;o++)for(var a=i[o].subtables,s=0;s<a.length;s++){var l=a[s],c=this.expandCoverage(l.coverage),h=void 0;for(h=0;h<c.length;h++){var u=c[h],f=l.sequences[h];r.push({sub:u,by:f})}}return r},_e.prototype.getAlternates=function(t,e,n){for(var r=[],i=this.getLookupTables(e,n,t,3),o=0;o<i.length;o++)for(var a=i[o].subtables,s=0;s<a.length;s++)for(var l=a[s],c=this.expandCoverage(l.coverage),h=l.alternateSets,u=0;u<c.length;u++)r.push({sub:c[u],by:h[u]});return r},_e.prototype.getLigatures=function(t,e,n){for(var r=[],i=this.getLookupTables(e,n,t,4),o=0;o<i.length;o++)for(var a=i[o].subtables,s=0;s<a.length;s++)for(var l=a[s],c=this.expandCoverage(l.coverage),h=l.ligatureSets,u=0;u<c.length;u++)for(var f=c[u],p=h[u],d=0;d<p.length;d++){var g=p[d];r.push({sub:[f].concat(g.components),by:g.ligGlyph})}return r},_e.prototype.addSingle=function(t,e,n,r){var i=ke(this.getLookupTables(n,r,t,1,!0)[0],2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});A.assert(1===i.coverage.format,"Single: unable to modify coverage table format "+i.coverage.format);var o=e.sub,a=this.binSearch(i.coverage.glyphs,o);a<0&&(a=-1-a,i.coverage.glyphs.splice(a,0,o),i.substitute.splice(a,0,0)),i.substitute[a]=e.by},_e.prototype.addMultiple=function(t,e,n,r){A.assert(e.by instanceof Array&&e.by.length>1,'Multiple: "by" must be an array of two or more ids');var i=ke(this.getLookupTables(n,r,t,2,!0)[0],1,{substFormat:1,coverage:{format:1,glyphs:[]},sequences:[]});A.assert(1===i.coverage.format,"Multiple: unable to modify coverage table format "+i.coverage.format);var o=e.sub,a=this.binSearch(i.coverage.glyphs,o);a<0&&(a=-1-a,i.coverage.glyphs.splice(a,0,o),i.sequences.splice(a,0,0)),i.sequences[a]=e.by},_e.prototype.addAlternate=function(t,e,n,r){var i=ke(this.getLookupTables(n,r,t,3,!0)[0],1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});A.assert(1===i.coverage.format,"Alternate: unable to modify coverage table format "+i.coverage.format);var o=e.sub,a=this.binSearch(i.coverage.glyphs,o);a<0&&(a=-1-a,i.coverage.glyphs.splice(a,0,o),i.alternateSets.splice(a,0,0)),i.alternateSets[a]=e.by},_e.prototype.addLigature=function(t,e,n,r){var i=this.getLookupTables(n,r,t,4,!0)[0],o=i.subtables[0];o||(o={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},i.subtables[0]=o),A.assert(1===o.coverage.format,"Ligature: unable to modify coverage table format "+o.coverage.format);var a=e.sub[0],s=e.sub.slice(1),l={ligGlyph:e.by,components:s},c=this.binSearch(o.coverage.glyphs,a);if(c>=0){for(var h=o.ligatureSets[c],u=0;u<h.length;u++)if(Oe(h[u].components,s))return;h.push(l)}else c=-1-c,o.coverage.glyphs.splice(c,0,a),o.ligatureSets.splice(c,0,[l])},_e.prototype.getFeature=function(t,e,n){if(/ss\d\d/.test(t))return this.getSingle(t,e,n);switch(t){case"aalt":case"salt":return this.getSingle(t,e,n).concat(this.getAlternates(t,e,n));case"dlig":case"liga":case"rlig":return this.getLigatures(t,e,n);case"ccmp":return this.getMultiple(t,e,n).concat(this.getLigatures(t,e,n));case"stch":return this.getMultiple(t,e,n)}},_e.prototype.add=function(t,e,n,r){if(/ss\d\d/.test(t))return this.addSingle(t,e,n,r);switch(t){case"aalt":case"salt":return"number"==typeof e.by?this.addSingle(t,e,n,r):this.addAlternate(t,e,n,r);case"dlig":case"liga":case"rlig":return this.addLigature(t,e,n,r);case"ccmp":return e.by instanceof Array?this.addMultiple(t,e,n,r):this.addLigature(t,e,n,r)}};var Re,je,Be,Fe,Ue={getPath:De,parse:function(t,e,n,r,i){return i.lowMemory?function(t,e,n,r){var i=new St.GlyphSet(r);return r._push=function(o){var a=n[o];a!==n[o+1]?i.push(o,St.ttfGlyphLoader(r,o,Ae,t,e+a,Ie)):i.push(o,St.glyphLoader(r,o))},i}(t,e,n,r):function(t,e,n,r){for(var i=new St.GlyphSet(r),o=0;o<n.length-1;o+=1){var a=n[o];a!==n[o+1]?i.push(o,St.ttfGlyphLoader(r,o,Ae,t,e+a,Ie)):i.push(o,St.glyphLoader(r,o))}return i}(t,e,n,r)}};function ze(t){this.font=t,this.getCommands=function(t){return Ue.getPath(t).commands},this._fpgmState=this._prepState=void 0,this._errorState=0}function Ge(t){return t}function Ne(t){return Math.sign(t)*Math.round(Math.abs(t))}function He(t){return Math.sign(t)*Math.round(Math.abs(2*t))/2}function Xe(t){return Math.sign(t)*(Math.round(Math.abs(t)+.5)-.5)}function We(t){return Math.sign(t)*Math.ceil(Math.abs(t))}function Ye(t){return Math.sign(t)*Math.floor(Math.abs(t))}var Ve=function(t){var e=this.srPeriod,n=this.srPhase,r=1;return t<0&&(t=-t,r=-1),t+=this.srThreshold-n,t=Math.trunc(t/e)*e,(t+=n)<0?n*r:t*r},qe={x:1,y:0,axis:"x",distance:function(t,e,n,r){return(n?t.xo:t.x)-(r?e.xo:e.x)},interpolate:function(t,e,n,r){var i,o,a,s,l,c,h;if(!r||r===this)return i=t.xo-e.xo,o=t.xo-n.xo,l=e.x-e.xo,c=n.x-n.xo,0===(h=(a=Math.abs(i))+(s=Math.abs(o)))?void(t.x=t.xo+(l+c)/2):void(t.x=t.xo+(l*s+c*a)/h);i=r.distance(t,e,!0,!0),o=r.distance(t,n,!0,!0),l=r.distance(e,e,!1,!0),c=r.distance(n,n,!1,!0),0!==(h=(a=Math.abs(i))+(s=Math.abs(o)))?qe.setRelative(t,t,(l*s+c*a)/h,r,!0):qe.setRelative(t,t,(l+c)/2,r,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(t,e,n,r,i){if(r&&r!==this){var o=i?e.xo:e.x,a=i?e.yo:e.y,s=o+n*r.x,l=a+n*r.y;t.x=s+(t.y-l)/r.normalSlope}else t.x=(i?e.xo:e.x)+n},slope:0,touch:function(t){t.xTouched=!0},touched:function(t){return t.xTouched},untouch:function(t){t.xTouched=!1}},Je={x:0,y:1,axis:"y",distance:function(t,e,n,r){return(n?t.yo:t.y)-(r?e.yo:e.y)},interpolate:function(t,e,n,r){var i,o,a,s,l,c,h;if(!r||r===this)return i=t.yo-e.yo,o=t.yo-n.yo,l=e.y-e.yo,c=n.y-n.yo,0===(h=(a=Math.abs(i))+(s=Math.abs(o)))?void(t.y=t.yo+(l+c)/2):void(t.y=t.yo+(l*s+c*a)/h);i=r.distance(t,e,!0,!0),o=r.distance(t,n,!0,!0),l=r.distance(e,e,!1,!0),c=r.distance(n,n,!1,!0),0!==(h=(a=Math.abs(i))+(s=Math.abs(o)))?Je.setRelative(t,t,(l*s+c*a)/h,r,!0):Je.setRelative(t,t,(l+c)/2,r,!0)},normalSlope:0,setRelative:function(t,e,n,r,i){if(r&&r!==this){var o=i?e.xo:e.x,a=i?e.yo:e.y,s=o+n*r.x,l=a+n*r.y;t.y=l+r.normalSlope*(t.x-s)}else t.y=(i?e.yo:e.y)+n},slope:Number.POSITIVE_INFINITY,touch:function(t){t.yTouched=!0},touched:function(t){return t.yTouched},untouch:function(t){t.yTouched=!1}};function Ke(t,e){this.x=t,this.y=e,this.axis=void 0,this.slope=e/t,this.normalSlope=-t/e,Object.freeze(this)}function Ze(t,e){var n=Math.sqrt(t*t+e*e);return e/=n,1===(t/=n)&&0===e?qe:0===t&&1===e?Je:new Ke(t,e)}function $e(t,e,n,r){this.x=this.xo=Math.round(64*t)/64,this.y=this.yo=Math.round(64*e)/64,this.lastPointOfContour=n,this.onCurve=r,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}Object.freeze(qe),Object.freeze(Je),Ke.prototype.distance=function(t,e,n,r){return this.x*qe.distance(t,e,n,r)+this.y*Je.distance(t,e,n,r)},Ke.prototype.interpolate=function(t,e,n,r){var i,o,a,s,l,c,h;a=r.distance(t,e,!0,!0),s=r.distance(t,n,!0,!0),i=r.distance(e,e,!1,!0),o=r.distance(n,n,!1,!0),0!==(h=(l=Math.abs(a))+(c=Math.abs(s)))?this.setRelative(t,t,(i*c+o*l)/h,r,!0):this.setRelative(t,t,(i+o)/2,r,!0)},Ke.prototype.setRelative=function(t,e,n,r,i){r=r||this;var o=i?e.xo:e.x,a=i?e.yo:e.y,s=o+n*r.x,l=a+n*r.y,c=r.normalSlope,h=this.slope,u=t.x,f=t.y;t.x=(h*u-c*s+l-f)/(h-c),t.y=h*(t.x-u)+f},Ke.prototype.touch=function(t){t.xTouched=!0,t.yTouched=!0},$e.prototype.nextTouched=function(t){for(var e=this.nextPointOnContour;!t.touched(e)&&e!==this;)e=e.nextPointOnContour;return e},$e.prototype.prevTouched=function(t){for(var e=this.prevPointOnContour;!t.touched(e)&&e!==this;)e=e.prevPointOnContour;return e};var Qe=Object.freeze(new $e(0,0)),tn={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function en(t,e){switch(this.env=t,this.stack=[],this.prog=e,t){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=qe,this.round=Ne}}function nn(t){for(var e=t.tZone=new Array(t.gZone.length),n=0;n<e.length;n++)e[n]=new $e(0,0)}function rn(t,e){var n,r=t.prog,i=t.ip,o=1;do{if(88===(n=r[++i]))o++;else if(89===n)o--;else if(64===n)i+=r[i+1]+1;else if(65===n)i+=2*r[i+1]+1;else if(n>=176&&n<=183)i+=n-176+1;else if(n>=184&&n<=191)i+=2*(n-184+1);else if(e&&1===o&&27===n)break}while(o>0);t.ip=i}function on(t,e){exports.DEBUG&&console.log(e.step,"SVTCA["+t.axis+"]"),e.fv=e.pv=e.dpv=t}function an(t,e){exports.DEBUG&&console.log(e.step,"SPVTCA["+t.axis+"]"),e.pv=e.dpv=t}function sn(t,e){exports.DEBUG&&console.log(e.step,"SFVTCA["+t.axis+"]"),e.fv=t}function ln(t,e){var n,r,i=e.stack,o=i.pop(),a=i.pop(),s=e.z2[o],l=e.z1[a];exports.DEBUG&&console.log("SPVTL["+t+"]",o,a),t?(n=s.y-l.y,r=l.x-s.x):(n=l.x-s.x,r=l.y-s.y),e.pv=e.dpv=Ze(n,r)}function cn(t,e){var n,r,i=e.stack,o=i.pop(),a=i.pop(),s=e.z2[o],l=e.z1[a];exports.DEBUG&&console.log("SFVTL["+t+"]",o,a),t?(n=s.y-l.y,r=l.x-s.x):(n=l.x-s.x,r=l.y-s.y),e.fv=Ze(n,r)}function hn(t){exports.DEBUG&&console.log(t.step,"POP[]"),t.stack.pop()}function un(t,e){var n=e.stack.pop(),r=e.z0[n],i=e.fv,o=e.pv;exports.DEBUG&&console.log(e.step,"MDAP["+t+"]",n);var a=o.distance(r,Qe);t&&(a=e.round(a)),i.setRelative(r,Qe,a,o),i.touch(r),e.rp0=e.rp1=n}function fn(t,e){var n,r,i,o=e.z2,a=o.length-2;exports.DEBUG&&console.log(e.step,"IUP["+t.axis+"]");for(var s=0;s<a;s++)n=o[s],t.touched(n)||(r=n.prevTouched(t))!==n&&(r===(i=n.nextTouched(t))&&t.setRelative(n,n,t.distance(r,r,!1,!0),t,!0),t.interpolate(n,r,i,t))}function pn(t,e){for(var n=e.stack,r=t?e.rp1:e.rp2,i=(t?e.z0:e.z1)[r],o=e.fv,a=e.pv,s=e.loop,l=e.z2;s--;){var c=n.pop(),h=l[c],u=a.distance(i,i,!1,!0);o.setRelative(h,h,u,a),o.touch(h),exports.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-s)+": ":"")+"SHP["+(t?"rp1":"rp2")+"]",c)}e.loop=1}function dn(t,e){var n=e.stack,r=t?e.rp1:e.rp2,i=(t?e.z0:e.z1)[r],o=e.fv,a=e.pv,s=n.pop(),l=e.z2[e.contours[s]],c=l;exports.DEBUG&&console.log(e.step,"SHC["+t+"]",s);var h=a.distance(i,i,!1,!0);do{c!==i&&o.setRelative(c,c,h,a),c=c.nextPointOnContour}while(c!==l)}function gn(t,e){var n,r,i=e.stack,o=t?e.rp1:e.rp2,a=(t?e.z0:e.z1)[o],s=e.fv,l=e.pv,c=i.pop();switch(exports.DEBUG&&console.log(e.step,"SHZ["+t+"]",c),c){case 0:n=e.tZone;break;case 1:n=e.gZone;break;default:throw new Error("Invalid zone")}for(var h=l.distance(a,a,!1,!0),u=n.length-2,f=0;f<u;f++)r=n[f],s.setRelative(r,r,h,l)}function vn(t,e){var n=e.stack,r=n.pop()/64,i=n.pop(),o=e.z1[i],a=e.z0[e.rp0],s=e.fv,l=e.pv;s.setRelative(o,a,r,l),s.touch(o),exports.DEBUG&&console.log(e.step,"MSIRP["+t+"]",r,i),e.rp1=e.rp0,e.rp2=i,t&&(e.rp0=i)}function mn(t,e){var n=e.stack,r=n.pop(),i=n.pop(),o=e.z0[i],a=e.fv,s=e.pv,l=e.cvt[r];exports.DEBUG&&console.log(e.step,"MIAP["+t+"]",r,"(",l,")",i);var c=s.distance(o,Qe);t&&(Math.abs(c-l)<e.cvCutIn&&(c=l),c=e.round(c)),a.setRelative(o,Qe,c,s),0===e.zp0&&(o.xo=o.x,o.yo=o.y),a.touch(o),e.rp0=e.rp1=i}function yn(t,e){var n=e.stack,r=n.pop(),i=e.z2[r];exports.DEBUG&&console.log(e.step,"GC["+t+"]",r),n.push(64*e.dpv.distance(i,Qe,t,!1))}function bn(t,e){var n=e.stack,r=n.pop(),i=n.pop(),o=e.z1[r],a=e.z0[i],s=e.dpv.distance(a,o,t,t);exports.DEBUG&&console.log(e.step,"MD["+t+"]",r,i,"->",s),e.stack.push(Math.round(64*s))}function xn(t,e){var n=e.stack,r=n.pop(),i=e.fv,o=e.pv,a=e.ppem,s=e.deltaBase+16*(t-1),l=e.deltaShift,c=e.z0;exports.DEBUG&&console.log(e.step,"DELTAP["+t+"]",r,n);for(var h=0;h<r;h++){var u=n.pop(),f=n.pop();if(s+((240&f)>>4)===a){var p=(15&f)-8;p>=0&&p++,exports.DEBUG&&console.log(e.step,"DELTAPFIX",u,"by",p*l);var d=c[u];i.setRelative(d,d,p*l,o)}}}function wn(t,e){var n=e.stack,r=n.pop();exports.DEBUG&&console.log(e.step,"ROUND[]"),n.push(64*e.round(r/64))}function Sn(t,e){var n=e.stack,r=n.pop(),i=e.ppem,o=e.deltaBase+16*(t-1),a=e.deltaShift;exports.DEBUG&&console.log(e.step,"DELTAC["+t+"]",r,n);for(var s=0;s<r;s++){var l=n.pop(),c=n.pop();if(o+((240&c)>>4)===i){var h=(15&c)-8;h>=0&&h++;var u=h*a;exports.DEBUG&&console.log(e.step,"DELTACFIX",l,"by",u),e.cvt[l]+=u}}}function Cn(t,e){var n,r,i=e.stack,o=i.pop(),a=i.pop(),s=e.z2[o],l=e.z1[a];exports.DEBUG&&console.log(e.step,"SDPVTL["+t+"]",o,a),t?(n=s.y-l.y,r=l.x-s.x):(n=l.x-s.x,r=l.y-s.y),e.dpv=Ze(n,r)}function Tn(t,e){var n=e.stack,r=e.prog,i=e.ip;exports.DEBUG&&console.log(e.step,"PUSHB["+t+"]");for(var o=0;o<t;o++)n.push(r[++i]);e.ip=i}function _n(t,e){var n=e.ip,r=e.prog,i=e.stack;exports.DEBUG&&console.log(e.ip,"PUSHW["+t+"]");for(var o=0;o<t;o++){var a=r[++n]<<8|r[++n];32768&a&&(a=-(1+(65535^a))),i.push(a)}e.ip=n}function On(t,e,n,r,i,o){var a,s,l,c,h=o.stack,u=t&&h.pop(),f=h.pop(),p=o.rp0,d=o.z0[p],g=o.z1[f],v=o.minDis,m=o.fv,y=o.dpv;l=(s=a=y.distance(g,d,!0,!0))>=0?1:-1,s=Math.abs(s),t&&(c=o.cvt[u],r&&Math.abs(s-c)<o.cvCutIn&&(s=c)),n&&s<v&&(s=v),r&&(s=o.round(s)),m.setRelative(g,d,l*s,y),m.touch(g),exports.DEBUG&&console.log(o.step,(t?"MIRP[":"MDRP[")+(e?"M":"m")+(n?">":"_")+(r?"R":"_")+(0===i?"Gr":1===i?"Bl":2===i?"Wh":"")+"]",t?u+"("+o.cvt[u]+","+c+")":"",f,"(d =",a,"->",l*s,")"),o.rp1=o.rp0,o.rp2=f,e&&(o.rp0=f)}function kn(t){this.char=t,this.state={},this.activeState=null}function Pn(t,e,n){this.contextName=n,this.startIndex=t,this.endOffset=e}function En(t,e,n){this.contextName=t,this.openRange=null,this.ranges=[],this.checkStart=e,this.checkEnd=n}function Mn(t,e){this.context=t,this.index=e,this.length=t.length,this.current=t[e],this.backtrack=t.slice(0,e),this.lookahead=t.slice(e+1)}function An(t){this.eventId=t,this.subscribers=[]}function Ln(t){var e=this,n=["start","end","next","newToken","contextStart","contextEnd","insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD","updateContextsRanges"];n.forEach((function(t){Object.defineProperty(e.events,t,{value:new An(t)})})),t&&n.forEach((function(n){var r=t[n];"function"==typeof r&&e.events[n].subscribe(r)}));["insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD"].forEach((function(t){e.events[t].subscribe(e.updateContextsRanges)}))}function Dn(t){this.tokens=[],this.registeredContexts={},this.contextCheckers=[],this.events={},this.registeredModifiers=[],Ln.call(this,t)}function In(t){return/[\u0600-\u065F\u066A-\u06D2\u06FA-\u06FF]/.test(t)}function Rn(t){return/[\u0630\u0690\u0621\u0631\u0661\u0671\u0622\u0632\u0672\u0692\u06C2\u0623\u0673\u0693\u06C3\u0624\u0694\u06C4\u0625\u0675\u0695\u06C5\u06E5\u0676\u0696\u06C6\u0627\u0677\u0697\u06C7\u0648\u0688\u0698\u06C8\u0689\u0699\u06C9\u068A\u06CA\u066B\u068B\u06CB\u068C\u068D\u06CD\u06FD\u068E\u06EE\u06FE\u062F\u068F\u06CF\u06EF]/.test(t)}function jn(t){return/[\u0600-\u0605\u060C-\u060E\u0610-\u061B\u061E\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED]/.test(t)}function Bn(t){return/[A-z]/.test(t)}function Fn(t){this.font=t,this.features={}}function Un(t){this.id=t.id,this.tag=t.tag,this.substitution=t.substitution}function zn(t,e){if(!t)return-1;switch(e.format){case 1:return e.glyphs.indexOf(t);case 2:for(var n=e.ranges,r=0;r<n.length;r++){var i=n[r];if(t>=i.start&&t<=i.end){var o=t-i.start;return i.index+o}}break;default:return-1}return-1}function Gn(t,e){return-1===zn(t,e.coverage)?null:t+e.deltaGlyphId}function Nn(t,e){var n=zn(t,e.coverage);return-1===n?null:e.substitute[n]}function Hn(t,e){for(var n=[],r=0;r<t.length;r++){var i=t[r],o=e.current,a=zn(o=Array.isArray(o)?o[0]:o,i);-1!==a&&n.push(a)}return n.length!==t.length?-1:n}function Xn(t,e){var n=e.inputCoverage.length+e.lookaheadCoverage.length+e.backtrackCoverage.length;if(t.context.length<n)return[];var r=Hn(e.inputCoverage,t);if(-1===r)return[];var i=e.inputCoverage.length-1;if(t.lookahead.length<e.lookaheadCoverage.length)return[];for(var o=t.lookahead.slice(i);o.length&&jn(o[0].char);)o.shift();var a=new Mn(o,0),s=Hn(e.lookaheadCoverage,a),l=[].concat(t.backtrack);for(l.reverse();l.length&&jn(l[0].char);)l.shift();if(l.length<e.backtrackCoverage.length)return[];var c=new Mn(l,0),h=Hn(e.backtrackCoverage,c),u=[];if(r.length===e.inputCoverage.length&&s.length===e.lookaheadCoverage.length&&h.length===e.backtrackCoverage.length)for(var f=0;f<e.lookupRecords.length;f++)for(var p=e.lookupRecords[f].lookupListIndex,d=this.getLookupByIndex(p),g=0;g<d.subtables.length;g++){var v=d.subtables[g],m=this.getLookupMethod(d,v);if("12"===this.getSubstitutionType(d,v))for(var y=0;y<r.length;y++){var b=m(t.get(y));b&&u.push(b)}}return u}function Wn(t,e){var n,r=zn(t.current,e.coverage);if(-1===r)return null;for(var i=e.ligatureSets[r],o=0;o<i.length;o++){n=i[o];for(var a=0;a<n.components.length;a++){if(t.lookahead[a]!==n.components[a])break;if(a===n.components.length-1)return n}}return null}function Yn(t,e){var n=zn(t,e.coverage);return-1===n?null:e.sequences[n]}ze.prototype.exec=function(t,e){if("number"!=typeof e)throw new Error("Point size is not a number!");if(!(this._errorState>2)){var n=this.font,r=this._prepState;if(!r||r.ppem!==e){var i=this._fpgmState;if(!i){en.prototype=tn,(i=this._fpgmState=new en("fpgm",n.tables.fpgm)).funcs=[],i.font=n,exports.DEBUG&&(console.log("---EXEC FPGM---"),i.step=-1);try{je(i)}catch(t){return console.log("Hinting error in FPGM:"+t),void(this._errorState=3)}}en.prototype=i,(r=this._prepState=new en("prep",n.tables.prep)).ppem=e;var o=n.tables.cvt;if(o)for(var a=r.cvt=new Array(o.length),s=e/n.unitsPerEm,l=0;l<o.length;l++)a[l]=o[l]*s;else r.cvt=[];exports.DEBUG&&(console.log("---EXEC PREP---"),r.step=-1);try{je(r)}catch(t){this._errorState<2&&console.log("Hinting error in PREP:"+t),this._errorState=2}}if(!(this._errorState>1))try{return Be(t,r)}catch(t){return this._errorState<1&&(console.log("Hinting error:"+t),console.log("Note: further hinting errors are silenced")),void(this._errorState=1)}}},Be=function(t,e){var n,r,i,o=e.ppem/e.font.unitsPerEm,a=o,s=t.components;if(en.prototype=e,s){var l=e.font;r=[],n=[];for(var c=0;c<s.length;c++){var h=s[c],u=l.glyphs.get(h.glyphIndex);i=new en("glyf",u.instructions),exports.DEBUG&&(console.log("---EXEC COMP "+c+"---"),i.step=-1),Fe(u,i,o,a);for(var f=Math.round(h.dx*o),p=Math.round(h.dy*a),d=i.gZone,g=i.contours,v=0;v<d.length;v++){var m=d[v];m.xTouched=m.yTouched=!1,m.xo=m.x=m.x+f,m.yo=m.y=m.y+p}var y=r.length;r.push.apply(r,d);for(var b=0;b<g.length;b++)n.push(g[b]+y)}t.instructions&&!i.inhibitGridFit&&((i=new en("glyf",t.instructions)).gZone=i.z0=i.z1=i.z2=r,i.contours=n,r.push(new $e(0,0),new $e(Math.round(t.advanceWidth*o),0)),exports.DEBUG&&(console.log("---EXEC COMPOSITE---"),i.step=-1),je(i),r.length-=2)}else i=new en("glyf",t.instructions),exports.DEBUG&&(console.log("---EXEC GLYPH---"),i.step=-1),Fe(t,i,o,a),r=i.gZone;return r},Fe=function(t,e,n,r){for(var i,o,a,s=t.points||[],l=s.length,c=e.gZone=e.z0=e.z1=e.z2=[],h=e.contours=[],u=0;u<l;u++)i=s[u],c[u]=new $e(i.x*n,i.y*r,i.lastPointOfContour,i.onCurve);for(var f=0;f<l;f++)i=c[f],o||(o=i,h.push(f)),i.lastPointOfContour?(i.nextPointOnContour=o,o.prevPointOnContour=i,o=void 0):(a=c[f+1],i.nextPointOnContour=a,a.prevPointOnContour=i);if(!e.inhibitGridFit){if(exports.DEBUG){console.log("PROCESSING GLYPH",e.stack);for(var p=0;p<l;p++)console.log(p,c[p].x,c[p].y)}if(c.push(new $e(0,0),new $e(Math.round(t.advanceWidth*n),0)),je(e),c.length-=2,exports.DEBUG){console.log("FINISHED GLYPH",e.stack);for(var d=0;d<l;d++)console.log(d,c[d].x,c[d].y)}}},je=function(t){var e=t.prog;if(e){var n,r=e.length;for(t.ip=0;t.ip<r;t.ip++){if(exports.DEBUG&&t.step++,!(n=Re[e[t.ip]]))throw new Error("unknown instruction: 0x"+Number(e[t.ip]).toString(16));n(t)}}},Re=[on.bind(void 0,Je),on.bind(void 0,qe),an.bind(void 0,Je),an.bind(void 0,qe),sn.bind(void 0,Je),sn.bind(void 0,qe),ln.bind(void 0,0),ln.bind(void 0,1),cn.bind(void 0,0),cn.bind(void 0,1),function(t){var e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"SPVFS[]",n,r),t.pv=t.dpv=Ze(r,n)},function(t){var e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"SPVFS[]",n,r),t.fv=Ze(r,n)},function(t){var e=t.stack,n=t.pv;exports.DEBUG&&console.log(t.step,"GPV[]"),e.push(16384*n.x),e.push(16384*n.y)},function(t){var e=t.stack,n=t.fv;exports.DEBUG&&console.log(t.step,"GFV[]"),e.push(16384*n.x),e.push(16384*n.y)},function(t){t.fv=t.pv,exports.DEBUG&&console.log(t.step,"SFVTPV[]")},function(t){var e=t.stack,n=e.pop(),r=e.pop(),i=e.pop(),o=e.pop(),a=e.pop(),s=t.z0,l=t.z1,c=s[n],h=s[r],u=l[i],f=l[o],p=t.z2[a];exports.DEBUG&&console.log("ISECT[], ",n,r,i,o,a);var d=c.x,g=c.y,v=h.x,m=h.y,y=u.x,b=u.y,x=f.x,w=f.y,S=(d-v)*(b-w)-(g-m)*(y-x),C=d*m-g*v,T=y*w-b*x;p.x=(C*(y-x)-T*(d-v))/S,p.y=(C*(b-w)-T*(g-m))/S},function(t){t.rp0=t.stack.pop(),exports.DEBUG&&console.log(t.step,"SRP0[]",t.rp0)},function(t){t.rp1=t.stack.pop(),exports.DEBUG&&console.log(t.step,"SRP1[]",t.rp1)},function(t){t.rp2=t.stack.pop(),exports.DEBUG&&console.log(t.step,"SRP2[]",t.rp2)},function(t){var e=t.stack.pop();switch(exports.DEBUG&&console.log(t.step,"SZP0[]",e),t.zp0=e,e){case 0:t.tZone||nn(t),t.z0=t.tZone;break;case 1:t.z0=t.gZone;break;default:throw new Error("Invalid zone pointer")}},function(t){var e=t.stack.pop();switch(exports.DEBUG&&console.log(t.step,"SZP1[]",e),t.zp1=e,e){case 0:t.tZone||nn(t),t.z1=t.tZone;break;case 1:t.z1=t.gZone;break;default:throw new Error("Invalid zone pointer")}},function(t){var e=t.stack.pop();switch(exports.DEBUG&&console.log(t.step,"SZP2[]",e),t.zp2=e,e){case 0:t.tZone||nn(t),t.z2=t.tZone;break;case 1:t.z2=t.gZone;break;default:throw new Error("Invalid zone pointer")}},function(t){var e=t.stack.pop();switch(exports.DEBUG&&console.log(t.step,"SZPS[]",e),t.zp0=t.zp1=t.zp2=e,e){case 0:t.tZone||nn(t),t.z0=t.z1=t.z2=t.tZone;break;case 1:t.z0=t.z1=t.z2=t.gZone;break;default:throw new Error("Invalid zone pointer")}},function(t){t.loop=t.stack.pop(),exports.DEBUG&&console.log(t.step,"SLOOP[]",t.loop)},function(t){exports.DEBUG&&console.log(t.step,"RTG[]"),t.round=Ne},function(t){exports.DEBUG&&console.log(t.step,"RTHG[]"),t.round=Xe},function(t){var e=t.stack.pop();exports.DEBUG&&console.log(t.step,"SMD[]",e),t.minDis=e/64},function(t){exports.DEBUG&&console.log(t.step,"ELSE[]"),rn(t,!1)},function(t){var e=t.stack.pop();exports.DEBUG&&console.log(t.step,"JMPR[]",e),t.ip+=e-1},function(t){var e=t.stack.pop();exports.DEBUG&&console.log(t.step,"SCVTCI[]",e),t.cvCutIn=e/64},void 0,void 0,function(t){var e=t.stack;exports.DEBUG&&console.log(t.step,"DUP[]"),e.push(e[e.length-1])},hn,function(t){exports.DEBUG&&console.log(t.step,"CLEAR[]"),t.stack.length=0},function(t){var e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"SWAP[]"),e.push(n),e.push(r)},function(t){var e=t.stack;exports.DEBUG&&console.log(t.step,"DEPTH[]"),e.push(e.length)},function(t){var e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"CINDEX[]",n),e.push(e[e.length-n])},function(t){var e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"MINDEX[]",n),e.push(e.splice(e.length-n,1)[0])},void 0,void 0,void 0,function(t){var e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"LOOPCALL[]",n,r);var i=t.ip,o=t.prog;t.prog=t.funcs[n];for(var a=0;a<r;a++)je(t),exports.DEBUG&&console.log(++t.step,a+1<r?"next loopcall":"done loopcall",a);t.ip=i,t.prog=o},function(t){var e=t.stack.pop();exports.DEBUG&&console.log(t.step,"CALL[]",e);var n=t.ip,r=t.prog;t.prog=t.funcs[e],je(t),t.ip=n,t.prog=r,exports.DEBUG&&console.log(++t.step,"returning from",e)},function(t){if("fpgm"!==t.env)throw new Error("FDEF not allowed here");var e=t.stack,n=t.prog,r=t.ip,i=e.pop(),o=r;for(exports.DEBUG&&console.log(t.step,"FDEF[]",i);45!==n[++r];);t.ip=r,t.funcs[i]=n.slice(o+1,r)},void 0,un.bind(void 0,0),un.bind(void 0,1),fn.bind(void 0,Je),fn.bind(void 0,qe),pn.bind(void 0,0),pn.bind(void 0,1),dn.bind(void 0,0),dn.bind(void 0,1),gn.bind(void 0,0),gn.bind(void 0,1),function(t){for(var e=t.stack,n=t.loop,r=t.fv,i=e.pop()/64,o=t.z2;n--;){var a=e.pop(),s=o[a];exports.DEBUG&&console.log(t.step,(t.loop>1?"loop "+(t.loop-n)+": ":"")+"SHPIX[]",a,i),r.setRelative(s,s,i),r.touch(s)}t.loop=1},function(t){for(var e=t.stack,n=t.rp1,r=t.rp2,i=t.loop,o=t.z0[n],a=t.z1[r],s=t.fv,l=t.dpv,c=t.z2;i--;){var h=e.pop(),u=c[h];exports.DEBUG&&console.log(t.step,(t.loop>1?"loop "+(t.loop-i)+": ":"")+"IP[]",h,n,"<->",r),s.interpolate(u,o,a,l),s.touch(u)}t.loop=1},vn.bind(void 0,0),vn.bind(void 0,1),function(t){for(var e=t.stack,n=t.rp0,r=t.z0[n],i=t.loop,o=t.fv,a=t.pv,s=t.z1;i--;){var l=e.pop(),c=s[l];exports.DEBUG&&console.log(t.step,(t.loop>1?"loop "+(t.loop-i)+": ":"")+"ALIGNRP[]",l),o.setRelative(c,r,0,a),o.touch(c)}t.loop=1},function(t){exports.DEBUG&&console.log(t.step,"RTDG[]"),t.round=He},mn.bind(void 0,0),mn.bind(void 0,1),function(t){var e=t.prog,n=t.ip,r=t.stack,i=e[++n];exports.DEBUG&&console.log(t.step,"NPUSHB[]",i);for(var o=0;o<i;o++)r.push(e[++n]);t.ip=n},function(t){var e=t.ip,n=t.prog,r=t.stack,i=n[++e];exports.DEBUG&&console.log(t.step,"NPUSHW[]",i);for(var o=0;o<i;o++){var a=n[++e]<<8|n[++e];32768&a&&(a=-(1+(65535^a))),r.push(a)}t.ip=e},function(t){var e=t.stack,n=t.store;n||(n=t.store=[]);var r=e.pop(),i=e.pop();exports.DEBUG&&console.log(t.step,"WS",r,i),n[i]=r},function(t){var e=t.stack,n=t.store,r=e.pop();exports.DEBUG&&console.log(t.step,"RS",r);var i=n&&n[r]||0;e.push(i)},function(t){var e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"WCVTP",n,r),t.cvt[r]=n/64},function(t){var e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"RCVT",n),e.push(64*t.cvt[n])},yn.bind(void 0,0),yn.bind(void 0,1),void 0,bn.bind(void 0,0),bn.bind(void 0,1),function(t){exports.DEBUG&&console.log(t.step,"MPPEM[]"),t.stack.push(t.ppem)},void 0,function(t){exports.DEBUG&&console.log(t.step,"FLIPON[]"),t.autoFlip=!0},void 0,void 0,function(t){var e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"LT[]",n,r),e.push(r<n?1:0)},function(t){var e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"LTEQ[]",n,r),e.push(r<=n?1:0)},function(t){var e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"GT[]",n,r),e.push(r>n?1:0)},function(t){var e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"GTEQ[]",n,r),e.push(r>=n?1:0)},function(t){var e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"EQ[]",n,r),e.push(n===r?1:0)},function(t){var e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"NEQ[]",n,r),e.push(n!==r?1:0)},function(t){var e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"ODD[]",n),e.push(Math.trunc(n)%2?1:0)},function(t){var e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"EVEN[]",n),e.push(Math.trunc(n)%2?0:1)},function(t){var e=t.stack.pop();exports.DEBUG&&console.log(t.step,"IF[]",e),e||(rn(t,!0),exports.DEBUG&&console.log(t.step,"EIF[]"))},function(t){exports.DEBUG&&console.log(t.step,"EIF[]")},function(t){var e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"AND[]",n,r),e.push(n&&r?1:0)},function(t){var e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"OR[]",n,r),e.push(n||r?1:0)},function(t){var e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"NOT[]",n),e.push(n?0:1)},xn.bind(void 0,1),function(t){var e=t.stack.pop();exports.DEBUG&&console.log(t.step,"SDB[]",e),t.deltaBase=e},function(t){var e=t.stack.pop();exports.DEBUG&&console.log(t.step,"SDS[]",e),t.deltaShift=Math.pow(.5,e)},function(t){var e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"ADD[]",n,r),e.push(r+n)},function(t){var e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"SUB[]",n,r),e.push(r-n)},function(t){var e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"DIV[]",n,r),e.push(64*r/n)},function(t){var e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"MUL[]",n,r),e.push(r*n/64)},function(t){var e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"ABS[]",n),e.push(Math.abs(n))},function(t){var e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"NEG[]",n),e.push(-n)},function(t){var e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"FLOOR[]",n),e.push(64*Math.floor(n/64))},function(t){var e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"CEILING[]",n),e.push(64*Math.ceil(n/64))},wn.bind(void 0,0),wn.bind(void 0,1),wn.bind(void 0,2),wn.bind(void 0,3),void 0,void 0,void 0,void 0,function(t){var e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"WCVTF[]",n,r),t.cvt[r]=n*t.ppem/t.font.unitsPerEm},xn.bind(void 0,2),xn.bind(void 0,3),Sn.bind(void 0,1),Sn.bind(void 0,2),Sn.bind(void 0,3),function(t){var e,n=t.stack.pop();switch(exports.DEBUG&&console.log(t.step,"SROUND[]",n),t.round=Ve,192&n){case 0:e=.5;break;case 64:e=1;break;case 128:e=2;break;default:throw new Error("invalid SROUND value")}switch(t.srPeriod=e,48&n){case 0:t.srPhase=0;break;case 16:t.srPhase=.25*e;break;case 32:t.srPhase=.5*e;break;case 48:t.srPhase=.75*e;break;default:throw new Error("invalid SROUND value")}n&=15,t.srThreshold=0===n?0:(n/8-.5)*e},function(t){var e,n=t.stack.pop();switch(exports.DEBUG&&console.log(t.step,"S45ROUND[]",n),t.round=Ve,192&n){case 0:e=Math.sqrt(2)/2;break;case 64:e=Math.sqrt(2);break;case 128:e=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(t.srPeriod=e,48&n){case 0:t.srPhase=0;break;case 16:t.srPhase=.25*e;break;case 32:t.srPhase=.5*e;break;case 48:t.srPhase=.75*e;break;default:throw new Error("invalid S45ROUND value")}n&=15,t.srThreshold=0===n?0:(n/8-.5)*e},void 0,void 0,function(t){exports.DEBUG&&console.log(t.step,"ROFF[]"),t.round=Ge},void 0,function(t){exports.DEBUG&&console.log(t.step,"RUTG[]"),t.round=We},function(t){exports.DEBUG&&console.log(t.step,"RDTG[]"),t.round=Ye},hn,hn,void 0,void 0,void 0,void 0,void 0,function(t){var e=t.stack.pop();exports.DEBUG&&console.log(t.step,"SCANCTRL[]",e)},Cn.bind(void 0,0),Cn.bind(void 0,1),function(t){var e=t.stack,n=e.pop(),r=0;exports.DEBUG&&console.log(t.step,"GETINFO[]",n),1&n&&(r=35),32&n&&(r|=4096),e.push(r)},void 0,function(t){var e=t.stack,n=e.pop(),r=e.pop(),i=e.pop();exports.DEBUG&&console.log(t.step,"ROLL[]"),e.push(r),e.push(n),e.push(i)},function(t){var e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"MAX[]",n,r),e.push(Math.max(r,n))},function(t){var e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"MIN[]",n,r),e.push(Math.min(r,n))},function(t){var e=t.stack.pop();exports.DEBUG&&console.log(t.step,"SCANTYPE[]",e)},function(t){var e=t.stack.pop(),n=t.stack.pop();switch(exports.DEBUG&&console.log(t.step,"INSTCTRL[]",e,n),e){case 1:return void(t.inhibitGridFit=!!n);case 2:return void(t.ignoreCvt=!!n);default:throw new Error("invalid INSTCTRL[] selector")}},void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,Tn.bind(void 0,1),Tn.bind(void 0,2),Tn.bind(void 0,3),Tn.bind(void 0,4),Tn.bind(void 0,5),Tn.bind(void 0,6),Tn.bind(void 0,7),Tn.bind(void 0,8),_n.bind(void 0,1),_n.bind(void 0,2),_n.bind(void 0,3),_n.bind(void 0,4),_n.bind(void 0,5),_n.bind(void 0,6),_n.bind(void 0,7),_n.bind(void 0,8),On.bind(void 0,0,0,0,0,0),On.bind(void 0,0,0,0,0,1),On.bind(void 0,0,0,0,0,2),On.bind(void 0,0,0,0,0,3),On.bind(void 0,0,0,0,1,0),On.bind(void 0,0,0,0,1,1),On.bind(void 0,0,0,0,1,2),On.bind(void 0,0,0,0,1,3),On.bind(void 0,0,0,1,0,0),On.bind(void 0,0,0,1,0,1),On.bind(void 0,0,0,1,0,2),On.bind(void 0,0,0,1,0,3),On.bind(void 0,0,0,1,1,0),On.bind(void 0,0,0,1,1,1),On.bind(void 0,0,0,1,1,2),On.bind(void 0,0,0,1,1,3),On.bind(void 0,0,1,0,0,0),On.bind(void 0,0,1,0,0,1),On.bind(void 0,0,1,0,0,2),On.bind(void 0,0,1,0,0,3),On.bind(void 0,0,1,0,1,0),On.bind(void 0,0,1,0,1,1),On.bind(void 0,0,1,0,1,2),On.bind(void 0,0,1,0,1,3),On.bind(void 0,0,1,1,0,0),On.bind(void 0,0,1,1,0,1),On.bind(void 0,0,1,1,0,2),On.bind(void 0,0,1,1,0,3),On.bind(void 0,0,1,1,1,0),On.bind(void 0,0,1,1,1,1),On.bind(void 0,0,1,1,1,2),On.bind(void 0,0,1,1,1,3),On.bind(void 0,1,0,0,0,0),On.bind(void 0,1,0,0,0,1),On.bind(void 0,1,0,0,0,2),On.bind(void 0,1,0,0,0,3),On.bind(void 0,1,0,0,1,0),On.bind(void 0,1,0,0,1,1),On.bind(void 0,1,0,0,1,2),On.bind(void 0,1,0,0,1,3),On.bind(void 0,1,0,1,0,0),On.bind(void 0,1,0,1,0,1),On.bind(void 0,1,0,1,0,2),On.bind(void 0,1,0,1,0,3),On.bind(void 0,1,0,1,1,0),On.bind(void 0,1,0,1,1,1),On.bind(void 0,1,0,1,1,2),On.bind(void 0,1,0,1,1,3),On.bind(void 0,1,1,0,0,0),On.bind(void 0,1,1,0,0,1),On.bind(void 0,1,1,0,0,2),On.bind(void 0,1,1,0,0,3),On.bind(void 0,1,1,0,1,0),On.bind(void 0,1,1,0,1,1),On.bind(void 0,1,1,0,1,2),On.bind(void 0,1,1,0,1,3),On.bind(void 0,1,1,1,0,0),On.bind(void 0,1,1,1,0,1),On.bind(void 0,1,1,1,0,2),On.bind(void 0,1,1,1,0,3),On.bind(void 0,1,1,1,1,0),On.bind(void 0,1,1,1,1,1),On.bind(void 0,1,1,1,1,2),On.bind(void 0,1,1,1,1,3)],kn.prototype.setState=function(t,e){return this.state[t]=e,this.activeState={key:t,value:this.state[t]},this.activeState},kn.prototype.getState=function(t){return this.state[t]||null},Dn.prototype.inboundIndex=function(t){return t>=0&&t<this.tokens.length},Dn.prototype.composeRUD=function(t){var e=this,n=t.map((function(t){return e[t[0]].apply(e,t.slice(1).concat(!0))})),r=function(t){return"object"==typeof t&&t.hasOwnProperty("FAIL")};if(n.every(r))return{FAIL:"composeRUD: one or more operations hasn't completed successfully",report:n.filter(r)};this.dispatch("composeRUD",[n.filter((function(t){return!r(t)}))])},Dn.prototype.replaceRange=function(t,e,n,r){e=null!==e?e:this.tokens.length;var i=n.every((function(t){return t instanceof kn}));if(!isNaN(t)&&this.inboundIndex(t)&&i){var o=this.tokens.splice.apply(this.tokens,[t,e].concat(n));return r||this.dispatch("replaceToken",[t,e,n]),[o,n]}return{FAIL:"replaceRange: invalid tokens or startIndex."}},Dn.prototype.replaceToken=function(t,e,n){if(!isNaN(t)&&this.inboundIndex(t)&&e instanceof kn){var r=this.tokens.splice(t,1,e);return n||this.dispatch("replaceToken",[t,e]),[r[0],e]}return{FAIL:"replaceToken: invalid token or index."}},Dn.prototype.removeRange=function(t,e,n){e=isNaN(e)?this.tokens.length:e;var r=this.tokens.splice(t,e);return n||this.dispatch("removeRange",[r,t,e]),r},Dn.prototype.removeToken=function(t,e){if(!isNaN(t)&&this.inboundIndex(t)){var n=this.tokens.splice(t,1);return e||this.dispatch("removeToken",[n,t]),n}return{FAIL:"removeToken: invalid token index."}},Dn.prototype.insertToken=function(t,e,n){return t.every((function(t){return t instanceof kn}))?(this.tokens.splice.apply(this.tokens,[e,0].concat(t)),n||this.dispatch("insertToken",[t,e]),t):{FAIL:"insertToken: invalid token(s)."}},Dn.prototype.registerModifier=function(t,e,n){this.events.newToken.subscribe((function(r,i){var o=[r,i],a=[r,i];if(null===e||!0===e.apply(this,o)){var s=n.apply(this,a);r.setState(t,s)}})),this.registeredModifiers.push(t)},An.prototype.subscribe=function(t){return"function"==typeof t?this.subscribers.push(t)-1:{FAIL:"invalid '"+this.eventId+"' event handler"}},An.prototype.unsubscribe=function(t){this.subscribers.splice(t,1)},Mn.prototype.setCurrentIndex=function(t){this.index=t,this.current=this.context[t],this.backtrack=this.context.slice(0,t),this.lookahead=this.context.slice(t+1)},Mn.prototype.get=function(t){switch(!0){case 0===t:return this.current;case t<0&&Math.abs(t)<=this.backtrack.length:return this.backtrack.slice(t)[0];case t>0&&t<=this.lookahead.length:return this.lookahead[t-1];default:return null}},Dn.prototype.rangeToText=function(t){if(t instanceof Pn)return this.getRangeTokens(t).map((function(t){return t.char})).join("")},Dn.prototype.getText=function(){return this.tokens.map((function(t){return t.char})).join("")},Dn.prototype.getContext=function(t){var e=this.registeredContexts[t];return e||null},Dn.prototype.on=function(t,e){var n=this.events[t];return n?n.subscribe(e):null},Dn.prototype.dispatch=function(t,e){var n=this,r=this.events[t];r instanceof An&&r.subscribers.forEach((function(t){t.apply(n,e||[])}))},Dn.prototype.registerContextChecker=function(t,e,n){if(this.getContext(t))return{FAIL:"context name '"+t+"' is already registered."};if("function"!=typeof e)return{FAIL:"missing context start check."};if("function"!=typeof n)return{FAIL:"missing context end check."};var r=new En(t,e,n);return this.registeredContexts[t]=r,this.contextCheckers.push(r),r},Dn.prototype.getRangeTokens=function(t){var e=t.startIndex+t.endOffset;return[].concat(this.tokens.slice(t.startIndex,e))},Dn.prototype.getContextRanges=function(t){var e=this.getContext(t);return e?e.ranges:{FAIL:"context checker '"+t+"' is not registered."}},Dn.prototype.resetContextsRanges=function(){var t=this.registeredContexts;for(var e in t){if(t.hasOwnProperty(e))t[e].ranges=[]}},Dn.prototype.updateContextsRanges=function(){this.resetContextsRanges();for(var t=this.tokens.map((function(t){return t.char})),e=0;e<t.length;e++){var n=new Mn(t,e);this.runContextCheck(n)}this.dispatch("updateContextsRanges",[this.registeredContexts])},Dn.prototype.setEndOffset=function(t,e){var n=new Pn(this.getContext(e).openRange.startIndex,t,e),r=this.getContext(e).ranges;return n.rangeId=e+"."+r.length,r.push(n),this.getContext(e).openRange=null,n},Dn.prototype.runContextCheck=function(t){var e=this,n=t.index;this.contextCheckers.forEach((function(r){var i=r.contextName,o=e.getContext(i).openRange;if(!o&&r.checkStart(t)&&(o=new Pn(n,null,i),e.getContext(i).openRange=o,e.dispatch("contextStart",[i,n])),o&&r.checkEnd(t)){var a=n-o.startIndex+1,s=e.setEndOffset(a,i);e.dispatch("contextEnd",[i,s])}}))},Dn.prototype.tokenize=function(t){this.tokens=[],this.resetContextsRanges();var e=Array.from(t);this.dispatch("start");for(var n=0;n<e.length;n++){var r=e[n],i=new Mn(e,n);this.dispatch("next",[i]),this.runContextCheck(i);var o=new kn(r);this.tokens.push(o),this.dispatch("newToken",[o,i])}return this.dispatch("end",[this.tokens]),this.tokens},Fn.prototype.getDefaultScriptFeaturesIndexes=function(){for(var t=this.font.tables.gsub.scripts,e=0;e<t.length;e++){var n=t[e];if("DFLT"===n.tag)return n.script.defaultLangSys.featureIndexes}return[]},Fn.prototype.getScriptFeaturesIndexes=function(t){if(!this.font.tables.gsub)return[];if(!t)return this.getDefaultScriptFeaturesIndexes();for(var e=this.font.tables.gsub.scripts,n=0;n<e.length;n++){var r=e[n];if(r.tag===t&&r.script.defaultLangSys)return r.script.defaultLangSys.featureIndexes;var i=r.langSysRecords;if(i)for(var o=0;o<i.length;o++){var a=i[o];if(a.tag===t)return a.langSys.featureIndexes}}return this.getDefaultScriptFeaturesIndexes()},Fn.prototype.mapTagsToFeatures=function(t,e){for(var n={},r=0;r<t.length;r++){var i=t[r].tag,o=t[r].feature;n[i]=o}this.features[e].tags=n},Fn.prototype.getScriptFeatures=function(t){var e=this.features[t];if(this.features.hasOwnProperty(t))return e;var n=this.getScriptFeaturesIndexes(t);if(!n)return null;var r=this.font.tables.gsub;return e=n.map((function(t){return r.features[t]})),this.features[t]=e,this.mapTagsToFeatures(e,t),e},Fn.prototype.getSubstitutionType=function(t,e){return t.lookupType.toString()+e.substFormat.toString()},Fn.prototype.getLookupMethod=function(t,e){var n=this;switch(this.getSubstitutionType(t,e)){case"11":return function(t){return Gn.apply(n,[t,e])};case"12":return function(t){return Nn.apply(n,[t,e])};case"63":return function(t){return Xn.apply(n,[t,e])};case"41":return function(t){return Wn.apply(n,[t,e])};case"21":return function(t){return Yn.apply(n,[t,e])};default:throw new Error("lookupType: "+t.lookupType+" - substFormat: "+e.substFormat+" is not yet supported")}},Fn.prototype.lookupFeature=function(t){var e=t.contextParams,n=e.index,r=this.getFeature({tag:t.tag,script:t.script});if(!r)return new Error("font '"+this.font.names.fullName.en+"' doesn't support feature '"+t.tag+"' for script '"+t.script+"'.");for(var i=this.getFeatureLookups(r),o=[].concat(e.context),a=0;a<i.length;a++)for(var s=i[a],l=this.getLookupSubtables(s),c=0;c<l.length;c++){var h=l[c],u=this.getSubstitutionType(s,h),f=this.getLookupMethod(s,h),p=void 0;switch(u){case"11":(p=f(e.current))&&o.splice(n,1,new Un({id:11,tag:t.tag,substitution:p}));break;case"12":(p=f(e.current))&&o.splice(n,1,new Un({id:12,tag:t.tag,substitution:p}));break;case"63":p=f(e),Array.isArray(p)&&p.length&&o.splice(n,1,new Un({id:63,tag:t.tag,substitution:p}));break;case"41":(p=f(e))&&o.splice(n,1,new Un({id:41,tag:t.tag,substitution:p}));break;case"21":(p=f(e.current))&&o.splice(n,1,new Un({id:21,tag:t.tag,substitution:p}))}e=new Mn(o,n),Array.isArray(p)&&!p.length||(p=null)}return o.length?o:null},Fn.prototype.supports=function(t){if(!t.script)return!1;this.getScriptFeatures(t.script);var e=this.features.hasOwnProperty(t.script);if(!t.tag)return e;var n=this.features[t.script].some((function(e){return e.tag===t.tag}));return e&&n},Fn.prototype.getLookupSubtables=function(t){return t.subtables||null},Fn.prototype.getLookupByIndex=function(t){return this.font.tables.gsub.lookups[t]||null},Fn.prototype.getFeatureLookups=function(t){return t.lookupListIndexes.map(this.getLookupByIndex.bind(this))},Fn.prototype.getFeature=function(t){if(!this.font)return{FAIL:"No font was found"};this.features.hasOwnProperty(t.script)||this.getScriptFeatures(t.script);var e=this.features[t.script];return e?e.tags[t.tag]?this.features[t.script].tags[t.tag]:null:{FAIL:"No feature for script "+t.script}};var Vn={startCheck:function(t){var e=t.current,n=t.get(-1);return null===n&&In(e)||!In(n)&&In(e)},endCheck:function(t){var e=t.get(1);return null===e||!In(e)}};var qn={startCheck:function(t){var e=t.current,n=t.get(-1);return(In(e)||jn(e))&&!In(n)},endCheck:function(t){var e=t.get(1);switch(!0){case null===e:return!0;case!In(e)&&!jn(e):var n=/\s/.test(e);if(!n)return!0;if(n){if(!t.lookahead.some((function(t){return In(t)||jn(t)})))return!0}break;default:return!1}}};var Jn={11:function(t,e,n){e[n].setState(t.tag,t.substitution)},12:function(t,e,n){e[n].setState(t.tag,t.substitution)},63:function(t,e,n){t.substitution.forEach((function(r,i){e[n+i].setState(t.tag,r)}))},41:function(t,e,n){var r=e[n];r.setState(t.tag,t.substitution.ligGlyph);for(var i=t.substitution.components.length,o=0;o<i;o++)(r=e[n+o+1]).setState("deleted",!0)}};function Kn(t,e,n){t instanceof Un&&Jn[t.id]&&Jn[t.id](t,e,n)}function Zn(t){var e=this,n=this.featuresTags.arab,r=this.tokenizer.getRangeTokens(t);if(1!==r.length){var i=new Mn(r.map((function(t){return t.getState("glyphIndex")})),0),o=new Mn(r.map((function(t){return t.char})),0);r.forEach((function(t,a){if(!jn(t.char)){i.setCurrentIndex(a),o.setCurrentIndex(a);var s,l=0;switch(function(t){for(var e=[].concat(t.backtrack),n=e.length-1;n>=0;n--){var r=e[n],i=Rn(r),o=jn(r);if(!i&&!o)return!0;if(i)return!1}return!1}(o)&&(l|=1),function(t){if(Rn(t.current))return!1;for(var e=0;e<t.lookahead.length;e++){if(!jn(t.lookahead[e]))return!0}return!1}(o)&&(l|=2),l){case 1:s="fina";break;case 2:s="init";break;case 3:s="medi"}if(-1!==n.indexOf(s)){var c=e.query.lookupFeature({tag:s,script:"arab",contextParams:i});if(c instanceof Error)return console.info(c.message);c.forEach((function(t,e){t instanceof Un&&(Kn(t,r,e),i.context[e]=t.substitution)}))}}}))}}function $n(t,e){return new Mn(t.map((function(t){return t.activeState.value})),e||0)}function Qn(t){var e=this,n=this.tokenizer.getRangeTokens(t),r=$n(n);r.context.forEach((function(t,i){r.setCurrentIndex(i);var o=e.query.lookupFeature({tag:"rlig",script:"arab",contextParams:r});o.length&&(o.forEach((function(t){return Kn(t,n,i)})),r=$n(n))}))}var tr={startCheck:function(t){var e=t.current,n=t.get(-1);return null===n&&Bn(e)||!Bn(n)&&Bn(e)},endCheck:function(t){var e=t.get(1);return null===e||!Bn(e)}};function er(t,e){return new Mn(t.map((function(t){return t.activeState.value})),e||0)}function nr(t){var e=this,n=this.tokenizer.getRangeTokens(t),r=er(n);r.context.forEach((function(t,i){r.setCurrentIndex(i);var o=e.query.lookupFeature({tag:"liga",script:"latn",contextParams:r});o.length&&(o.forEach((function(t){return Kn(t,n,i)})),r=er(n))}))}function rr(t){this.baseDir=t||"ltr",this.tokenizer=new Dn,this.featuresTags={}}function ir(t){var e=this.contextChecks[t+"Check"];return this.tokenizer.registerContextChecker(t,e.startCheck,e.endCheck)}function or(){return ir.call(this,"latinWord"),ir.call(this,"arabicWord"),ir.call(this,"arabicSentence"),this.tokenizer.tokenize(this.text)}function ar(){var t=this;this.tokenizer.getContextRanges("arabicSentence").forEach((function(e){var n=t.tokenizer.getRangeTokens(e);t.tokenizer.replaceRange(e.startIndex,e.endOffset,n.reverse())}))}function sr(){if(-1===this.tokenizer.registeredModifiers.indexOf("glyphIndex"))throw new Error("glyphIndex modifier is required to apply arabic presentation features.")}function lr(){var t=this;this.featuresTags.hasOwnProperty("arab")&&(sr.call(this),this.tokenizer.getContextRanges("arabicWord").forEach((function(e){Zn.call(t,e)})))}function cr(){var t=this;this.featuresTags.hasOwnProperty("arab")&&(-1!==this.featuresTags.arab.indexOf("rlig")&&(sr.call(this),this.tokenizer.getContextRanges("arabicWord").forEach((function(e){Qn.call(t,e)}))))}function hr(){var t=this;this.featuresTags.hasOwnProperty("latn")&&(-1!==this.featuresTags.latn.indexOf("liga")&&(sr.call(this),this.tokenizer.getContextRanges("latinWord").forEach((function(e){nr.call(t,e)}))))}function ur(t){(t=t||{}).tables=t.tables||{},t.empty||(Ee(t.familyName,"When creating a new Font object, familyName is required."),Ee(t.styleName,"When creating a new Font object, styleName is required."),Ee(t.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),Ee(t.ascender,"When creating a new Font object, ascender is required."),Ee(t.descender<=0,"When creating a new Font object, negative descender value is required."),this.names={fontFamily:{en:t.familyName||" "},fontSubfamily:{en:t.styleName||" "},fullName:{en:t.fullName||t.familyName+" "+t.styleName},postScriptName:{en:t.postScriptName||(t.familyName+t.styleName).replace(/\s/g,"")},designer:{en:t.designer||" "},designerURL:{en:t.designerURL||" "},manufacturer:{en:t.manufacturer||" "},manufacturerURL:{en:t.manufacturerURL||" "},license:{en:t.license||" "},licenseURL:{en:t.licenseURL||" "},version:{en:t.version||"Version 0.1"},description:{en:t.description||" "},copyright:{en:t.copyright||" "},trademark:{en:t.trademark||" "}},this.unitsPerEm=t.unitsPerEm||1e3,this.ascender=t.ascender,this.descender=t.descender,this.createdTimestamp=t.createdTimestamp,this.tables=Object.assign(t.tables,{os2:Object.assign({usWeightClass:t.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:t.widthClass||this.usWidthClasses.MEDIUM,fsSelection:t.fsSelection||this.fsSelectionValues.REGULAR},t.tables.os2)})),this.supported=!0,this.glyphs=new St.GlyphSet(this,t.glyphs||[]),this.encoding=new pt(this),this.position=new Te(this),this.substitution=new _e(this),this.tables=this.tables||{},this._push=null,this._hmtxTableData={},Object.defineProperty(this,"hinting",{get:function(){return this._hinting?this._hinting:"truetype"===this.outlinesFormat?this._hinting=new ze(this):void 0}})}function fr(t,e){var n=JSON.stringify(t),r=256;for(var i in e){var o=parseInt(i);if(o&&!(o<256)){if(JSON.stringify(e[i])===n)return o;r<=o&&(r=o+1)}}return e[r]=t,r}function pr(t,e,n){var r=fr(e.name,n);return[{name:"tag_"+t,type:"TAG",value:e.tag},{name:"minValue_"+t,type:"FIXED",value:e.minValue<<16},{name:"defaultValue_"+t,type:"FIXED",value:e.defaultValue<<16},{name:"maxValue_"+t,type:"FIXED",value:e.maxValue<<16},{name:"flags_"+t,type:"USHORT",value:0},{name:"nameID_"+t,type:"USHORT",value:r}]}function dr(t,e,n){var r={},i=new at.Parser(t,e);return r.tag=i.parseTag(),r.minValue=i.parseFixed(),r.defaultValue=i.parseFixed(),r.maxValue=i.parseFixed(),i.skip("uShort",1),r.name=n[i.parseUShort()]||{},r}function gr(t,e,n,r){for(var i=[{name:"nameID_"+t,type:"USHORT",value:fr(e.name,r)},{name:"flags_"+t,type:"USHORT",value:0}],o=0;o<n.length;++o){var a=n[o].tag;i.push({name:"axis_"+t+" "+a,type:"FIXED",value:e.coordinates[a]<<16})}return i}function vr(t,e,n,r){var i={},o=new at.Parser(t,e);i.name=r[o.parseUShort()]||{},o.skip("uShort",1),i.coordinates={};for(var a=0;a<n.length;++a)i.coordinates[n[a].tag]=o.parseFixed();return i}rr.prototype.setText=function(t){this.text=t},rr.prototype.contextChecks={latinWordCheck:tr,arabicWordCheck:Vn,arabicSentenceCheck:qn},rr.prototype.registerFeatures=function(t,e){var n=this,r=e.filter((function(e){return n.query.supports({script:t,tag:e})}));this.featuresTags.hasOwnProperty(t)?this.featuresTags[t]=this.featuresTags[t].concat(r):this.featuresTags[t]=r},rr.prototype.applyFeatures=function(t,e){if(!t)throw new Error("No valid font was provided to apply features");this.query||(this.query=new Fn(t));for(var n=0;n<e.length;n++){var r=e[n];this.query.supports({script:r.script})&&this.registerFeatures(r.script,r.tags)}},rr.prototype.registerModifier=function(t,e,n){this.tokenizer.registerModifier(t,e,n)},rr.prototype.checkContextReady=function(t){return!!this.tokenizer.getContext(t)},rr.prototype.applyFeaturesToContexts=function(){this.checkContextReady("arabicWord")&&(lr.call(this),cr.call(this)),this.checkContextReady("latinWord")&&hr.call(this),this.checkContextReady("arabicSentence")&&ar.call(this)},rr.prototype.processText=function(t){this.text&&this.text===t||(this.setText(t),or.call(this),this.applyFeaturesToContexts())},rr.prototype.getBidiText=function(t){return this.processText(t),this.tokenizer.getText()},rr.prototype.getTextGlyphs=function(t){this.processText(t);for(var e=[],n=0;n<this.tokenizer.tokens.length;n++){var r=this.tokenizer.tokens[n];if(!r.state.deleted){var i=r.activeState.value;e.push(Array.isArray(i)?i[0]:i)}}return e},ur.prototype.hasChar=function(t){return null!==this.encoding.charToGlyphIndex(t)},ur.prototype.charToGlyphIndex=function(t){return this.encoding.charToGlyphIndex(t)},ur.prototype.charToGlyph=function(t){var e=this.charToGlyphIndex(t),n=this.glyphs.get(e);return n||(n=this.glyphs.get(0)),n},ur.prototype.updateFeatures=function(t){return this.defaultRenderOptions.features.map((function(e){return"latn"===e.script?{script:"latn",tags:e.tags.filter((function(e){return t[e]}))}:e}))},ur.prototype.stringToGlyphs=function(t,e){var n=this,r=new rr;r.registerModifier("glyphIndex",null,(function(t){return n.charToGlyphIndex(t.char)}));var i=e?this.updateFeatures(e.features):this.defaultRenderOptions.features;r.applyFeatures(this,i);for(var o=r.getTextGlyphs(t),a=o.length,s=new Array(a),l=this.glyphs.get(0),c=0;c<a;c+=1)s[c]=this.glyphs.get(o[c])||l;return s},ur.prototype.nameToGlyphIndex=function(t){return this.glyphNames.nameToGlyphIndex(t)},ur.prototype.nameToGlyph=function(t){var e=this.nameToGlyphIndex(t),n=this.glyphs.get(e);return n||(n=this.glyphs.get(0)),n},ur.prototype.glyphIndexToName=function(t){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(t):""},ur.prototype.getKerningValue=function(t,e){t=t.index||t,e=e.index||e;var n=this.position.defaultKerningTables;return n?this.position.getKerningValue(n,t,e):this.kerningPairs[t+","+e]||0},ur.prototype.defaultRenderOptions={kerning:!0,features:[{script:"arab",tags:["init","medi","fina","rlig"]},{script:"latn",tags:["liga","rlig"]}]},ur.prototype.forEachGlyph=function(t,e,n,r,i,o){e=void 0!==e?e:0,n=void 0!==n?n:0,r=void 0!==r?r:72,i=Object.assign({},this.defaultRenderOptions,i);var a,s=1/this.unitsPerEm*r,l=this.stringToGlyphs(t,i);if(i.kerning){var c=i.script||this.position.getDefaultScriptName();a=this.position.getKerningTables(c,i.language)}for(var h=0;h<l.length;h+=1){var u=l[h];if(o.call(this,u,e,n,r,i),u.advanceWidth&&(e+=u.advanceWidth*s),i.kerning&&h<l.length-1)e+=(a?this.position.getKerningValue(a,u.index,l[h+1].index):this.getKerningValue(u,l[h+1]))*s;i.letterSpacing?e+=i.letterSpacing*r:i.tracking&&(e+=i.tracking/1e3*r)}return e},ur.prototype.getPath=function(t,e,n,r,i){var o=new P;return this.forEachGlyph(t,e,n,r,i,(function(t,e,n,r){var a=t.getPath(e,n,r,i,this);o.extend(a)})),o},ur.prototype.getPaths=function(t,e,n,r,i){var o=[];return this.forEachGlyph(t,e,n,r,i,(function(t,e,n,r){var a=t.getPath(e,n,r,i,this);o.push(a)})),o},ur.prototype.getAdvanceWidth=function(t,e,n){return this.forEachGlyph(t,0,0,e,n,(function(){}))},ur.prototype.draw=function(t,e,n,r,i,o){this.getPath(e,n,r,i,o).draw(t)},ur.prototype.drawPoints=function(t,e,n,r,i,o){this.forEachGlyph(e,n,r,i,o,(function(e,n,r,i){e.drawPoints(t,n,r,i)}))},ur.prototype.drawMetrics=function(t,e,n,r,i,o){this.forEachGlyph(e,n,r,i,o,(function(e,n,r,i){e.drawMetrics(t,n,r,i)}))},ur.prototype.getEnglishName=function(t){var e=this.names[t];if(e)return e.en},ur.prototype.validate=function(){var t=this;function e(e){var n=t.getEnglishName(e);n&&n.trim().length}e("fontFamily"),e("weightName"),e("manufacturer"),e("copyright"),e("version"),this.unitsPerEm},ur.prototype.toTables=function(){return be.fontToTable(this)},ur.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},ur.prototype.toArrayBuffer=function(){for(var t=this.toTables().encode(),e=new ArrayBuffer(t.length),n=new Uint8Array(e),r=0;r<t.length;r++)n[r]=t[r];return e},ur.prototype.download=function(e){var r=this.getEnglishName("fontFamily"),i=this.getEnglishName("fontSubfamily");e=e||r.replace(/\s/g,"")+"-"+i+".otf";var o=this.toArrayBuffer();if("undefined"!=typeof window)if(window.URL=window.URL||window.webkitURL,window.URL){var a=new DataView(o),s=new Blob([a],{type:"font/opentype"}),l=document.createElement("a");l.href=window.URL.createObjectURL(s),l.download=e;var c=document.createEvent("MouseEvents");c.initEvent("click",!0,!1),l.dispatchEvent(c)}else console.warn("Font file could not be downloaded. Try using a different browser.");else{var h=n(23),u=function(e){for(var n=new t(e.byteLength),r=new Uint8Array(e),i=0;i<n.length;++i)n[i]=r[i];return n}(o);h.writeFileSync(e,u)}},ur.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},ur.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},ur.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};var mr={make:function(t,e){var n=new $.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:t.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:t.instances.length},{name:"instanceSize",type:"USHORT",value:4+4*t.axes.length}]);n.offsetToData=n.sizeOf();for(var r=0;r<t.axes.length;r++)n.fields=n.fields.concat(pr(r,t.axes[r],e));for(var i=0;i<t.instances.length;i++)n.fields=n.fields.concat(gr(i,t.instances[i],t.axes,e));return n},parse:function(t,e,n){var r=new at.Parser(t,e),i=r.parseULong();A.argument(65536===i,"Unsupported fvar table version.");var o=r.parseOffset16();r.skip("uShort",1);for(var a=r.parseUShort(),s=r.parseUShort(),l=r.parseUShort(),c=r.parseUShort(),h=[],u=0;u<a;u++)h.push(dr(t,e+o+u*s,n));for(var f=[],p=e+o+a*s,d=0;d<l;d++)f.push(vr(t,p+d*c,h,n));return{axes:h,instances:f}}},yr=function(){return{coverage:this.parsePointer(it.coverage),attachPoints:this.parseList(it.pointer(it.uShortList))}},br=function(){var t=this.parseUShort();return A.argument(1===t||2===t||3===t,"Unsupported CaretValue table version."),1===t?{coordinate:this.parseShort()}:2===t?{pointindex:this.parseShort()}:3===t?{coordinate:this.parseShort()}:void 0},xr=function(){return this.parseList(it.pointer(br))},wr=function(){return{coverage:this.parsePointer(it.coverage),ligGlyphs:this.parseList(it.pointer(xr))}},Sr=function(){return this.parseUShort(),this.parseList(it.pointer(it.coverage))};var Cr={parse:function(t,e){var n=new it(t,e=e||0),r=n.parseVersion(1);A.argument(1===r||1.2===r||1.3===r,"Unsupported GDEF table version.");var i={version:r,classDef:n.parsePointer(it.classDef),attachList:n.parsePointer(yr),ligCaretList:n.parsePointer(wr),markAttachClassDef:n.parsePointer(it.classDef)};return r>=1.2&&(i.markGlyphSets=n.parsePointer(Sr)),i}},Tr=new Array(10);Tr[1]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();return 1===e?{posFormat:1,coverage:this.parsePointer(it.coverage),value:this.parseValueRecord()}:2===e?{posFormat:2,coverage:this.parsePointer(it.coverage),values:this.parseValueRecordList()}:void A.assert(!1,"0x"+t.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")},Tr[2]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();A.assert(1===e||2===e,"0x"+t.toString(16)+": GPOS lookup type 2 format must be 1 or 2.");var n=this.parsePointer(it.coverage),r=this.parseUShort(),i=this.parseUShort();if(1===e)return{posFormat:e,coverage:n,valueFormat1:r,valueFormat2:i,pairSets:this.parseList(it.pointer(it.list((function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(r),value2:this.parseValueRecord(i)}}))))};if(2===e){var o=this.parsePointer(it.classDef),a=this.parsePointer(it.classDef),s=this.parseUShort(),l=this.parseUShort();return{posFormat:e,coverage:n,valueFormat1:r,valueFormat2:i,classDef1:o,classDef2:a,class1Count:s,class2Count:l,classRecords:this.parseList(s,it.list(l,(function(){return{value1:this.parseValueRecord(r),value2:this.parseValueRecord(i)}})))}}},Tr[3]=function(){return{error:"GPOS Lookup 3 not supported"}},Tr[4]=function(){return{error:"GPOS Lookup 4 not supported"}},Tr[5]=function(){return{error:"GPOS Lookup 5 not supported"}},Tr[6]=function(){return{error:"GPOS Lookup 6 not supported"}},Tr[7]=function(){return{error:"GPOS Lookup 7 not supported"}},Tr[8]=function(){return{error:"GPOS Lookup 8 not supported"}},Tr[9]=function(){return{error:"GPOS Lookup 9 not supported"}};var _r=new Array(10);var Or={parse:function(t,e){var n=new it(t,e=e||0),r=n.parseVersion(1);return A.argument(1===r||1.1===r,"Unsupported GPOS table version "+r),1===r?{version:r,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(Tr)}:{version:r,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(Tr),variations:n.parseFeatureVariationsList()}},make:function(t){return new $.Table("GPOS",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new $.ScriptList(t.scripts)},{name:"features",type:"TABLE",value:new $.FeatureList(t.features)},{name:"lookups",type:"TABLE",value:new $.LookupList(t.lookups,_r)}])}};var kr={parse:function(t,e){var n=new at.Parser(t,e),r=n.parseUShort();if(0===r)return function(t){var e={};t.skip("uShort");var n=t.parseUShort();A.argument(0===n,"Unsupported kern sub-table version."),t.skip("uShort",2);var r=t.parseUShort();t.skip("uShort",3);for(var i=0;i<r;i+=1){var o=t.parseUShort(),a=t.parseUShort(),s=t.parseShort();e[o+","+a]=s}return e}(n);if(1===r)return function(t){var e={};t.skip("uShort"),t.parseULong()>1&&console.warn("Only the first kern subtable is supported."),t.skip("uLong");var n=255&t.parseUShort();if(t.skip("uShort"),0===n){var r=t.parseUShort();t.skip("uShort",3);for(var i=0;i<r;i+=1){var o=t.parseUShort(),a=t.parseUShort(),s=t.parseShort();e[o+","+a]=s}}return e}(n);throw new Error("Unsupported kern table version ("+r+").")}};var Pr={parse:function(t,e,n,r){for(var i=new at.Parser(t,e),o=r?i.parseUShort:i.parseULong,a=[],s=0;s<n+1;s+=1){var l=o.call(i);r&&(l*=2),a.push(l)}return a}};function Er(t,e){n(23).readFile(t,(function(t,n){if(t)return e(t.message);e(null,Pe(n))}))}function Mr(t,e){var n=new XMLHttpRequest;n.open("get",t,!0),n.responseType="arraybuffer",n.onload=function(){return n.response?e(null,n.response):e("Font could not be loaded: "+n.statusText)},n.onerror=function(){e("Font could not be loaded")},n.send()}function Ar(t,e){for(var n=[],r=12,i=0;i<e;i+=1){var o=at.getTag(t,r),a=at.getULong(t,r+4),s=at.getULong(t,r+8),l=at.getULong(t,r+12);n.push({tag:o,checksum:a,offset:s,length:l,compression:!1}),r+=16}return n}function Lr(t,e){if("WOFF"===e.compression){var n=new Uint8Array(t.buffer,e.offset+2,e.compressedLength-2),r=new Uint8Array(e.length);if(_(n,r),r.byteLength!==e.length)throw new Error("Decompression error: "+e.tag+" decompressed length doesn't match recorded length");return{data:new DataView(r.buffer,0),offset:0}}return{data:t,offset:e.offset}}function Dr(t,e){var n,r;e=null==e?{}:e;var i,o,a,s,l,c,h,u,f,p,d,g,v,m=new ur({empty:!0}),y=new DataView(t,0),b=[],x=at.getTag(y,0);if(x===String.fromCharCode(0,1,0,0)||"true"===x||"typ1"===x)m.outlinesFormat="truetype",b=Ar(y,i=at.getUShort(y,4));else if("OTTO"===x)m.outlinesFormat="cff",b=Ar(y,i=at.getUShort(y,4));else{if("wOFF"!==x)throw new Error("Unsupported OpenType signature "+x);var w=at.getTag(y,4);if(w===String.fromCharCode(0,1,0,0))m.outlinesFormat="truetype";else{if("OTTO"!==w)throw new Error("Unsupported OpenType flavor "+x);m.outlinesFormat="cff"}b=function(t,e){for(var n=[],r=44,i=0;i<e;i+=1){var o=at.getTag(t,r),a=at.getULong(t,r+4),s=at.getULong(t,r+8),l=at.getULong(t,r+12),c=void 0;c=s<l&&"WOFF",n.push({tag:o,offset:a,compression:c,compressedLength:s,length:l}),r+=20}return n}(y,i=at.getUShort(y,12))}for(var S=0;S<i;S+=1){var C=b[S],T=void 0;switch(C.tag){case"cmap":T=Lr(y,C),m.tables.cmap=lt.parse(T.data,T.offset),m.encoding=new dt(m.tables.cmap);break;case"cvt ":T=Lr(y,C),v=new at.Parser(T.data,T.offset),m.tables.cvt=v.parseShortList(C.length/2);break;case"fvar":a=C;break;case"fpgm":T=Lr(y,C),v=new at.Parser(T.data,T.offset),m.tables.fpgm=v.parseByteList(C.length);break;case"head":T=Lr(y,C),m.tables.head=Nt.parse(T.data,T.offset),m.unitsPerEm=m.tables.head.unitsPerEm,n=m.tables.head.indexToLocFormat;break;case"hhea":T=Lr(y,C),m.tables.hhea=Ht.parse(T.data,T.offset),m.ascender=m.tables.hhea.ascender,m.descender=m.tables.hhea.descender,m.numberOfHMetrics=m.tables.hhea.numberOfHMetrics;break;case"hmtx":u=C;break;case"ltag":T=Lr(y,C),r=Wt.parse(T.data,T.offset);break;case"maxp":T=Lr(y,C),m.tables.maxp=Yt.parse(T.data,T.offset),m.numGlyphs=m.tables.maxp.numGlyphs;break;case"name":d=C;break;case"OS/2":T=Lr(y,C),m.tables.os2=ae.parse(T.data,T.offset);break;case"post":T=Lr(y,C),m.tables.post=se.parse(T.data,T.offset),m.glyphNames=new vt(m.tables.post);break;case"prep":T=Lr(y,C),v=new at.Parser(T.data,T.offset),m.tables.prep=v.parseByteList(C.length);break;case"glyf":s=C;break;case"loca":p=C;break;case"CFF ":o=C;break;case"kern":f=C;break;case"GDEF":l=C;break;case"GPOS":c=C;break;case"GSUB":h=C;break;case"meta":g=C}}var _=Lr(y,d);if(m.tables.name=ie.parse(_.data,_.offset,r),m.names=m.tables.name,s&&p){var O=0===n,k=Lr(y,p),P=Pr.parse(k.data,k.offset,m.numGlyphs,O),E=Lr(y,s);m.glyphs=Ue.parse(E.data,E.offset,P,m,e)}else{if(!o)throw new Error("Font doesn't contain TrueType or CFF outlines.");var M=Lr(y,o);Gt.parse(M.data,M.offset,m,e)}var A=Lr(y,u);if(Xt.parse(m,A.data,A.offset,m.numberOfHMetrics,m.numGlyphs,m.glyphs,e),mt(m,e),f){var L=Lr(y,f);m.kerningPairs=kr.parse(L.data,L.offset)}else m.kerningPairs={};if(l){var D=Lr(y,l);m.tables.gdef=Cr.parse(D.data,D.offset)}if(c){var I=Lr(y,c);m.tables.gpos=Or.parse(I.data,I.offset),m.position.init()}if(h){var R=Lr(y,h);m.tables.gsub=ue.parse(R.data,R.offset)}if(a){var j=Lr(y,a);m.tables.fvar=mr.parse(j.data,j.offset,m.names)}if(g){var B=Lr(y,g);m.tables.meta=fe.parse(B.data,B.offset),m.metas=m.tables.meta}return m}var Ir=Object.freeze({__proto__:null,Font:ur,Glyph:bt,Path:P,BoundingBox:k,_parse:at,parse:Dr,load:function(t,e,n){n=null==n?{}:n;var r="undefined"==typeof window&&!n.isUrl?Er:Mr;return new Promise((function(i,o){r(t,(function(t,r){if(t){if(e)return e(t);o(t)}var a;try{a=Dr(r,n)}catch(t){if(e)return e(t,null);o(t)}if(e)return e(null,a);i(a)}))}))},loadSync:function(t,e){return Dr(Pe(n(23).readFileSync(t)),e)}});e.a=Ir}).call(this,n(11).Buffer)},76:function(t,e,n){t.exports=n.p+"3e1af3ef546b9e6ecef9f3ba197bf7d2.ttf"},77:function(t,e,n){t.exports=n.p+"42bbe4eefcde1297b11dc4b6491e9746.ttf"},78:function(t,e,n){t.exports=n.p+"ec4c9962ba54eb91787aa93d361c10a8.ttf"},788:function(t,e,n){"use strict";n.r(e),n.d(e,"InspectStudio",(function(){return H}));var r=n(0),i=(n(353),n(355),n(37)),o=n(44),a=n(33),s=n(20),l=n(1);class c extends r.a{constructor(t){super(t),this.canvasWrapper=null,Object(i.a)(this,{coords:t=>t.canvasState.mouseCoords,zoomLevel:t=>t.canvasState.zoomLevel,curTool:t=>t.toolState.curTool,renderer:t=>t.canvasState.renderer,metricScale:t=>t.canvasState.metricScale})}componentDidMount(){const t=Object(s.d)("render",l.b.getState().sessionState.project.designFileType);a.facade.initRendererOnCanvas(this.canvasWrapper).then(()=>{t(),this.props.onRendered()})}componentWillUnmount(){}zoomIn(){a.facade.zoomIn()}zoomOut(){a.facade.zoomOut()}otherScale(){const t=window.prompt("Please enter a scale number",""+this.state.metricScale);if(t){const e=parseFloat(t);!isNaN(e)&&e>0&&a.facade.setMetricScale(e)}}render(){return Object(r.b)("div",{ref:t=>this.canvasWrapper=t,class:`canvas ${this.state.curTool?this.state.curTool.slug:""}`},this.state.renderer?Object(r.b)("div",{class:"tools"},Object(r.b)("div",null,this.state.coords?Object(r.b)("span",{class:"text"},"X: ",this.state.coords.x):null,this.state.coords?Object(r.b)("span",{class:"text"},"Y: ",this.state.coords.y):null),Object(r.b)("div",{class:"metricScale dropdown is-hoverable is-up"},Object(r.b)("div",{class:"dropdown-trigger"},Object(r.b)("i",{class:"fas fa-ruler-combined"}),Object(r.b)("span",{class:"metrics"},"@",this.state.metricScale,"X")),Object(r.b)("div",{class:"dropdown-menu",id:"dropdown-menu7",role:"menu"},Object(r.b)("div",{class:"dropdown-content"},Object(r.b)("div",{class:"dropdown-item "},Object(r.b)("p",null,"Pick a metric scale that the design file has been created at. It will affect canvas measurements only.")),Object(r.b)("hr",{class:"dropdown-divider"}),o.metricScales.map(t=>Object(r.b)("div",{onClick:()=>{a.facade.setMetricScale(t)},class:"dropdown-item selectable"},Object(r.b)("p",null,"@",t,"X"))),Object(r.b)("hr",{class:"dropdown-divider"}),Object(r.b)("div",{onClick:()=>{this.otherScale()},class:"dropdown-item selectable"},Object(r.b)("p",null,"Other"))))),Object(r.b)("div",{class:"zoomTool"},Object(r.b)("span",{class:"zoom",onClick:()=>this.zoomOut()},Object(r.b)("i",{class:"fas fa-search-minus"})),Object(r.b)("span",{class:"text"},Math.round(100*(this.state.zoomLevel||1)),"%"),Object(r.b)("span",{class:"zoom",onClick:()=>this.zoomIn()},Object(r.b)("i",{class:"fas fa-search-plus"})))):null)}}n(357),n(359),n(361);var h=n(121);n(363);class u extends r.a{constructor(t){super(t),this.state={value:"string"==typeof t.value?t.value:"",copied:!1},t.value instanceof Promise&&t.value.then(t=>{this.setState({value:t})})}get label(){if(this.props.children){if(this.props.children instanceof Array&&this.props.children.length>0)return this.props.children;if(!(this.props.children instanceof Array))return this.props.children}return this.state.value}componentWillReceiveProps(t){t.value instanceof Promise?t.value.then(t=>{this.setState({value:t})}):this.setState({value:t.value})}copy(){Object(h.a)(this.state.value),this.setState({copied:!0}),setTimeout(()=>{this.setState({copied:!1})},1e3)}render(){return Object(r.b)("div",{onClick:()=>this.copy(),class:"clickCopyDiv"},Object(r.b)("span",{class:"labelToCopy"},this.label),this.state.copied?Object(r.b)("div",{class:"copied animated fadeOutUp"},a.i18n.lang("copied")+"!"):null)}}var f=n(65);class p extends class{toCode(t){const e=t.style;return e?Object.keys(e).map(n=>{const r=e[n];return this.styleToCode(n,r,t)}).filter(t=>t.length>0).join("\n"):""}}{styleToCode(t,e,n){return["left","top","right","bottom"].indexOf(t)>-1?`${t}: ${e}px;`:"opacity"===t?`opacity:${e}`:Object(f.b)(n)?"fontFamily"===t?`font-family:${e}`:"fontSize"===t?`font-size:${e}px`:"fontWeight"===t?`font-weight:${e}`:"fontStyle"===t?`font-style:${e}`:"textDecoration"===t?`text-decoration:${e}`:"textAlign"===t?`align:${e}`:"fill"===t?`color:${e}`:"":"fill"===t?`background-color:${e}`:""}}p.codeType="CSS";class d extends r.a{constructor(){super(),this.state={showCss:!1}}renderTable(){const t=this.props.layer;return Object(r.b)("table",null,Object(r.b)("tr",null,Object(r.b)("td",null,"Name"),Object(r.b)("td",null,Object(r.b)(u,{value:t.name}))),Object(r.b)("tr",null,Object(r.b)("td",null,"Type"),Object(r.b)("td",null,Object(r.b)(u,{value:t.layerType}))),Object(r.b)("tr",null,Object(r.b)("td",null,"Left"),Object(r.b)("td",null,Object(r.b)(u,{value:t.rect.left.toFixed()}))),Object(r.b)("tr",null,Object(r.b)("td",null,"Top"),Object(r.b)("td",null,Object(r.b)(u,{value:t.rect.top.toFixed()}))),Object(r.b)("tr",null,Object(r.b)("td",null,"Width"),Object(r.b)("td",null,Object(r.b)(u,{value:t.rect.width.toFixed()}))),Object(r.b)("tr",null,Object(r.b)("td",null,"Height"),Object(r.b)("td",null,Object(r.b)(u,{value:t.rect.height.toFixed()}))),this.renderTextProps(),t.style?this.renderObject(t.style):null)}renderStyles(){}renderObject(t,e=""){let n=[];Object.keys(t).filter(e=>void 0!==t[e]).forEach(i=>{const o=t[i],a=e+i;"object"==typeof o?n=n.concat(this.renderObject(o,a+"-")):n.push(Object(r.b)("tr",null,Object(r.b)("td",null,a),Object(r.b)("td",null,Object(r.b)(u,{value:o.toString()}))))});return n}renderTextProps(){const t=this.props.layer;return Object(f.b)(t)?[Object(r.b)("tr",null,Object(r.b)("td",null,"Text"),Object(r.b)("td",null,Object(r.b)(u,{value:t.rawText})))].concat(t.font?this.renderObject(t.font):[]):null}renderCss(){const t=this.props.layer,e=(new p).toCode(t);return Object(r.b)("pre",null,e)}render(){return Object(r.b)("div",{class:"card layerBasicView"},Object(r.b)("div",{class:"title has-background-grey-dark has-text-white-ter"},"LAYER INFO",Object(r.b)("span",{class:"flex1"}),Object(r.b)("span",{onClick:()=>{this.setState({showCss:!this.state.showCss})},class:`showCss ${this.state.showCss?"has-text-info":""}`},"CSS")," "),Object(r.b)("div",{class:"cardBody"},this.state.showCss?this.renderCss():this.renderTable()))}}n(365);var g=n(64);class v extends r.a{constructor(){super(),this.state={loading:!1}}async buttonClick(t){if(this.props.onClick){const e=t.currentTarget,n=this.props.onClick(t);if(n instanceof Promise){const t=e.clientWidth,r=e.clientHeight;e.style.width=t+"px",e.style.height=r+"px",this.setState({loading:!0}),await n,this.setState({loading:!1}),e.style.width="",e.style.height=""}}}render(){return Object(r.b)("button",{disabled:this.state.loading||this.props.disabled,onClick:t=>this.buttonClick(t),class:this.props.class},this.state.loading?Object(r.b)("span",{class:"animated infinite spin"},Object(r.b)("i",{class:"fas fa-spinner"})):this.props.children)}}var m="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABfGlDQ1BJQ0MgUHJvZmlsZQAAKJFjYGAqSSwoyGFhYGDIzSspCnJ3UoiIjFJgv8PAzcDDIMRgxSCemFxc4BgQ4MOAE3y7xsAIoi/rgsxK8/x506a1fP4WNq+ZclYlOrj1gQF3SmpxMgMDIweQnZxSnJwLZOcA2TrJBUUlQPYMIFu3vKQAxD4BZIsUAR0IZN8BsdMh7A8gdhKYzcQCVhMS5AxkSwDZAkkQtgaInQ5hW4DYyRmJKUC2B8guiBvAgNPDRcHcwFLXkYC7SQa5OaUwO0ChxZOaFxoMcgcQyzB4MLgwKDCYMxgwWDLoMjiWpFaUgBQ65xdUFmWmZ5QoOAJDNlXBOT+3oLQktUhHwTMvWU9HwcjA0ACkDhRnEKM/B4FNZxQ7jxDLX8jAYKnMwMDcgxBLmsbAsH0PA4PEKYSYyjwGBn5rBoZt5woSixLhDmf8xkKIX5xmbARh8zgxMLDe+///sxoDA/skBoa/E////73o//+/i4H2A+PsQA4AJHdp4IxrEg8AAACDSURBVDgR3VJBEgARDGtx4gH+/y4P8AGu7Masm2zvejGTaDQN7b3Pt4RVrVXGGEfaOSchxngkAaKxtfYvQLs/AtOxCYE7S8DiLxAIbEHwjhQQFStwWkqZLGdVlZyz4DzV+gdWzikl8d6f+he2LDAbwNnrW5Eb3DeM8wKBYOZMItyreQC1XjqT76HMaAAAAABJRU5ErkJggg==",y=n(2);const b=["iOS","Android"],x={iOS:{2:"@2x",3:"@3x",4:"@4x"},Android:{1:"-mdpi",1.5:"-hdpi",2:"-xhdpi",3:"-xxhdpi",4:"-xxxhdpi"}};var w=n(129);n(367);function S(t){const[e,n]=Object(y.c)(t.ipt.name.slice(0,15)),[i,o]=Object(y.c)(!1),[l,c]=Object(y.c)("iOS"),[h,u]=Object(y.c)([{trim:!1,scale:1,format:"image/png",optimize:!0,downloading:!1}]);function f(t){var e;return void 0!==t.suffix?t.suffix:null!==(e=x[l][t.scale])&&void 0!==e?e:""}const p=Object(y.b)(null);function d(t,e){const n=h.slice(0);n.splice(t,1,Object.assign(Object.assign({},n[t]),e)),u(n)}async function g(n){var r;Object(s.a)("export_single","export"),d(h.indexOf(n),{downloading:!0});const i=await a.facade.layer.layerToBlob(t.ipt,n);let o=(null!==(r=n.name)&&void 0!==r?r:e)+f(n);o=`${o}.${n.format.replace("image/","").toLowerCase()}`,await a.facade.exportBlob(o,i,a.facade.findLocalExporter()),d(h.indexOf(n),{downloading:!1})}function v(){if(h.length){return h[h.length-1].scale+1}return 1}function S(t){return t.format.replace("image/","").toLowerCase()}return Object(y.a)(()=>{const e=p.current;Object(w.layerToCanvas)(t.ipt,1).then(t=>{const{width:n,height:r}=t;if(n>=e.clientWidth||r>=240){const i=r/n;if(240/e.clientWidth<i){const e=220,n=e/i;t.style.width=n+"px",t.style.height=e+"px"}else{const n=e.clientWidth-20,r=n*i;t.style.width=n+"px",t.style.height=r+"px"}}p.current.appendChild(t)})},[]),Object(r.b)("div",{class:"modal is-active"},Object(r.b)("div",{class:"modal-background"}),Object(r.b)("div",{class:"modal-content overflow-visible"},Object(r.b)("div",{class:"content has-background-grey-dark exporModal"},Object(r.b)("div",{class:"pl-3 pr-3 has-text-weight-bold has-background-grey-dark is-flex is-align-items-center"},Object(r.b)("span",{class:"p-3"},"Export Assets"),Object(r.b)("span",{class:"is-flex-grow-1"}),Object(r.b)("a",{onClick:()=>t.onClose(),class:"p-3 fas fa-times has-text-white"})),Object(r.b)("div",{class:"is-flex is-align-items-center is-justify-content-center preview",ref:p,style:{backgroundImage:`url(${m})`,height:"240px"}},Object(r.b)("div",{class:"mask"})),Object(r.b)("div",{class:"is-flex is-align-items-center p-4  pl-6 pr-6 has-background-grey-darker"},Object(r.b)("a",{onClick:()=>{u(h.concat([{trim:!1,scale:v(),format:h.length?h[h.length-1].format:"image/png",optimize:!0,downloading:!1}]))},class:"has-text-weight-bold"},Object(r.b)("span",{class:"fas fa-plus pr-3 has-text-primary"}),Object(r.b)("span",{class:"has-text-white"},"Add Variant")),Object(r.b)("span",{class:"is-flex-grow-1"}),Object(r.b)("span",{class:"mr-3 is-size-7"},"Name:"),Object(r.b)("div",{class:"mr-3"},Object(r.b)("input",{onInput:t=>{const e=t.currentTarget.value;n(e)},value:e,class:"baseName transparent p-2",type:"text"})),Object(r.b)("span",{class:"mr-3 is-size-7"},"Suffix:"),Object(r.b)("div",{class:"buttons are-small"},b.map(t=>Object(r.b)("button",{onClick:()=>{c(t)},class:"button is-primary "+(l!==t?"is-outlined":"")},t)))),Object(r.b)("div",{class:"variantList is-size-7"},h.map((n,i)=>{var o;return Object(r.b)("div",{class:"variantItem pl-6 pr-6 pt-3 pb-3 is-flex is-align-items-center"},Object(r.b)("div",{class:"pr-4"},Object(r.b)("span",{class:`fa ${a.facade.layer.getLayerIcon(t.ipt)}`})),Object(r.b)("div",{class:"is-flex-grow-1"}," ",Object(r.b)("input",{onChange:t=>{const e=t.currentTarget.value;d(i,e?{name:e}:{name:void 0})},value:null!==(o=n.name)&&void 0!==o?o:e,class:"transparent p-2 has-background-dark",type:"text",style:{width:"96px"}})),Object(r.b)("div",{class:"pl-3 "},Object(r.b)("span",null,Math.round(t.ipt.rect.width*n.scale),"px"),Object(r.b)("span",{class:"pl-2 pr-2"},"x"),Object(r.b)("span",null,Math.round(t.ipt.rect.height*n.scale),"px")),Object(r.b)("div",{class:"scale ml-3 "},Object(r.b)(C,{scale:n.scale,onScaleChange:t=>{d(i,{scale:t})}})),Object(r.b)("div",{class:"suffix ml-3 is-flex "},Object(r.b)("input",{style:{width:"64px"},placeholder:"Suffix",class:"transparent has-background-dark p-2",type:"text",value:f(n),onChange:t=>{const e=t.target.value;d(i,{suffix:e})}})),Object(r.b)("div",{class:"format ml-3"},Object(r.b)(T,{layer:t.ipt,format:n.format,onChooseFormat:t=>{d(i,{format:t})}})),Object(r.b)("div",{class:"ml-3"},Object(r.b)("a",{disabled:n.downloading,onClick:()=>{g(n)},class:`p-2 fas has-text-grey-lighter ${n.downloading?"fa-spinner animated infinite spin":"fa-download"}`})),Object(r.b)("div",{class:"ml-1"},Object(r.b)("a",{onClick:()=>{const t=h.slice(0);t.splice(i,1),u(t)},class:"p-2 fas fa-times has-text-grey-lighter"})))})),Object(r.b)("div",{class:"p-5 has-background-dark"},Object(r.b)("button",{onClick:()=>async function(){var n;if(0!==h.length){if(o(!0),1===h.length)await g(h[0]);else{Object(s.a)("export_variants","export");const r=[];for(const t of h){let i=null!==(n=t.name)&&void 0!==n?n:e;i+=f(t),i=`${i}.${S(t)}`,r.push(i)}const i=await a.facade.layer.layerToZip(t.ipt,r,h),o=`${e}.zip`;await a.facade.exportBlob(o,i,a.facade.findLocalExporter())}o(!1)}}(),disabled:i||0===h.length,class:"button is-primary is-fullwidth"+(i?" is-loading":"")},Object(r.b)("span",{class:"icon"},Object(r.b)("i",{class:"fas fa-download"})),Object(r.b)("span",null,"EXPORT (",function(){let t=e;return h.length>1?`${t}.zip`:1===h.length?(t+=f(h[0]),`${t}.${h[0].format.replace("image/","").toLowerCase()}`):void 0}(),")")),Object(r.b)("div",{class:"p-3 has-text-weight-light is-flex is-align-items-center is-justify-content-center has-text-grey-light"},"PNG, JPEG and SVG files are optimized automatically.")))))}function C(t){const[e,n]=Object(y.c)(!1);return Object(r.b)("div",{class:`dropdown ${e?"is-active":""}`},Object(r.b)("button",{class:"is-flex is-align-items-center transparent has-background-dark is-clickable",onBlur:()=>n(!1),onClick:()=>n(!e)},Object(r.b)("span",{class:"p-2",style:{width:"45px",textAlign:"center"}},t.scale,"X"),Object(r.b)("span",{class:"icon is-small"},Object(r.b)("i",{class:"fas fa-caret-down"}))),Object(r.b)("div",{class:"dropdown-menu"},Object(r.b)("div",{class:"dropdown-content"},[.25,.5,.75,1,1.5,2,3,4].map(e=>Object(r.b)("a",{onMouseDown:()=>{t.onScaleChange(e)},class:"dropdown-item"},e,"X")),Object(r.b)("hr",{class:"dropdown-divider"}),Object(r.b)("a",{onMouseDown:()=>{const e=parseFloat(window.prompt("Please enter scale number: ",t.scale.toString()));t.onScaleChange(e)},href:"javascript:;",class:"dropdown-item"},"Other Scale"))))}function T(t){const[e,n]=Object(y.c)(!1);return Object(r.b)("div",{class:`dropdown ${e?"is-active":""}`},Object(r.b)("button",{class:"is-flex is-align-items-center transparent has-background-dark is-clickable",onBlur:()=>n(!1),onClick:()=>n(!e)},Object(r.b)("span",{class:"p-2",style:{width:"60px",textAlign:"center"}},t.format.replace("image/","").toUpperCase()),Object(r.b)("span",{class:"icon is-small"},Object(r.b)("i",{class:"fas fa-caret-down"}))),Object(r.b)("div",{class:"dropdown-menu"},Object(r.b)("div",{class:"dropdown-content"},a.facade.layer.getExportTypes(t.layer).map(e=>Object(r.b)("a",{onMouseDown:()=>{t.onChooseFormat(e)},class:"dropdown-item"},e.replace("image/","").toUpperCase())))))}class _ extends r.a{constructor(t){super(t),this.previewUrl="",this.imgEle=null,this.state={exportImgParams:{trim:!0,scale:1,format:Object(g.e)(this.props.layer)[0],optimize:!0},showExportModal:!1}}get imgParamsFormat(){return this.state.exportImgParams.format}set imgParamsFormat(t){this.state.exportImgParams.format!==t&&this.setState({exportImgParams:Object.assign(Object.assign({},this.state.exportImgParams),{format:t})})}get exportFileName(){return Object(g.d)(this.props.layer,this.state.exportImgParams)}componentDidMount(){this.updatePreview()}async updatePreview(){this.previewUrl="",this.forceUpdate();const t=await a.facade.layer.exportImageUrl(this.props.layer,this.state.exportImgParams);t!==this.previewUrl&&(this.previewUrl=t,this.forceUpdate())}componentDidUpdate(t,e){this.state.exportImgParams===e.exportImgParams&&this.props.layer===t.layer||this.updatePreview()}componentWillReceiveProps(t){this.props.layer,t.layer}render(){return Object(r.b)("div",{class:"card layerExportView"},Object(r.b)("div",{class:"title has-background-grey-dark has-text-white-ter"},"EXPORT"),Object(r.b)("div",{class:"cardBody"},this.renderImageParam(),this.renderFileExporters()))}async exportFile(t){Object(s.a)("export_flash","export"),await a.facade.layer.exportLayerWithExporter(this.props.layer,t,this.state.exportImgParams)}renderFileExporters(){return Object(r.b)("div",{class:"fileExport"},Object(r.b)("div",{class:"fileName pb-3"},"Name: ",this.exportFileName),Object(r.b)("div",{class:"is-flex buttons block"},Object(r.b)("button",{onClick:()=>this.setState({showExportModal:!0}),class:"button is-primary is-flex-grow-1 "},Object(r.b)("span",{class:"icon"},Object(r.b)("i",{class:"fas fa-download"})),Object(r.b)("span",null,"Export")),Object(r.b)(v,{onClick:()=>this.exportFile(a.facade.findLocalExporter()),class:"button is-primary"},Object(r.b)("i",{class:"fas fa-bolt"}))),this.state.showExportModal?Object(r.b)(S,{ipt:this.props.layer,onClose:()=>this.setState({showExportModal:!1})}):null)}toogleTrim(){this.setState({exportImgParams:Object.assign(Object.assign({},this.state.exportImgParams),{trim:!this.state.exportImgParams.trim})})}setImgScale(t){t!==this.state.exportImgParams.scale&&this.setState({exportImgParams:Object.assign(Object.assign({},this.state.exportImgParams),{scale:t})})}toggleOptimize(){this.setState({exportImgParams:Object.assign(Object.assign({},this.state.exportImgParams),{optimize:!this.state.exportImgParams.optimize})})}renderImageParam(){return Object(r.b)("div",{class:"imgParam"},Object(r.b)("div",{class:"preview",style:{backgroundImage:`url(${m})`}},Object(r.b)("div",{class:"mask"}),this.previewUrl?Object(r.b)("img",{ref:t=>this.imgEle=t,src:this.previewUrl}):null,this.previewUrl?Object(r.b)("div",{class:"size"},Math.round(this.props.layer.rect.width*this.state.exportImgParams.scale),"x",Math.round(this.props.layer.rect.height*this.state.exportImgParams.scale)):null))}}var O=n(48),k=(n(369),n(47));class P extends r.a{constructor(t){super(t),this.state={active:!1};let e=void 0;Object(i.a)(this,{active:async n=>{if(t.showActive){if(e===n.toolState.choseLayers)return this.state.active;const r=t.layer;if(e=n.toolState.choseLayers,Object(f.a)(r)){for(const t of e){if(await Object(k.b)(r,t))return!0}return!1}return e.indexOf(r)>-1}return!1}})}componentWillReceiveProps(t){t.layer!==this.props.layer&&this.setState({children:void 0})}getIcon(t){return a.facade.layer.getLayerIcon(t)}layerItemClick(t,e){e.metaKey||e.shiftKey||e.ctrlKey?l.b.dispatch({type:"toolStateToggleChoseLayer",layers:[t]}):l.b.dispatch({type:"toolStateChoseLayer",layers:[t]})}async toggleFolder(t){if(Object(f.a)(t))if(this.state.children)this.setState({children:void 0});else{const e=t.children.slice(0);this.setState({children:e})}}renderChildren(){const t=this.props.indent?this.props.indent:0;return this.state.children.map(e=>Object(r.b)(P,{showActive:this.props.showActive,layer:e,indent:t+1}))}renderLayerItem(){const t=this.props.layer,e=this.props.indent?this.props.indent:0,n=this.state.active;return Object(r.b)("div",null,Object(r.b)("div",{class:"layerItemContainer"},Object(r.b)("div",{class:"layerItem "+(t.visible?"":"invisible")+(n?" active":""),onClick:e=>{this.layerItemClick(t,e)}},Object(r.b)("span",{class:"indent",style:{width:16*e}}),Object(r.b)("span",{class:"icon is-small"},Object(r.b)("i",{class:"fas "+this.getIcon(t),"aria-hidden":"true"})),Object(r.b)("span",{class:"name"},t.name)),Object(f.a)(t)?Object(r.b)("div",{onClick:()=>{this.toggleFolder(t)},class:"folderToggle itemBtn"},this.state.children?Object(r.b)("i",{class:"far fa-minus-square"}):Object(r.b)("i",{class:"far fa-plus-square"})):null),this.state.children?this.renderChildren():null)}render(){return this.renderLayerItem()}}n(371);class E extends r.a{constructor(){super(),Object(i.a)(this,{nearbyLayers:t=>t.toolState.neabyLayers})}render(){if(!this.state.nearbyLayers||0===this.state.nearbyLayers.length)return null;const t=this.state.nearbyLayers.slice(1);return Object(r.b)("div",{class:"nearByLayers"},Object(r.b)("div",{class:"pageList"},Object(r.b)("h3",{class:"page-head"},"Near by Layers"),Object(r.b)("div",{class:"layerList"},t.map(t=>Object(r.b)(P,{showActive:!1,layer:t})))))}}class M extends r.a{constructor(){super(),Object(i.a)(this,{layers:t=>t.toolState.choseLayers,display:t=>t.toolState.choseLayers.length>0})}get curLayer(){return Object(O.b)(this.state.layers)}render(){return this.state.display&&this.curLayer?Object(r.b)("div",null,Object(r.b)(E,null),Object(r.b)(_,{layer:this.curLayer}),Object(r.b)(d,{layer:this.curLayer})):null}}var A=n(63),L=(n(373),n(102));class D extends r.a{constructor(){super(),Object(i.a)(this,{display:t=>!!t.toolState.curTool&&t.toolState.curTool instanceof A.ColorTool,colors:t=>t.toolState.pickedColors,hoverColor:t=>t.toolState.hoverColor})}copyColor(t){a.facade.copyColor(t)}render(){return this.state.display?Object(r.b)("div",{class:"card colorPickedView"},Object(r.b)("div",{class:"title"},"Colors"),Object(r.b)("div",{class:"cardBody"},Object(r.b)("div",{class:"hoverColor"},Object(r.b)("div",{class:"preview",style:`background-color:${this.state.hoverColor}`}),Object(r.b)("div",{class:"txt"},Object(r.b)("span",{class:"hex"},Object(L.a)(this.state.hoverColor).toUpperCase()),Object(r.b)("span",null,"Click to Copy"))),Object(r.b)("div",{class:"pickedColors"},this.state.colors.map(t=>Object(r.b)("div",{onClick:()=>this.copyColor(t),class:"pickedColor"},Object(r.b)("div",{class:"preview",style:`background-color:${t}`}),Object(r.b)("span",null,Object(L.a)(t).toUpperCase())))))):null}}class I extends r.a{get curToolState(){return l.b.getState().toolState.curTool}componentDidMount(){}componentWillUnmount(){}render(){return Object(r.b)("aside",{class:"sidebar sidebarRight"},Object(r.b)(D,null),Object(r.b)(M,null))}}n(375),n(377);class R extends r.a{onToolClick(t){return Object(s.e)(this.props.tool.name),this.props.onClick(t)}render(){return Object(r.b)("div",{onClick:t=>this.onToolClick(t),class:`toolBtn toggle ${this.props.tool.activated?"active":""}`},this.props.tool.isClsSVG?Object(r.b)("img",{src:this.props.tool.cls}):Object(r.b)("i",{class:this.props.tool.cls}))}}class j extends r.a{constructor(){super(),Object(i.a)(this,{display:t=>!!t.canvasState.renderer,showListColumn:t=>t.viewState.showListColumn,curTool:t=>t.toolState.curTool}),this.unsubscribe=Object(l.a)(t=>t.toolState.choseLayers,()=>{this.setExclusiveTool(Object(A.getToolInst)(A.InspectTool))},!1)}componentWillUnmount(){this.unsubscribe()}render(){return this.state.display?Object(r.b)("div",{class:"toolbar"},this.renderPillarTool(),Object(r.b)("div",{class:"flex1"}),this.renderGeneralTools()):null}renderGeneralTools(){return a.tools.tools.general.map(t=>this.bindToggleTool(t)).concat([Object(r.b)("div",{onClick:()=>l.b.dispatch({type:"viewStateToggleListItem"}),class:`toolBtn toggle toolLayers ${this.state.showListColumn?"active":""}`},Object(r.b)("i",{class:"fas fa-th"}))])}renderPillarTool(){return a.tools.tools.inspect.map(t=>this.bindExclusiveTool(t))}async setExclusiveTool(t){await a.tools.setActiveTool(t),this.forceUpdate()}bindExclusiveTool(t){return t?Object(r.b)(R,{onClick:()=>this.setExclusiveTool(t),tool:t}):null}async toggleTool(t){await a.tools.toggleTool(t),this.forceUpdate()}bindToggleTool(t){if(t)return Object(r.b)(R,{onClick:()=>this.toggleTool(t),tool:t})}}n(379),n(381),n(383);class B extends r.a{constructor(){super()}get pageState(){return this.props.page}componentWillUnmount(){this.unsubscribe()}componentDidMount(){this.renderLayerItem(),this.unsubscribe=l.b.subscribe(()=>{this.pageState&&this.pageState!==this.currentPage&&this.renderLayerItem()})}async renderLayerItem(){this.currentPage=this.pageState;const t=await this.currentPage.getLayers();this.setState({layers:t})}render(){const{layers:t}=this.state;return Object(r.b)("div",{class:"layerList"},t&&t.map((t,e,n)=>Object(r.b)(P,{showActive:!0,layer:t})))}}class F extends r.a{constructor(){super(),Object(i.b)(this,{choseLayers:t=>t.toolState.choseLayers}),this.state={collapsedPages:[]}}async componentDidMount(){const t=l.b.getState().sessionState.project;if(t){const e=t.pages;this.setState({pages:e})}}async chosePage(t){Object(s.a)("choose_page"),l.b.dispatch({type:"toolStateChoseLayer",layers:await t.getLayers()})}togglePage(t){const e=this.state.collapsedPages.concat([]),n=e.indexOf(t);n>-1?e.splice(n,1):e.push(t),this.setState({collapsedPages:e})}renderPage(t){const e=!(!this.state.choseLayers||!this.state.choseLayers.find(e=>e.page===t));return Object(r.b)("div",{class:"pageWrapper"},Object(r.b)("div",{class:`page-head ${e?"active":""}`},Object(r.b)("div",{onClick:()=>this.chosePage(t),class:"name"},t.name),Object(r.b)("div",{onClick:()=>Object(o.centerToPage)(t),class:"itemBtn"},Object(r.b)("i",{class:"fas fa-crosshairs"})),Object(r.b)("div",{class:"itemBtn",onClick:()=>this.togglePage(t)},-1===this.state.collapsedPages.indexOf(t)?Object(r.b)("i",{class:"far fa-minus-square"}):Object(r.b)("i",{class:"far fa-plus-square"}))),-1===this.state.collapsedPages.indexOf(t)?Object(r.b)("div",{class:"layerListWrapper"},Object(r.b)(B,{page:t})):null,Object(r.b)("div",{class:"pageLayerInfo"},"(",t.layerAmount," Layers)"))}render(){return Object(r.b)("div",{class:"pageList"},this.state.pages?this.state.pages.map(t=>this.renderPage(t)):null)}}class U extends r.a{constructor(){super(),Object(i.a)(this,{display:t=>!!t.sessionState.project,showListColumn:t=>t.viewState.showListColumn})}render(){return this.state.display?Object(r.b)("aside",{class:"sidebar sidebarLeft"},Object(r.b)(j,null),this.state.showListColumn?Object(r.b)(F,null):null):null}}var z=n(135),G=n(307),N=n(188);class H extends r.a{constructor(t){super(t),this.onToggleView=t=>{},Object(i.b)(this,{project:t=>t.sessionState.project}),this.state={loading:!!t.file,rendered:!1},t.file&&this.onLoadFile(t.file)}renderMain(){return window.document.title=this.state.project.name,Object(r.b)("div",{class:"mainContainer flexColumn"},this.state.rendered?null:Object(r.b)("div",{class:"modal is-active"},Object(r.b)("div",{class:"modal-background"}),Object(r.b)("div",{class:"modal-content"},Object(r.b)("div",{class:"is-size-4 p-4"},Object(r.b)("i",{class:"fas fa-spinner is-size-2  animated infinite spin"})," Rendering design file..."))),Object(r.b)(U,null),Object(r.b)("main",{class:"flexItem main"},Object(r.b)("div",{class:"canvasWrapper"},Object(r.b)(c,{onRendered:()=>this.setState({rendered:!0})}))),Object(r.b)(I,null))}async onLoadFile(t){this.setState({loading:!0});const{facade:e}=await Promise.resolve().then(n.bind(null,33));e.projectOpenLocalFile(t).then(async()=>{},t=>{Object(G.b)(t)}).then(()=>{this.setState({loading:!1})})}renderLoader(){return Object(r.b)("div",{class:"fileLoaderWrapper"},Object(r.b)("div",{class:"formatsWrapper"},Object(r.b)(N.a,null)),Object(r.b)(z.a,{onFile:t=>{this.onLoadFile(t)}}))}renderLoading(){return Object(r.b)("div",{class:"loading is-size-4"},Object(r.b)("i",{class:"fas fa-spinner is-size-2  animated infinite spin"})," Parsing... Please be patient.")}render(){return Object(r.b)("div",{class:"inspectStudio"},this.state.project?this.renderMain():this.state.loading?this.renderLoading():this.renderLoader())}}},79:function(t,e,n){t.exports=n.p+"50705c5ed1205b63efdbfee941a6b655.ttf"},80:function(t,e,n){t.exports=n.p+"ee7b96fa85d8fdb8c126409326ac2d2b.ttf"},81:function(t,e,n){t.exports=n.p+"1eb7a893589ddce89d81cdb22a356660.ttf"},82:function(t,e,n){t.exports=n.p+"fc84e998bc29b297ea20321e4c90b6ed.ttf"},83:function(t,e,n){t.exports=n.p+"d1efcd4d126837fe0dcf9b6cf3a00d64.ttf"},84:function(t,e,n){t.exports=n.p+"d08840599e05db7345652d3d417574a9.ttf"},85:function(t,e,n){t.exports=n.p+"bd19ad60600a1537c00d3b4923a5e5de.ttf"},86:function(t,e,n){t.exports=n.p+"89e2666c24d37055bcb60e9d2d9f7e35.ttf"},87:function(t,e,n){t.exports=n.p+"0fc25386220a58203994ce45fb4ae570.ttf"},88:function(t,e,n){t.exports=n.p+"75d8a15d657168eea8d8531c0cce43ca.otf"},89:function(t,e,n){t.exports=n.p+"18b540358f32829a0ef8b56a9f88799a.otf"},90:function(t,e,n){t.exports=n.p+"00101c1366fd581ebdf4c8e6eff251e3.otf"},91:function(t,e,n){t.exports=n.p+"8d99acb6bce338bbe1532ddcb36d4dfd.otf"},92:function(t,e,n){t.exports=n.p+"db78b9359171f24936b16d84f63af378.ttf"},93:function(t,e,n){!function(){function e(t,e){document.addEventListener?t.addEventListener("scroll",e,!1):t.attachEvent("scroll",e)}function n(t){this.a=document.createElement("div"),this.a.setAttribute("aria-hidden","true"),this.a.appendChild(document.createTextNode(t)),this.b=document.createElement("span"),this.c=document.createElement("span"),this.h=document.createElement("span"),this.f=document.createElement("span"),this.g=-1,this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.b.appendChild(this.h),this.c.appendChild(this.f),this.a.appendChild(this.b),this.a.appendChild(this.c)}function r(t,e){t.a.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+e+";"}function i(t){var e=t.a.offsetWidth,n=e+100;return t.f.style.width=n+"px",t.c.scrollLeft=n,t.b.scrollLeft=t.b.scrollWidth+100,t.g!==e&&(t.g=e,!0)}function o(t,n){function r(){var t=o;i(t)&&t.a.parentNode&&n(t.g)}var o=t;e(t.b,r),e(t.c,r),i(t)}function a(t,e){var n=e||{};this.family=t,this.style=n.style||"normal",this.weight=n.weight||"normal",this.stretch=n.stretch||"normal"}var s=null,l=null,c=null,h=null;function u(){return null===h&&(h=!!document.fonts),h}function f(){if(null===c){var t=document.createElement("div");try{t.style.font="condensed 100px sans-serif"}catch(t){}c=""!==t.style.font}return c}function p(t,e){return[t.style,t.weight,f()?t.stretch:"","100px",e].join(" ")}a.prototype.load=function(t,e){var i=this,a=t||"BESbswy",c=0,h=e||3e3,f=(new Date).getTime();return new Promise((function(t,e){if(u()&&!function(){if(null===l)if(u()&&/Apple/.test(window.navigator.vendor)){var t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent);l=!!t&&603>parseInt(t[1],10)}else l=!1;return l}()){var d=new Promise((function(t,e){!function n(){(new Date).getTime()-f>=h?e(Error(h+"ms timeout exceeded")):document.fonts.load(p(i,'"'+i.family+'"'),a).then((function(e){1<=e.length?t():setTimeout(n,25)}),e)}()})),g=new Promise((function(t,e){c=setTimeout((function(){e(Error(h+"ms timeout exceeded"))}),h)}));Promise.race([g,d]).then((function(){clearTimeout(c),t(i)}),e)}else!function(t){document.body?t():document.addEventListener?document.addEventListener("DOMContentLoaded",(function e(){document.removeEventListener("DOMContentLoaded",e),t()})):document.attachEvent("onreadystatechange",(function e(){"interactive"!=document.readyState&&"complete"!=document.readyState||(document.detachEvent("onreadystatechange",e),t())}))}((function(){function l(){var e;(e=-1!=v&&-1!=m||-1!=v&&-1!=y||-1!=m&&-1!=y)&&((e=v!=m&&v!=y&&m!=y)||(null===s&&(e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),s=!!e&&(536>parseInt(e[1],10)||536===parseInt(e[1],10)&&11>=parseInt(e[2],10))),e=s&&(v==b&&m==b&&y==b||v==x&&m==x&&y==x||v==w&&m==w&&y==w)),e=!e),e&&(S.parentNode&&S.parentNode.removeChild(S),clearTimeout(c),t(i))}var u=new n(a),d=new n(a),g=new n(a),v=-1,m=-1,y=-1,b=-1,x=-1,w=-1,S=document.createElement("div");S.dir="ltr",r(u,p(i,"sans-serif")),r(d,p(i,"serif")),r(g,p(i,"monospace")),S.appendChild(u.a),S.appendChild(d.a),S.appendChild(g.a),document.body.appendChild(S),b=u.a.offsetWidth,x=d.a.offsetWidth,w=g.a.offsetWidth,function t(){if((new Date).getTime()-f>=h)S.parentNode&&S.parentNode.removeChild(S),e(Error(h+"ms timeout exceeded"));else{var n=document.hidden;!0!==n&&void 0!==n||(v=u.a.offsetWidth,m=d.a.offsetWidth,y=g.a.offsetWidth,l()),c=setTimeout(t,50)}}(),o(u,(function(t){v=t,l()})),r(u,p(i,'"'+i.family+'",sans-serif')),o(d,(function(t){m=t,l()})),r(d,p(i,'"'+i.family+'",serif')),o(g,(function(t){y=t,l()})),r(g,p(i,'"'+i.family+'",monospace'))}))}))},t.exports=a}()},94:function(t,e,n){(function(e){var n=function(){"use strict";function t(n,i,o,a){"object"==typeof i&&(o=i.depth,a=i.prototype,i.filter,i=i.circular);var s=[],l=[],c=void 0!==e;return void 0===i&&(i=!0),void 0===o&&(o=1/0),function n(o,h){if(null===o)return null;if(0==h)return o;var u,f;if("object"!=typeof o)return o;if(t.__isArray(o))u=[];else if(t.__isRegExp(o))u=new RegExp(o.source,r(o)),o.lastIndex&&(u.lastIndex=o.lastIndex);else if(t.__isDate(o))u=new Date(o.getTime());else{if(c&&e.isBuffer(o))return u=e.allocUnsafe?e.allocUnsafe(o.length):new e(o.length),o.copy(u),u;void 0===a?(f=Object.getPrototypeOf(o),u=Object.create(f)):(u=Object.create(a),f=a)}if(i){var p=s.indexOf(o);if(-1!=p)return l[p];s.push(o),l.push(u)}for(var d in o){var g;f&&(g=Object.getOwnPropertyDescriptor(f,d)),g&&null==g.set||(u[d]=n(o[d],h-1))}return u}(n,o)}function n(t){return Object.prototype.toString.call(t)}function r(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}return t.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},t.__objToStr=n,t.__isDate=function(t){return"object"==typeof t&&"[object Date]"===n(t)},t.__isArray=function(t){return"object"==typeof t&&"[object Array]"===n(t)},t.__isRegExp=function(t){return"object"==typeof t&&"[object RegExp]"===n(t)},t.__getRegExpFlags=r,t}();t.exports&&(t.exports=n)}).call(this,n(11).Buffer)},95:function(t,e,n){var r;function i(){this.anchorPoint=void 0,this.reverse=!1,this.points=[]}i.prototype={constructor:i,Point:function(t,e){this.x=t,this.y=e},_findPolarAngle:function(t,e){var n,r;if(!t||!e)return 0;if(n=e.x-t.x,r=e.y-t.y,0==n&&0==r)return 0;var i=57.295779513082*Math.atan2(r,n);return this.reverse?0>=i&&(i+=360):i>=0&&(i+=360),i},addPoint:function(t,e){return void 0===this.anchorPoint?void(this.anchorPoint=new this.Point(t,e)):this.anchorPoint.y>e&&this.anchorPoint.x>t||this.anchorPoint.y===e&&this.anchorPoint.x>t||this.anchorPoint.y>e&&this.anchorPoint.x===t?(this.points.push(new this.Point(this.anchorPoint.x,this.anchorPoint.y)),void(this.anchorPoint=new this.Point(t,e))):void this.points.push(new this.Point(t,e))},_sortPoints:function(){var t=this;return this.points.sort((function(e,n){var r=t._findPolarAngle(t.anchorPoint,e),i=t._findPolarAngle(t.anchorPoint,n);return i>r?-1:r>i?1:0}))},_checkPoints:function(t,e,n){var r=this._findPolarAngle(t,e),i=this._findPolarAngle(t,n);return r>i?!(r-i>180):!(i>r)||i-r>180},getHull:function(){var t,e,n=[];if(this.reverse=this.points.every((function(t){return t.x<0&&t.y<0})),3>(e=(t=this._sortPoints()).length))return t.unshift(this.anchorPoint),t;for(n.push(t.shift(),t.shift());;){var r,i,o;if(n.push(t.shift()),r=n[n.length-3],i=n[n.length-2],o=n[n.length-1],this._checkPoints(r,i,o)&&n.splice(n.length-2,1),0==t.length){if(e==n.length){var a=this.anchorPoint;return(n=n.filter((function(t){return!!t}))).some((function(t){return t.x==a.x&&t.y==a.y}))||n.unshift(this.anchorPoint),n}e=(t=n).length,(n=[]).push(t.shift(),t.shift())}}}},void 0!==(r=function(){return i}.call(e,n,e,t))&&(t.exports=r),t.exports=i},96:function(t,e,n){t.exports=n(45)},97:function(t,e,n){!function(){"use strict";var e=n(46),r=function(t){this.curves=[],this._3d=!1,t&&(this.curves=t,this._3d=this.curves[0]._3d)};r.prototype={valueOf:function(){return this.toString()},toString:function(){return"["+this.curves.map((function(t){return e.pointsToString(t.points)})).join(", ")+"]"},addCurve:function(t){this.curves.push(t),this._3d=this._3d||t._3d},length:function(){return this.curves.map((function(t){return t.length()})).reduce((function(t,e){return t+e}))},curve:function(t){return this.curves[t]},bbox:function(){for(var t=this.curves,n=t[0].bbox(),r=1;r<t.length;r++)e.expandbox(n,t[r].bbox());return n},offset:function(t){var e=[];return this.curves.forEach((function(n){e=e.concat(n.offset(t))})),new r(e)}},t.exports=r}()},98:function(t,e,n){var r=n(99),i={x:!1,y:!1};function o(t,e,n){if("Z"!==e){if("M"!==e){var r=[!1,i.x,i.y].concat(n),o=new(t.bind.apply(t,r)),a=n.slice(-2);return i={x:a[0],y:a[1]},o}i={x:n[0],y:n[1]}}}t.exports=function(t,e){for(var n,i,a=r(e).split(" "),s=new RegExp("[MLCQZ]",""),l=[],c={C:6,Q:4,L:2,M:2};a.length;)n=a.splice(0,1)[0],s.test(n)&&(i=o(t,n,a.splice(0,c[n]).map(parseFloat)))&&l.push(i);return new t.PolyBezier(l)}},99:function(t,e){t.exports=function(t){var e,n,r,i,o,a,s=(t=t.replace(/,/g," ").replace(/-/g," - ").replace(/-\s+/g,"-").replace(/([a-zA-Z])/g," $1 ")).replace(/([a-zA-Z])\s?/g,"|$1").split("|"),l=s.length,c=[],h=0,u=0,f=0,p=0,d=0,g=0,v=0,m=0,y="";for(e=1;e<l;e++)if(i=(r=(n=s[e]).substring(0,1)).toLowerCase(),o=(c=(c=n.replace(r,"").trim().split(" ")).filter((function(t){return""!==t})).map(parseFloat)).length,"m"===i){if(y+="M ","m"===r?(f+=c[0],p+=c[1]):(f=c[0],p=c[1]),h=f,u=p,y+=f+" "+p+" ",o>2)for(a=0;a<o;a+=2)"m"===r?(f+=c[a],p+=c[a+1]):(f=c[a],p=c[a+1]),y+=["L",f,p,""].join(" ")}else if("l"===i)for(a=0;a<o;a+=2)"l"===r?(f+=c[a],p+=c[a+1]):(f=c[a],p=c[a+1]),y+=["L",f,p,""].join(" ");else if("h"===i)for(a=0;a<o;a++)"h"===r?f+=c[a]:f=c[a],y+=["L",f,p,""].join(" ");else if("v"===i)for(a=0;a<o;a++)"v"===r?p+=c[a]:p=c[a],y+=["L",f,p,""].join(" ");else if("q"===i)for(a=0;a<o;a+=4)"q"===r?(d=f+c[a],g=p+c[a+1],f+=c[a+2],p+=c[a+3]):(d=c[a],g=c[a+1],f=c[a+2],p=c[a+3]),y+=["Q",d,g,f,p,""].join(" ");else if("t"===i)for(a=0;a<o;a+=2)d=f+(f-d),g=p+(p-g),"t"===r?(f+=c[a],p+=c[a+1]):(f=c[a],p=c[a+1]),y+=["Q",d,g,f,p,""].join(" ");else if("c"===i)for(a=0;a<o;a+=6)"c"===r?(d=f+c[a],g=p+c[a+1],v=f+c[a+2],m=p+c[a+3],f+=c[a+4],p+=c[a+5]):(d=c[a],g=c[a+1],v=c[a+2],m=c[a+3],f=c[a+4],p=c[a+5]),y+=["C",d,g,v,m,f,p,""].join(" ");else if("s"===i)for(a=0;a<o;a+=4)d=f+(f-v),g=p+(p-m),"s"===r?(v=f+c[a],m=p+c[a+1],f+=c[a+2],p+=c[a+3]):(v=c[a],m=c[a+1],f=c[a+2],p=c[a+3]),y+=["C",d,g,v,m,f,p,""].join(" ");else"z"===i&&(y+="Z ",f=h,p=u);return y.trim()}}}]);